var ow=Object.defineProperty;var lw=(r,e,t)=>e in r?ow(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Ke=(r,e,t)=>lw(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var Yc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ld(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var af={exports:{}},Yo={},of={exports:{}},pt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tm;function cw(){if(Tm)return pt;Tm=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;function x(R){return R===null||typeof R!="object"?null:(R=g&&R[g]||R["@@iterator"],typeof R=="function"?R:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,v={};function _(R,b,ee){this.props=R,this.context=b,this.refs=v,this.updater=ee||m}_.prototype.isReactComponent={},_.prototype.setState=function(R,b){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,b,"setState")},_.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function S(){}S.prototype=_.prototype;function T(R,b,ee){this.props=R,this.context=b,this.refs=v,this.updater=ee||m}var C=T.prototype=new S;C.constructor=T,y(C,_.prototype),C.isPureReactComponent=!0;var A=Array.isArray,P=Object.prototype.hasOwnProperty,N={current:null},O={key:!0,ref:!0,__self:!0,__source:!0};function V(R,b,ee){var G,H={},me=null,Me=null;if(b!=null)for(G in b.ref!==void 0&&(Me=b.ref),b.key!==void 0&&(me=""+b.key),b)P.call(b,G)&&!O.hasOwnProperty(G)&&(H[G]=b[G]);var Fe=arguments.length-2;if(Fe===1)H.children=ee;else if(1<Fe){for(var be=Array(Fe),De=0;De<Fe;De++)be[De]=arguments[De+2];H.children=be}if(R&&R.defaultProps)for(G in Fe=R.defaultProps,Fe)H[G]===void 0&&(H[G]=Fe[G]);return{$$typeof:r,type:R,key:me,ref:Me,props:H,_owner:N.current}}function B(R,b){return{$$typeof:r,type:R.type,key:b,ref:R.ref,props:R.props,_owner:R._owner}}function te(R){return typeof R=="object"&&R!==null&&R.$$typeof===r}function ie(R){var b={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(ee){return b[ee]})}var D=/\/+/g;function J(R,b){return typeof R=="object"&&R!==null&&R.key!=null?ie(""+R.key):b.toString(36)}function F(R,b,ee,G,H){var me=typeof R;(me==="undefined"||me==="boolean")&&(R=null);var Me=!1;if(R===null)Me=!0;else switch(me){case"string":case"number":Me=!0;break;case"object":switch(R.$$typeof){case r:case e:Me=!0}}if(Me)return Me=R,H=H(Me),R=G===""?"."+J(Me,0):G,A(H)?(ee="",R!=null&&(ee=R.replace(D,"$&/")+"/"),F(H,b,ee,"",function(De){return De})):H!=null&&(te(H)&&(H=B(H,ee+(!H.key||Me&&Me.key===H.key?"":(""+H.key).replace(D,"$&/")+"/")+R)),b.push(H)),1;if(Me=0,G=G===""?".":G+":",A(R))for(var Fe=0;Fe<R.length;Fe++){me=R[Fe];var be=G+J(me,Fe);Me+=F(me,b,ee,be,H)}else if(be=x(R),typeof be=="function")for(R=be.call(R),Fe=0;!(me=R.next()).done;)me=me.value,be=G+J(me,Fe++),Me+=F(me,b,ee,be,H);else if(me==="object")throw b=String(R),Error("Objects are not valid as a React child (found: "+(b==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":b)+"). If you meant to render a collection of children, use an array instead.");return Me}function se(R,b,ee){if(R==null)return R;var G=[],H=0;return F(R,G,"","",function(me){return b.call(ee,me,H++)}),G}function Ee(R){if(R._status===-1){var b=R._result;b=b(),b.then(function(ee){(R._status===0||R._status===-1)&&(R._status=1,R._result=ee)},function(ee){(R._status===0||R._status===-1)&&(R._status=2,R._result=ee)}),R._status===-1&&(R._status=0,R._result=b)}if(R._status===1)return R._result.default;throw R._result}var le={current:null},xe={transition:null},X={ReactCurrentDispatcher:le,ReactCurrentBatchConfig:xe,ReactCurrentOwner:N};function pe(){throw Error("act(...) is not supported in production builds of React.")}return pt.Children={map:se,forEach:function(R,b,ee){se(R,function(){b.apply(this,arguments)},ee)},count:function(R){var b=0;return se(R,function(){b++}),b},toArray:function(R){return se(R,function(b){return b})||[]},only:function(R){if(!te(R))throw Error("React.Children.only expected to receive a single React element child.");return R}},pt.Component=_,pt.Fragment=t,pt.Profiler=i,pt.PureComponent=T,pt.StrictMode=n,pt.Suspense=u,pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,pt.act=pe,pt.cloneElement=function(R,b,ee){if(R==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+R+".");var G=y({},R.props),H=R.key,me=R.ref,Me=R._owner;if(b!=null){if(b.ref!==void 0&&(me=b.ref,Me=N.current),b.key!==void 0&&(H=""+b.key),R.type&&R.type.defaultProps)var Fe=R.type.defaultProps;for(be in b)P.call(b,be)&&!O.hasOwnProperty(be)&&(G[be]=b[be]===void 0&&Fe!==void 0?Fe[be]:b[be])}var be=arguments.length-2;if(be===1)G.children=ee;else if(1<be){Fe=Array(be);for(var De=0;De<be;De++)Fe[De]=arguments[De+2];G.children=Fe}return{$$typeof:r,type:R.type,key:H,ref:me,props:G,_owner:Me}},pt.createContext=function(R){return R={$$typeof:o,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},R.Provider={$$typeof:s,_context:R},R.Consumer=R},pt.createElement=V,pt.createFactory=function(R){var b=V.bind(null,R);return b.type=R,b},pt.createRef=function(){return{current:null}},pt.forwardRef=function(R){return{$$typeof:c,render:R}},pt.isValidElement=te,pt.lazy=function(R){return{$$typeof:h,_payload:{_status:-1,_result:R},_init:Ee}},pt.memo=function(R,b){return{$$typeof:d,type:R,compare:b===void 0?null:b}},pt.startTransition=function(R){var b=xe.transition;xe.transition={};try{R()}finally{xe.transition=b}},pt.unstable_act=pe,pt.useCallback=function(R,b){return le.current.useCallback(R,b)},pt.useContext=function(R){return le.current.useContext(R)},pt.useDebugValue=function(){},pt.useDeferredValue=function(R){return le.current.useDeferredValue(R)},pt.useEffect=function(R,b){return le.current.useEffect(R,b)},pt.useId=function(){return le.current.useId()},pt.useImperativeHandle=function(R,b,ee){return le.current.useImperativeHandle(R,b,ee)},pt.useInsertionEffect=function(R,b){return le.current.useInsertionEffect(R,b)},pt.useLayoutEffect=function(R,b){return le.current.useLayoutEffect(R,b)},pt.useMemo=function(R,b){return le.current.useMemo(R,b)},pt.useReducer=function(R,b,ee){return le.current.useReducer(R,b,ee)},pt.useRef=function(R){return le.current.useRef(R)},pt.useState=function(R){return le.current.useState(R)},pt.useSyncExternalStore=function(R,b,ee){return le.current.useSyncExternalStore(R,b,ee)},pt.useTransition=function(){return le.current.useTransition()},pt.version="18.3.1",pt}var Em;function cd(){return Em||(Em=1,of.exports=cw()),of.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Am;function uw(){if(Am)return Yo;Am=1;var r=cd(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(c,u,d){var h,g={},x=null,m=null;d!==void 0&&(x=""+d),u.key!==void 0&&(x=""+u.key),u.ref!==void 0&&(m=u.ref);for(h in u)n.call(u,h)&&!s.hasOwnProperty(h)&&(g[h]=u[h]);if(c&&c.defaultProps)for(h in u=c.defaultProps,u)g[h]===void 0&&(g[h]=u[h]);return{$$typeof:e,type:c,key:x,ref:m,props:g,_owner:i.current}}return Yo.Fragment=t,Yo.jsx=o,Yo.jsxs=o,Yo}var bm;function hw(){return bm||(bm=1,af.exports=uw()),af.exports}var L=hw(),vt=cd();const Lx=ld(vt);var $c={},lf={exports:{}},Jr={},cf={exports:{}},uf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fm;function fw(){return Fm||(Fm=1,(function(r){function e(xe,X){var pe=xe.length;xe.push(X);e:for(;0<pe;){var R=pe-1>>>1,b=xe[R];if(0<i(b,X))xe[R]=X,xe[pe]=b,pe=R;else break e}}function t(xe){return xe.length===0?null:xe[0]}function n(xe){if(xe.length===0)return null;var X=xe[0],pe=xe.pop();if(pe!==X){xe[0]=pe;e:for(var R=0,b=xe.length,ee=b>>>1;R<ee;){var G=2*(R+1)-1,H=xe[G],me=G+1,Me=xe[me];if(0>i(H,pe))me<b&&0>i(Me,H)?(xe[R]=Me,xe[me]=pe,R=me):(xe[R]=H,xe[G]=pe,R=G);else if(me<b&&0>i(Me,pe))xe[R]=Me,xe[me]=pe,R=me;else break e}}return X}function i(xe,X){var pe=xe.sortIndex-X.sortIndex;return pe!==0?pe:xe.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var o=Date,c=o.now();r.unstable_now=function(){return o.now()-c}}var u=[],d=[],h=1,g=null,x=3,m=!1,y=!1,v=!1,_=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(xe){for(var X=t(d);X!==null;){if(X.callback===null)n(d);else if(X.startTime<=xe)n(d),X.sortIndex=X.expirationTime,e(u,X);else break;X=t(d)}}function A(xe){if(v=!1,C(xe),!y)if(t(u)!==null)y=!0,Ee(P);else{var X=t(d);X!==null&&le(A,X.startTime-xe)}}function P(xe,X){y=!1,v&&(v=!1,S(V),V=-1),m=!0;var pe=x;try{for(C(X),g=t(u);g!==null&&(!(g.expirationTime>X)||xe&&!ie());){var R=g.callback;if(typeof R=="function"){g.callback=null,x=g.priorityLevel;var b=R(g.expirationTime<=X);X=r.unstable_now(),typeof b=="function"?g.callback=b:g===t(u)&&n(u),C(X)}else n(u);g=t(u)}if(g!==null)var ee=!0;else{var G=t(d);G!==null&&le(A,G.startTime-X),ee=!1}return ee}finally{g=null,x=pe,m=!1}}var N=!1,O=null,V=-1,B=5,te=-1;function ie(){return!(r.unstable_now()-te<B)}function D(){if(O!==null){var xe=r.unstable_now();te=xe;var X=!0;try{X=O(!0,xe)}finally{X?J():(N=!1,O=null)}}else N=!1}var J;if(typeof T=="function")J=function(){T(D)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,se=F.port2;F.port1.onmessage=D,J=function(){se.postMessage(null)}}else J=function(){_(D,0)};function Ee(xe){O=xe,N||(N=!0,J())}function le(xe,X){V=_(function(){xe(r.unstable_now())},X)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(xe){xe.callback=null},r.unstable_continueExecution=function(){y||m||(y=!0,Ee(P))},r.unstable_forceFrameRate=function(xe){0>xe||125<xe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<xe?Math.floor(1e3/xe):5},r.unstable_getCurrentPriorityLevel=function(){return x},r.unstable_getFirstCallbackNode=function(){return t(u)},r.unstable_next=function(xe){switch(x){case 1:case 2:case 3:var X=3;break;default:X=x}var pe=x;x=X;try{return xe()}finally{x=pe}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(xe,X){switch(xe){case 1:case 2:case 3:case 4:case 5:break;default:xe=3}var pe=x;x=xe;try{return X()}finally{x=pe}},r.unstable_scheduleCallback=function(xe,X,pe){var R=r.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?R+pe:R):pe=R,xe){case 1:var b=-1;break;case 2:b=250;break;case 5:b=1073741823;break;case 4:b=1e4;break;default:b=5e3}return b=pe+b,xe={id:h++,callback:X,priorityLevel:xe,startTime:pe,expirationTime:b,sortIndex:-1},pe>R?(xe.sortIndex=pe,e(d,xe),t(u)===null&&xe===t(d)&&(v?(S(V),V=-1):v=!0,le(A,pe-R))):(xe.sortIndex=b,e(u,xe),y||m||(y=!0,Ee(P))),xe},r.unstable_shouldYield=ie,r.unstable_wrapCallback=function(xe){var X=x;return function(){var pe=x;x=X;try{return xe.apply(this,arguments)}finally{x=pe}}}})(uf)),uf}var Om;function dw(){return Om||(Om=1,cf.exports=fw()),cf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dm;function gw(){if(Dm)return Jr;Dm=1;var r=cd(),e=dw();function t(a){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+a,f=1;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function s(a,l){o(a,l),o(a+"Capture",l)}function o(a,l){for(i[a]=l,a=0;a<l.length;a++)n.add(l[a])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},g={};function x(a){return u.call(g,a)?!0:u.call(h,a)?!1:d.test(a)?g[a]=!0:(h[a]=!0,!1)}function m(a,l,f,p){if(f!==null&&f.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return p?!1:f!==null?!f.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function y(a,l,f,p){if(l===null||typeof l>"u"||m(a,l,f,p))return!0;if(p)return!1;if(f!==null)switch(f.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function v(a,l,f,p,w,k,M){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=p,this.attributeNamespace=w,this.mustUseProperty=f,this.propertyName=a,this.type=l,this.sanitizeURL=k,this.removeEmptyString=M}var _={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){_[a]=new v(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var l=a[0];_[l]=new v(l,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){_[a]=new v(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){_[a]=new v(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){_[a]=new v(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){_[a]=new v(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){_[a]=new v(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){_[a]=new v(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){_[a]=new v(a,5,!1,a.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function T(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var l=a.replace(S,T);_[l]=new v(l,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var l=a.replace(S,T);_[l]=new v(l,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var l=a.replace(S,T);_[l]=new v(l,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){_[a]=new v(a,1,!1,a.toLowerCase(),null,!1,!1)}),_.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){_[a]=new v(a,1,!1,a.toLowerCase(),null,!0,!0)});function C(a,l,f,p){var w=_.hasOwnProperty(l)?_[l]:null;(w!==null?w.type!==0:p||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(y(l,f,w,p)&&(f=null),p||w===null?x(l)&&(f===null?a.removeAttribute(l):a.setAttribute(l,""+f)):w.mustUseProperty?a[w.propertyName]=f===null?w.type===3?!1:"":f:(l=w.attributeName,p=w.attributeNamespace,f===null?a.removeAttribute(l):(w=w.type,f=w===3||w===4&&f===!0?"":""+f,p?a.setAttributeNS(p,l,f):a.setAttribute(l,f))))}var A=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,P=Symbol.for("react.element"),N=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),te=Symbol.for("react.provider"),ie=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),J=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),se=Symbol.for("react.memo"),Ee=Symbol.for("react.lazy"),le=Symbol.for("react.offscreen"),xe=Symbol.iterator;function X(a){return a===null||typeof a!="object"?null:(a=xe&&a[xe]||a["@@iterator"],typeof a=="function"?a:null)}var pe=Object.assign,R;function b(a){if(R===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);R=l&&l[1]||""}return`
`+R+a}var ee=!1;function G(a,l){if(!a||ee)return"";ee=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(Te){var p=Te}Reflect.construct(a,[],l)}else{try{l.call()}catch(Te){p=Te}a.call(l.prototype)}else{try{throw Error()}catch(Te){p=Te}a()}}catch(Te){if(Te&&p&&typeof Te.stack=="string"){for(var w=Te.stack.split(`
`),k=p.stack.split(`
`),M=w.length-1,Q=k.length-1;1<=M&&0<=Q&&w[M]!==k[Q];)Q--;for(;1<=M&&0<=Q;M--,Q--)if(w[M]!==k[Q]){if(M!==1||Q!==1)do if(M--,Q--,0>Q||w[M]!==k[Q]){var oe=`
`+w[M].replace(" at new "," at ");return a.displayName&&oe.includes("<anonymous>")&&(oe=oe.replace("<anonymous>",a.displayName)),oe}while(1<=M&&0<=Q);break}}}finally{ee=!1,Error.prepareStackTrace=f}return(a=a?a.displayName||a.name:"")?b(a):""}function H(a){switch(a.tag){case 5:return b(a.type);case 16:return b("Lazy");case 13:return b("Suspense");case 19:return b("SuspenseList");case 0:case 2:case 15:return a=G(a.type,!1),a;case 11:return a=G(a.type.render,!1),a;case 1:return a=G(a.type,!0),a;default:return""}}function me(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case O:return"Fragment";case N:return"Portal";case B:return"Profiler";case V:return"StrictMode";case J:return"Suspense";case F:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case ie:return(a.displayName||"Context")+".Consumer";case te:return(a._context.displayName||"Context")+".Provider";case D:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case se:return l=a.displayName||null,l!==null?l:me(a.type)||"Memo";case Ee:l=a._payload,a=a._init;try{return me(a(l))}catch{}}return null}function Me(a){var l=a.type;switch(a.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=l.render,a=a.displayName||a.name||"",l.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return me(l);case 8:return l===V?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function Fe(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function be(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function De(a){var l=be(a)?"checked":"value",f=Object.getOwnPropertyDescriptor(a.constructor.prototype,l),p=""+a[l];if(!a.hasOwnProperty(l)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var w=f.get,k=f.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return w.call(this)},set:function(M){p=""+M,k.call(this,M)}}),Object.defineProperty(a,l,{enumerable:f.enumerable}),{getValue:function(){return p},setValue:function(M){p=""+M},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function ne(a){a._valueTracker||(a._valueTracker=De(a))}function z(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var f=l.getValue(),p="";return a&&(p=be(a)?a.checked?"true":"false":a.value),a=p,a!==f?(l.setValue(a),!0):!1}function Le(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function E(a,l){var f=l.checked;return pe({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??a._wrapperState.initialChecked})}function de(a,l){var f=l.defaultValue==null?"":l.defaultValue,p=l.checked!=null?l.checked:l.defaultChecked;f=Fe(l.value!=null?l.value:f),a._wrapperState={initialChecked:p,initialValue:f,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function ce(a,l){l=l.checked,l!=null&&C(a,"checked",l,!1)}function j(a,l){ce(a,l);var f=Fe(l.value),p=l.type;if(f!=null)p==="number"?(f===0&&a.value===""||a.value!=f)&&(a.value=""+f):a.value!==""+f&&(a.value=""+f);else if(p==="submit"||p==="reset"){a.removeAttribute("value");return}l.hasOwnProperty("value")?ae(a,l.type,f):l.hasOwnProperty("defaultValue")&&ae(a,l.type,Fe(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(a.defaultChecked=!!l.defaultChecked)}function U(a,l,f){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var p=l.type;if(!(p!=="submit"&&p!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+a._wrapperState.initialValue,f||l===a.value||(a.value=l),a.defaultValue=l}f=a.name,f!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,f!==""&&(a.name=f)}function ae(a,l,f){(l!=="number"||Le(a.ownerDocument)!==a)&&(f==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+f&&(a.defaultValue=""+f))}var Ae=Array.isArray;function Pe(a,l,f,p){if(a=a.options,l){l={};for(var w=0;w<f.length;w++)l["$"+f[w]]=!0;for(f=0;f<a.length;f++)w=l.hasOwnProperty("$"+a[f].value),a[f].selected!==w&&(a[f].selected=w),w&&p&&(a[f].defaultSelected=!0)}else{for(f=""+Fe(f),l=null,w=0;w<a.length;w++){if(a[w].value===f){a[w].selected=!0,p&&(a[w].defaultSelected=!0);return}l!==null||a[w].disabled||(l=a[w])}l!==null&&(l.selected=!0)}}function ge(a,l){if(l.dangerouslySetInnerHTML!=null)throw Error(t(91));return pe({},l,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function Oe(a,l){var f=l.value;if(f==null){if(f=l.children,l=l.defaultValue,f!=null){if(l!=null)throw Error(t(92));if(Ae(f)){if(1<f.length)throw Error(t(93));f=f[0]}l=f}l==null&&(l=""),f=l}a._wrapperState={initialValue:Fe(f)}}function Re(a,l){var f=Fe(l.value),p=Fe(l.defaultValue);f!=null&&(f=""+f,f!==a.value&&(a.value=f),l.defaultValue==null&&a.defaultValue!==f&&(a.defaultValue=f)),p!=null&&(a.defaultValue=""+p)}function Be(a){var l=a.textContent;l===a._wrapperState.initialValue&&l!==""&&l!==null&&(a.value=l)}function re(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function nt(a,l){return a==null||a==="http://www.w3.org/1999/xhtml"?re(l):a==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var He,Ne=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,f,p,w){MSApp.execUnsafeLocalFunction(function(){return a(l,f,p,w)})}:a})(function(a,l){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=l;else{for(He=He||document.createElement("div"),He.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=He.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;l.firstChild;)a.appendChild(l.firstChild)}});function Ye(a,l){if(l){var f=a.firstChild;if(f&&f===a.lastChild&&f.nodeType===3){f.nodeValue=l;return}}a.textContent=l}var Ze={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dt=["Webkit","ms","Moz","O"];Object.keys(Ze).forEach(function(a){dt.forEach(function(l){l=l+a.charAt(0).toUpperCase()+a.substring(1),Ze[l]=Ze[a]})});function st(a,l,f){return l==null||typeof l=="boolean"||l===""?"":f||typeof l!="number"||l===0||Ze.hasOwnProperty(a)&&Ze[a]?(""+l).trim():l+"px"}function Ht(a,l){a=a.style;for(var f in l)if(l.hasOwnProperty(f)){var p=f.indexOf("--")===0,w=st(f,l[f],p);f==="float"&&(f="cssFloat"),p?a.setProperty(f,w):a[f]=w}}var Nn=pe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function pr(a,l){if(l){if(Nn[a]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(t(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(t(61))}if(l.style!=null&&typeof l.style!="object")throw Error(t(62))}}function mn(a,l){if(a.indexOf("-")===-1)return typeof l.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yi=null;function ni(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var $i=null,In=null,Gr=null;function xn(a){if(a=Po(a)){if(typeof $i!="function")throw Error(t(280));var l=a.stateNode;l&&(l=lc(l),$i(a.stateNode,a.type,l))}}function jl(a){In?Gr?Gr.push(a):Gr=[a]:In=a}function zl(){if(In){var a=In,l=Gr;if(Gr=In=null,xn(a),l)for(a=0;a<l.length;a++)xn(l[a])}}function Ul(a,l){return a(l)}function Vl(){}var uo=!1;function Wl(a,l,f){if(uo)return a(l,f);uo=!0;try{return Ul(a,l,f)}finally{uo=!1,(In!==null||Gr!==null)&&(Vl(),zl())}}function Fs(a,l){var f=a.stateNode;if(f===null)return null;var p=lc(f);if(p===null)return null;f=p[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(a=a.type,p=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!p;break e;default:a=!1}if(a)return null;if(f&&typeof f!="function")throw Error(t(231,l,typeof f));return f}var ho=!1;if(c)try{var _i={};Object.defineProperty(_i,"passive",{get:function(){ho=!0}}),window.addEventListener("test",_i,_i),window.removeEventListener("test",_i,_i)}catch{ho=!1}function Th(a,l,f,p,w,k,M,Q,oe){var Te=Array.prototype.slice.call(arguments,3);try{l.apply(f,Te)}catch(ze){this.onError(ze)}}var Os=!1,fa=null,I=!1,K=null,W={onError:function(a){Os=!0,fa=a}};function Y(a,l,f,p,w,k,M,Q,oe){Os=!1,fa=null,Th.apply(W,arguments)}function Z(a,l,f,p,w,k,M,Q,oe){if(Y.apply(this,arguments),Os){if(Os){var Te=fa;Os=!1,fa=null}else throw Error(t(198));I||(I=!0,K=Te)}}function q(a){var l=a,f=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(f=l.return),a=l.return;while(a)}return l.tag===3?f:null}function we(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function Ie(a){if(q(a)!==a)throw Error(t(188))}function _e(a){var l=a.alternate;if(!l){if(l=q(a),l===null)throw Error(t(188));return l!==a?null:a}for(var f=a,p=l;;){var w=f.return;if(w===null)break;var k=w.alternate;if(k===null){if(p=w.return,p!==null){f=p;continue}break}if(w.child===k.child){for(k=w.child;k;){if(k===f)return Ie(w),a;if(k===p)return Ie(w),l;k=k.sibling}throw Error(t(188))}if(f.return!==p.return)f=w,p=k;else{for(var M=!1,Q=w.child;Q;){if(Q===f){M=!0,f=w,p=k;break}if(Q===p){M=!0,p=w,f=k;break}Q=Q.sibling}if(!M){for(Q=k.child;Q;){if(Q===f){M=!0,f=k,p=w;break}if(Q===p){M=!0,p=k,f=w;break}Q=Q.sibling}if(!M)throw Error(t(189))}}if(f.alternate!==p)throw Error(t(190))}if(f.tag!==3)throw Error(t(188));return f.stateNode.current===f?a:l}function Se(a){return a=_e(a),a!==null?ke(a):null}function ke(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var l=ke(a);if(l!==null)return l;a=a.sibling}return null}var Ue=e.unstable_scheduleCallback,$e=e.unstable_cancelCallback,Je=e.unstable_shouldYield,Xe=e.unstable_requestPaint,We=e.unstable_now,ut=e.unstable_getCurrentPriorityLevel,bt=e.unstable_ImmediatePriority,Ft=e.unstable_UserBlockingPriority,Xt=e.unstable_NormalPriority,Ds=e.unstable_LowPriority,Ki=e.unstable_IdlePriority,ii=null,cr=null;function fo(a){if(cr&&typeof cr.onCommitFiberRoot=="function")try{cr.onCommitFiberRoot(ii,a,void 0,(a.current.flags&128)===128)}catch{}}var Gt=Math.clz32?Math.clz32:T2,k2=Math.log,C2=Math.LN2;function T2(a){return a>>>=0,a===0?32:31-(k2(a)/C2|0)|0}var Hl=64,Xl=4194304;function go(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function Gl(a,l){var f=a.pendingLanes;if(f===0)return 0;var p=0,w=a.suspendedLanes,k=a.pingedLanes,M=f&268435455;if(M!==0){var Q=M&~w;Q!==0?p=go(Q):(k&=M,k!==0&&(p=go(k)))}else M=f&~w,M!==0?p=go(M):k!==0&&(p=go(k));if(p===0)return 0;if(l!==0&&l!==p&&(l&w)===0&&(w=p&-p,k=l&-l,w>=k||w===16&&(k&4194240)!==0))return l;if((p&4)!==0&&(p|=f&16),l=a.entangledLanes,l!==0)for(a=a.entanglements,l&=p;0<l;)f=31-Gt(l),w=1<<f,p|=a[f],l&=~w;return p}function E2(a,l){switch(a){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function A2(a,l){for(var f=a.suspendedLanes,p=a.pingedLanes,w=a.expirationTimes,k=a.pendingLanes;0<k;){var M=31-Gt(k),Q=1<<M,oe=w[M];oe===-1?((Q&f)===0||(Q&p)!==0)&&(w[M]=E2(Q,l)):oe<=l&&(a.expiredLanes|=Q),k&=~Q}}function Eh(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function rg(){var a=Hl;return Hl<<=1,(Hl&4194240)===0&&(Hl=64),a}function Ah(a){for(var l=[],f=0;31>f;f++)l.push(a);return l}function po(a,l,f){a.pendingLanes|=l,l!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,l=31-Gt(l),a[l]=f}function b2(a,l){var f=a.pendingLanes&~l;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=l,a.mutableReadLanes&=l,a.entangledLanes&=l,l=a.entanglements;var p=a.eventTimes;for(a=a.expirationTimes;0<f;){var w=31-Gt(f),k=1<<w;l[w]=0,p[w]=-1,a[w]=-1,f&=~k}}function bh(a,l){var f=a.entangledLanes|=l;for(a=a.entanglements;f;){var p=31-Gt(f),w=1<<p;w&l|a[p]&l&&(a[p]|=l),f&=~w}}var Et=0;function ng(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var ig,Fh,sg,ag,og,Oh=!1,Yl=[],Zi=null,qi=null,Ji=null,mo=new Map,xo=new Map,Qi=[],F2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function lg(a,l){switch(a){case"focusin":case"focusout":Zi=null;break;case"dragenter":case"dragleave":qi=null;break;case"mouseover":case"mouseout":Ji=null;break;case"pointerover":case"pointerout":mo.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":xo.delete(l.pointerId)}}function vo(a,l,f,p,w,k){return a===null||a.nativeEvent!==k?(a={blockedOn:l,domEventName:f,eventSystemFlags:p,nativeEvent:k,targetContainers:[w]},l!==null&&(l=Po(l),l!==null&&Fh(l)),a):(a.eventSystemFlags|=p,l=a.targetContainers,w!==null&&l.indexOf(w)===-1&&l.push(w),a)}function O2(a,l,f,p,w){switch(l){case"focusin":return Zi=vo(Zi,a,l,f,p,w),!0;case"dragenter":return qi=vo(qi,a,l,f,p,w),!0;case"mouseover":return Ji=vo(Ji,a,l,f,p,w),!0;case"pointerover":var k=w.pointerId;return mo.set(k,vo(mo.get(k)||null,a,l,f,p,w)),!0;case"gotpointercapture":return k=w.pointerId,xo.set(k,vo(xo.get(k)||null,a,l,f,p,w)),!0}return!1}function cg(a){var l=Ps(a.target);if(l!==null){var f=q(l);if(f!==null){if(l=f.tag,l===13){if(l=we(f),l!==null){a.blockedOn=l,og(a.priority,function(){sg(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){a.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}a.blockedOn=null}function $l(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var f=Ph(a.domEventName,a.eventSystemFlags,l[0],a.nativeEvent);if(f===null){f=a.nativeEvent;var p=new f.constructor(f.type,f);yi=p,f.target.dispatchEvent(p),yi=null}else return l=Po(f),l!==null&&Fh(l),a.blockedOn=f,!1;l.shift()}return!0}function ug(a,l,f){$l(a)&&f.delete(l)}function D2(){Oh=!1,Zi!==null&&$l(Zi)&&(Zi=null),qi!==null&&$l(qi)&&(qi=null),Ji!==null&&$l(Ji)&&(Ji=null),mo.forEach(ug),xo.forEach(ug)}function yo(a,l){a.blockedOn===l&&(a.blockedOn=null,Oh||(Oh=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,D2)))}function _o(a){function l(w){return yo(w,a)}if(0<Yl.length){yo(Yl[0],a);for(var f=1;f<Yl.length;f++){var p=Yl[f];p.blockedOn===a&&(p.blockedOn=null)}}for(Zi!==null&&yo(Zi,a),qi!==null&&yo(qi,a),Ji!==null&&yo(Ji,a),mo.forEach(l),xo.forEach(l),f=0;f<Qi.length;f++)p=Qi[f],p.blockedOn===a&&(p.blockedOn=null);for(;0<Qi.length&&(f=Qi[0],f.blockedOn===null);)cg(f),f.blockedOn===null&&Qi.shift()}var da=A.ReactCurrentBatchConfig,Kl=!0;function P2(a,l,f,p){var w=Et,k=da.transition;da.transition=null;try{Et=1,Dh(a,l,f,p)}finally{Et=w,da.transition=k}}function M2(a,l,f,p){var w=Et,k=da.transition;da.transition=null;try{Et=4,Dh(a,l,f,p)}finally{Et=w,da.transition=k}}function Dh(a,l,f,p){if(Kl){var w=Ph(a,l,f,p);if(w===null)Kh(a,l,p,Zl,f),lg(a,p);else if(O2(w,a,l,f,p))p.stopPropagation();else if(lg(a,p),l&4&&-1<F2.indexOf(a)){for(;w!==null;){var k=Po(w);if(k!==null&&ig(k),k=Ph(a,l,f,p),k===null&&Kh(a,l,p,Zl,f),k===w)break;w=k}w!==null&&p.stopPropagation()}else Kh(a,l,p,null,f)}}var Zl=null;function Ph(a,l,f,p){if(Zl=null,a=ni(p),a=Ps(a),a!==null)if(l=q(a),l===null)a=null;else if(f=l.tag,f===13){if(a=we(l),a!==null)return a;a=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null);return Zl=a,null}function hg(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ut()){case bt:return 1;case Ft:return 4;case Xt:case Ds:return 16;case Ki:return 536870912;default:return 16}default:return 16}}var es=null,Mh=null,ql=null;function fg(){if(ql)return ql;var a,l=Mh,f=l.length,p,w="value"in es?es.value:es.textContent,k=w.length;for(a=0;a<f&&l[a]===w[a];a++);var M=f-a;for(p=1;p<=M&&l[f-p]===w[k-p];p++);return ql=w.slice(a,1<p?1-p:void 0)}function Jl(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function Ql(){return!0}function dg(){return!1}function an(a){function l(f,p,w,k,M){this._reactName=f,this._targetInst=w,this.type=p,this.nativeEvent=k,this.target=M,this.currentTarget=null;for(var Q in a)a.hasOwnProperty(Q)&&(f=a[Q],this[Q]=f?f(k):k[Q]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?Ql:dg,this.isPropagationStopped=dg,this}return pe(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Ql)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Ql)},persist:function(){},isPersistent:Ql}),l}var ga={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nh=an(ga),wo=pe({},ga,{view:0,detail:0}),N2=an(wo),Ih,Rh,So,ec=pe({},wo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bh,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==So&&(So&&a.type==="mousemove"?(Ih=a.screenX-So.screenX,Rh=a.screenY-So.screenY):Rh=Ih=0,So=a),Ih)},movementY:function(a){return"movementY"in a?a.movementY:Rh}}),gg=an(ec),I2=pe({},ec,{dataTransfer:0}),R2=an(I2),L2=pe({},wo,{relatedTarget:0}),Lh=an(L2),B2=pe({},ga,{animationName:0,elapsedTime:0,pseudoElement:0}),j2=an(B2),z2=pe({},ga,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),U2=an(z2),V2=pe({},ga,{data:0}),pg=an(V2),W2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},H2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},X2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function G2(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=X2[a])?!!l[a]:!1}function Bh(){return G2}var Y2=pe({},wo,{key:function(a){if(a.key){var l=W2[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=Jl(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?H2[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bh,charCode:function(a){return a.type==="keypress"?Jl(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Jl(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),$2=an(Y2),K2=pe({},ec,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mg=an(K2),Z2=pe({},wo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bh}),q2=an(Z2),J2=pe({},ga,{propertyName:0,elapsedTime:0,pseudoElement:0}),Q2=an(J2),e_=pe({},ec,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),t_=an(e_),r_=[9,13,27,32],jh=c&&"CompositionEvent"in window,ko=null;c&&"documentMode"in document&&(ko=document.documentMode);var n_=c&&"TextEvent"in window&&!ko,xg=c&&(!jh||ko&&8<ko&&11>=ko),vg=" ",yg=!1;function _g(a,l){switch(a){case"keyup":return r_.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wg(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var pa=!1;function i_(a,l){switch(a){case"compositionend":return wg(l);case"keypress":return l.which!==32?null:(yg=!0,vg);case"textInput":return a=l.data,a===vg&&yg?null:a;default:return null}}function s_(a,l){if(pa)return a==="compositionend"||!jh&&_g(a,l)?(a=fg(),ql=Mh=es=null,pa=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return xg&&l.locale!=="ko"?null:l.data;default:return null}}var a_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sg(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!a_[a.type]:l==="textarea"}function kg(a,l,f,p){jl(p),l=sc(l,"onChange"),0<l.length&&(f=new Nh("onChange","change",null,f,p),a.push({event:f,listeners:l}))}var Co=null,To=null;function o_(a){Ug(a,0)}function tc(a){var l=_a(a);if(z(l))return a}function l_(a,l){if(a==="change")return l}var Cg=!1;if(c){var zh;if(c){var Uh="oninput"in document;if(!Uh){var Tg=document.createElement("div");Tg.setAttribute("oninput","return;"),Uh=typeof Tg.oninput=="function"}zh=Uh}else zh=!1;Cg=zh&&(!document.documentMode||9<document.documentMode)}function Eg(){Co&&(Co.detachEvent("onpropertychange",Ag),To=Co=null)}function Ag(a){if(a.propertyName==="value"&&tc(To)){var l=[];kg(l,To,a,ni(a)),Wl(o_,l)}}function c_(a,l,f){a==="focusin"?(Eg(),Co=l,To=f,Co.attachEvent("onpropertychange",Ag)):a==="focusout"&&Eg()}function u_(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return tc(To)}function h_(a,l){if(a==="click")return tc(l)}function f_(a,l){if(a==="input"||a==="change")return tc(l)}function d_(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var Rn=typeof Object.is=="function"?Object.is:d_;function Eo(a,l){if(Rn(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var f=Object.keys(a),p=Object.keys(l);if(f.length!==p.length)return!1;for(p=0;p<f.length;p++){var w=f[p];if(!u.call(l,w)||!Rn(a[w],l[w]))return!1}return!0}function bg(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Fg(a,l){var f=bg(a);a=0;for(var p;f;){if(f.nodeType===3){if(p=a+f.textContent.length,a<=l&&p>=l)return{node:f,offset:l-a};a=p}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=bg(f)}}function Og(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?Og(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function Dg(){for(var a=window,l=Le();l instanceof a.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)a=l.contentWindow;else break;l=Le(a.document)}return l}function Vh(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}function g_(a){var l=Dg(),f=a.focusedElem,p=a.selectionRange;if(l!==f&&f&&f.ownerDocument&&Og(f.ownerDocument.documentElement,f)){if(p!==null&&Vh(f)){if(l=p.start,a=p.end,a===void 0&&(a=l),"selectionStart"in f)f.selectionStart=l,f.selectionEnd=Math.min(a,f.value.length);else if(a=(l=f.ownerDocument||document)&&l.defaultView||window,a.getSelection){a=a.getSelection();var w=f.textContent.length,k=Math.min(p.start,w);p=p.end===void 0?k:Math.min(p.end,w),!a.extend&&k>p&&(w=p,p=k,k=w),w=Fg(f,k);var M=Fg(f,p);w&&M&&(a.rangeCount!==1||a.anchorNode!==w.node||a.anchorOffset!==w.offset||a.focusNode!==M.node||a.focusOffset!==M.offset)&&(l=l.createRange(),l.setStart(w.node,w.offset),a.removeAllRanges(),k>p?(a.addRange(l),a.extend(M.node,M.offset)):(l.setEnd(M.node,M.offset),a.addRange(l)))}}for(l=[],a=f;a=a.parentNode;)a.nodeType===1&&l.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<l.length;f++)a=l[f],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var p_=c&&"documentMode"in document&&11>=document.documentMode,ma=null,Wh=null,Ao=null,Hh=!1;function Pg(a,l,f){var p=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Hh||ma==null||ma!==Le(p)||(p=ma,"selectionStart"in p&&Vh(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Ao&&Eo(Ao,p)||(Ao=p,p=sc(Wh,"onSelect"),0<p.length&&(l=new Nh("onSelect","select",null,l,f),a.push({event:l,listeners:p}),l.target=ma)))}function rc(a,l){var f={};return f[a.toLowerCase()]=l.toLowerCase(),f["Webkit"+a]="webkit"+l,f["Moz"+a]="moz"+l,f}var xa={animationend:rc("Animation","AnimationEnd"),animationiteration:rc("Animation","AnimationIteration"),animationstart:rc("Animation","AnimationStart"),transitionend:rc("Transition","TransitionEnd")},Xh={},Mg={};c&&(Mg=document.createElement("div").style,"AnimationEvent"in window||(delete xa.animationend.animation,delete xa.animationiteration.animation,delete xa.animationstart.animation),"TransitionEvent"in window||delete xa.transitionend.transition);function nc(a){if(Xh[a])return Xh[a];if(!xa[a])return a;var l=xa[a],f;for(f in l)if(l.hasOwnProperty(f)&&f in Mg)return Xh[a]=l[f];return a}var Ng=nc("animationend"),Ig=nc("animationiteration"),Rg=nc("animationstart"),Lg=nc("transitionend"),Bg=new Map,jg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ts(a,l){Bg.set(a,l),s(l,[a])}for(var Gh=0;Gh<jg.length;Gh++){var Yh=jg[Gh],m_=Yh.toLowerCase(),x_=Yh[0].toUpperCase()+Yh.slice(1);ts(m_,"on"+x_)}ts(Ng,"onAnimationEnd"),ts(Ig,"onAnimationIteration"),ts(Rg,"onAnimationStart"),ts("dblclick","onDoubleClick"),ts("focusin","onFocus"),ts("focusout","onBlur"),ts(Lg,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),v_=new Set("cancel close invalid load scroll toggle".split(" ").concat(bo));function zg(a,l,f){var p=a.type||"unknown-event";a.currentTarget=f,Z(p,l,void 0,a),a.currentTarget=null}function Ug(a,l){l=(l&4)!==0;for(var f=0;f<a.length;f++){var p=a[f],w=p.event;p=p.listeners;e:{var k=void 0;if(l)for(var M=p.length-1;0<=M;M--){var Q=p[M],oe=Q.instance,Te=Q.currentTarget;if(Q=Q.listener,oe!==k&&w.isPropagationStopped())break e;zg(w,Q,Te),k=oe}else for(M=0;M<p.length;M++){if(Q=p[M],oe=Q.instance,Te=Q.currentTarget,Q=Q.listener,oe!==k&&w.isPropagationStopped())break e;zg(w,Q,Te),k=oe}}}if(I)throw a=K,I=!1,K=null,a}function Mt(a,l){var f=l[t0];f===void 0&&(f=l[t0]=new Set);var p=a+"__bubble";f.has(p)||(Vg(l,a,2,!1),f.add(p))}function $h(a,l,f){var p=0;l&&(p|=4),Vg(f,a,p,l)}var ic="_reactListening"+Math.random().toString(36).slice(2);function Fo(a){if(!a[ic]){a[ic]=!0,n.forEach(function(f){f!=="selectionchange"&&(v_.has(f)||$h(f,!1,a),$h(f,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[ic]||(l[ic]=!0,$h("selectionchange",!1,l))}}function Vg(a,l,f,p){switch(hg(l)){case 1:var w=P2;break;case 4:w=M2;break;default:w=Dh}f=w.bind(null,l,f,a),w=void 0,!ho||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(w=!0),p?w!==void 0?a.addEventListener(l,f,{capture:!0,passive:w}):a.addEventListener(l,f,!0):w!==void 0?a.addEventListener(l,f,{passive:w}):a.addEventListener(l,f,!1)}function Kh(a,l,f,p,w){var k=p;if((l&1)===0&&(l&2)===0&&p!==null)e:for(;;){if(p===null)return;var M=p.tag;if(M===3||M===4){var Q=p.stateNode.containerInfo;if(Q===w||Q.nodeType===8&&Q.parentNode===w)break;if(M===4)for(M=p.return;M!==null;){var oe=M.tag;if((oe===3||oe===4)&&(oe=M.stateNode.containerInfo,oe===w||oe.nodeType===8&&oe.parentNode===w))return;M=M.return}for(;Q!==null;){if(M=Ps(Q),M===null)return;if(oe=M.tag,oe===5||oe===6){p=k=M;continue e}Q=Q.parentNode}}p=p.return}Wl(function(){var Te=k,ze=ni(f),Ve=[];e:{var je=Bg.get(a);if(je!==void 0){var qe=Nh,tt=a;switch(a){case"keypress":if(Jl(f)===0)break e;case"keydown":case"keyup":qe=$2;break;case"focusin":tt="focus",qe=Lh;break;case"focusout":tt="blur",qe=Lh;break;case"beforeblur":case"afterblur":qe=Lh;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":qe=gg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":qe=R2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":qe=q2;break;case Ng:case Ig:case Rg:qe=j2;break;case Lg:qe=Q2;break;case"scroll":qe=N2;break;case"wheel":qe=t_;break;case"copy":case"cut":case"paste":qe=U2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":qe=mg}var rt=(l&4)!==0,Yt=!rt&&a==="scroll",ve=rt?je!==null?je+"Capture":null:je;rt=[];for(var fe=Te,ye;fe!==null;){ye=fe;var Ge=ye.stateNode;if(ye.tag===5&&Ge!==null&&(ye=Ge,ve!==null&&(Ge=Fs(fe,ve),Ge!=null&&rt.push(Oo(fe,Ge,ye)))),Yt)break;fe=fe.return}0<rt.length&&(je=new qe(je,tt,null,f,ze),Ve.push({event:je,listeners:rt}))}}if((l&7)===0){e:{if(je=a==="mouseover"||a==="pointerover",qe=a==="mouseout"||a==="pointerout",je&&f!==yi&&(tt=f.relatedTarget||f.fromElement)&&(Ps(tt)||tt[wi]))break e;if((qe||je)&&(je=ze.window===ze?ze:(je=ze.ownerDocument)?je.defaultView||je.parentWindow:window,qe?(tt=f.relatedTarget||f.toElement,qe=Te,tt=tt?Ps(tt):null,tt!==null&&(Yt=q(tt),tt!==Yt||tt.tag!==5&&tt.tag!==6)&&(tt=null)):(qe=null,tt=Te),qe!==tt)){if(rt=gg,Ge="onMouseLeave",ve="onMouseEnter",fe="mouse",(a==="pointerout"||a==="pointerover")&&(rt=mg,Ge="onPointerLeave",ve="onPointerEnter",fe="pointer"),Yt=qe==null?je:_a(qe),ye=tt==null?je:_a(tt),je=new rt(Ge,fe+"leave",qe,f,ze),je.target=Yt,je.relatedTarget=ye,Ge=null,Ps(ze)===Te&&(rt=new rt(ve,fe+"enter",tt,f,ze),rt.target=ye,rt.relatedTarget=Yt,Ge=rt),Yt=Ge,qe&&tt)t:{for(rt=qe,ve=tt,fe=0,ye=rt;ye;ye=va(ye))fe++;for(ye=0,Ge=ve;Ge;Ge=va(Ge))ye++;for(;0<fe-ye;)rt=va(rt),fe--;for(;0<ye-fe;)ve=va(ve),ye--;for(;fe--;){if(rt===ve||ve!==null&&rt===ve.alternate)break t;rt=va(rt),ve=va(ve)}rt=null}else rt=null;qe!==null&&Wg(Ve,je,qe,rt,!1),tt!==null&&Yt!==null&&Wg(Ve,Yt,tt,rt,!0)}}e:{if(je=Te?_a(Te):window,qe=je.nodeName&&je.nodeName.toLowerCase(),qe==="select"||qe==="input"&&je.type==="file")var it=l_;else if(Sg(je))if(Cg)it=f_;else{it=u_;var at=c_}else(qe=je.nodeName)&&qe.toLowerCase()==="input"&&(je.type==="checkbox"||je.type==="radio")&&(it=h_);if(it&&(it=it(a,Te))){kg(Ve,it,f,ze);break e}at&&at(a,je,Te),a==="focusout"&&(at=je._wrapperState)&&at.controlled&&je.type==="number"&&ae(je,"number",je.value)}switch(at=Te?_a(Te):window,a){case"focusin":(Sg(at)||at.contentEditable==="true")&&(ma=at,Wh=Te,Ao=null);break;case"focusout":Ao=Wh=ma=null;break;case"mousedown":Hh=!0;break;case"contextmenu":case"mouseup":case"dragend":Hh=!1,Pg(Ve,f,ze);break;case"selectionchange":if(p_)break;case"keydown":case"keyup":Pg(Ve,f,ze)}var ot;if(jh)e:{switch(a){case"compositionstart":var ct="onCompositionStart";break e;case"compositionend":ct="onCompositionEnd";break e;case"compositionupdate":ct="onCompositionUpdate";break e}ct=void 0}else pa?_g(a,f)&&(ct="onCompositionEnd"):a==="keydown"&&f.keyCode===229&&(ct="onCompositionStart");ct&&(xg&&f.locale!=="ko"&&(pa||ct!=="onCompositionStart"?ct==="onCompositionEnd"&&pa&&(ot=fg()):(es=ze,Mh="value"in es?es.value:es.textContent,pa=!0)),at=sc(Te,ct),0<at.length&&(ct=new pg(ct,a,null,f,ze),Ve.push({event:ct,listeners:at}),ot?ct.data=ot:(ot=wg(f),ot!==null&&(ct.data=ot)))),(ot=n_?i_(a,f):s_(a,f))&&(Te=sc(Te,"onBeforeInput"),0<Te.length&&(ze=new pg("onBeforeInput","beforeinput",null,f,ze),Ve.push({event:ze,listeners:Te}),ze.data=ot))}Ug(Ve,l)})}function Oo(a,l,f){return{instance:a,listener:l,currentTarget:f}}function sc(a,l){for(var f=l+"Capture",p=[];a!==null;){var w=a,k=w.stateNode;w.tag===5&&k!==null&&(w=k,k=Fs(a,f),k!=null&&p.unshift(Oo(a,k,w)),k=Fs(a,l),k!=null&&p.push(Oo(a,k,w))),a=a.return}return p}function va(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function Wg(a,l,f,p,w){for(var k=l._reactName,M=[];f!==null&&f!==p;){var Q=f,oe=Q.alternate,Te=Q.stateNode;if(oe!==null&&oe===p)break;Q.tag===5&&Te!==null&&(Q=Te,w?(oe=Fs(f,k),oe!=null&&M.unshift(Oo(f,oe,Q))):w||(oe=Fs(f,k),oe!=null&&M.push(Oo(f,oe,Q)))),f=f.return}M.length!==0&&a.push({event:l,listeners:M})}var y_=/\r\n?/g,__=/\u0000|\uFFFD/g;function Hg(a){return(typeof a=="string"?a:""+a).replace(y_,`
`).replace(__,"")}function ac(a,l,f){if(l=Hg(l),Hg(a)!==l&&f)throw Error(t(425))}function oc(){}var Zh=null,qh=null;function Jh(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Qh=typeof setTimeout=="function"?setTimeout:void 0,w_=typeof clearTimeout=="function"?clearTimeout:void 0,Xg=typeof Promise=="function"?Promise:void 0,S_=typeof queueMicrotask=="function"?queueMicrotask:typeof Xg<"u"?function(a){return Xg.resolve(null).then(a).catch(k_)}:Qh;function k_(a){setTimeout(function(){throw a})}function e0(a,l){var f=l,p=0;do{var w=f.nextSibling;if(a.removeChild(f),w&&w.nodeType===8)if(f=w.data,f==="/$"){if(p===0){a.removeChild(w),_o(l);return}p--}else f!=="$"&&f!=="$?"&&f!=="$!"||p++;f=w}while(f);_o(l)}function rs(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return a}function Gg(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var f=a.data;if(f==="$"||f==="$!"||f==="$?"){if(l===0)return a;l--}else f==="/$"&&l++}a=a.previousSibling}return null}var ya=Math.random().toString(36).slice(2),si="__reactFiber$"+ya,Do="__reactProps$"+ya,wi="__reactContainer$"+ya,t0="__reactEvents$"+ya,C_="__reactListeners$"+ya,T_="__reactHandles$"+ya;function Ps(a){var l=a[si];if(l)return l;for(var f=a.parentNode;f;){if(l=f[wi]||f[si]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(a=Gg(a);a!==null;){if(f=a[si])return f;a=Gg(a)}return l}a=f,f=a.parentNode}return null}function Po(a){return a=a[si]||a[wi],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function _a(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function lc(a){return a[Do]||null}var r0=[],wa=-1;function ns(a){return{current:a}}function Nt(a){0>wa||(a.current=r0[wa],r0[wa]=null,wa--)}function Ot(a,l){wa++,r0[wa]=a.current,a.current=l}var is={},Cr=ns(is),Yr=ns(!1),Ms=is;function Sa(a,l){var f=a.type.contextTypes;if(!f)return is;var p=a.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===l)return p.__reactInternalMemoizedMaskedChildContext;var w={},k;for(k in f)w[k]=l[k];return p&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=l,a.__reactInternalMemoizedMaskedChildContext=w),w}function $r(a){return a=a.childContextTypes,a!=null}function cc(){Nt(Yr),Nt(Cr)}function Yg(a,l,f){if(Cr.current!==is)throw Error(t(168));Ot(Cr,l),Ot(Yr,f)}function $g(a,l,f){var p=a.stateNode;if(l=l.childContextTypes,typeof p.getChildContext!="function")return f;p=p.getChildContext();for(var w in p)if(!(w in l))throw Error(t(108,Me(a)||"Unknown",w));return pe({},f,p)}function uc(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||is,Ms=Cr.current,Ot(Cr,a),Ot(Yr,Yr.current),!0}function Kg(a,l,f){var p=a.stateNode;if(!p)throw Error(t(169));f?(a=$g(a,l,Ms),p.__reactInternalMemoizedMergedChildContext=a,Nt(Yr),Nt(Cr),Ot(Cr,a)):Nt(Yr),Ot(Yr,f)}var Si=null,hc=!1,n0=!1;function Zg(a){Si===null?Si=[a]:Si.push(a)}function E_(a){hc=!0,Zg(a)}function ss(){if(!n0&&Si!==null){n0=!0;var a=0,l=Et;try{var f=Si;for(Et=1;a<f.length;a++){var p=f[a];do p=p(!0);while(p!==null)}Si=null,hc=!1}catch(w){throw Si!==null&&(Si=Si.slice(a+1)),Ue(bt,ss),w}finally{Et=l,n0=!1}}return null}var ka=[],Ca=0,fc=null,dc=0,vn=[],yn=0,Ns=null,ki=1,Ci="";function Is(a,l){ka[Ca++]=dc,ka[Ca++]=fc,fc=a,dc=l}function qg(a,l,f){vn[yn++]=ki,vn[yn++]=Ci,vn[yn++]=Ns,Ns=a;var p=ki;a=Ci;var w=32-Gt(p)-1;p&=~(1<<w),f+=1;var k=32-Gt(l)+w;if(30<k){var M=w-w%5;k=(p&(1<<M)-1).toString(32),p>>=M,w-=M,ki=1<<32-Gt(l)+w|f<<w|p,Ci=k+a}else ki=1<<k|f<<w|p,Ci=a}function i0(a){a.return!==null&&(Is(a,1),qg(a,1,0))}function s0(a){for(;a===fc;)fc=ka[--Ca],ka[Ca]=null,dc=ka[--Ca],ka[Ca]=null;for(;a===Ns;)Ns=vn[--yn],vn[yn]=null,Ci=vn[--yn],vn[yn]=null,ki=vn[--yn],vn[yn]=null}var on=null,ln=null,Rt=!1,Ln=null;function Jg(a,l){var f=kn(5,null,null,0);f.elementType="DELETED",f.stateNode=l,f.return=a,l=a.deletions,l===null?(a.deletions=[f],a.flags|=16):l.push(f)}function Qg(a,l){switch(a.tag){case 5:var f=a.type;return l=l.nodeType!==1||f.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(a.stateNode=l,on=a,ln=rs(l.firstChild),!0):!1;case 6:return l=a.pendingProps===""||l.nodeType!==3?null:l,l!==null?(a.stateNode=l,on=a,ln=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(f=Ns!==null?{id:ki,overflow:Ci}:null,a.memoizedState={dehydrated:l,treeContext:f,retryLane:1073741824},f=kn(18,null,null,0),f.stateNode=l,f.return=a,a.child=f,on=a,ln=null,!0):!1;default:return!1}}function a0(a){return(a.mode&1)!==0&&(a.flags&128)===0}function o0(a){if(Rt){var l=ln;if(l){var f=l;if(!Qg(a,l)){if(a0(a))throw Error(t(418));l=rs(f.nextSibling);var p=on;l&&Qg(a,l)?Jg(p,f):(a.flags=a.flags&-4097|2,Rt=!1,on=a)}}else{if(a0(a))throw Error(t(418));a.flags=a.flags&-4097|2,Rt=!1,on=a}}}function ep(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;on=a}function gc(a){if(a!==on)return!1;if(!Rt)return ep(a),Rt=!0,!1;var l;if((l=a.tag!==3)&&!(l=a.tag!==5)&&(l=a.type,l=l!=="head"&&l!=="body"&&!Jh(a.type,a.memoizedProps)),l&&(l=ln)){if(a0(a))throw tp(),Error(t(418));for(;l;)Jg(a,l),l=rs(l.nextSibling)}if(ep(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,l=0;a;){if(a.nodeType===8){var f=a.data;if(f==="/$"){if(l===0){ln=rs(a.nextSibling);break e}l--}else f!=="$"&&f!=="$!"&&f!=="$?"||l++}a=a.nextSibling}ln=null}}else ln=on?rs(a.stateNode.nextSibling):null;return!0}function tp(){for(var a=ln;a;)a=rs(a.nextSibling)}function Ta(){ln=on=null,Rt=!1}function l0(a){Ln===null?Ln=[a]:Ln.push(a)}var A_=A.ReactCurrentBatchConfig;function Mo(a,l,f){if(a=f.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(t(309));var p=f.stateNode}if(!p)throw Error(t(147,a));var w=p,k=""+a;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===k?l.ref:(l=function(M){var Q=w.refs;M===null?delete Q[k]:Q[k]=M},l._stringRef=k,l)}if(typeof a!="string")throw Error(t(284));if(!f._owner)throw Error(t(290,a))}return a}function pc(a,l){throw a=Object.prototype.toString.call(l),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a))}function rp(a){var l=a._init;return l(a._payload)}function np(a){function l(ve,fe){if(a){var ye=ve.deletions;ye===null?(ve.deletions=[fe],ve.flags|=16):ye.push(fe)}}function f(ve,fe){if(!a)return null;for(;fe!==null;)l(ve,fe),fe=fe.sibling;return null}function p(ve,fe){for(ve=new Map;fe!==null;)fe.key!==null?ve.set(fe.key,fe):ve.set(fe.index,fe),fe=fe.sibling;return ve}function w(ve,fe){return ve=ds(ve,fe),ve.index=0,ve.sibling=null,ve}function k(ve,fe,ye){return ve.index=ye,a?(ye=ve.alternate,ye!==null?(ye=ye.index,ye<fe?(ve.flags|=2,fe):ye):(ve.flags|=2,fe)):(ve.flags|=1048576,fe)}function M(ve){return a&&ve.alternate===null&&(ve.flags|=2),ve}function Q(ve,fe,ye,Ge){return fe===null||fe.tag!==6?(fe=Q0(ye,ve.mode,Ge),fe.return=ve,fe):(fe=w(fe,ye),fe.return=ve,fe)}function oe(ve,fe,ye,Ge){var it=ye.type;return it===O?ze(ve,fe,ye.props.children,Ge,ye.key):fe!==null&&(fe.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===Ee&&rp(it)===fe.type)?(Ge=w(fe,ye.props),Ge.ref=Mo(ve,fe,ye),Ge.return=ve,Ge):(Ge=jc(ye.type,ye.key,ye.props,null,ve.mode,Ge),Ge.ref=Mo(ve,fe,ye),Ge.return=ve,Ge)}function Te(ve,fe,ye,Ge){return fe===null||fe.tag!==4||fe.stateNode.containerInfo!==ye.containerInfo||fe.stateNode.implementation!==ye.implementation?(fe=ef(ye,ve.mode,Ge),fe.return=ve,fe):(fe=w(fe,ye.children||[]),fe.return=ve,fe)}function ze(ve,fe,ye,Ge,it){return fe===null||fe.tag!==7?(fe=Ws(ye,ve.mode,Ge,it),fe.return=ve,fe):(fe=w(fe,ye),fe.return=ve,fe)}function Ve(ve,fe,ye){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return fe=Q0(""+fe,ve.mode,ye),fe.return=ve,fe;if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case P:return ye=jc(fe.type,fe.key,fe.props,null,ve.mode,ye),ye.ref=Mo(ve,null,fe),ye.return=ve,ye;case N:return fe=ef(fe,ve.mode,ye),fe.return=ve,fe;case Ee:var Ge=fe._init;return Ve(ve,Ge(fe._payload),ye)}if(Ae(fe)||X(fe))return fe=Ws(fe,ve.mode,ye,null),fe.return=ve,fe;pc(ve,fe)}return null}function je(ve,fe,ye,Ge){var it=fe!==null?fe.key:null;if(typeof ye=="string"&&ye!==""||typeof ye=="number")return it!==null?null:Q(ve,fe,""+ye,Ge);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case P:return ye.key===it?oe(ve,fe,ye,Ge):null;case N:return ye.key===it?Te(ve,fe,ye,Ge):null;case Ee:return it=ye._init,je(ve,fe,it(ye._payload),Ge)}if(Ae(ye)||X(ye))return it!==null?null:ze(ve,fe,ye,Ge,null);pc(ve,ye)}return null}function qe(ve,fe,ye,Ge,it){if(typeof Ge=="string"&&Ge!==""||typeof Ge=="number")return ve=ve.get(ye)||null,Q(fe,ve,""+Ge,it);if(typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case P:return ve=ve.get(Ge.key===null?ye:Ge.key)||null,oe(fe,ve,Ge,it);case N:return ve=ve.get(Ge.key===null?ye:Ge.key)||null,Te(fe,ve,Ge,it);case Ee:var at=Ge._init;return qe(ve,fe,ye,at(Ge._payload),it)}if(Ae(Ge)||X(Ge))return ve=ve.get(ye)||null,ze(fe,ve,Ge,it,null);pc(fe,Ge)}return null}function tt(ve,fe,ye,Ge){for(var it=null,at=null,ot=fe,ct=fe=0,fr=null;ot!==null&&ct<ye.length;ct++){ot.index>ct?(fr=ot,ot=null):fr=ot.sibling;var Ct=je(ve,ot,ye[ct],Ge);if(Ct===null){ot===null&&(ot=fr);break}a&&ot&&Ct.alternate===null&&l(ve,ot),fe=k(Ct,fe,ct),at===null?it=Ct:at.sibling=Ct,at=Ct,ot=fr}if(ct===ye.length)return f(ve,ot),Rt&&Is(ve,ct),it;if(ot===null){for(;ct<ye.length;ct++)ot=Ve(ve,ye[ct],Ge),ot!==null&&(fe=k(ot,fe,ct),at===null?it=ot:at.sibling=ot,at=ot);return Rt&&Is(ve,ct),it}for(ot=p(ve,ot);ct<ye.length;ct++)fr=qe(ot,ve,ct,ye[ct],Ge),fr!==null&&(a&&fr.alternate!==null&&ot.delete(fr.key===null?ct:fr.key),fe=k(fr,fe,ct),at===null?it=fr:at.sibling=fr,at=fr);return a&&ot.forEach(function(gs){return l(ve,gs)}),Rt&&Is(ve,ct),it}function rt(ve,fe,ye,Ge){var it=X(ye);if(typeof it!="function")throw Error(t(150));if(ye=it.call(ye),ye==null)throw Error(t(151));for(var at=it=null,ot=fe,ct=fe=0,fr=null,Ct=ye.next();ot!==null&&!Ct.done;ct++,Ct=ye.next()){ot.index>ct?(fr=ot,ot=null):fr=ot.sibling;var gs=je(ve,ot,Ct.value,Ge);if(gs===null){ot===null&&(ot=fr);break}a&&ot&&gs.alternate===null&&l(ve,ot),fe=k(gs,fe,ct),at===null?it=gs:at.sibling=gs,at=gs,ot=fr}if(Ct.done)return f(ve,ot),Rt&&Is(ve,ct),it;if(ot===null){for(;!Ct.done;ct++,Ct=ye.next())Ct=Ve(ve,Ct.value,Ge),Ct!==null&&(fe=k(Ct,fe,ct),at===null?it=Ct:at.sibling=Ct,at=Ct);return Rt&&Is(ve,ct),it}for(ot=p(ve,ot);!Ct.done;ct++,Ct=ye.next())Ct=qe(ot,ve,ct,Ct.value,Ge),Ct!==null&&(a&&Ct.alternate!==null&&ot.delete(Ct.key===null?ct:Ct.key),fe=k(Ct,fe,ct),at===null?it=Ct:at.sibling=Ct,at=Ct);return a&&ot.forEach(function(aw){return l(ve,aw)}),Rt&&Is(ve,ct),it}function Yt(ve,fe,ye,Ge){if(typeof ye=="object"&&ye!==null&&ye.type===O&&ye.key===null&&(ye=ye.props.children),typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case P:e:{for(var it=ye.key,at=fe;at!==null;){if(at.key===it){if(it=ye.type,it===O){if(at.tag===7){f(ve,at.sibling),fe=w(at,ye.props.children),fe.return=ve,ve=fe;break e}}else if(at.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===Ee&&rp(it)===at.type){f(ve,at.sibling),fe=w(at,ye.props),fe.ref=Mo(ve,at,ye),fe.return=ve,ve=fe;break e}f(ve,at);break}else l(ve,at);at=at.sibling}ye.type===O?(fe=Ws(ye.props.children,ve.mode,Ge,ye.key),fe.return=ve,ve=fe):(Ge=jc(ye.type,ye.key,ye.props,null,ve.mode,Ge),Ge.ref=Mo(ve,fe,ye),Ge.return=ve,ve=Ge)}return M(ve);case N:e:{for(at=ye.key;fe!==null;){if(fe.key===at)if(fe.tag===4&&fe.stateNode.containerInfo===ye.containerInfo&&fe.stateNode.implementation===ye.implementation){f(ve,fe.sibling),fe=w(fe,ye.children||[]),fe.return=ve,ve=fe;break e}else{f(ve,fe);break}else l(ve,fe);fe=fe.sibling}fe=ef(ye,ve.mode,Ge),fe.return=ve,ve=fe}return M(ve);case Ee:return at=ye._init,Yt(ve,fe,at(ye._payload),Ge)}if(Ae(ye))return tt(ve,fe,ye,Ge);if(X(ye))return rt(ve,fe,ye,Ge);pc(ve,ye)}return typeof ye=="string"&&ye!==""||typeof ye=="number"?(ye=""+ye,fe!==null&&fe.tag===6?(f(ve,fe.sibling),fe=w(fe,ye),fe.return=ve,ve=fe):(f(ve,fe),fe=Q0(ye,ve.mode,Ge),fe.return=ve,ve=fe),M(ve)):f(ve,fe)}return Yt}var Ea=np(!0),ip=np(!1),mc=ns(null),xc=null,Aa=null,c0=null;function u0(){c0=Aa=xc=null}function h0(a){var l=mc.current;Nt(mc),a._currentValue=l}function f0(a,l,f){for(;a!==null;){var p=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,p!==null&&(p.childLanes|=l)):p!==null&&(p.childLanes&l)!==l&&(p.childLanes|=l),a===f)break;a=a.return}}function ba(a,l){xc=a,c0=Aa=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&l)!==0&&(Kr=!0),a.firstContext=null)}function _n(a){var l=a._currentValue;if(c0!==a)if(a={context:a,memoizedValue:l,next:null},Aa===null){if(xc===null)throw Error(t(308));Aa=a,xc.dependencies={lanes:0,firstContext:a}}else Aa=Aa.next=a;return l}var Rs=null;function d0(a){Rs===null?Rs=[a]:Rs.push(a)}function sp(a,l,f,p){var w=l.interleaved;return w===null?(f.next=f,d0(l)):(f.next=w.next,w.next=f),l.interleaved=f,Ti(a,p)}function Ti(a,l){a.lanes|=l;var f=a.alternate;for(f!==null&&(f.lanes|=l),f=a,a=a.return;a!==null;)a.childLanes|=l,f=a.alternate,f!==null&&(f.childLanes|=l),f=a,a=a.return;return f.tag===3?f.stateNode:null}var as=!1;function g0(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ap(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function Ei(a,l){return{eventTime:a,lane:l,tag:0,payload:null,callback:null,next:null}}function os(a,l,f){var p=a.updateQueue;if(p===null)return null;if(p=p.shared,(wt&2)!==0){var w=p.pending;return w===null?l.next=l:(l.next=w.next,w.next=l),p.pending=l,Ti(a,f)}return w=p.interleaved,w===null?(l.next=l,d0(p)):(l.next=w.next,w.next=l),p.interleaved=l,Ti(a,f)}function vc(a,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194240)!==0)){var p=l.lanes;p&=a.pendingLanes,f|=p,l.lanes=f,bh(a,f)}}function op(a,l){var f=a.updateQueue,p=a.alternate;if(p!==null&&(p=p.updateQueue,f===p)){var w=null,k=null;if(f=f.firstBaseUpdate,f!==null){do{var M={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};k===null?w=k=M:k=k.next=M,f=f.next}while(f!==null);k===null?w=k=l:k=k.next=l}else w=k=l;f={baseState:p.baseState,firstBaseUpdate:w,lastBaseUpdate:k,shared:p.shared,effects:p.effects},a.updateQueue=f;return}a=f.lastBaseUpdate,a===null?f.firstBaseUpdate=l:a.next=l,f.lastBaseUpdate=l}function yc(a,l,f,p){var w=a.updateQueue;as=!1;var k=w.firstBaseUpdate,M=w.lastBaseUpdate,Q=w.shared.pending;if(Q!==null){w.shared.pending=null;var oe=Q,Te=oe.next;oe.next=null,M===null?k=Te:M.next=Te,M=oe;var ze=a.alternate;ze!==null&&(ze=ze.updateQueue,Q=ze.lastBaseUpdate,Q!==M&&(Q===null?ze.firstBaseUpdate=Te:Q.next=Te,ze.lastBaseUpdate=oe))}if(k!==null){var Ve=w.baseState;M=0,ze=Te=oe=null,Q=k;do{var je=Q.lane,qe=Q.eventTime;if((p&je)===je){ze!==null&&(ze=ze.next={eventTime:qe,lane:0,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null});e:{var tt=a,rt=Q;switch(je=l,qe=f,rt.tag){case 1:if(tt=rt.payload,typeof tt=="function"){Ve=tt.call(qe,Ve,je);break e}Ve=tt;break e;case 3:tt.flags=tt.flags&-65537|128;case 0:if(tt=rt.payload,je=typeof tt=="function"?tt.call(qe,Ve,je):tt,je==null)break e;Ve=pe({},Ve,je);break e;case 2:as=!0}}Q.callback!==null&&Q.lane!==0&&(a.flags|=64,je=w.effects,je===null?w.effects=[Q]:je.push(Q))}else qe={eventTime:qe,lane:je,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null},ze===null?(Te=ze=qe,oe=Ve):ze=ze.next=qe,M|=je;if(Q=Q.next,Q===null){if(Q=w.shared.pending,Q===null)break;je=Q,Q=je.next,je.next=null,w.lastBaseUpdate=je,w.shared.pending=null}}while(!0);if(ze===null&&(oe=Ve),w.baseState=oe,w.firstBaseUpdate=Te,w.lastBaseUpdate=ze,l=w.shared.interleaved,l!==null){w=l;do M|=w.lane,w=w.next;while(w!==l)}else k===null&&(w.shared.lanes=0);js|=M,a.lanes=M,a.memoizedState=Ve}}function lp(a,l,f){if(a=l.effects,l.effects=null,a!==null)for(l=0;l<a.length;l++){var p=a[l],w=p.callback;if(w!==null){if(p.callback=null,p=f,typeof w!="function")throw Error(t(191,w));w.call(p)}}}var No={},ai=ns(No),Io=ns(No),Ro=ns(No);function Ls(a){if(a===No)throw Error(t(174));return a}function p0(a,l){switch(Ot(Ro,l),Ot(Io,a),Ot(ai,No),a=l.nodeType,a){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:nt(null,"");break;default:a=a===8?l.parentNode:l,l=a.namespaceURI||null,a=a.tagName,l=nt(l,a)}Nt(ai),Ot(ai,l)}function Fa(){Nt(ai),Nt(Io),Nt(Ro)}function cp(a){Ls(Ro.current);var l=Ls(ai.current),f=nt(l,a.type);l!==f&&(Ot(Io,a),Ot(ai,f))}function m0(a){Io.current===a&&(Nt(ai),Nt(Io))}var Bt=ns(0);function _c(a){for(var l=a;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var x0=[];function v0(){for(var a=0;a<x0.length;a++)x0[a]._workInProgressVersionPrimary=null;x0.length=0}var wc=A.ReactCurrentDispatcher,y0=A.ReactCurrentBatchConfig,Bs=0,jt=null,rr=null,ur=null,Sc=!1,Lo=!1,Bo=0,b_=0;function Tr(){throw Error(t(321))}function _0(a,l){if(l===null)return!1;for(var f=0;f<l.length&&f<a.length;f++)if(!Rn(a[f],l[f]))return!1;return!0}function w0(a,l,f,p,w,k){if(Bs=k,jt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,wc.current=a===null||a.memoizedState===null?P_:M_,a=f(p,w),Lo){k=0;do{if(Lo=!1,Bo=0,25<=k)throw Error(t(301));k+=1,ur=rr=null,l.updateQueue=null,wc.current=N_,a=f(p,w)}while(Lo)}if(wc.current=Tc,l=rr!==null&&rr.next!==null,Bs=0,ur=rr=jt=null,Sc=!1,l)throw Error(t(300));return a}function S0(){var a=Bo!==0;return Bo=0,a}function oi(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ur===null?jt.memoizedState=ur=a:ur=ur.next=a,ur}function wn(){if(rr===null){var a=jt.alternate;a=a!==null?a.memoizedState:null}else a=rr.next;var l=ur===null?jt.memoizedState:ur.next;if(l!==null)ur=l,rr=a;else{if(a===null)throw Error(t(310));rr=a,a={memoizedState:rr.memoizedState,baseState:rr.baseState,baseQueue:rr.baseQueue,queue:rr.queue,next:null},ur===null?jt.memoizedState=ur=a:ur=ur.next=a}return ur}function jo(a,l){return typeof l=="function"?l(a):l}function k0(a){var l=wn(),f=l.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=a;var p=rr,w=p.baseQueue,k=f.pending;if(k!==null){if(w!==null){var M=w.next;w.next=k.next,k.next=M}p.baseQueue=w=k,f.pending=null}if(w!==null){k=w.next,p=p.baseState;var Q=M=null,oe=null,Te=k;do{var ze=Te.lane;if((Bs&ze)===ze)oe!==null&&(oe=oe.next={lane:0,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null}),p=Te.hasEagerState?Te.eagerState:a(p,Te.action);else{var Ve={lane:ze,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null};oe===null?(Q=oe=Ve,M=p):oe=oe.next=Ve,jt.lanes|=ze,js|=ze}Te=Te.next}while(Te!==null&&Te!==k);oe===null?M=p:oe.next=Q,Rn(p,l.memoizedState)||(Kr=!0),l.memoizedState=p,l.baseState=M,l.baseQueue=oe,f.lastRenderedState=p}if(a=f.interleaved,a!==null){w=a;do k=w.lane,jt.lanes|=k,js|=k,w=w.next;while(w!==a)}else w===null&&(f.lanes=0);return[l.memoizedState,f.dispatch]}function C0(a){var l=wn(),f=l.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=a;var p=f.dispatch,w=f.pending,k=l.memoizedState;if(w!==null){f.pending=null;var M=w=w.next;do k=a(k,M.action),M=M.next;while(M!==w);Rn(k,l.memoizedState)||(Kr=!0),l.memoizedState=k,l.baseQueue===null&&(l.baseState=k),f.lastRenderedState=k}return[k,p]}function up(){}function hp(a,l){var f=jt,p=wn(),w=l(),k=!Rn(p.memoizedState,w);if(k&&(p.memoizedState=w,Kr=!0),p=p.queue,T0(gp.bind(null,f,p,a),[a]),p.getSnapshot!==l||k||ur!==null&&ur.memoizedState.tag&1){if(f.flags|=2048,zo(9,dp.bind(null,f,p,w,l),void 0,null),hr===null)throw Error(t(349));(Bs&30)!==0||fp(f,l,w)}return w}function fp(a,l,f){a.flags|=16384,a={getSnapshot:l,value:f},l=jt.updateQueue,l===null?(l={lastEffect:null,stores:null},jt.updateQueue=l,l.stores=[a]):(f=l.stores,f===null?l.stores=[a]:f.push(a))}function dp(a,l,f,p){l.value=f,l.getSnapshot=p,pp(l)&&mp(a)}function gp(a,l,f){return f(function(){pp(l)&&mp(a)})}function pp(a){var l=a.getSnapshot;a=a.value;try{var f=l();return!Rn(a,f)}catch{return!0}}function mp(a){var l=Ti(a,1);l!==null&&Un(l,a,1,-1)}function xp(a){var l=oi();return typeof a=="function"&&(a=a()),l.memoizedState=l.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jo,lastRenderedState:a},l.queue=a,a=a.dispatch=D_.bind(null,jt,a),[l.memoizedState,a]}function zo(a,l,f,p){return a={tag:a,create:l,destroy:f,deps:p,next:null},l=jt.updateQueue,l===null?(l={lastEffect:null,stores:null},jt.updateQueue=l,l.lastEffect=a.next=a):(f=l.lastEffect,f===null?l.lastEffect=a.next=a:(p=f.next,f.next=a,a.next=p,l.lastEffect=a)),a}function vp(){return wn().memoizedState}function kc(a,l,f,p){var w=oi();jt.flags|=a,w.memoizedState=zo(1|l,f,void 0,p===void 0?null:p)}function Cc(a,l,f,p){var w=wn();p=p===void 0?null:p;var k=void 0;if(rr!==null){var M=rr.memoizedState;if(k=M.destroy,p!==null&&_0(p,M.deps)){w.memoizedState=zo(l,f,k,p);return}}jt.flags|=a,w.memoizedState=zo(1|l,f,k,p)}function yp(a,l){return kc(8390656,8,a,l)}function T0(a,l){return Cc(2048,8,a,l)}function _p(a,l){return Cc(4,2,a,l)}function wp(a,l){return Cc(4,4,a,l)}function Sp(a,l){if(typeof l=="function")return a=a(),l(a),function(){l(null)};if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function kp(a,l,f){return f=f!=null?f.concat([a]):null,Cc(4,4,Sp.bind(null,l,a),f)}function E0(){}function Cp(a,l){var f=wn();l=l===void 0?null:l;var p=f.memoizedState;return p!==null&&l!==null&&_0(l,p[1])?p[0]:(f.memoizedState=[a,l],a)}function Tp(a,l){var f=wn();l=l===void 0?null:l;var p=f.memoizedState;return p!==null&&l!==null&&_0(l,p[1])?p[0]:(a=a(),f.memoizedState=[a,l],a)}function Ep(a,l,f){return(Bs&21)===0?(a.baseState&&(a.baseState=!1,Kr=!0),a.memoizedState=f):(Rn(f,l)||(f=rg(),jt.lanes|=f,js|=f,a.baseState=!0),l)}function F_(a,l){var f=Et;Et=f!==0&&4>f?f:4,a(!0);var p=y0.transition;y0.transition={};try{a(!1),l()}finally{Et=f,y0.transition=p}}function Ap(){return wn().memoizedState}function O_(a,l,f){var p=hs(a);if(f={lane:p,action:f,hasEagerState:!1,eagerState:null,next:null},bp(a))Fp(l,f);else if(f=sp(a,l,f,p),f!==null){var w=Lr();Un(f,a,p,w),Op(f,l,p)}}function D_(a,l,f){var p=hs(a),w={lane:p,action:f,hasEagerState:!1,eagerState:null,next:null};if(bp(a))Fp(l,w);else{var k=a.alternate;if(a.lanes===0&&(k===null||k.lanes===0)&&(k=l.lastRenderedReducer,k!==null))try{var M=l.lastRenderedState,Q=k(M,f);if(w.hasEagerState=!0,w.eagerState=Q,Rn(Q,M)){var oe=l.interleaved;oe===null?(w.next=w,d0(l)):(w.next=oe.next,oe.next=w),l.interleaved=w;return}}catch{}finally{}f=sp(a,l,w,p),f!==null&&(w=Lr(),Un(f,a,p,w),Op(f,l,p))}}function bp(a){var l=a.alternate;return a===jt||l!==null&&l===jt}function Fp(a,l){Lo=Sc=!0;var f=a.pending;f===null?l.next=l:(l.next=f.next,f.next=l),a.pending=l}function Op(a,l,f){if((f&4194240)!==0){var p=l.lanes;p&=a.pendingLanes,f|=p,l.lanes=f,bh(a,f)}}var Tc={readContext:_n,useCallback:Tr,useContext:Tr,useEffect:Tr,useImperativeHandle:Tr,useInsertionEffect:Tr,useLayoutEffect:Tr,useMemo:Tr,useReducer:Tr,useRef:Tr,useState:Tr,useDebugValue:Tr,useDeferredValue:Tr,useTransition:Tr,useMutableSource:Tr,useSyncExternalStore:Tr,useId:Tr,unstable_isNewReconciler:!1},P_={readContext:_n,useCallback:function(a,l){return oi().memoizedState=[a,l===void 0?null:l],a},useContext:_n,useEffect:yp,useImperativeHandle:function(a,l,f){return f=f!=null?f.concat([a]):null,kc(4194308,4,Sp.bind(null,l,a),f)},useLayoutEffect:function(a,l){return kc(4194308,4,a,l)},useInsertionEffect:function(a,l){return kc(4,2,a,l)},useMemo:function(a,l){var f=oi();return l=l===void 0?null:l,a=a(),f.memoizedState=[a,l],a},useReducer:function(a,l,f){var p=oi();return l=f!==void 0?f(l):l,p.memoizedState=p.baseState=l,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:l},p.queue=a,a=a.dispatch=O_.bind(null,jt,a),[p.memoizedState,a]},useRef:function(a){var l=oi();return a={current:a},l.memoizedState=a},useState:xp,useDebugValue:E0,useDeferredValue:function(a){return oi().memoizedState=a},useTransition:function(){var a=xp(!1),l=a[0];return a=F_.bind(null,a[1]),oi().memoizedState=a,[l,a]},useMutableSource:function(){},useSyncExternalStore:function(a,l,f){var p=jt,w=oi();if(Rt){if(f===void 0)throw Error(t(407));f=f()}else{if(f=l(),hr===null)throw Error(t(349));(Bs&30)!==0||fp(p,l,f)}w.memoizedState=f;var k={value:f,getSnapshot:l};return w.queue=k,yp(gp.bind(null,p,k,a),[a]),p.flags|=2048,zo(9,dp.bind(null,p,k,f,l),void 0,null),f},useId:function(){var a=oi(),l=hr.identifierPrefix;if(Rt){var f=Ci,p=ki;f=(p&~(1<<32-Gt(p)-1)).toString(32)+f,l=":"+l+"R"+f,f=Bo++,0<f&&(l+="H"+f.toString(32)),l+=":"}else f=b_++,l=":"+l+"r"+f.toString(32)+":";return a.memoizedState=l},unstable_isNewReconciler:!1},M_={readContext:_n,useCallback:Cp,useContext:_n,useEffect:T0,useImperativeHandle:kp,useInsertionEffect:_p,useLayoutEffect:wp,useMemo:Tp,useReducer:k0,useRef:vp,useState:function(){return k0(jo)},useDebugValue:E0,useDeferredValue:function(a){var l=wn();return Ep(l,rr.memoizedState,a)},useTransition:function(){var a=k0(jo)[0],l=wn().memoizedState;return[a,l]},useMutableSource:up,useSyncExternalStore:hp,useId:Ap,unstable_isNewReconciler:!1},N_={readContext:_n,useCallback:Cp,useContext:_n,useEffect:T0,useImperativeHandle:kp,useInsertionEffect:_p,useLayoutEffect:wp,useMemo:Tp,useReducer:C0,useRef:vp,useState:function(){return C0(jo)},useDebugValue:E0,useDeferredValue:function(a){var l=wn();return rr===null?l.memoizedState=a:Ep(l,rr.memoizedState,a)},useTransition:function(){var a=C0(jo)[0],l=wn().memoizedState;return[a,l]},useMutableSource:up,useSyncExternalStore:hp,useId:Ap,unstable_isNewReconciler:!1};function Bn(a,l){if(a&&a.defaultProps){l=pe({},l),a=a.defaultProps;for(var f in a)l[f]===void 0&&(l[f]=a[f]);return l}return l}function A0(a,l,f,p){l=a.memoizedState,f=f(p,l),f=f==null?l:pe({},l,f),a.memoizedState=f,a.lanes===0&&(a.updateQueue.baseState=f)}var Ec={isMounted:function(a){return(a=a._reactInternals)?q(a)===a:!1},enqueueSetState:function(a,l,f){a=a._reactInternals;var p=Lr(),w=hs(a),k=Ei(p,w);k.payload=l,f!=null&&(k.callback=f),l=os(a,k,w),l!==null&&(Un(l,a,w,p),vc(l,a,w))},enqueueReplaceState:function(a,l,f){a=a._reactInternals;var p=Lr(),w=hs(a),k=Ei(p,w);k.tag=1,k.payload=l,f!=null&&(k.callback=f),l=os(a,k,w),l!==null&&(Un(l,a,w,p),vc(l,a,w))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var f=Lr(),p=hs(a),w=Ei(f,p);w.tag=2,l!=null&&(w.callback=l),l=os(a,w,p),l!==null&&(Un(l,a,p,f),vc(l,a,p))}};function Dp(a,l,f,p,w,k,M){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(p,k,M):l.prototype&&l.prototype.isPureReactComponent?!Eo(f,p)||!Eo(w,k):!0}function Pp(a,l,f){var p=!1,w=is,k=l.contextType;return typeof k=="object"&&k!==null?k=_n(k):(w=$r(l)?Ms:Cr.current,p=l.contextTypes,k=(p=p!=null)?Sa(a,w):is),l=new l(f,k),a.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Ec,a.stateNode=l,l._reactInternals=a,p&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=w,a.__reactInternalMemoizedMaskedChildContext=k),l}function Mp(a,l,f,p){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,p),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,p),l.state!==a&&Ec.enqueueReplaceState(l,l.state,null)}function b0(a,l,f,p){var w=a.stateNode;w.props=f,w.state=a.memoizedState,w.refs={},g0(a);var k=l.contextType;typeof k=="object"&&k!==null?w.context=_n(k):(k=$r(l)?Ms:Cr.current,w.context=Sa(a,k)),w.state=a.memoizedState,k=l.getDerivedStateFromProps,typeof k=="function"&&(A0(a,l,k,f),w.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(l=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),l!==w.state&&Ec.enqueueReplaceState(w,w.state,null),yc(a,f,w,p),w.state=a.memoizedState),typeof w.componentDidMount=="function"&&(a.flags|=4194308)}function Oa(a,l){try{var f="",p=l;do f+=H(p),p=p.return;while(p);var w=f}catch(k){w=`
Error generating stack: `+k.message+`
`+k.stack}return{value:a,source:l,stack:w,digest:null}}function F0(a,l,f){return{value:a,source:null,stack:f??null,digest:l??null}}function O0(a,l){try{console.error(l.value)}catch(f){setTimeout(function(){throw f})}}var I_=typeof WeakMap=="function"?WeakMap:Map;function Np(a,l,f){f=Ei(-1,f),f.tag=3,f.payload={element:null};var p=l.value;return f.callback=function(){Mc||(Mc=!0,X0=p),O0(a,l)},f}function Ip(a,l,f){f=Ei(-1,f),f.tag=3;var p=a.type.getDerivedStateFromError;if(typeof p=="function"){var w=l.value;f.payload=function(){return p(w)},f.callback=function(){O0(a,l)}}var k=a.stateNode;return k!==null&&typeof k.componentDidCatch=="function"&&(f.callback=function(){O0(a,l),typeof p!="function"&&(cs===null?cs=new Set([this]):cs.add(this));var M=l.stack;this.componentDidCatch(l.value,{componentStack:M!==null?M:""})}),f}function Rp(a,l,f){var p=a.pingCache;if(p===null){p=a.pingCache=new I_;var w=new Set;p.set(l,w)}else w=p.get(l),w===void 0&&(w=new Set,p.set(l,w));w.has(f)||(w.add(f),a=K_.bind(null,a,l,f),l.then(a,a))}function Lp(a){do{var l;if((l=a.tag===13)&&(l=a.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return a;a=a.return}while(a!==null);return null}function Bp(a,l,f,p,w){return(a.mode&1)===0?(a===l?a.flags|=65536:(a.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(l=Ei(-1,1),l.tag=2,os(f,l,1))),f.lanes|=1),a):(a.flags|=65536,a.lanes=w,a)}var R_=A.ReactCurrentOwner,Kr=!1;function Rr(a,l,f,p){l.child=a===null?ip(l,null,f,p):Ea(l,a.child,f,p)}function jp(a,l,f,p,w){f=f.render;var k=l.ref;return ba(l,w),p=w0(a,l,f,p,k,w),f=S0(),a!==null&&!Kr?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~w,Ai(a,l,w)):(Rt&&f&&i0(l),l.flags|=1,Rr(a,l,p,w),l.child)}function zp(a,l,f,p,w){if(a===null){var k=f.type;return typeof k=="function"&&!J0(k)&&k.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(l.tag=15,l.type=k,Up(a,l,k,p,w)):(a=jc(f.type,null,p,l,l.mode,w),a.ref=l.ref,a.return=l,l.child=a)}if(k=a.child,(a.lanes&w)===0){var M=k.memoizedProps;if(f=f.compare,f=f!==null?f:Eo,f(M,p)&&a.ref===l.ref)return Ai(a,l,w)}return l.flags|=1,a=ds(k,p),a.ref=l.ref,a.return=l,l.child=a}function Up(a,l,f,p,w){if(a!==null){var k=a.memoizedProps;if(Eo(k,p)&&a.ref===l.ref)if(Kr=!1,l.pendingProps=p=k,(a.lanes&w)!==0)(a.flags&131072)!==0&&(Kr=!0);else return l.lanes=a.lanes,Ai(a,l,w)}return D0(a,l,f,p,w)}function Vp(a,l,f){var p=l.pendingProps,w=p.children,k=a!==null?a.memoizedState:null;if(p.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ot(Pa,cn),cn|=f;else{if((f&1073741824)===0)return a=k!==null?k.baseLanes|f:f,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:a,cachePool:null,transitions:null},l.updateQueue=null,Ot(Pa,cn),cn|=a,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=k!==null?k.baseLanes:f,Ot(Pa,cn),cn|=p}else k!==null?(p=k.baseLanes|f,l.memoizedState=null):p=f,Ot(Pa,cn),cn|=p;return Rr(a,l,w,f),l.child}function Wp(a,l){var f=l.ref;(a===null&&f!==null||a!==null&&a.ref!==f)&&(l.flags|=512,l.flags|=2097152)}function D0(a,l,f,p,w){var k=$r(f)?Ms:Cr.current;return k=Sa(l,k),ba(l,w),f=w0(a,l,f,p,k,w),p=S0(),a!==null&&!Kr?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~w,Ai(a,l,w)):(Rt&&p&&i0(l),l.flags|=1,Rr(a,l,f,w),l.child)}function Hp(a,l,f,p,w){if($r(f)){var k=!0;uc(l)}else k=!1;if(ba(l,w),l.stateNode===null)bc(a,l),Pp(l,f,p),b0(l,f,p,w),p=!0;else if(a===null){var M=l.stateNode,Q=l.memoizedProps;M.props=Q;var oe=M.context,Te=f.contextType;typeof Te=="object"&&Te!==null?Te=_n(Te):(Te=$r(f)?Ms:Cr.current,Te=Sa(l,Te));var ze=f.getDerivedStateFromProps,Ve=typeof ze=="function"||typeof M.getSnapshotBeforeUpdate=="function";Ve||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(Q!==p||oe!==Te)&&Mp(l,M,p,Te),as=!1;var je=l.memoizedState;M.state=je,yc(l,p,M,w),oe=l.memoizedState,Q!==p||je!==oe||Yr.current||as?(typeof ze=="function"&&(A0(l,f,ze,p),oe=l.memoizedState),(Q=as||Dp(l,f,Q,p,je,oe,Te))?(Ve||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount=="function"&&(l.flags|=4194308)):(typeof M.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=p,l.memoizedState=oe),M.props=p,M.state=oe,M.context=Te,p=Q):(typeof M.componentDidMount=="function"&&(l.flags|=4194308),p=!1)}else{M=l.stateNode,ap(a,l),Q=l.memoizedProps,Te=l.type===l.elementType?Q:Bn(l.type,Q),M.props=Te,Ve=l.pendingProps,je=M.context,oe=f.contextType,typeof oe=="object"&&oe!==null?oe=_n(oe):(oe=$r(f)?Ms:Cr.current,oe=Sa(l,oe));var qe=f.getDerivedStateFromProps;(ze=typeof qe=="function"||typeof M.getSnapshotBeforeUpdate=="function")||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(Q!==Ve||je!==oe)&&Mp(l,M,p,oe),as=!1,je=l.memoizedState,M.state=je,yc(l,p,M,w);var tt=l.memoizedState;Q!==Ve||je!==tt||Yr.current||as?(typeof qe=="function"&&(A0(l,f,qe,p),tt=l.memoizedState),(Te=as||Dp(l,f,Te,p,je,tt,oe)||!1)?(ze||typeof M.UNSAFE_componentWillUpdate!="function"&&typeof M.componentWillUpdate!="function"||(typeof M.componentWillUpdate=="function"&&M.componentWillUpdate(p,tt,oe),typeof M.UNSAFE_componentWillUpdate=="function"&&M.UNSAFE_componentWillUpdate(p,tt,oe)),typeof M.componentDidUpdate=="function"&&(l.flags|=4),typeof M.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof M.componentDidUpdate!="function"||Q===a.memoizedProps&&je===a.memoizedState||(l.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||Q===a.memoizedProps&&je===a.memoizedState||(l.flags|=1024),l.memoizedProps=p,l.memoizedState=tt),M.props=p,M.state=tt,M.context=oe,p=Te):(typeof M.componentDidUpdate!="function"||Q===a.memoizedProps&&je===a.memoizedState||(l.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||Q===a.memoizedProps&&je===a.memoizedState||(l.flags|=1024),p=!1)}return P0(a,l,f,p,k,w)}function P0(a,l,f,p,w,k){Wp(a,l);var M=(l.flags&128)!==0;if(!p&&!M)return w&&Kg(l,f,!1),Ai(a,l,k);p=l.stateNode,R_.current=l;var Q=M&&typeof f.getDerivedStateFromError!="function"?null:p.render();return l.flags|=1,a!==null&&M?(l.child=Ea(l,a.child,null,k),l.child=Ea(l,null,Q,k)):Rr(a,l,Q,k),l.memoizedState=p.state,w&&Kg(l,f,!0),l.child}function Xp(a){var l=a.stateNode;l.pendingContext?Yg(a,l.pendingContext,l.pendingContext!==l.context):l.context&&Yg(a,l.context,!1),p0(a,l.containerInfo)}function Gp(a,l,f,p,w){return Ta(),l0(w),l.flags|=256,Rr(a,l,f,p),l.child}var M0={dehydrated:null,treeContext:null,retryLane:0};function N0(a){return{baseLanes:a,cachePool:null,transitions:null}}function Yp(a,l,f){var p=l.pendingProps,w=Bt.current,k=!1,M=(l.flags&128)!==0,Q;if((Q=M)||(Q=a!==null&&a.memoizedState===null?!1:(w&2)!==0),Q?(k=!0,l.flags&=-129):(a===null||a.memoizedState!==null)&&(w|=1),Ot(Bt,w&1),a===null)return o0(l),a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((l.mode&1)===0?l.lanes=1:a.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(M=p.children,a=p.fallback,k?(p=l.mode,k=l.child,M={mode:"hidden",children:M},(p&1)===0&&k!==null?(k.childLanes=0,k.pendingProps=M):k=zc(M,p,0,null),a=Ws(a,p,f,null),k.return=l,a.return=l,k.sibling=a,l.child=k,l.child.memoizedState=N0(f),l.memoizedState=M0,a):I0(l,M));if(w=a.memoizedState,w!==null&&(Q=w.dehydrated,Q!==null))return L_(a,l,M,p,Q,w,f);if(k){k=p.fallback,M=l.mode,w=a.child,Q=w.sibling;var oe={mode:"hidden",children:p.children};return(M&1)===0&&l.child!==w?(p=l.child,p.childLanes=0,p.pendingProps=oe,l.deletions=null):(p=ds(w,oe),p.subtreeFlags=w.subtreeFlags&14680064),Q!==null?k=ds(Q,k):(k=Ws(k,M,f,null),k.flags|=2),k.return=l,p.return=l,p.sibling=k,l.child=p,p=k,k=l.child,M=a.child.memoizedState,M=M===null?N0(f):{baseLanes:M.baseLanes|f,cachePool:null,transitions:M.transitions},k.memoizedState=M,k.childLanes=a.childLanes&~f,l.memoizedState=M0,p}return k=a.child,a=k.sibling,p=ds(k,{mode:"visible",children:p.children}),(l.mode&1)===0&&(p.lanes=f),p.return=l,p.sibling=null,a!==null&&(f=l.deletions,f===null?(l.deletions=[a],l.flags|=16):f.push(a)),l.child=p,l.memoizedState=null,p}function I0(a,l){return l=zc({mode:"visible",children:l},a.mode,0,null),l.return=a,a.child=l}function Ac(a,l,f,p){return p!==null&&l0(p),Ea(l,a.child,null,f),a=I0(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function L_(a,l,f,p,w,k,M){if(f)return l.flags&256?(l.flags&=-257,p=F0(Error(t(422))),Ac(a,l,M,p)):l.memoizedState!==null?(l.child=a.child,l.flags|=128,null):(k=p.fallback,w=l.mode,p=zc({mode:"visible",children:p.children},w,0,null),k=Ws(k,w,M,null),k.flags|=2,p.return=l,k.return=l,p.sibling=k,l.child=p,(l.mode&1)!==0&&Ea(l,a.child,null,M),l.child.memoizedState=N0(M),l.memoizedState=M0,k);if((l.mode&1)===0)return Ac(a,l,M,null);if(w.data==="$!"){if(p=w.nextSibling&&w.nextSibling.dataset,p)var Q=p.dgst;return p=Q,k=Error(t(419)),p=F0(k,p,void 0),Ac(a,l,M,p)}if(Q=(M&a.childLanes)!==0,Kr||Q){if(p=hr,p!==null){switch(M&-M){case 4:w=2;break;case 16:w=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:w=32;break;case 536870912:w=268435456;break;default:w=0}w=(w&(p.suspendedLanes|M))!==0?0:w,w!==0&&w!==k.retryLane&&(k.retryLane=w,Ti(a,w),Un(p,a,w,-1))}return q0(),p=F0(Error(t(421))),Ac(a,l,M,p)}return w.data==="$?"?(l.flags|=128,l.child=a.child,l=Z_.bind(null,a),w._reactRetry=l,null):(a=k.treeContext,ln=rs(w.nextSibling),on=l,Rt=!0,Ln=null,a!==null&&(vn[yn++]=ki,vn[yn++]=Ci,vn[yn++]=Ns,ki=a.id,Ci=a.overflow,Ns=l),l=I0(l,p.children),l.flags|=4096,l)}function $p(a,l,f){a.lanes|=l;var p=a.alternate;p!==null&&(p.lanes|=l),f0(a.return,l,f)}function R0(a,l,f,p,w){var k=a.memoizedState;k===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:p,tail:f,tailMode:w}:(k.isBackwards=l,k.rendering=null,k.renderingStartTime=0,k.last=p,k.tail=f,k.tailMode=w)}function Kp(a,l,f){var p=l.pendingProps,w=p.revealOrder,k=p.tail;if(Rr(a,l,p.children,f),p=Bt.current,(p&2)!==0)p=p&1|2,l.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&$p(a,f,l);else if(a.tag===19)$p(a,f,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}p&=1}if(Ot(Bt,p),(l.mode&1)===0)l.memoizedState=null;else switch(w){case"forwards":for(f=l.child,w=null;f!==null;)a=f.alternate,a!==null&&_c(a)===null&&(w=f),f=f.sibling;f=w,f===null?(w=l.child,l.child=null):(w=f.sibling,f.sibling=null),R0(l,!1,w,f,k);break;case"backwards":for(f=null,w=l.child,l.child=null;w!==null;){if(a=w.alternate,a!==null&&_c(a)===null){l.child=w;break}a=w.sibling,w.sibling=f,f=w,w=a}R0(l,!0,f,null,k);break;case"together":R0(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function bc(a,l){(l.mode&1)===0&&a!==null&&(a.alternate=null,l.alternate=null,l.flags|=2)}function Ai(a,l,f){if(a!==null&&(l.dependencies=a.dependencies),js|=l.lanes,(f&l.childLanes)===0)return null;if(a!==null&&l.child!==a.child)throw Error(t(153));if(l.child!==null){for(a=l.child,f=ds(a,a.pendingProps),l.child=f,f.return=l;a.sibling!==null;)a=a.sibling,f=f.sibling=ds(a,a.pendingProps),f.return=l;f.sibling=null}return l.child}function B_(a,l,f){switch(l.tag){case 3:Xp(l),Ta();break;case 5:cp(l);break;case 1:$r(l.type)&&uc(l);break;case 4:p0(l,l.stateNode.containerInfo);break;case 10:var p=l.type._context,w=l.memoizedProps.value;Ot(mc,p._currentValue),p._currentValue=w;break;case 13:if(p=l.memoizedState,p!==null)return p.dehydrated!==null?(Ot(Bt,Bt.current&1),l.flags|=128,null):(f&l.child.childLanes)!==0?Yp(a,l,f):(Ot(Bt,Bt.current&1),a=Ai(a,l,f),a!==null?a.sibling:null);Ot(Bt,Bt.current&1);break;case 19:if(p=(f&l.childLanes)!==0,(a.flags&128)!==0){if(p)return Kp(a,l,f);l.flags|=128}if(w=l.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),Ot(Bt,Bt.current),p)break;return null;case 22:case 23:return l.lanes=0,Vp(a,l,f)}return Ai(a,l,f)}var Zp,L0,qp,Jp;Zp=function(a,l){for(var f=l.child;f!==null;){if(f.tag===5||f.tag===6)a.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===l)break;for(;f.sibling===null;){if(f.return===null||f.return===l)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},L0=function(){},qp=function(a,l,f,p){var w=a.memoizedProps;if(w!==p){a=l.stateNode,Ls(ai.current);var k=null;switch(f){case"input":w=E(a,w),p=E(a,p),k=[];break;case"select":w=pe({},w,{value:void 0}),p=pe({},p,{value:void 0}),k=[];break;case"textarea":w=ge(a,w),p=ge(a,p),k=[];break;default:typeof w.onClick!="function"&&typeof p.onClick=="function"&&(a.onclick=oc)}pr(f,p);var M;f=null;for(Te in w)if(!p.hasOwnProperty(Te)&&w.hasOwnProperty(Te)&&w[Te]!=null)if(Te==="style"){var Q=w[Te];for(M in Q)Q.hasOwnProperty(M)&&(f||(f={}),f[M]="")}else Te!=="dangerouslySetInnerHTML"&&Te!=="children"&&Te!=="suppressContentEditableWarning"&&Te!=="suppressHydrationWarning"&&Te!=="autoFocus"&&(i.hasOwnProperty(Te)?k||(k=[]):(k=k||[]).push(Te,null));for(Te in p){var oe=p[Te];if(Q=w!=null?w[Te]:void 0,p.hasOwnProperty(Te)&&oe!==Q&&(oe!=null||Q!=null))if(Te==="style")if(Q){for(M in Q)!Q.hasOwnProperty(M)||oe&&oe.hasOwnProperty(M)||(f||(f={}),f[M]="");for(M in oe)oe.hasOwnProperty(M)&&Q[M]!==oe[M]&&(f||(f={}),f[M]=oe[M])}else f||(k||(k=[]),k.push(Te,f)),f=oe;else Te==="dangerouslySetInnerHTML"?(oe=oe?oe.__html:void 0,Q=Q?Q.__html:void 0,oe!=null&&Q!==oe&&(k=k||[]).push(Te,oe)):Te==="children"?typeof oe!="string"&&typeof oe!="number"||(k=k||[]).push(Te,""+oe):Te!=="suppressContentEditableWarning"&&Te!=="suppressHydrationWarning"&&(i.hasOwnProperty(Te)?(oe!=null&&Te==="onScroll"&&Mt("scroll",a),k||Q===oe||(k=[])):(k=k||[]).push(Te,oe))}f&&(k=k||[]).push("style",f);var Te=k;(l.updateQueue=Te)&&(l.flags|=4)}},Jp=function(a,l,f,p){f!==p&&(l.flags|=4)};function Uo(a,l){if(!Rt)switch(a.tailMode){case"hidden":l=a.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?a.tail=null:f.sibling=null;break;case"collapsed":f=a.tail;for(var p=null;f!==null;)f.alternate!==null&&(p=f),f=f.sibling;p===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:p.sibling=null}}function Er(a){var l=a.alternate!==null&&a.alternate.child===a.child,f=0,p=0;if(l)for(var w=a.child;w!==null;)f|=w.lanes|w.childLanes,p|=w.subtreeFlags&14680064,p|=w.flags&14680064,w.return=a,w=w.sibling;else for(w=a.child;w!==null;)f|=w.lanes|w.childLanes,p|=w.subtreeFlags,p|=w.flags,w.return=a,w=w.sibling;return a.subtreeFlags|=p,a.childLanes=f,l}function j_(a,l,f){var p=l.pendingProps;switch(s0(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Er(l),null;case 1:return $r(l.type)&&cc(),Er(l),null;case 3:return p=l.stateNode,Fa(),Nt(Yr),Nt(Cr),v0(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(a===null||a.child===null)&&(gc(l)?l.flags|=4:a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Ln!==null&&($0(Ln),Ln=null))),L0(a,l),Er(l),null;case 5:m0(l);var w=Ls(Ro.current);if(f=l.type,a!==null&&l.stateNode!=null)qp(a,l,f,p,w),a.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!p){if(l.stateNode===null)throw Error(t(166));return Er(l),null}if(a=Ls(ai.current),gc(l)){p=l.stateNode,f=l.type;var k=l.memoizedProps;switch(p[si]=l,p[Do]=k,a=(l.mode&1)!==0,f){case"dialog":Mt("cancel",p),Mt("close",p);break;case"iframe":case"object":case"embed":Mt("load",p);break;case"video":case"audio":for(w=0;w<bo.length;w++)Mt(bo[w],p);break;case"source":Mt("error",p);break;case"img":case"image":case"link":Mt("error",p),Mt("load",p);break;case"details":Mt("toggle",p);break;case"input":de(p,k),Mt("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!k.multiple},Mt("invalid",p);break;case"textarea":Oe(p,k),Mt("invalid",p)}pr(f,k),w=null;for(var M in k)if(k.hasOwnProperty(M)){var Q=k[M];M==="children"?typeof Q=="string"?p.textContent!==Q&&(k.suppressHydrationWarning!==!0&&ac(p.textContent,Q,a),w=["children",Q]):typeof Q=="number"&&p.textContent!==""+Q&&(k.suppressHydrationWarning!==!0&&ac(p.textContent,Q,a),w=["children",""+Q]):i.hasOwnProperty(M)&&Q!=null&&M==="onScroll"&&Mt("scroll",p)}switch(f){case"input":ne(p),U(p,k,!0);break;case"textarea":ne(p),Be(p);break;case"select":case"option":break;default:typeof k.onClick=="function"&&(p.onclick=oc)}p=w,l.updateQueue=p,p!==null&&(l.flags|=4)}else{M=w.nodeType===9?w:w.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=re(f)),a==="http://www.w3.org/1999/xhtml"?f==="script"?(a=M.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof p.is=="string"?a=M.createElement(f,{is:p.is}):(a=M.createElement(f),f==="select"&&(M=a,p.multiple?M.multiple=!0:p.size&&(M.size=p.size))):a=M.createElementNS(a,f),a[si]=l,a[Do]=p,Zp(a,l,!1,!1),l.stateNode=a;e:{switch(M=mn(f,p),f){case"dialog":Mt("cancel",a),Mt("close",a),w=p;break;case"iframe":case"object":case"embed":Mt("load",a),w=p;break;case"video":case"audio":for(w=0;w<bo.length;w++)Mt(bo[w],a);w=p;break;case"source":Mt("error",a),w=p;break;case"img":case"image":case"link":Mt("error",a),Mt("load",a),w=p;break;case"details":Mt("toggle",a),w=p;break;case"input":de(a,p),w=E(a,p),Mt("invalid",a);break;case"option":w=p;break;case"select":a._wrapperState={wasMultiple:!!p.multiple},w=pe({},p,{value:void 0}),Mt("invalid",a);break;case"textarea":Oe(a,p),w=ge(a,p),Mt("invalid",a);break;default:w=p}pr(f,w),Q=w;for(k in Q)if(Q.hasOwnProperty(k)){var oe=Q[k];k==="style"?Ht(a,oe):k==="dangerouslySetInnerHTML"?(oe=oe?oe.__html:void 0,oe!=null&&Ne(a,oe)):k==="children"?typeof oe=="string"?(f!=="textarea"||oe!=="")&&Ye(a,oe):typeof oe=="number"&&Ye(a,""+oe):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(i.hasOwnProperty(k)?oe!=null&&k==="onScroll"&&Mt("scroll",a):oe!=null&&C(a,k,oe,M))}switch(f){case"input":ne(a),U(a,p,!1);break;case"textarea":ne(a),Be(a);break;case"option":p.value!=null&&a.setAttribute("value",""+Fe(p.value));break;case"select":a.multiple=!!p.multiple,k=p.value,k!=null?Pe(a,!!p.multiple,k,!1):p.defaultValue!=null&&Pe(a,!!p.multiple,p.defaultValue,!0);break;default:typeof w.onClick=="function"&&(a.onclick=oc)}switch(f){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return Er(l),null;case 6:if(a&&l.stateNode!=null)Jp(a,l,a.memoizedProps,p);else{if(typeof p!="string"&&l.stateNode===null)throw Error(t(166));if(f=Ls(Ro.current),Ls(ai.current),gc(l)){if(p=l.stateNode,f=l.memoizedProps,p[si]=l,(k=p.nodeValue!==f)&&(a=on,a!==null))switch(a.tag){case 3:ac(p.nodeValue,f,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&ac(p.nodeValue,f,(a.mode&1)!==0)}k&&(l.flags|=4)}else p=(f.nodeType===9?f:f.ownerDocument).createTextNode(p),p[si]=l,l.stateNode=p}return Er(l),null;case 13:if(Nt(Bt),p=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(Rt&&ln!==null&&(l.mode&1)!==0&&(l.flags&128)===0)tp(),Ta(),l.flags|=98560,k=!1;else if(k=gc(l),p!==null&&p.dehydrated!==null){if(a===null){if(!k)throw Error(t(318));if(k=l.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error(t(317));k[si]=l}else Ta(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Er(l),k=!1}else Ln!==null&&($0(Ln),Ln=null),k=!0;if(!k)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=f,l):(p=p!==null,p!==(a!==null&&a.memoizedState!==null)&&p&&(l.child.flags|=8192,(l.mode&1)!==0&&(a===null||(Bt.current&1)!==0?nr===0&&(nr=3):q0())),l.updateQueue!==null&&(l.flags|=4),Er(l),null);case 4:return Fa(),L0(a,l),a===null&&Fo(l.stateNode.containerInfo),Er(l),null;case 10:return h0(l.type._context),Er(l),null;case 17:return $r(l.type)&&cc(),Er(l),null;case 19:if(Nt(Bt),k=l.memoizedState,k===null)return Er(l),null;if(p=(l.flags&128)!==0,M=k.rendering,M===null)if(p)Uo(k,!1);else{if(nr!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(M=_c(a),M!==null){for(l.flags|=128,Uo(k,!1),p=M.updateQueue,p!==null&&(l.updateQueue=p,l.flags|=4),l.subtreeFlags=0,p=f,f=l.child;f!==null;)k=f,a=p,k.flags&=14680066,M=k.alternate,M===null?(k.childLanes=0,k.lanes=a,k.child=null,k.subtreeFlags=0,k.memoizedProps=null,k.memoizedState=null,k.updateQueue=null,k.dependencies=null,k.stateNode=null):(k.childLanes=M.childLanes,k.lanes=M.lanes,k.child=M.child,k.subtreeFlags=0,k.deletions=null,k.memoizedProps=M.memoizedProps,k.memoizedState=M.memoizedState,k.updateQueue=M.updateQueue,k.type=M.type,a=M.dependencies,k.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),f=f.sibling;return Ot(Bt,Bt.current&1|2),l.child}a=a.sibling}k.tail!==null&&We()>Ma&&(l.flags|=128,p=!0,Uo(k,!1),l.lanes=4194304)}else{if(!p)if(a=_c(M),a!==null){if(l.flags|=128,p=!0,f=a.updateQueue,f!==null&&(l.updateQueue=f,l.flags|=4),Uo(k,!0),k.tail===null&&k.tailMode==="hidden"&&!M.alternate&&!Rt)return Er(l),null}else 2*We()-k.renderingStartTime>Ma&&f!==1073741824&&(l.flags|=128,p=!0,Uo(k,!1),l.lanes=4194304);k.isBackwards?(M.sibling=l.child,l.child=M):(f=k.last,f!==null?f.sibling=M:l.child=M,k.last=M)}return k.tail!==null?(l=k.tail,k.rendering=l,k.tail=l.sibling,k.renderingStartTime=We(),l.sibling=null,f=Bt.current,Ot(Bt,p?f&1|2:f&1),l):(Er(l),null);case 22:case 23:return Z0(),p=l.memoizedState!==null,a!==null&&a.memoizedState!==null!==p&&(l.flags|=8192),p&&(l.mode&1)!==0?(cn&1073741824)!==0&&(Er(l),l.subtreeFlags&6&&(l.flags|=8192)):Er(l),null;case 24:return null;case 25:return null}throw Error(t(156,l.tag))}function z_(a,l){switch(s0(l),l.tag){case 1:return $r(l.type)&&cc(),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return Fa(),Nt(Yr),Nt(Cr),v0(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 5:return m0(l),null;case 13:if(Nt(Bt),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(t(340));Ta()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return Nt(Bt),null;case 4:return Fa(),null;case 10:return h0(l.type._context),null;case 22:case 23:return Z0(),null;case 24:return null;default:return null}}var Fc=!1,Ar=!1,U_=typeof WeakSet=="function"?WeakSet:Set,et=null;function Da(a,l){var f=a.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(p){Ut(a,l,p)}else f.current=null}function B0(a,l,f){try{f()}catch(p){Ut(a,l,p)}}var Qp=!1;function V_(a,l){if(Zh=Kl,a=Dg(),Vh(a)){if("selectionStart"in a)var f={start:a.selectionStart,end:a.selectionEnd};else e:{f=(f=a.ownerDocument)&&f.defaultView||window;var p=f.getSelection&&f.getSelection();if(p&&p.rangeCount!==0){f=p.anchorNode;var w=p.anchorOffset,k=p.focusNode;p=p.focusOffset;try{f.nodeType,k.nodeType}catch{f=null;break e}var M=0,Q=-1,oe=-1,Te=0,ze=0,Ve=a,je=null;t:for(;;){for(var qe;Ve!==f||w!==0&&Ve.nodeType!==3||(Q=M+w),Ve!==k||p!==0&&Ve.nodeType!==3||(oe=M+p),Ve.nodeType===3&&(M+=Ve.nodeValue.length),(qe=Ve.firstChild)!==null;)je=Ve,Ve=qe;for(;;){if(Ve===a)break t;if(je===f&&++Te===w&&(Q=M),je===k&&++ze===p&&(oe=M),(qe=Ve.nextSibling)!==null)break;Ve=je,je=Ve.parentNode}Ve=qe}f=Q===-1||oe===-1?null:{start:Q,end:oe}}else f=null}f=f||{start:0,end:0}}else f=null;for(qh={focusedElem:a,selectionRange:f},Kl=!1,et=l;et!==null;)if(l=et,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,et=a;else for(;et!==null;){l=et;try{var tt=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(tt!==null){var rt=tt.memoizedProps,Yt=tt.memoizedState,ve=l.stateNode,fe=ve.getSnapshotBeforeUpdate(l.elementType===l.type?rt:Bn(l.type,rt),Yt);ve.__reactInternalSnapshotBeforeUpdate=fe}break;case 3:var ye=l.stateNode.containerInfo;ye.nodeType===1?ye.textContent="":ye.nodeType===9&&ye.documentElement&&ye.removeChild(ye.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ge){Ut(l,l.return,Ge)}if(a=l.sibling,a!==null){a.return=l.return,et=a;break}et=l.return}return tt=Qp,Qp=!1,tt}function Vo(a,l,f){var p=l.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var w=p=p.next;do{if((w.tag&a)===a){var k=w.destroy;w.destroy=void 0,k!==void 0&&B0(l,f,k)}w=w.next}while(w!==p)}}function Oc(a,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var f=l=l.next;do{if((f.tag&a)===a){var p=f.create;f.destroy=p()}f=f.next}while(f!==l)}}function j0(a){var l=a.ref;if(l!==null){var f=a.stateNode;switch(a.tag){case 5:a=f;break;default:a=f}typeof l=="function"?l(a):l.current=a}}function em(a){var l=a.alternate;l!==null&&(a.alternate=null,em(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&(delete l[si],delete l[Do],delete l[t0],delete l[C_],delete l[T_])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function tm(a){return a.tag===5||a.tag===3||a.tag===4}function rm(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||tm(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function z0(a,l,f){var p=a.tag;if(p===5||p===6)a=a.stateNode,l?f.nodeType===8?f.parentNode.insertBefore(a,l):f.insertBefore(a,l):(f.nodeType===8?(l=f.parentNode,l.insertBefore(a,f)):(l=f,l.appendChild(a)),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=oc));else if(p!==4&&(a=a.child,a!==null))for(z0(a,l,f),a=a.sibling;a!==null;)z0(a,l,f),a=a.sibling}function U0(a,l,f){var p=a.tag;if(p===5||p===6)a=a.stateNode,l?f.insertBefore(a,l):f.appendChild(a);else if(p!==4&&(a=a.child,a!==null))for(U0(a,l,f),a=a.sibling;a!==null;)U0(a,l,f),a=a.sibling}var mr=null,jn=!1;function ls(a,l,f){for(f=f.child;f!==null;)nm(a,l,f),f=f.sibling}function nm(a,l,f){if(cr&&typeof cr.onCommitFiberUnmount=="function")try{cr.onCommitFiberUnmount(ii,f)}catch{}switch(f.tag){case 5:Ar||Da(f,l);case 6:var p=mr,w=jn;mr=null,ls(a,l,f),mr=p,jn=w,mr!==null&&(jn?(a=mr,f=f.stateNode,a.nodeType===8?a.parentNode.removeChild(f):a.removeChild(f)):mr.removeChild(f.stateNode));break;case 18:mr!==null&&(jn?(a=mr,f=f.stateNode,a.nodeType===8?e0(a.parentNode,f):a.nodeType===1&&e0(a,f),_o(a)):e0(mr,f.stateNode));break;case 4:p=mr,w=jn,mr=f.stateNode.containerInfo,jn=!0,ls(a,l,f),mr=p,jn=w;break;case 0:case 11:case 14:case 15:if(!Ar&&(p=f.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){w=p=p.next;do{var k=w,M=k.destroy;k=k.tag,M!==void 0&&((k&2)!==0||(k&4)!==0)&&B0(f,l,M),w=w.next}while(w!==p)}ls(a,l,f);break;case 1:if(!Ar&&(Da(f,l),p=f.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=f.memoizedProps,p.state=f.memoizedState,p.componentWillUnmount()}catch(Q){Ut(f,l,Q)}ls(a,l,f);break;case 21:ls(a,l,f);break;case 22:f.mode&1?(Ar=(p=Ar)||f.memoizedState!==null,ls(a,l,f),Ar=p):ls(a,l,f);break;default:ls(a,l,f)}}function im(a){var l=a.updateQueue;if(l!==null){a.updateQueue=null;var f=a.stateNode;f===null&&(f=a.stateNode=new U_),l.forEach(function(p){var w=q_.bind(null,a,p);f.has(p)||(f.add(p),p.then(w,w))})}}function zn(a,l){var f=l.deletions;if(f!==null)for(var p=0;p<f.length;p++){var w=f[p];try{var k=a,M=l,Q=M;e:for(;Q!==null;){switch(Q.tag){case 5:mr=Q.stateNode,jn=!1;break e;case 3:mr=Q.stateNode.containerInfo,jn=!0;break e;case 4:mr=Q.stateNode.containerInfo,jn=!0;break e}Q=Q.return}if(mr===null)throw Error(t(160));nm(k,M,w),mr=null,jn=!1;var oe=w.alternate;oe!==null&&(oe.return=null),w.return=null}catch(Te){Ut(w,l,Te)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)sm(l,a),l=l.sibling}function sm(a,l){var f=a.alternate,p=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(zn(l,a),li(a),p&4){try{Vo(3,a,a.return),Oc(3,a)}catch(rt){Ut(a,a.return,rt)}try{Vo(5,a,a.return)}catch(rt){Ut(a,a.return,rt)}}break;case 1:zn(l,a),li(a),p&512&&f!==null&&Da(f,f.return);break;case 5:if(zn(l,a),li(a),p&512&&f!==null&&Da(f,f.return),a.flags&32){var w=a.stateNode;try{Ye(w,"")}catch(rt){Ut(a,a.return,rt)}}if(p&4&&(w=a.stateNode,w!=null)){var k=a.memoizedProps,M=f!==null?f.memoizedProps:k,Q=a.type,oe=a.updateQueue;if(a.updateQueue=null,oe!==null)try{Q==="input"&&k.type==="radio"&&k.name!=null&&ce(w,k),mn(Q,M);var Te=mn(Q,k);for(M=0;M<oe.length;M+=2){var ze=oe[M],Ve=oe[M+1];ze==="style"?Ht(w,Ve):ze==="dangerouslySetInnerHTML"?Ne(w,Ve):ze==="children"?Ye(w,Ve):C(w,ze,Ve,Te)}switch(Q){case"input":j(w,k);break;case"textarea":Re(w,k);break;case"select":var je=w._wrapperState.wasMultiple;w._wrapperState.wasMultiple=!!k.multiple;var qe=k.value;qe!=null?Pe(w,!!k.multiple,qe,!1):je!==!!k.multiple&&(k.defaultValue!=null?Pe(w,!!k.multiple,k.defaultValue,!0):Pe(w,!!k.multiple,k.multiple?[]:"",!1))}w[Do]=k}catch(rt){Ut(a,a.return,rt)}}break;case 6:if(zn(l,a),li(a),p&4){if(a.stateNode===null)throw Error(t(162));w=a.stateNode,k=a.memoizedProps;try{w.nodeValue=k}catch(rt){Ut(a,a.return,rt)}}break;case 3:if(zn(l,a),li(a),p&4&&f!==null&&f.memoizedState.isDehydrated)try{_o(l.containerInfo)}catch(rt){Ut(a,a.return,rt)}break;case 4:zn(l,a),li(a);break;case 13:zn(l,a),li(a),w=a.child,w.flags&8192&&(k=w.memoizedState!==null,w.stateNode.isHidden=k,!k||w.alternate!==null&&w.alternate.memoizedState!==null||(H0=We())),p&4&&im(a);break;case 22:if(ze=f!==null&&f.memoizedState!==null,a.mode&1?(Ar=(Te=Ar)||ze,zn(l,a),Ar=Te):zn(l,a),li(a),p&8192){if(Te=a.memoizedState!==null,(a.stateNode.isHidden=Te)&&!ze&&(a.mode&1)!==0)for(et=a,ze=a.child;ze!==null;){for(Ve=et=ze;et!==null;){switch(je=et,qe=je.child,je.tag){case 0:case 11:case 14:case 15:Vo(4,je,je.return);break;case 1:Da(je,je.return);var tt=je.stateNode;if(typeof tt.componentWillUnmount=="function"){p=je,f=je.return;try{l=p,tt.props=l.memoizedProps,tt.state=l.memoizedState,tt.componentWillUnmount()}catch(rt){Ut(p,f,rt)}}break;case 5:Da(je,je.return);break;case 22:if(je.memoizedState!==null){lm(Ve);continue}}qe!==null?(qe.return=je,et=qe):lm(Ve)}ze=ze.sibling}e:for(ze=null,Ve=a;;){if(Ve.tag===5){if(ze===null){ze=Ve;try{w=Ve.stateNode,Te?(k=w.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none"):(Q=Ve.stateNode,oe=Ve.memoizedProps.style,M=oe!=null&&oe.hasOwnProperty("display")?oe.display:null,Q.style.display=st("display",M))}catch(rt){Ut(a,a.return,rt)}}}else if(Ve.tag===6){if(ze===null)try{Ve.stateNode.nodeValue=Te?"":Ve.memoizedProps}catch(rt){Ut(a,a.return,rt)}}else if((Ve.tag!==22&&Ve.tag!==23||Ve.memoizedState===null||Ve===a)&&Ve.child!==null){Ve.child.return=Ve,Ve=Ve.child;continue}if(Ve===a)break e;for(;Ve.sibling===null;){if(Ve.return===null||Ve.return===a)break e;ze===Ve&&(ze=null),Ve=Ve.return}ze===Ve&&(ze=null),Ve.sibling.return=Ve.return,Ve=Ve.sibling}}break;case 19:zn(l,a),li(a),p&4&&im(a);break;case 21:break;default:zn(l,a),li(a)}}function li(a){var l=a.flags;if(l&2){try{e:{for(var f=a.return;f!==null;){if(tm(f)){var p=f;break e}f=f.return}throw Error(t(160))}switch(p.tag){case 5:var w=p.stateNode;p.flags&32&&(Ye(w,""),p.flags&=-33);var k=rm(a);U0(a,k,w);break;case 3:case 4:var M=p.stateNode.containerInfo,Q=rm(a);z0(a,Q,M);break;default:throw Error(t(161))}}catch(oe){Ut(a,a.return,oe)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function W_(a,l,f){et=a,am(a)}function am(a,l,f){for(var p=(a.mode&1)!==0;et!==null;){var w=et,k=w.child;if(w.tag===22&&p){var M=w.memoizedState!==null||Fc;if(!M){var Q=w.alternate,oe=Q!==null&&Q.memoizedState!==null||Ar;Q=Fc;var Te=Ar;if(Fc=M,(Ar=oe)&&!Te)for(et=w;et!==null;)M=et,oe=M.child,M.tag===22&&M.memoizedState!==null?cm(w):oe!==null?(oe.return=M,et=oe):cm(w);for(;k!==null;)et=k,am(k),k=k.sibling;et=w,Fc=Q,Ar=Te}om(a)}else(w.subtreeFlags&8772)!==0&&k!==null?(k.return=w,et=k):om(a)}}function om(a){for(;et!==null;){var l=et;if((l.flags&8772)!==0){var f=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:Ar||Oc(5,l);break;case 1:var p=l.stateNode;if(l.flags&4&&!Ar)if(f===null)p.componentDidMount();else{var w=l.elementType===l.type?f.memoizedProps:Bn(l.type,f.memoizedProps);p.componentDidUpdate(w,f.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var k=l.updateQueue;k!==null&&lp(l,k,p);break;case 3:var M=l.updateQueue;if(M!==null){if(f=null,l.child!==null)switch(l.child.tag){case 5:f=l.child.stateNode;break;case 1:f=l.child.stateNode}lp(l,M,f)}break;case 5:var Q=l.stateNode;if(f===null&&l.flags&4){f=Q;var oe=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":oe.autoFocus&&f.focus();break;case"img":oe.src&&(f.src=oe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var Te=l.alternate;if(Te!==null){var ze=Te.memoizedState;if(ze!==null){var Ve=ze.dehydrated;Ve!==null&&_o(Ve)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Ar||l.flags&512&&j0(l)}catch(je){Ut(l,l.return,je)}}if(l===a){et=null;break}if(f=l.sibling,f!==null){f.return=l.return,et=f;break}et=l.return}}function lm(a){for(;et!==null;){var l=et;if(l===a){et=null;break}var f=l.sibling;if(f!==null){f.return=l.return,et=f;break}et=l.return}}function cm(a){for(;et!==null;){var l=et;try{switch(l.tag){case 0:case 11:case 15:var f=l.return;try{Oc(4,l)}catch(oe){Ut(l,f,oe)}break;case 1:var p=l.stateNode;if(typeof p.componentDidMount=="function"){var w=l.return;try{p.componentDidMount()}catch(oe){Ut(l,w,oe)}}var k=l.return;try{j0(l)}catch(oe){Ut(l,k,oe)}break;case 5:var M=l.return;try{j0(l)}catch(oe){Ut(l,M,oe)}}}catch(oe){Ut(l,l.return,oe)}if(l===a){et=null;break}var Q=l.sibling;if(Q!==null){Q.return=l.return,et=Q;break}et=l.return}}var H_=Math.ceil,Dc=A.ReactCurrentDispatcher,V0=A.ReactCurrentOwner,Sn=A.ReactCurrentBatchConfig,wt=0,hr=null,qt=null,xr=0,cn=0,Pa=ns(0),nr=0,Wo=null,js=0,Pc=0,W0=0,Ho=null,Zr=null,H0=0,Ma=1/0,bi=null,Mc=!1,X0=null,cs=null,Nc=!1,us=null,Ic=0,Xo=0,G0=null,Rc=-1,Lc=0;function Lr(){return(wt&6)!==0?We():Rc!==-1?Rc:Rc=We()}function hs(a){return(a.mode&1)===0?1:(wt&2)!==0&&xr!==0?xr&-xr:A_.transition!==null?(Lc===0&&(Lc=rg()),Lc):(a=Et,a!==0||(a=window.event,a=a===void 0?16:hg(a.type)),a)}function Un(a,l,f,p){if(50<Xo)throw Xo=0,G0=null,Error(t(185));po(a,f,p),((wt&2)===0||a!==hr)&&(a===hr&&((wt&2)===0&&(Pc|=f),nr===4&&fs(a,xr)),qr(a,p),f===1&&wt===0&&(l.mode&1)===0&&(Ma=We()+500,hc&&ss()))}function qr(a,l){var f=a.callbackNode;A2(a,l);var p=Gl(a,a===hr?xr:0);if(p===0)f!==null&&$e(f),a.callbackNode=null,a.callbackPriority=0;else if(l=p&-p,a.callbackPriority!==l){if(f!=null&&$e(f),l===1)a.tag===0?E_(hm.bind(null,a)):Zg(hm.bind(null,a)),S_(function(){(wt&6)===0&&ss()}),f=null;else{switch(ng(p)){case 1:f=bt;break;case 4:f=Ft;break;case 16:f=Xt;break;case 536870912:f=Ki;break;default:f=Xt}f=ym(f,um.bind(null,a))}a.callbackPriority=l,a.callbackNode=f}}function um(a,l){if(Rc=-1,Lc=0,(wt&6)!==0)throw Error(t(327));var f=a.callbackNode;if(Na()&&a.callbackNode!==f)return null;var p=Gl(a,a===hr?xr:0);if(p===0)return null;if((p&30)!==0||(p&a.expiredLanes)!==0||l)l=Bc(a,p);else{l=p;var w=wt;wt|=2;var k=dm();(hr!==a||xr!==l)&&(bi=null,Ma=We()+500,Us(a,l));do try{Y_();break}catch(Q){fm(a,Q)}while(!0);u0(),Dc.current=k,wt=w,qt!==null?l=0:(hr=null,xr=0,l=nr)}if(l!==0){if(l===2&&(w=Eh(a),w!==0&&(p=w,l=Y0(a,w))),l===1)throw f=Wo,Us(a,0),fs(a,p),qr(a,We()),f;if(l===6)fs(a,p);else{if(w=a.current.alternate,(p&30)===0&&!X_(w)&&(l=Bc(a,p),l===2&&(k=Eh(a),k!==0&&(p=k,l=Y0(a,k))),l===1))throw f=Wo,Us(a,0),fs(a,p),qr(a,We()),f;switch(a.finishedWork=w,a.finishedLanes=p,l){case 0:case 1:throw Error(t(345));case 2:Vs(a,Zr,bi);break;case 3:if(fs(a,p),(p&130023424)===p&&(l=H0+500-We(),10<l)){if(Gl(a,0)!==0)break;if(w=a.suspendedLanes,(w&p)!==p){Lr(),a.pingedLanes|=a.suspendedLanes&w;break}a.timeoutHandle=Qh(Vs.bind(null,a,Zr,bi),l);break}Vs(a,Zr,bi);break;case 4:if(fs(a,p),(p&4194240)===p)break;for(l=a.eventTimes,w=-1;0<p;){var M=31-Gt(p);k=1<<M,M=l[M],M>w&&(w=M),p&=~k}if(p=w,p=We()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*H_(p/1960))-p,10<p){a.timeoutHandle=Qh(Vs.bind(null,a,Zr,bi),p);break}Vs(a,Zr,bi);break;case 5:Vs(a,Zr,bi);break;default:throw Error(t(329))}}}return qr(a,We()),a.callbackNode===f?um.bind(null,a):null}function Y0(a,l){var f=Ho;return a.current.memoizedState.isDehydrated&&(Us(a,l).flags|=256),a=Bc(a,l),a!==2&&(l=Zr,Zr=f,l!==null&&$0(l)),a}function $0(a){Zr===null?Zr=a:Zr.push.apply(Zr,a)}function X_(a){for(var l=a;;){if(l.flags&16384){var f=l.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var p=0;p<f.length;p++){var w=f[p],k=w.getSnapshot;w=w.value;try{if(!Rn(k(),w))return!1}catch{return!1}}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function fs(a,l){for(l&=~W0,l&=~Pc,a.suspendedLanes|=l,a.pingedLanes&=~l,a=a.expirationTimes;0<l;){var f=31-Gt(l),p=1<<f;a[f]=-1,l&=~p}}function hm(a){if((wt&6)!==0)throw Error(t(327));Na();var l=Gl(a,0);if((l&1)===0)return qr(a,We()),null;var f=Bc(a,l);if(a.tag!==0&&f===2){var p=Eh(a);p!==0&&(l=p,f=Y0(a,p))}if(f===1)throw f=Wo,Us(a,0),fs(a,l),qr(a,We()),f;if(f===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=l,Vs(a,Zr,bi),qr(a,We()),null}function K0(a,l){var f=wt;wt|=1;try{return a(l)}finally{wt=f,wt===0&&(Ma=We()+500,hc&&ss())}}function zs(a){us!==null&&us.tag===0&&(wt&6)===0&&Na();var l=wt;wt|=1;var f=Sn.transition,p=Et;try{if(Sn.transition=null,Et=1,a)return a()}finally{Et=p,Sn.transition=f,wt=l,(wt&6)===0&&ss()}}function Z0(){cn=Pa.current,Nt(Pa)}function Us(a,l){a.finishedWork=null,a.finishedLanes=0;var f=a.timeoutHandle;if(f!==-1&&(a.timeoutHandle=-1,w_(f)),qt!==null)for(f=qt.return;f!==null;){var p=f;switch(s0(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&cc();break;case 3:Fa(),Nt(Yr),Nt(Cr),v0();break;case 5:m0(p);break;case 4:Fa();break;case 13:Nt(Bt);break;case 19:Nt(Bt);break;case 10:h0(p.type._context);break;case 22:case 23:Z0()}f=f.return}if(hr=a,qt=a=ds(a.current,null),xr=cn=l,nr=0,Wo=null,W0=Pc=js=0,Zr=Ho=null,Rs!==null){for(l=0;l<Rs.length;l++)if(f=Rs[l],p=f.interleaved,p!==null){f.interleaved=null;var w=p.next,k=f.pending;if(k!==null){var M=k.next;k.next=w,p.next=M}f.pending=p}Rs=null}return a}function fm(a,l){do{var f=qt;try{if(u0(),wc.current=Tc,Sc){for(var p=jt.memoizedState;p!==null;){var w=p.queue;w!==null&&(w.pending=null),p=p.next}Sc=!1}if(Bs=0,ur=rr=jt=null,Lo=!1,Bo=0,V0.current=null,f===null||f.return===null){nr=1,Wo=l,qt=null;break}e:{var k=a,M=f.return,Q=f,oe=l;if(l=xr,Q.flags|=32768,oe!==null&&typeof oe=="object"&&typeof oe.then=="function"){var Te=oe,ze=Q,Ve=ze.tag;if((ze.mode&1)===0&&(Ve===0||Ve===11||Ve===15)){var je=ze.alternate;je?(ze.updateQueue=je.updateQueue,ze.memoizedState=je.memoizedState,ze.lanes=je.lanes):(ze.updateQueue=null,ze.memoizedState=null)}var qe=Lp(M);if(qe!==null){qe.flags&=-257,Bp(qe,M,Q,k,l),qe.mode&1&&Rp(k,Te,l),l=qe,oe=Te;var tt=l.updateQueue;if(tt===null){var rt=new Set;rt.add(oe),l.updateQueue=rt}else tt.add(oe);break e}else{if((l&1)===0){Rp(k,Te,l),q0();break e}oe=Error(t(426))}}else if(Rt&&Q.mode&1){var Yt=Lp(M);if(Yt!==null){(Yt.flags&65536)===0&&(Yt.flags|=256),Bp(Yt,M,Q,k,l),l0(Oa(oe,Q));break e}}k=oe=Oa(oe,Q),nr!==4&&(nr=2),Ho===null?Ho=[k]:Ho.push(k),k=M;do{switch(k.tag){case 3:k.flags|=65536,l&=-l,k.lanes|=l;var ve=Np(k,oe,l);op(k,ve);break e;case 1:Q=oe;var fe=k.type,ye=k.stateNode;if((k.flags&128)===0&&(typeof fe.getDerivedStateFromError=="function"||ye!==null&&typeof ye.componentDidCatch=="function"&&(cs===null||!cs.has(ye)))){k.flags|=65536,l&=-l,k.lanes|=l;var Ge=Ip(k,Q,l);op(k,Ge);break e}}k=k.return}while(k!==null)}pm(f)}catch(it){l=it,qt===f&&f!==null&&(qt=f=f.return);continue}break}while(!0)}function dm(){var a=Dc.current;return Dc.current=Tc,a===null?Tc:a}function q0(){(nr===0||nr===3||nr===2)&&(nr=4),hr===null||(js&268435455)===0&&(Pc&268435455)===0||fs(hr,xr)}function Bc(a,l){var f=wt;wt|=2;var p=dm();(hr!==a||xr!==l)&&(bi=null,Us(a,l));do try{G_();break}catch(w){fm(a,w)}while(!0);if(u0(),wt=f,Dc.current=p,qt!==null)throw Error(t(261));return hr=null,xr=0,nr}function G_(){for(;qt!==null;)gm(qt)}function Y_(){for(;qt!==null&&!Je();)gm(qt)}function gm(a){var l=vm(a.alternate,a,cn);a.memoizedProps=a.pendingProps,l===null?pm(a):qt=l,V0.current=null}function pm(a){var l=a;do{var f=l.alternate;if(a=l.return,(l.flags&32768)===0){if(f=j_(f,l,cn),f!==null){qt=f;return}}else{if(f=z_(f,l),f!==null){f.flags&=32767,qt=f;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{nr=6,qt=null;return}}if(l=l.sibling,l!==null){qt=l;return}qt=l=a}while(l!==null);nr===0&&(nr=5)}function Vs(a,l,f){var p=Et,w=Sn.transition;try{Sn.transition=null,Et=1,$_(a,l,f,p)}finally{Sn.transition=w,Et=p}return null}function $_(a,l,f,p){do Na();while(us!==null);if((wt&6)!==0)throw Error(t(327));f=a.finishedWork;var w=a.finishedLanes;if(f===null)return null;if(a.finishedWork=null,a.finishedLanes=0,f===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var k=f.lanes|f.childLanes;if(b2(a,k),a===hr&&(qt=hr=null,xr=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||Nc||(Nc=!0,ym(Xt,function(){return Na(),null})),k=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||k){k=Sn.transition,Sn.transition=null;var M=Et;Et=1;var Q=wt;wt|=4,V0.current=null,V_(a,f),sm(f,a),g_(qh),Kl=!!Zh,qh=Zh=null,a.current=f,W_(f),Xe(),wt=Q,Et=M,Sn.transition=k}else a.current=f;if(Nc&&(Nc=!1,us=a,Ic=w),k=a.pendingLanes,k===0&&(cs=null),fo(f.stateNode),qr(a,We()),l!==null)for(p=a.onRecoverableError,f=0;f<l.length;f++)w=l[f],p(w.value,{componentStack:w.stack,digest:w.digest});if(Mc)throw Mc=!1,a=X0,X0=null,a;return(Ic&1)!==0&&a.tag!==0&&Na(),k=a.pendingLanes,(k&1)!==0?a===G0?Xo++:(Xo=0,G0=a):Xo=0,ss(),null}function Na(){if(us!==null){var a=ng(Ic),l=Sn.transition,f=Et;try{if(Sn.transition=null,Et=16>a?16:a,us===null)var p=!1;else{if(a=us,us=null,Ic=0,(wt&6)!==0)throw Error(t(331));var w=wt;for(wt|=4,et=a.current;et!==null;){var k=et,M=k.child;if((et.flags&16)!==0){var Q=k.deletions;if(Q!==null){for(var oe=0;oe<Q.length;oe++){var Te=Q[oe];for(et=Te;et!==null;){var ze=et;switch(ze.tag){case 0:case 11:case 15:Vo(8,ze,k)}var Ve=ze.child;if(Ve!==null)Ve.return=ze,et=Ve;else for(;et!==null;){ze=et;var je=ze.sibling,qe=ze.return;if(em(ze),ze===Te){et=null;break}if(je!==null){je.return=qe,et=je;break}et=qe}}}var tt=k.alternate;if(tt!==null){var rt=tt.child;if(rt!==null){tt.child=null;do{var Yt=rt.sibling;rt.sibling=null,rt=Yt}while(rt!==null)}}et=k}}if((k.subtreeFlags&2064)!==0&&M!==null)M.return=k,et=M;else e:for(;et!==null;){if(k=et,(k.flags&2048)!==0)switch(k.tag){case 0:case 11:case 15:Vo(9,k,k.return)}var ve=k.sibling;if(ve!==null){ve.return=k.return,et=ve;break e}et=k.return}}var fe=a.current;for(et=fe;et!==null;){M=et;var ye=M.child;if((M.subtreeFlags&2064)!==0&&ye!==null)ye.return=M,et=ye;else e:for(M=fe;et!==null;){if(Q=et,(Q.flags&2048)!==0)try{switch(Q.tag){case 0:case 11:case 15:Oc(9,Q)}}catch(it){Ut(Q,Q.return,it)}if(Q===M){et=null;break e}var Ge=Q.sibling;if(Ge!==null){Ge.return=Q.return,et=Ge;break e}et=Q.return}}if(wt=w,ss(),cr&&typeof cr.onPostCommitFiberRoot=="function")try{cr.onPostCommitFiberRoot(ii,a)}catch{}p=!0}return p}finally{Et=f,Sn.transition=l}}return!1}function mm(a,l,f){l=Oa(f,l),l=Np(a,l,1),a=os(a,l,1),l=Lr(),a!==null&&(po(a,1,l),qr(a,l))}function Ut(a,l,f){if(a.tag===3)mm(a,a,f);else for(;l!==null;){if(l.tag===3){mm(l,a,f);break}else if(l.tag===1){var p=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(cs===null||!cs.has(p))){a=Oa(f,a),a=Ip(l,a,1),l=os(l,a,1),a=Lr(),l!==null&&(po(l,1,a),qr(l,a));break}}l=l.return}}function K_(a,l,f){var p=a.pingCache;p!==null&&p.delete(l),l=Lr(),a.pingedLanes|=a.suspendedLanes&f,hr===a&&(xr&f)===f&&(nr===4||nr===3&&(xr&130023424)===xr&&500>We()-H0?Us(a,0):W0|=f),qr(a,l)}function xm(a,l){l===0&&((a.mode&1)===0?l=1:(l=Xl,Xl<<=1,(Xl&130023424)===0&&(Xl=4194304)));var f=Lr();a=Ti(a,l),a!==null&&(po(a,l,f),qr(a,f))}function Z_(a){var l=a.memoizedState,f=0;l!==null&&(f=l.retryLane),xm(a,f)}function q_(a,l){var f=0;switch(a.tag){case 13:var p=a.stateNode,w=a.memoizedState;w!==null&&(f=w.retryLane);break;case 19:p=a.stateNode;break;default:throw Error(t(314))}p!==null&&p.delete(l),xm(a,f)}var vm;vm=function(a,l,f){if(a!==null)if(a.memoizedProps!==l.pendingProps||Yr.current)Kr=!0;else{if((a.lanes&f)===0&&(l.flags&128)===0)return Kr=!1,B_(a,l,f);Kr=(a.flags&131072)!==0}else Kr=!1,Rt&&(l.flags&1048576)!==0&&qg(l,dc,l.index);switch(l.lanes=0,l.tag){case 2:var p=l.type;bc(a,l),a=l.pendingProps;var w=Sa(l,Cr.current);ba(l,f),w=w0(null,l,p,a,w,f);var k=S0();return l.flags|=1,typeof w=="object"&&w!==null&&typeof w.render=="function"&&w.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,$r(p)?(k=!0,uc(l)):k=!1,l.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,g0(l),w.updater=Ec,l.stateNode=w,w._reactInternals=l,b0(l,p,a,f),l=P0(null,l,p,!0,k,f)):(l.tag=0,Rt&&k&&i0(l),Rr(null,l,w,f),l=l.child),l;case 16:p=l.elementType;e:{switch(bc(a,l),a=l.pendingProps,w=p._init,p=w(p._payload),l.type=p,w=l.tag=Q_(p),a=Bn(p,a),w){case 0:l=D0(null,l,p,a,f);break e;case 1:l=Hp(null,l,p,a,f);break e;case 11:l=jp(null,l,p,a,f);break e;case 14:l=zp(null,l,p,Bn(p.type,a),f);break e}throw Error(t(306,p,""))}return l;case 0:return p=l.type,w=l.pendingProps,w=l.elementType===p?w:Bn(p,w),D0(a,l,p,w,f);case 1:return p=l.type,w=l.pendingProps,w=l.elementType===p?w:Bn(p,w),Hp(a,l,p,w,f);case 3:e:{if(Xp(l),a===null)throw Error(t(387));p=l.pendingProps,k=l.memoizedState,w=k.element,ap(a,l),yc(l,p,null,f);var M=l.memoizedState;if(p=M.element,k.isDehydrated)if(k={element:p,isDehydrated:!1,cache:M.cache,pendingSuspenseBoundaries:M.pendingSuspenseBoundaries,transitions:M.transitions},l.updateQueue.baseState=k,l.memoizedState=k,l.flags&256){w=Oa(Error(t(423)),l),l=Gp(a,l,p,f,w);break e}else if(p!==w){w=Oa(Error(t(424)),l),l=Gp(a,l,p,f,w);break e}else for(ln=rs(l.stateNode.containerInfo.firstChild),on=l,Rt=!0,Ln=null,f=ip(l,null,p,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Ta(),p===w){l=Ai(a,l,f);break e}Rr(a,l,p,f)}l=l.child}return l;case 5:return cp(l),a===null&&o0(l),p=l.type,w=l.pendingProps,k=a!==null?a.memoizedProps:null,M=w.children,Jh(p,w)?M=null:k!==null&&Jh(p,k)&&(l.flags|=32),Wp(a,l),Rr(a,l,M,f),l.child;case 6:return a===null&&o0(l),null;case 13:return Yp(a,l,f);case 4:return p0(l,l.stateNode.containerInfo),p=l.pendingProps,a===null?l.child=Ea(l,null,p,f):Rr(a,l,p,f),l.child;case 11:return p=l.type,w=l.pendingProps,w=l.elementType===p?w:Bn(p,w),jp(a,l,p,w,f);case 7:return Rr(a,l,l.pendingProps,f),l.child;case 8:return Rr(a,l,l.pendingProps.children,f),l.child;case 12:return Rr(a,l,l.pendingProps.children,f),l.child;case 10:e:{if(p=l.type._context,w=l.pendingProps,k=l.memoizedProps,M=w.value,Ot(mc,p._currentValue),p._currentValue=M,k!==null)if(Rn(k.value,M)){if(k.children===w.children&&!Yr.current){l=Ai(a,l,f);break e}}else for(k=l.child,k!==null&&(k.return=l);k!==null;){var Q=k.dependencies;if(Q!==null){M=k.child;for(var oe=Q.firstContext;oe!==null;){if(oe.context===p){if(k.tag===1){oe=Ei(-1,f&-f),oe.tag=2;var Te=k.updateQueue;if(Te!==null){Te=Te.shared;var ze=Te.pending;ze===null?oe.next=oe:(oe.next=ze.next,ze.next=oe),Te.pending=oe}}k.lanes|=f,oe=k.alternate,oe!==null&&(oe.lanes|=f),f0(k.return,f,l),Q.lanes|=f;break}oe=oe.next}}else if(k.tag===10)M=k.type===l.type?null:k.child;else if(k.tag===18){if(M=k.return,M===null)throw Error(t(341));M.lanes|=f,Q=M.alternate,Q!==null&&(Q.lanes|=f),f0(M,f,l),M=k.sibling}else M=k.child;if(M!==null)M.return=k;else for(M=k;M!==null;){if(M===l){M=null;break}if(k=M.sibling,k!==null){k.return=M.return,M=k;break}M=M.return}k=M}Rr(a,l,w.children,f),l=l.child}return l;case 9:return w=l.type,p=l.pendingProps.children,ba(l,f),w=_n(w),p=p(w),l.flags|=1,Rr(a,l,p,f),l.child;case 14:return p=l.type,w=Bn(p,l.pendingProps),w=Bn(p.type,w),zp(a,l,p,w,f);case 15:return Up(a,l,l.type,l.pendingProps,f);case 17:return p=l.type,w=l.pendingProps,w=l.elementType===p?w:Bn(p,w),bc(a,l),l.tag=1,$r(p)?(a=!0,uc(l)):a=!1,ba(l,f),Pp(l,p,w),b0(l,p,w,f),P0(null,l,p,!0,a,f);case 19:return Kp(a,l,f);case 22:return Vp(a,l,f)}throw Error(t(156,l.tag))};function ym(a,l){return Ue(a,l)}function J_(a,l,f,p){this.tag=a,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kn(a,l,f,p){return new J_(a,l,f,p)}function J0(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Q_(a){if(typeof a=="function")return J0(a)?1:0;if(a!=null){if(a=a.$$typeof,a===D)return 11;if(a===se)return 14}return 2}function ds(a,l){var f=a.alternate;return f===null?(f=kn(a.tag,l,a.key,a.mode),f.elementType=a.elementType,f.type=a.type,f.stateNode=a.stateNode,f.alternate=a,a.alternate=f):(f.pendingProps=l,f.type=a.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=a.flags&14680064,f.childLanes=a.childLanes,f.lanes=a.lanes,f.child=a.child,f.memoizedProps=a.memoizedProps,f.memoizedState=a.memoizedState,f.updateQueue=a.updateQueue,l=a.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=a.sibling,f.index=a.index,f.ref=a.ref,f}function jc(a,l,f,p,w,k){var M=2;if(p=a,typeof a=="function")J0(a)&&(M=1);else if(typeof a=="string")M=5;else e:switch(a){case O:return Ws(f.children,w,k,l);case V:M=8,w|=8;break;case B:return a=kn(12,f,l,w|2),a.elementType=B,a.lanes=k,a;case J:return a=kn(13,f,l,w),a.elementType=J,a.lanes=k,a;case F:return a=kn(19,f,l,w),a.elementType=F,a.lanes=k,a;case le:return zc(f,w,k,l);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case te:M=10;break e;case ie:M=9;break e;case D:M=11;break e;case se:M=14;break e;case Ee:M=16,p=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return l=kn(M,f,l,w),l.elementType=a,l.type=p,l.lanes=k,l}function Ws(a,l,f,p){return a=kn(7,a,p,l),a.lanes=f,a}function zc(a,l,f,p){return a=kn(22,a,p,l),a.elementType=le,a.lanes=f,a.stateNode={isHidden:!1},a}function Q0(a,l,f){return a=kn(6,a,null,l),a.lanes=f,a}function ef(a,l,f){return l=kn(4,a.children!==null?a.children:[],a.key,l),l.lanes=f,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}function ew(a,l,f,p,w){this.tag=l,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ah(0),this.expirationTimes=Ah(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ah(0),this.identifierPrefix=p,this.onRecoverableError=w,this.mutableSourceEagerHydrationData=null}function tf(a,l,f,p,w,k,M,Q,oe){return a=new ew(a,l,f,Q,oe),l===1?(l=1,k===!0&&(l|=8)):l=0,k=kn(3,null,null,l),a.current=k,k.stateNode=a,k.memoizedState={element:p,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},g0(k),a}function tw(a,l,f){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:N,key:p==null?null:""+p,children:a,containerInfo:l,implementation:f}}function _m(a){if(!a)return is;a=a._reactInternals;e:{if(q(a)!==a||a.tag!==1)throw Error(t(170));var l=a;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if($r(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(t(171))}if(a.tag===1){var f=a.type;if($r(f))return $g(a,f,l)}return l}function wm(a,l,f,p,w,k,M,Q,oe){return a=tf(f,p,!0,a,w,k,M,Q,oe),a.context=_m(null),f=a.current,p=Lr(),w=hs(f),k=Ei(p,w),k.callback=l??null,os(f,k,w),a.current.lanes=w,po(a,w,p),qr(a,p),a}function Uc(a,l,f,p){var w=l.current,k=Lr(),M=hs(w);return f=_m(f),l.context===null?l.context=f:l.pendingContext=f,l=Ei(k,M),l.payload={element:a},p=p===void 0?null:p,p!==null&&(l.callback=p),a=os(w,l,M),a!==null&&(Un(a,w,M,k),vc(a,w,M)),M}function Vc(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function Sm(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var f=a.retryLane;a.retryLane=f!==0&&f<l?f:l}}function rf(a,l){Sm(a,l),(a=a.alternate)&&Sm(a,l)}function rw(){return null}var km=typeof reportError=="function"?reportError:function(a){console.error(a)};function nf(a){this._internalRoot=a}Wc.prototype.render=nf.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(t(409));Uc(a,l,null,null)},Wc.prototype.unmount=nf.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;zs(function(){Uc(null,a,null,null)}),l[wi]=null}};function Wc(a){this._internalRoot=a}Wc.prototype.unstable_scheduleHydration=function(a){if(a){var l=ag();a={blockedOn:null,target:a,priority:l};for(var f=0;f<Qi.length&&l!==0&&l<Qi[f].priority;f++);Qi.splice(f,0,a),f===0&&cg(a)}};function sf(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Hc(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function Cm(){}function nw(a,l,f,p,w){if(w){if(typeof p=="function"){var k=p;p=function(){var Te=Vc(M);k.call(Te)}}var M=wm(l,p,a,0,null,!1,!1,"",Cm);return a._reactRootContainer=M,a[wi]=M.current,Fo(a.nodeType===8?a.parentNode:a),zs(),M}for(;w=a.lastChild;)a.removeChild(w);if(typeof p=="function"){var Q=p;p=function(){var Te=Vc(oe);Q.call(Te)}}var oe=tf(a,0,!1,null,null,!1,!1,"",Cm);return a._reactRootContainer=oe,a[wi]=oe.current,Fo(a.nodeType===8?a.parentNode:a),zs(function(){Uc(l,oe,f,p)}),oe}function Xc(a,l,f,p,w){var k=f._reactRootContainer;if(k){var M=k;if(typeof w=="function"){var Q=w;w=function(){var oe=Vc(M);Q.call(oe)}}Uc(l,M,a,w)}else M=nw(f,l,a,w,p);return Vc(M)}ig=function(a){switch(a.tag){case 3:var l=a.stateNode;if(l.current.memoizedState.isDehydrated){var f=go(l.pendingLanes);f!==0&&(bh(l,f|1),qr(l,We()),(wt&6)===0&&(Ma=We()+500,ss()))}break;case 13:zs(function(){var p=Ti(a,1);if(p!==null){var w=Lr();Un(p,a,1,w)}}),rf(a,1)}},Fh=function(a){if(a.tag===13){var l=Ti(a,134217728);if(l!==null){var f=Lr();Un(l,a,134217728,f)}rf(a,134217728)}},sg=function(a){if(a.tag===13){var l=hs(a),f=Ti(a,l);if(f!==null){var p=Lr();Un(f,a,l,p)}rf(a,l)}},ag=function(){return Et},og=function(a,l){var f=Et;try{return Et=a,l()}finally{Et=f}},$i=function(a,l,f){switch(l){case"input":if(j(a,f),l=f.name,f.type==="radio"&&l!=null){for(f=a;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<f.length;l++){var p=f[l];if(p!==a&&p.form===a.form){var w=lc(p);if(!w)throw Error(t(90));z(p),j(p,w)}}}break;case"textarea":Re(a,f);break;case"select":l=f.value,l!=null&&Pe(a,!!f.multiple,l,!1)}},Ul=K0,Vl=zs;var iw={usingClientEntryPoint:!1,Events:[Po,_a,lc,jl,zl,K0]},Go={findFiberByHostInstance:Ps,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sw={bundleType:Go.bundleType,version:Go.version,rendererPackageName:Go.rendererPackageName,rendererConfig:Go.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:A.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=Se(a),a===null?null:a.stateNode},findFiberByHostInstance:Go.findFiberByHostInstance||rw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gc.isDisabled&&Gc.supportsFiber)try{ii=Gc.inject(sw),cr=Gc}catch{}}return Jr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iw,Jr.createPortal=function(a,l){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sf(l))throw Error(t(200));return tw(a,l,null,f)},Jr.createRoot=function(a,l){if(!sf(a))throw Error(t(299));var f=!1,p="",w=km;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onRecoverableError!==void 0&&(w=l.onRecoverableError)),l=tf(a,1,!1,null,null,f,!1,p,w),a[wi]=l.current,Fo(a.nodeType===8?a.parentNode:a),new nf(l)},Jr.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=Se(l),a=a===null?null:a.stateNode,a},Jr.flushSync=function(a){return zs(a)},Jr.hydrate=function(a,l,f){if(!Hc(l))throw Error(t(200));return Xc(null,a,l,!0,f)},Jr.hydrateRoot=function(a,l,f){if(!sf(a))throw Error(t(405));var p=f!=null&&f.hydratedSources||null,w=!1,k="",M=km;if(f!=null&&(f.unstable_strictMode===!0&&(w=!0),f.identifierPrefix!==void 0&&(k=f.identifierPrefix),f.onRecoverableError!==void 0&&(M=f.onRecoverableError)),l=wm(l,null,a,1,f??null,w,!1,k,M),a[wi]=l.current,Fo(a),p)for(a=0;a<p.length;a++)f=p[a],w=f._getVersion,w=w(f._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[f,w]:l.mutableSourceEagerHydrationData.push(f,w);return new Wc(l)},Jr.render=function(a,l,f){if(!Hc(l))throw Error(t(200));return Xc(null,a,l,!1,f)},Jr.unmountComponentAtNode=function(a){if(!Hc(a))throw Error(t(40));return a._reactRootContainer?(zs(function(){Xc(null,null,a,!1,function(){a._reactRootContainer=null,a[wi]=null})}),!0):!1},Jr.unstable_batchedUpdates=K0,Jr.unstable_renderSubtreeIntoContainer=function(a,l,f,p){if(!Hc(f))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return Xc(a,l,f,!1,p)},Jr.version="18.3.1-next-f1338f8080-20240426",Jr}var Pm;function pw(){if(Pm)return lf.exports;Pm=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),lf.exports=gw(),lf.exports}var Mm;function mw(){if(Mm)return $c;Mm=1;var r=pw();return $c.createRoot=r.createRoot,$c.hydrateRoot=r.hydrateRoot,$c}var xw=mw();const vw=ld(xw);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yw=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Bx=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var _w={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ww=vt.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:o,...c},u)=>vt.createElement("svg",{ref:u,..._w,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:Bx("lucide",i),...c},[...o.map(([d,h])=>vt.createElement(d,h)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=(r,e)=>{const t=vt.forwardRef(({className:n,...i},s)=>vt.createElement(ww,{ref:s,iconNode:e,className:Bx(`lucide-${yw(r)}`,n),...i}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kc=kr("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sw=kr("Battery",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mu=kr("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=kr("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nm=kr("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kw=kr("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cw=kr("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Im=kr("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tw=kr("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ew=kr("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aw=kr("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bw=kr("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fw=kr("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ow=kr("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dw=kr("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rm=kr("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nu=kr("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var jx=1252,Pw=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ud={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},hd=function(r){Pw.indexOf(r)!=-1&&(jx=ud[0]=r)};function Mw(){hd(1252)}var qn=function(r){hd(r)};function zx(){qn(1200),Mw()}function Lm(r){for(var e=[],t=0,n=r.length;t<n;++t)e[t]=r.charCodeAt(t);return e}function Nw(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t)+(r.charCodeAt(2*t+1)<<8));return e.join("")}function Ux(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t+1)+(r.charCodeAt(2*t)<<8));return e.join("")}var Zo=function(r){var e=r.charCodeAt(0),t=r.charCodeAt(1);return e==255&&t==254?Nw(r.slice(2)):e==254&&t==255?Ux(r.slice(2)):e==65279?r.slice(1):r},Zc=function(e){return String.fromCharCode(e)},Bm=function(e){return String.fromCharCode(e)},pl,_s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function jm(r){for(var e="",t=0,n=0,i=0,s=0,o=0,c=0,u=0,d=0;d<r.length;)t=r.charCodeAt(d++),s=t>>2,n=r.charCodeAt(d++),o=(t&3)<<4|n>>4,i=r.charCodeAt(d++),c=(n&15)<<2|i>>6,u=i&63,isNaN(n)?c=u=64:isNaN(i)&&(u=64),e+=_s.charAt(s)+_s.charAt(o)+_s.charAt(c)+_s.charAt(u);return e}function gn(r){var e="",t=0,n=0,i=0,s=0,o=0,c=0,u=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<r.length;)s=_s.indexOf(r.charAt(d++)),o=_s.indexOf(r.charAt(d++)),t=s<<2|o>>4,e+=String.fromCharCode(t),c=_s.indexOf(r.charAt(d++)),n=(o&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(n)),u=_s.indexOf(r.charAt(d++)),i=(c&3)<<6|u,u!==64&&(e+=String.fromCharCode(i));return e}var xt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),sa=(function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function ks(r){return xt?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function zm(r){return xt?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var Kn=function(e){return xt?sa(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function aa(r){if(Array.isArray(r))return r.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function fd(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return fd(new Uint8Array(r));for(var e=new Array(r.length),t=0;t<r.length;++t)e[t]=r[t];return e}var vs=xt?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:sa(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var n=new Uint8Array(t),i=0;for(e=0,t=0;e<r.length;t+=i,++e)if(i=r[e].length,r[e]instanceof Uint8Array)n.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";n.set(new Uint8Array(r[e]),t)}return n}return[].concat.apply([],r.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Iw(r){for(var e=[],t=0,n=r.length+250,i=ks(r.length+255),s=0;s<r.length;++s){var o=r.charCodeAt(s);if(o<128)i[t++]=o;else if(o<2048)i[t++]=192|o>>6&31,i[t++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=r.charCodeAt(++s)&1023;i[t++]=240|o>>8&7,i[t++]=128|o>>2&63,i[t++]=128|c>>6&15|(o&3)<<4,i[t++]=128|c&63}else i[t++]=224|o>>12&15,i[t++]=128|o>>6&63,i[t++]=128|o&63;t>n&&(e.push(i.slice(0,t)),t=0,i=ks(65535),n=65530)}return e.push(i.slice(0,t)),vs(e)}var Wr=/\u0000/g,qo=/[\u0001-\u0006]/g;function Xa(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function Jn(r,e){var t=""+r;return t.length>=e?t:Vt("0",e-t.length)+t}function dd(r,e){var t=""+r;return t.length>=e?t:Vt(" ",e-t.length)+t}function Uu(r,e){var t=""+r;return t.length>=e?t:t+Vt(" ",e-t.length)}function Rw(r,e){var t=""+Math.round(r);return t.length>=e?t:Vt("0",e-t.length)+t}function Lw(r,e){var t=""+r;return t.length>=e?t:Vt("0",e-t.length)+t}var Um=Math.pow(2,32);function Ia(r,e){if(r>Um||r<-Um)return Rw(r,e);var t=Math.round(r);return Lw(t,e)}function Vu(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var Vm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],hf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Bw(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',r}var ft={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Wm={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},jw={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Wu(r,e,t){for(var n=r<0?-1:1,i=r*n,s=0,o=1,c=0,u=1,d=0,h=0,g=Math.floor(i);d<e&&(g=Math.floor(i),c=g*o+s,h=g*d+u,!(i-g<5e-8));)i=1/(i-g),s=o,o=c,u=d,d=h;if(h>e&&(d>e?(h=u,c=s):(h=d,c=o)),!t)return[0,n*c,h];var x=Math.floor(n*c/h);return[x,n*c-x*h,h]}function $s(r,e,t){if(r>2958465||r<0)return null;var n=r|0,i=Math.floor(86400*(r-n)),s=0,o=[],c={D:n,T:i,u:86400*(r-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++i==86400&&(c.T=i=0,++n,++c.D)),n===60)o=t?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=t?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],s=u.getDay(),n<60&&(s=(s+6)%7),t&&(s=Xw(u,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=i%60,i=Math.floor(i/60),c.M=i%60,i=Math.floor(i/60),c.H=i,c.q=s,c}var Vx=new Date(1899,11,31,0,0,0),zw=Vx.getTime(),Uw=new Date(1900,2,1,0,0,0);function Wx(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=Uw&&(t+=1440*60*1e3),(t-(zw+(r.getTimezoneOffset()-Vx.getTimezoneOffset())*6e4))/(1440*60*1e3)}function gd(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Vw(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Ww(r){var e=r<0?12:11,t=gd(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function Hw(r){var e=gd(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function ml(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=Ww(r):e===10?t=r.toFixed(10).substr(0,12):t=Hw(r),gd(Vw(t.toUpperCase()))}function ta(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):ml(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return On(14,Wx(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function Xw(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function Gw(r,e,t,n){var i="",s=0,o=0,c=t.y,u,d=0;switch(r){case 98:c=t.y+543;case 121:switch(e.length){case 1:case 2:u=c%100,d=2;break;default:u=c%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:u=t.m,d=e.length;break;case 3:return hf[t.m-1][1];case 5:return hf[t.m-1][0];default:return hf[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:u=t.d,d=e.length;break;case 3:return Vm[t.q][0];default:return Vm[t.q][1]}break;case 104:switch(e.length){case 1:case 2:u=1+(t.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:u=t.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:u=t.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Jn(t.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(t.S+t.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(i=Jn(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":u=t.D*24+t.H;break;case"[m]":case"[mm]":u=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":u=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:u=c,d=1;break}var h=d>0?Jn(u,d):"";return h}function ws(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,n=r.substr(0,t);t!=r.length;t+=e)n+=(n.length>0?",":"")+r.substr(t,e);return n}var Hx=/%/g;function Yw(r,e,t){var n=e.replace(Hx,""),i=e.length-n.length;return Ri(r,n,t*Math.pow(10,2*i))+Vt("%",i)}function $w(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ri(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function Xx(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Xx(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),t.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+s):t+="E+"+(o-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,d,h){return u+d+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Gx=/# (\?+)( ?)\/( ?)(\d+)/;function Kw(r,e,t){var n=parseInt(r[4],10),i=Math.round(e*n),s=Math.floor(i/n),o=i-s*n,c=n;return t+(s===0?"":""+s)+" "+(o===0?Vt(" ",r[1].length+1+r[4].length):dd(o,r[1].length)+r[2]+"/"+r[3]+Jn(c,r[4].length))}function Zw(r,e,t){return t+(e===0?"":""+e)+Vt(" ",r[1].length+2+r[4].length)}var Yx=/^#*0*\.([0#]+)/,$x=/\).*[0#]/,Kx=/\(###\) ###\\?-####/;function jr(r){for(var e="",t,n=0;n!=r.length;++n)switch(t=r.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function Hm(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function Xm(r,e){var t=r-Math.floor(r),n=Math.pow(10,e);return e<(""+Math.round(t*n)).length?0:Math.round(t*n)}function qw(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function Jw(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function En(r,e,t){if(r.charCodeAt(0)===40&&!e.match($x)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?En("n",n,t):"("+En("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return $w(r,e,t);if(e.indexOf("%")!==-1)return Yw(r,e,t);if(e.indexOf("E")!==-1)return Xx(e,t);if(e.charCodeAt(0)===36)return"$"+En(r,e.substr(e.charAt(1)==" "?2:1),t);var i,s,o,c,u=Math.abs(t),d=t<0?"-":"";if(e.match(/^00+$/))return d+Ia(u,e.length);if(e.match(/^[#?]+$/))return i=Ia(t,0),i==="0"&&(i=""),i.length>e.length?i:jr(e.substr(0,e.length-i.length))+i;if(s=e.match(Gx))return Kw(s,u,d);if(e.match(/^#+0+$/))return d+Ia(u,e.length-e.indexOf("0"));if(s=e.match(Yx))return i=Hm(t,s[1].length).replace(/^([^\.]+)$/,"$1."+jr(s[1])).replace(/\.$/,"."+jr(s[1])).replace(/\.(\d*)$/,function(y,v){return"."+v+Vt("0",jr(s[1]).length-v.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+Hm(u,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+ws(Ia(u,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+En(r,e,-t):ws(""+(Math.floor(t)+qw(t,s[1].length)))+"."+Jn(Xm(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return En(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Xa(En(r,e.replace(/[\\-]/g,""),t)),o=0,Xa(Xa(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<i.length?i.charAt(o++):y==="0"?"0":""}));if(e.match(Kx))return i=En(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),c=Wu(u,Math.pow(10,o)-1,!1),i=""+d,h=Ri("n",s[1],c[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=Uu(c[2],o),h.length<s[4].length&&(h=jr(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),c=Wu(u,Math.pow(10,o)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?dd(c[1],o)+s[2]+"/"+s[3]+Uu(c[2],o):Vt(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Ia(t,0),e.length<=i.length?i:jr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var g=e.indexOf(".")-o,x=e.length-i.length-g;return jr(e.substr(0,g)+i+e.substr(e.length-x))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=Xm(t,s[1].length),t<0?"-"+En(r,e,-t):ws(Jw(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Jn(0,3-y.length):"")+y})+"."+Jn(o,s[1].length);switch(e){case"###,##0.00":return En(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var m=ws(Ia(u,0));return m!=="0"?d+m:"";case"###,###.00":return En(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return En(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Qw(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ri(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function eS(r,e,t){var n=e.replace(Hx,""),i=e.length-n.length;return Ri(r,n,t*Math.pow(10,2*i))+Vt("%",i)}function Zx(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Zx(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!t.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+s):t+="E+"+(o-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,d,h){return u+d+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function ui(r,e,t){if(r.charCodeAt(0)===40&&!e.match($x)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ui("n",n,t):"("+ui("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return Qw(r,e,t);if(e.indexOf("%")!==-1)return eS(r,e,t);if(e.indexOf("E")!==-1)return Zx(e,t);if(e.charCodeAt(0)===36)return"$"+ui(r,e.substr(e.charAt(1)==" "?2:1),t);var i,s,o,c,u=Math.abs(t),d=t<0?"-":"";if(e.match(/^00+$/))return d+Jn(u,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:jr(e.substr(0,e.length-i.length))+i;if(s=e.match(Gx))return Zw(s,u,d);if(e.match(/^#+0+$/))return d+Jn(u,e.length-e.indexOf("0"));if(s=e.match(Yx))return i=(""+t).replace(/^([^\.]+)$/,"$1."+jr(s[1])).replace(/\.$/,"."+jr(s[1])),i=i.replace(/\.(\d*)$/,function(y,v){return"."+v+Vt("0",jr(s[1]).length-v.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+ws(""+u);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ui(r,e,-t):ws(""+t)+"."+Vt("0",s[1].length);if(s=e.match(/^#,#*,#0/))return ui(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Xa(ui(r,e.replace(/[\\-]/g,""),t)),o=0,Xa(Xa(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<i.length?i.charAt(o++):y==="0"?"0":""}));if(e.match(Kx))return i=ui(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),c=Wu(u,Math.pow(10,o)-1,!1),i=""+d,h=Ri("n",s[1],c[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=Uu(c[2],o),h.length<s[4].length&&(h=jr(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),c=Wu(u,Math.pow(10,o)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?dd(c[1],o)+s[2]+"/"+s[3]+Uu(c[2],o):Vt(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:jr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var g=e.indexOf(".")-o,x=e.length-i.length-g;return jr(e.substr(0,g)+i+e.substr(e.length-x))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+ui(r,e,-t):ws(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Jn(0,3-y.length):"")+y})+"."+Jn(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=ws(""+u);return m!=="0"?d+m:"";default:if(e.match(/\.[0#?]*$/))return ui(r,e.slice(0,e.lastIndexOf(".")),t)+jr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ri(r,e,t){return(t|0)===t?ui(r,e,t):En(r,e,t)}function tS(r){for(var e=[],t=!1,n=0,i=0;n<r.length;++n)switch(r.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=r.substr(i,n-i),i=n+1}if(e[e.length]=r.substr(i),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var qx=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function eo(r){for(var e=0,t="",n="";e<r.length;)switch(t=r.charAt(e)){case"G":Vu(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=t;r.charAt(e++)!=="]"&&e<r.length;)n+=r.charAt(e);if(n.match(qx))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function rS(r,e,t,n){for(var i=[],s="",o=0,c="",u="t",d,h,g,x="H";o<r.length;)switch(c=r.charAt(o)){case"G":if(!Vu(r,o))throw new Error("unrecognized character "+c+" in "+r);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(g=r.charCodeAt(++o))!==34&&o<r.length;)s+=String.fromCharCode(g);i[i.length]={t:"t",v:s},++o;break;case"\\":var m=r.charAt(++o),y=m==="("||m===")"?m:"t";i[i.length]={t:y,v:m},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:e},++o;break;case"B":case"b":if(r.charAt(o+1)==="1"||r.charAt(o+1)==="2"){if(d==null&&(d=$s(e,t,r.charAt(o+1)==="2"),d==null))return"";i[i.length]={t:"X",v:r.substr(o,2)},u=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=$s(e,t),d==null))return"";for(s=c;++o<r.length&&r.charAt(o).toLowerCase()===c;)s+=c;c==="m"&&u.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=x),i[i.length]={t:c,v:s},u=c;break;case"A":case"a":case"":var v={t:c,v:c};if(d==null&&(d=$s(e,t)),r.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(v.v=d.H>=12?"P":"A"),v.t="T",x="h",o+=3):r.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(v.v=d.H>=12?"PM":"AM"),v.t="T",o+=5,x="h"):r.substr(o,5).toUpperCase()==="/"?(d!=null&&(v.v=d.H>=12?"":""),v.t="T",o+=5,x="h"):(v.t="t",++o),d==null&&v.t==="T")return"";i[i.length]=v,u=c;break;case"[":for(s=c;r.charAt(o++)!=="]"&&o<r.length;)s+=r.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(qx)){if(d==null&&(d=$s(e,t),d==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},u=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",eo(r)||(i[i.length]={t:"t",v:s}));break;case".":if(d!=null){for(s=c;++o<r.length&&(c=r.charAt(o))==="0";)s+=c;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=c;++o<r.length&&"0#?.,E+-%".indexOf(c=r.charAt(o))>-1;)s+=c;i[i.length]={t:"n",v:s};break;case"?":for(s=c;r.charAt(++o)===c;)s+=c;i[i.length]={t:c,v:s},u=c;break;case"*":++o,(r.charAt(o)==" "||r.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=c;o<r.length&&"0123456789".indexOf(r.charAt(++o))>-1;)s+=r.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:c,v:c},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+r);i[i.length]={t:"t",v:c},++o;break}var _=0,S=0,T;for(o=i.length-1,u="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=x,u="h",_<1&&(_=1);break;case"s":(T=i[o].v.match(/\.0+$/))&&(S=Math.max(S,T[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":u=i[o].t;break;case"m":u==="s"&&(i[o].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&i[o].v.match(/[Hh]/)&&(_=1),_<2&&i[o].v.match(/[Mm]/)&&(_=2),_<3&&i[o].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var C="",A;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=Gw(i[o].t.charCodeAt(0),i[o].v,d,S),i[o].t="t";break;case"n":case"?":for(A=o+1;i[A]!=null&&((c=i[A].t)==="?"||c==="D"||(c===" "||c==="t")&&i[A+1]!=null&&(i[A+1].t==="?"||i[A+1].t==="t"&&i[A+1].v==="/")||i[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(i[A].v==="/"||i[A].v===" "&&i[A+1]!=null&&i[A+1].t=="?"));)i[o].v+=i[A].v,i[A]={v:"",t:";"},++A;C+=i[o].v,o=A-1;break;case"G":i[o].t="t",i[o].v=ta(e,t);break}var P="",N,O;if(C.length>0){C.charCodeAt(0)==40?(N=e<0&&C.charCodeAt(0)===45?-e:e,O=Ri("n",C,N)):(N=e<0&&n>1?-e:e,O=Ri("n",C,N),N<0&&i[0]&&i[0].t=="t"&&(O=O.substr(1),i[0].v="-"+i[0].v)),A=O.length-1;var V=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){V=o;break}var B=i.length;if(V===i.length&&O.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(A>=i[o].v.length-1?(A-=i[o].v.length,i[o].v=O.substr(A+1,i[o].v.length)):A<0?i[o].v="":(i[o].v=O.substr(0,A+1),A=-1),i[o].t="t",B=o);A>=0&&B<i.length&&(i[B].v=O.substr(0,A+1)+i[B].v)}else if(V!==i.length&&O.indexOf("E")===-1){for(A=O.indexOf(".")-1,o=V;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(h=i[o].v.indexOf(".")>-1&&o===V?i[o].v.indexOf(".")-1:i[o].v.length-1,P=i[o].v.substr(h+1);h>=0;--h)A>=0&&(i[o].v.charAt(h)==="0"||i[o].v.charAt(h)==="#")&&(P=O.charAt(A--)+P);i[o].v=P,i[o].t="t",B=o}for(A>=0&&B<i.length&&(i[B].v=O.substr(0,A+1)+i[B].v),A=O.indexOf(".")+1,o=V;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==V)){for(h=i[o].v.indexOf(".")>-1&&o===V?i[o].v.indexOf(".")+1:0,P=i[o].v.substr(0,h);h<i[o].v.length;++h)A<O.length&&(P+=O.charAt(A++));i[o].v=P,i[o].t="t",B=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(N=n>1&&e<0&&o>0&&i[o-1].v==="-"?-e:e,i[o].v=Ri(i[o].t,i[o].v,N),i[o].t="t");var te="";for(o=0;o!==i.length;++o)i[o]!=null&&(te+=i[o].v);return te}var Gm=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ym(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function nS(r,e){var t=tS(r),n=t.length,i=t[n-1].indexOf("@");if(n<4&&i>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var o=t[0].match(Gm),c=t[1].match(Gm);return Ym(e,o)?[n,t[0]]:Ym(e,c)?[n,t[1]]:[n,t[o!=null&&c!=null?2:1]]}return[n,s]}function On(r,e,t){t==null&&(t={});var n="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?n=t.dateNF:n=r;break;case"number":r==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:ft)[r],n==null&&(n=t.table&&t.table[Wm[r]]||ft[Wm[r]]),n==null&&(n=jw[r]||"General");break}if(Vu(n,0))return ta(e,t);e instanceof Date&&(e=Wx(e,t.date1904));var i=nS(n,e);if(Vu(i[1]))return ta(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return rS(i[1],e,t,i[0])}function Js(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(ft[t]==null){e<0&&(e=t);continue}if(ft[t]==r){e=t;break}}e<0&&(e=391)}return ft[e]=r,e}function Jx(){ft=Bw()}var iS={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Qx=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function sS(r){var e=typeof r=="number"?ft[r]:r;return e=e.replace(Qx,"(\\d+)"),new RegExp("^"+e+"$")}function aS(r,e,t){var n=-1,i=-1,s=-1,o=-1,c=-1,u=-1;(e.match(Qx)||[]).forEach(function(g,x){var m=parseInt(t[x+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":o=m;break;case"s":u=m;break;case"m":o>=0?c=m:i=m;break}}),u>=0&&c==-1&&i>=0&&(c=i,i=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&c==-1&&u==-1?d:n==-1&&i==-1&&s==-1?h:d+"T"+h}var oS=(function(){var r={};r.version="1.2.0";function e(){for(var O=0,V=new Array(256),B=0;B!=256;++B)O=B,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,V[B]=O;return typeof Int32Array<"u"?new Int32Array(V):V}var t=e();function n(O){var V=0,B=0,te=0,ie=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(te=0;te!=256;++te)ie[te]=O[te];for(te=0;te!=256;++te)for(B=O[te],V=256+te;V<4096;V+=256)B=ie[V]=B>>>8^O[B&255];var D=[];for(te=1;te!=16;++te)D[te-1]=typeof Int32Array<"u"?ie.subarray(te*256,te*256+256):ie.slice(te*256,te*256+256);return D}var i=n(t),s=i[0],o=i[1],c=i[2],u=i[3],d=i[4],h=i[5],g=i[6],x=i[7],m=i[8],y=i[9],v=i[10],_=i[11],S=i[12],T=i[13],C=i[14];function A(O,V){for(var B=V^-1,te=0,ie=O.length;te<ie;)B=B>>>8^t[(B^O.charCodeAt(te++))&255];return~B}function P(O,V){for(var B=V^-1,te=O.length-15,ie=0;ie<te;)B=C[O[ie++]^B&255]^T[O[ie++]^B>>8&255]^S[O[ie++]^B>>16&255]^_[O[ie++]^B>>>24]^v[O[ie++]]^y[O[ie++]]^m[O[ie++]]^x[O[ie++]]^g[O[ie++]]^h[O[ie++]]^d[O[ie++]]^u[O[ie++]]^c[O[ie++]]^o[O[ie++]]^s[O[ie++]]^t[O[ie++]];for(te+=15;ie<te;)B=B>>>8^t[(B^O[ie++])&255];return~B}function N(O,V){for(var B=V^-1,te=0,ie=O.length,D=0,J=0;te<ie;)D=O.charCodeAt(te++),D<128?B=B>>>8^t[(B^D)&255]:D<2048?(B=B>>>8^t[(B^(192|D>>6&31))&255],B=B>>>8^t[(B^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,J=O.charCodeAt(te++)&1023,B=B>>>8^t[(B^(240|D>>8&7))&255],B=B>>>8^t[(B^(128|D>>2&63))&255],B=B>>>8^t[(B^(128|J>>6&15|(D&3)<<4))&255],B=B>>>8^t[(B^(128|J&63))&255]):(B=B>>>8^t[(B^(224|D>>12&15))&255],B=B>>>8^t[(B^(128|D>>6&63))&255],B=B>>>8^t[(B^(128|D&63))&255]);return~B}return r.table=t,r.bstr=A,r.buf=P,r.str=N,r})(),yt=(function(){var e={};e.version="1.2.1";function t(I,K){for(var W=I.split("/"),Y=K.split("/"),Z=0,q=0,we=Math.min(W.length,Y.length);Z<we;++Z){if(q=W[Z].length-Y[Z].length)return q;if(W[Z]!=Y[Z])return W[Z]<Y[Z]?-1:1}return W.length-Y.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var K=I.lastIndexOf("/");return K===-1?I:I.slice(0,K+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var K=I.lastIndexOf("/");return K===-1?I:I.slice(K+1)}function s(I,K){typeof K=="string"&&(K=new Date(K));var W=K.getHours();W=W<<6|K.getMinutes(),W=W<<5|K.getSeconds()>>>1,I.write_shift(2,W);var Y=K.getFullYear()-1980;Y=Y<<4|K.getMonth()+1,Y=Y<<5|K.getDate(),I.write_shift(2,Y)}function o(I){var K=I.read_shift(2)&65535,W=I.read_shift(2)&65535,Y=new Date,Z=W&31;W>>>=5;var q=W&15;W>>>=4,Y.setMilliseconds(0),Y.setFullYear(W+1980),Y.setMonth(q-1),Y.setDate(Z);var we=K&31;K>>>=5;var Ie=K&63;return K>>>=6,Y.setHours(K),Y.setMinutes(Ie),Y.setSeconds(we<<1),Y}function c(I){yr(I,0);for(var K={},W=0;I.l<=I.length-4;){var Y=I.read_shift(2),Z=I.read_shift(2),q=I.l+Z,we={};switch(Y){case 21589:W=I.read_shift(1),W&1&&(we.mtime=I.read_shift(4)),Z>5&&(W&2&&(we.atime=I.read_shift(4)),W&4&&(we.ctime=I.read_shift(4))),we.mtime&&(we.mt=new Date(we.mtime*1e3));break}I.l=q,K[Y]=we}return K}var u;function d(){return u||(u={})}function h(I,K){if(I[0]==80&&I[1]==75)return $i(I,K);if((I[0]|32)==109&&(I[1]|32)==105)return Wl(I,K);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var W=3,Y=512,Z=0,q=0,we=0,Ie=0,_e=0,Se=[],ke=I.slice(0,512);yr(ke,0);var Ue=g(ke);switch(W=Ue[0],W){case 3:Y=512;break;case 4:Y=4096;break;case 0:if(Ue[1]==0)return $i(I,K);default:throw new Error("Major Version: Expected 3 or 4 saw "+W)}Y!==512&&(ke=I.slice(0,Y),yr(ke,28));var $e=I.slice(0,Y);x(ke,W);var Je=ke.read_shift(4,"i");if(W===3&&Je!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Je);ke.l+=4,we=ke.read_shift(4,"i"),ke.l+=4,ke.chk("00100000","Mini Stream Cutoff Size: "),Ie=ke.read_shift(4,"i"),Z=ke.read_shift(4,"i"),_e=ke.read_shift(4,"i"),q=ke.read_shift(4,"i");for(var Xe=-1,We=0;We<109&&(Xe=ke.read_shift(4,"i"),!(Xe<0));++We)Se[We]=Xe;var ut=m(I,Y);_(_e,q,ut,Y,Se);var bt=T(ut,we,Se,Y);bt[we].name="!Directory",Z>0&&Ie!==J&&(bt[Ie].name="!MiniFAT"),bt[Se[0]].name="!FAT",bt.fat_addrs=Se,bt.ssz=Y;var Ft={},Xt=[],Ds=[],Ki=[];C(we,bt,ut,Xt,Z,Ft,Ds,Ie),y(Ds,Ki,Xt),Xt.shift();var ii={FileIndex:Ds,FullPaths:Ki};return K&&K.raw&&(ii.raw={header:$e,sectors:ut}),ii}function g(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(F,"Header Signature: "),I.l+=16;var K=I.read_shift(2,"u");return[I.read_shift(2,"u"),K]}function x(I,K){var W=9;switch(I.l+=2,W=I.read_shift(2)){case 9:if(K!=3)throw new Error("Sector Shift: Expected 9 saw "+W);break;case 12:if(K!=4)throw new Error("Sector Shift: Expected 12 saw "+W);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+W)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function m(I,K){for(var W=Math.ceil(I.length/K)-1,Y=[],Z=1;Z<W;++Z)Y[Z-1]=I.slice(Z*K,(Z+1)*K);return Y[W-1]=I.slice(W*K),Y}function y(I,K,W){for(var Y=0,Z=0,q=0,we=0,Ie=0,_e=W.length,Se=[],ke=[];Y<_e;++Y)Se[Y]=ke[Y]=Y,K[Y]=W[Y];for(;Ie<ke.length;++Ie)Y=ke[Ie],Z=I[Y].L,q=I[Y].R,we=I[Y].C,Se[Y]===Y&&(Z!==-1&&Se[Z]!==Z&&(Se[Y]=Se[Z]),q!==-1&&Se[q]!==q&&(Se[Y]=Se[q])),we!==-1&&(Se[we]=Y),Z!==-1&&Y!=Se[Y]&&(Se[Z]=Se[Y],ke.lastIndexOf(Z)<Ie&&ke.push(Z)),q!==-1&&Y!=Se[Y]&&(Se[q]=Se[Y],ke.lastIndexOf(q)<Ie&&ke.push(q));for(Y=1;Y<_e;++Y)Se[Y]===Y&&(q!==-1&&Se[q]!==q?Se[Y]=Se[q]:Z!==-1&&Se[Z]!==Z&&(Se[Y]=Se[Z]));for(Y=1;Y<_e;++Y)if(I[Y].type!==0){if(Ie=Y,Ie!=Se[Ie])do Ie=Se[Ie],K[Y]=K[Ie]+"/"+K[Y];while(Ie!==0&&Se[Ie]!==-1&&Ie!=Se[Ie]);Se[Y]=-1}for(K[0]+="/",Y=1;Y<_e;++Y)I[Y].type!==2&&(K[Y]+="/")}function v(I,K,W){for(var Y=I.start,Z=I.size,q=[],we=Y;W&&Z>0&&we>=0;)q.push(K.slice(we*D,we*D+D)),Z-=D,we=Xs(W,we*4);return q.length===0?ir(0):vs(q).slice(0,I.size)}function _(I,K,W,Y,Z){var q=J;if(I===J){if(K!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var we=W[I],Ie=(Y>>>2)-1;if(!we)return;for(var _e=0;_e<Ie&&(q=Xs(we,_e*4))!==J;++_e)Z.push(q);_(Xs(we,Y-4),K-1,W,Y,Z)}}function S(I,K,W,Y,Z){var q=[],we=[];Z||(Z=[]);var Ie=Y-1,_e=0,Se=0;for(_e=K;_e>=0;){Z[_e]=!0,q[q.length]=_e,we.push(I[_e]);var ke=W[Math.floor(_e*4/Y)];if(Se=_e*4&Ie,Y<4+Se)throw new Error("FAT boundary crossed: "+_e+" 4 "+Y);if(!I[ke])break;_e=Xs(I[ke],Se)}return{nodes:q,data:n1([we])}}function T(I,K,W,Y){var Z=I.length,q=[],we=[],Ie=[],_e=[],Se=Y-1,ke=0,Ue=0,$e=0,Je=0;for(ke=0;ke<Z;++ke)if(Ie=[],$e=ke+K,$e>=Z&&($e-=Z),!we[$e]){_e=[];var Xe=[];for(Ue=$e;Ue>=0;){Xe[Ue]=!0,we[Ue]=!0,Ie[Ie.length]=Ue,_e.push(I[Ue]);var We=W[Math.floor(Ue*4/Y)];if(Je=Ue*4&Se,Y<4+Je)throw new Error("FAT boundary crossed: "+Ue+" 4 "+Y);if(!I[We]||(Ue=Xs(I[We],Je),Xe[Ue]))break}q[$e]={nodes:Ie,data:n1([_e])}}return q}function C(I,K,W,Y,Z,q,we,Ie){for(var _e=0,Se=Y.length?2:0,ke=K[I].data,Ue=0,$e=0,Je;Ue<ke.length;Ue+=128){var Xe=ke.slice(Ue,Ue+128);yr(Xe,64),$e=Xe.read_shift(2),Je=yd(Xe,0,$e-Se),Y.push(Je);var We={name:Je,type:Xe.read_shift(1),color:Xe.read_shift(1),L:Xe.read_shift(4,"i"),R:Xe.read_shift(4,"i"),C:Xe.read_shift(4,"i"),clsid:Xe.read_shift(16),state:Xe.read_shift(4,"i"),start:0,size:0},ut=Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2);ut!==0&&(We.ct=A(Xe,Xe.l-8));var bt=Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2);bt!==0&&(We.mt=A(Xe,Xe.l-8)),We.start=Xe.read_shift(4,"i"),We.size=Xe.read_shift(4,"i"),We.size<0&&We.start<0&&(We.size=We.type=0,We.start=J,We.name=""),We.type===5?(_e=We.start,Z>0&&_e!==J&&(K[_e].name="!StreamData")):We.size>=4096?(We.storage="fat",K[We.start]===void 0&&(K[We.start]=S(W,We.start,K.fat_addrs,K.ssz)),K[We.start].name=We.name,We.content=K[We.start].data.slice(0,We.size)):(We.storage="minifat",We.size<0?We.size=0:_e!==J&&We.start!==J&&K[_e]&&(We.content=v(We,K[_e].data,(K[Ie]||{}).data))),We.content&&yr(We.content,0),q[Je]=We,we.push(We)}}function A(I,K){return new Date((hn(I,K+4)/1e7*Math.pow(2,32)+hn(I,K)/1e7-11644473600)*1e3)}function P(I,K){return d(),h(u.readFileSync(I),K)}function N(I,K){var W=K&&K.type;switch(W||xt&&Buffer.isBuffer(I)&&(W="buffer"),W||"base64"){case"file":return P(I,K);case"base64":return h(Kn(gn(I)),K);case"binary":return h(Kn(I),K)}return h(I,K)}function O(I,K){var W=K||{},Y=W.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=Y+"/",I.FileIndex[0]={name:Y,type:5}),W.CLSID&&(I.FileIndex[0].clsid=W.CLSID),V(I)}function V(I){var K="Sh33tJ5";if(!yt.find(I,"/"+K)){var W=ir(4);W[0]=55,W[1]=W[3]=50,W[2]=54,I.FileIndex.push({name:K,type:2,content:W,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+K),B(I)}}function B(I,K){O(I);for(var W=!1,Y=!1,Z=I.FullPaths.length-1;Z>=0;--Z){var q=I.FileIndex[Z];switch(q.type){case 0:Y?W=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:Y=!0,isNaN(q.R*q.L*q.C)&&(W=!0),q.R>-1&&q.L>-1&&q.R==q.L&&(W=!0);break;default:W=!0;break}}if(!(!W&&!K)){var we=new Date(1987,1,19),Ie=0,_e=Object.create?Object.create(null):{},Se=[];for(Z=0;Z<I.FullPaths.length;++Z)_e[I.FullPaths[Z]]=!0,I.FileIndex[Z].type!==0&&Se.push([I.FullPaths[Z],I.FileIndex[Z]]);for(Z=0;Z<Se.length;++Z){var ke=n(Se[Z][0]);Y=_e[ke],Y||(Se.push([ke,{name:i(ke).replace("/",""),type:1,clsid:Ee,ct:we,mt:we,content:null}]),_e[ke]=!0)}for(Se.sort(function(Je,Xe){return t(Je[0],Xe[0])}),I.FullPaths=[],I.FileIndex=[],Z=0;Z<Se.length;++Z)I.FullPaths[Z]=Se[Z][0],I.FileIndex[Z]=Se[Z][1];for(Z=0;Z<Se.length;++Z){var Ue=I.FileIndex[Z],$e=I.FullPaths[Z];if(Ue.name=i($e).replace("/",""),Ue.L=Ue.R=Ue.C=-(Ue.color=1),Ue.size=Ue.content?Ue.content.length:0,Ue.start=0,Ue.clsid=Ue.clsid||Ee,Z===0)Ue.C=Se.length>1?1:-1,Ue.size=0,Ue.type=5;else if($e.slice(-1)=="/"){for(Ie=Z+1;Ie<Se.length&&n(I.FullPaths[Ie])!=$e;++Ie);for(Ue.C=Ie>=Se.length?-1:Ie,Ie=Z+1;Ie<Se.length&&n(I.FullPaths[Ie])!=n($e);++Ie);Ue.R=Ie>=Se.length?-1:Ie,Ue.type=1}else n(I.FullPaths[Z+1]||"")==n($e)&&(Ue.R=Z+1),Ue.type=2}}}function te(I,K){var W=K||{};if(W.fileType=="mad")return Fs(I,W);switch(B(I),W.fileType){case"zip":return Gr(I,W)}var Y=(function(Je){for(var Xe=0,We=0,ut=0;ut<Je.FileIndex.length;++ut){var bt=Je.FileIndex[ut];if(bt.content){var Ft=bt.content.length;Ft>0&&(Ft<4096?Xe+=Ft+63>>6:We+=Ft+511>>9)}}for(var Xt=Je.FullPaths.length+3>>2,Ds=Xe+7>>3,Ki=Xe+127>>7,ii=Ds+We+Xt+Ki,cr=ii+127>>7,fo=cr<=109?0:Math.ceil((cr-109)/127);ii+cr+fo+127>>7>cr;)fo=++cr<=109?0:Math.ceil((cr-109)/127);var Gt=[1,fo,cr,Ki,Xt,We,Xe,0];return Je.FileIndex[0].size=Xe<<6,Gt[7]=(Je.FileIndex[0].start=Gt[0]+Gt[1]+Gt[2]+Gt[3]+Gt[4]+Gt[5])+(Gt[6]+7>>3),Gt})(I),Z=ir(Y[7]<<9),q=0,we=0;{for(q=0;q<8;++q)Z.write_shift(1,se[q]);for(q=0;q<8;++q)Z.write_shift(2,0);for(Z.write_shift(2,62),Z.write_shift(2,3),Z.write_shift(2,65534),Z.write_shift(2,9),Z.write_shift(2,6),q=0;q<3;++q)Z.write_shift(2,0);for(Z.write_shift(4,0),Z.write_shift(4,Y[2]),Z.write_shift(4,Y[0]+Y[1]+Y[2]+Y[3]-1),Z.write_shift(4,0),Z.write_shift(4,4096),Z.write_shift(4,Y[3]?Y[0]+Y[1]+Y[2]-1:J),Z.write_shift(4,Y[3]),Z.write_shift(-4,Y[1]?Y[0]-1:J),Z.write_shift(4,Y[1]),q=0;q<109;++q)Z.write_shift(-4,q<Y[2]?Y[1]+q:-1)}if(Y[1])for(we=0;we<Y[1];++we){for(;q<236+we*127;++q)Z.write_shift(-4,q<Y[2]?Y[1]+q:-1);Z.write_shift(-4,we===Y[1]-1?J:we+1)}var Ie=function(Je){for(we+=Je;q<we-1;++q)Z.write_shift(-4,q+1);Je&&(++q,Z.write_shift(-4,J))};for(we=q=0,we+=Y[1];q<we;++q)Z.write_shift(-4,le.DIFSECT);for(we+=Y[2];q<we;++q)Z.write_shift(-4,le.FATSECT);Ie(Y[3]),Ie(Y[4]);for(var _e=0,Se=0,ke=I.FileIndex[0];_e<I.FileIndex.length;++_e)ke=I.FileIndex[_e],ke.content&&(Se=ke.content.length,!(Se<4096)&&(ke.start=we,Ie(Se+511>>9)));for(Ie(Y[6]+7>>3);Z.l&511;)Z.write_shift(-4,le.ENDOFCHAIN);for(we=q=0,_e=0;_e<I.FileIndex.length;++_e)ke=I.FileIndex[_e],ke.content&&(Se=ke.content.length,!(!Se||Se>=4096)&&(ke.start=we,Ie(Se+63>>6)));for(;Z.l&511;)Z.write_shift(-4,le.ENDOFCHAIN);for(q=0;q<Y[4]<<2;++q){var Ue=I.FullPaths[q];if(!Ue||Ue.length===0){for(_e=0;_e<17;++_e)Z.write_shift(4,0);for(_e=0;_e<3;++_e)Z.write_shift(4,-1);for(_e=0;_e<12;++_e)Z.write_shift(4,0);continue}ke=I.FileIndex[q],q===0&&(ke.start=ke.size?ke.start-1:J);var $e=q===0&&W.root||ke.name;if(Se=2*($e.length+1),Z.write_shift(64,$e,"utf16le"),Z.write_shift(2,Se),Z.write_shift(1,ke.type),Z.write_shift(1,ke.color),Z.write_shift(-4,ke.L),Z.write_shift(-4,ke.R),Z.write_shift(-4,ke.C),ke.clsid)Z.write_shift(16,ke.clsid,"hex");else for(_e=0;_e<4;++_e)Z.write_shift(4,0);Z.write_shift(4,ke.state||0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,ke.start),Z.write_shift(4,ke.size),Z.write_shift(4,0)}for(q=1;q<I.FileIndex.length;++q)if(ke=I.FileIndex[q],ke.size>=4096)if(Z.l=ke.start+1<<9,xt&&Buffer.isBuffer(ke.content))ke.content.copy(Z,Z.l,0,ke.size),Z.l+=ke.size+511&-512;else{for(_e=0;_e<ke.size;++_e)Z.write_shift(1,ke.content[_e]);for(;_e&511;++_e)Z.write_shift(1,0)}for(q=1;q<I.FileIndex.length;++q)if(ke=I.FileIndex[q],ke.size>0&&ke.size<4096)if(xt&&Buffer.isBuffer(ke.content))ke.content.copy(Z,Z.l,0,ke.size),Z.l+=ke.size+63&-64;else{for(_e=0;_e<ke.size;++_e)Z.write_shift(1,ke.content[_e]);for(;_e&63;++_e)Z.write_shift(1,0)}if(xt)Z.l=Z.length;else for(;Z.l<Z.length;)Z.write_shift(1,0);return Z}function ie(I,K){var W=I.FullPaths.map(function(_e){return _e.toUpperCase()}),Y=W.map(function(_e){var Se=_e.split("/");return Se[Se.length-(_e.slice(-1)=="/"?2:1)]}),Z=!1;K.charCodeAt(0)===47?(Z=!0,K=W[0].slice(0,-1)+K):Z=K.indexOf("/")!==-1;var q=K.toUpperCase(),we=Z===!0?W.indexOf(q):Y.indexOf(q);if(we!==-1)return I.FileIndex[we];var Ie=!q.match(qo);for(q=q.replace(Wr,""),Ie&&(q=q.replace(qo,"!")),we=0;we<W.length;++we)if((Ie?W[we].replace(qo,"!"):W[we]).replace(Wr,"")==q||(Ie?Y[we].replace(qo,"!"):Y[we]).replace(Wr,"")==q)return I.FileIndex[we];return null}var D=64,J=-2,F="d0cf11e0a1b11ae1",se=[208,207,17,224,161,177,26,225],Ee="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:J,FREESECT:-1,HEADER_SIGNATURE:F,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function xe(I,K,W){d();var Y=te(I,W);u.writeFileSync(K,Y)}function X(I){for(var K=new Array(I.length),W=0;W<I.length;++W)K[W]=String.fromCharCode(I[W]);return K.join("")}function pe(I,K){var W=te(I,K);switch(K&&K.type||"buffer"){case"file":return d(),u.writeFileSync(K.filename,W),W;case"binary":return typeof W=="string"?W:X(W);case"base64":return jm(typeof W=="string"?W:X(W));case"buffer":if(xt)return Buffer.isBuffer(W)?W:sa(W);case"array":return typeof W=="string"?Kn(W):W}return W}var R;function b(I){try{var K=I.InflateRaw,W=new K;if(W._processChunk(new Uint8Array([3,0]),W._finishFlushFlag),W.bytesRead)R=I;else throw new Error("zlib does not expose bytesRead")}catch(Y){console.error("cannot use native zlib: "+(Y.message||Y))}}function ee(I,K){if(!R)return yi(I,K);var W=R.InflateRaw,Y=new W,Z=Y._processChunk(I.slice(I.l),Y._finishFlushFlag);return I.l+=Y.bytesRead,Z}function G(I){return R?R.deflateRawSync(I):Ye(I)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],me=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Fe(I){var K=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(K>>16|K>>8|K)&255}for(var be=typeof Uint8Array<"u",De=be?new Uint8Array(256):[],ne=0;ne<256;++ne)De[ne]=Fe(ne);function z(I,K){var W=De[I&255];return K<=8?W>>>8-K:(W=W<<8|De[I>>8&255],K<=16?W>>>16-K:(W=W<<8|De[I>>16&255],W>>>24-K))}function Le(I,K){var W=K&7,Y=K>>>3;return(I[Y]|(W<=6?0:I[Y+1]<<8))>>>W&3}function E(I,K){var W=K&7,Y=K>>>3;return(I[Y]|(W<=5?0:I[Y+1]<<8))>>>W&7}function de(I,K){var W=K&7,Y=K>>>3;return(I[Y]|(W<=4?0:I[Y+1]<<8))>>>W&15}function ce(I,K){var W=K&7,Y=K>>>3;return(I[Y]|(W<=3?0:I[Y+1]<<8))>>>W&31}function j(I,K){var W=K&7,Y=K>>>3;return(I[Y]|(W<=1?0:I[Y+1]<<8))>>>W&127}function U(I,K,W){var Y=K&7,Z=K>>>3,q=(1<<W)-1,we=I[Z]>>>Y;return W<8-Y||(we|=I[Z+1]<<8-Y,W<16-Y)||(we|=I[Z+2]<<16-Y,W<24-Y)||(we|=I[Z+3]<<24-Y),we&q}function ae(I,K,W){var Y=K&7,Z=K>>>3;return Y<=5?I[Z]|=(W&7)<<Y:(I[Z]|=W<<Y&255,I[Z+1]=(W&7)>>8-Y),K+3}function Ae(I,K,W){var Y=K&7,Z=K>>>3;return W=(W&1)<<Y,I[Z]|=W,K+1}function Pe(I,K,W){var Y=K&7,Z=K>>>3;return W<<=Y,I[Z]|=W&255,W>>>=8,I[Z+1]=W,K+8}function ge(I,K,W){var Y=K&7,Z=K>>>3;return W<<=Y,I[Z]|=W&255,W>>>=8,I[Z+1]=W&255,I[Z+2]=W>>>8,K+16}function Oe(I,K){var W=I.length,Y=2*W>K?2*W:K+5,Z=0;if(W>=K)return I;if(xt){var q=zm(Y);if(I.copy)I.copy(q);else for(;Z<I.length;++Z)q[Z]=I[Z];return q}else if(be){var we=new Uint8Array(Y);if(we.set)we.set(I);else for(;Z<W;++Z)we[Z]=I[Z];return we}return I.length=Y,I}function Re(I){for(var K=new Array(I),W=0;W<I;++W)K[W]=0;return K}function Be(I,K,W){var Y=1,Z=0,q=0,we=0,Ie=0,_e=I.length,Se=be?new Uint16Array(32):Re(32);for(q=0;q<32;++q)Se[q]=0;for(q=_e;q<W;++q)I[q]=0;_e=I.length;var ke=be?new Uint16Array(_e):Re(_e);for(q=0;q<_e;++q)Se[Z=I[q]]++,Y<Z&&(Y=Z),ke[q]=0;for(Se[0]=0,q=1;q<=Y;++q)Se[q+16]=Ie=Ie+Se[q-1]<<1;for(q=0;q<_e;++q)Ie=I[q],Ie!=0&&(ke[q]=Se[Ie+16]++);var Ue=0;for(q=0;q<_e;++q)if(Ue=I[q],Ue!=0)for(Ie=z(ke[q],Y)>>Y-Ue,we=(1<<Y+4-Ue)-1;we>=0;--we)K[Ie|we<<Ue]=Ue&15|q<<4;return Y}var re=be?new Uint16Array(512):Re(512),nt=be?new Uint16Array(32):Re(32);if(!be){for(var He=0;He<512;++He)re[He]=0;for(He=0;He<32;++He)nt[He]=0}(function(){for(var I=[],K=0;K<32;K++)I.push(5);Be(I,nt,32);var W=[];for(K=0;K<=143;K++)W.push(8);for(;K<=255;K++)W.push(9);for(;K<=279;K++)W.push(7);for(;K<=287;K++)W.push(8);Be(W,re,288)})();var Ne=(function(){for(var K=be?new Uint8Array(32768):[],W=0,Y=0;W<Me.length-1;++W)for(;Y<Me[W+1];++Y)K[Y]=W;for(;Y<32768;++Y)K[Y]=29;var Z=be?new Uint8Array(259):[];for(W=0,Y=0;W<me.length-1;++W)for(;Y<me[W+1];++Y)Z[Y]=W;function q(Ie,_e){for(var Se=0;Se<Ie.length;){var ke=Math.min(65535,Ie.length-Se),Ue=Se+ke==Ie.length;for(_e.write_shift(1,+Ue),_e.write_shift(2,ke),_e.write_shift(2,~ke&65535);ke-- >0;)_e[_e.l++]=Ie[Se++]}return _e.l}function we(Ie,_e){for(var Se=0,ke=0,Ue=be?new Uint16Array(32768):[];ke<Ie.length;){var $e=Math.min(65535,Ie.length-ke);if($e<10){for(Se=ae(_e,Se,+(ke+$e==Ie.length)),Se&7&&(Se+=8-(Se&7)),_e.l=Se/8|0,_e.write_shift(2,$e),_e.write_shift(2,~$e&65535);$e-- >0;)_e[_e.l++]=Ie[ke++];Se=_e.l*8;continue}Se=ae(_e,Se,+(ke+$e==Ie.length)+2);for(var Je=0;$e-- >0;){var Xe=Ie[ke];Je=(Je<<5^Xe)&32767;var We=-1,ut=0;if((We=Ue[Je])&&(We|=ke&-32768,We>ke&&(We-=32768),We<ke))for(;Ie[We+ut]==Ie[ke+ut]&&ut<250;)++ut;if(ut>2){Xe=Z[ut],Xe<=22?Se=Pe(_e,Se,De[Xe+1]>>1)-1:(Pe(_e,Se,3),Se+=5,Pe(_e,Se,De[Xe-23]>>5),Se+=3);var bt=Xe<8?0:Xe-4>>2;bt>0&&(ge(_e,Se,ut-me[Xe]),Se+=bt),Xe=K[ke-We],Se=Pe(_e,Se,De[Xe]>>3),Se-=3;var Ft=Xe<4?0:Xe-2>>1;Ft>0&&(ge(_e,Se,ke-We-Me[Xe]),Se+=Ft);for(var Xt=0;Xt<ut;++Xt)Ue[Je]=ke&32767,Je=(Je<<5^Ie[ke])&32767,++ke;$e-=ut-1}else Xe<=143?Xe=Xe+48:Se=Ae(_e,Se,1),Se=Pe(_e,Se,De[Xe]),Ue[Je]=ke&32767,++ke}Se=Pe(_e,Se,0)-1}return _e.l=(Se+7)/8|0,_e.l}return function(_e,Se){return _e.length<8?q(_e,Se):we(_e,Se)}})();function Ye(I){var K=ir(50+Math.floor(I.length*1.1)),W=Ne(I,K);return K.slice(0,W)}var Ze=be?new Uint16Array(32768):Re(32768),dt=be?new Uint16Array(32768):Re(32768),st=be?new Uint16Array(128):Re(128),Ht=1,Nn=1;function pr(I,K){var W=ce(I,K)+257;K+=5;var Y=ce(I,K)+1;K+=5;var Z=de(I,K)+4;K+=4;for(var q=0,we=be?new Uint8Array(19):Re(19),Ie=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_e=1,Se=be?new Uint8Array(8):Re(8),ke=be?new Uint8Array(8):Re(8),Ue=we.length,$e=0;$e<Z;++$e)we[H[$e]]=q=E(I,K),_e<q&&(_e=q),Se[q]++,K+=3;var Je=0;for(Se[0]=0,$e=1;$e<=_e;++$e)ke[$e]=Je=Je+Se[$e-1]<<1;for($e=0;$e<Ue;++$e)(Je=we[$e])!=0&&(Ie[$e]=ke[Je]++);var Xe=0;for($e=0;$e<Ue;++$e)if(Xe=we[$e],Xe!=0){Je=De[Ie[$e]]>>8-Xe;for(var We=(1<<7-Xe)-1;We>=0;--We)st[Je|We<<Xe]=Xe&7|$e<<3}var ut=[];for(_e=1;ut.length<W+Y;)switch(Je=st[j(I,K)],K+=Je&7,Je>>>=3){case 16:for(q=3+Le(I,K),K+=2,Je=ut[ut.length-1];q-- >0;)ut.push(Je);break;case 17:for(q=3+E(I,K),K+=3;q-- >0;)ut.push(0);break;case 18:for(q=11+j(I,K),K+=7;q-- >0;)ut.push(0);break;default:ut.push(Je),_e<Je&&(_e=Je);break}var bt=ut.slice(0,W),Ft=ut.slice(W);for($e=W;$e<286;++$e)bt[$e]=0;for($e=Y;$e<30;++$e)Ft[$e]=0;return Ht=Be(bt,Ze,286),Nn=Be(Ft,dt,30),K}function mn(I,K){if(I[0]==3&&!(I[1]&3))return[ks(K),2];for(var W=0,Y=0,Z=zm(K||1<<18),q=0,we=Z.length>>>0,Ie=0,_e=0;(Y&1)==0;){if(Y=E(I,W),W+=3,Y>>>1)Y>>1==1?(Ie=9,_e=5):(W=pr(I,W),Ie=Ht,_e=Nn);else{W&7&&(W+=8-(W&7));var Se=I[W>>>3]|I[(W>>>3)+1]<<8;if(W+=32,Se>0)for(!K&&we<q+Se&&(Z=Oe(Z,q+Se),we=Z.length);Se-- >0;)Z[q++]=I[W>>>3],W+=8;continue}for(;;){!K&&we<q+32767&&(Z=Oe(Z,q+32767),we=Z.length);var ke=U(I,W,Ie),Ue=Y>>>1==1?re[ke]:Ze[ke];if(W+=Ue&15,Ue>>>=4,(Ue>>>8&255)===0)Z[q++]=Ue;else{if(Ue==256)break;Ue-=257;var $e=Ue<8?0:Ue-4>>2;$e>5&&($e=0);var Je=q+me[Ue];$e>0&&(Je+=U(I,W,$e),W+=$e),ke=U(I,W,_e),Ue=Y>>>1==1?nt[ke]:dt[ke],W+=Ue&15,Ue>>>=4;var Xe=Ue<4?0:Ue-2>>1,We=Me[Ue];for(Xe>0&&(We+=U(I,W,Xe),W+=Xe),!K&&we<Je&&(Z=Oe(Z,Je+100),we=Z.length);q<Je;)Z[q]=Z[q-We],++q}}}return K?[Z,W+7>>>3]:[Z.slice(0,q),W+7>>>3]}function yi(I,K){var W=I.slice(I.l||0),Y=mn(W,K);return I.l+=Y[1],Y[0]}function ni(I,K){if(I)typeof console<"u"&&console.error(K);else throw new Error(K)}function $i(I,K){var W=I;yr(W,0);var Y=[],Z=[],q={FileIndex:Y,FullPaths:Z};O(q,{root:K.root});for(var we=W.length-4;(W[we]!=80||W[we+1]!=75||W[we+2]!=5||W[we+3]!=6)&&we>=0;)--we;W.l=we+4,W.l+=4;var Ie=W.read_shift(2);W.l+=6;var _e=W.read_shift(4);for(W.l=_e,we=0;we<Ie;++we){W.l+=20;var Se=W.read_shift(4),ke=W.read_shift(4),Ue=W.read_shift(2),$e=W.read_shift(2),Je=W.read_shift(2);W.l+=8;var Xe=W.read_shift(4),We=c(W.slice(W.l+Ue,W.l+Ue+$e));W.l+=Ue+$e+Je;var ut=W.l;W.l=Xe+4,In(W,Se,ke,q,We),W.l=ut}return q}function In(I,K,W,Y,Z){I.l+=2;var q=I.read_shift(2),we=I.read_shift(2),Ie=o(I);if(q&8257)throw new Error("Unsupported ZIP encryption");for(var _e=I.read_shift(4),Se=I.read_shift(4),ke=I.read_shift(4),Ue=I.read_shift(2),$e=I.read_shift(2),Je="",Xe=0;Xe<Ue;++Xe)Je+=String.fromCharCode(I[I.l++]);if($e){var We=c(I.slice(I.l,I.l+$e));(We[21589]||{}).mt&&(Ie=We[21589].mt),((Z||{})[21589]||{}).mt&&(Ie=Z[21589].mt)}I.l+=$e;var ut=I.slice(I.l,I.l+Se);switch(we){case 8:ut=ee(I,ke);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+we)}var bt=!1;q&8&&(_e=I.read_shift(4),_e==134695760&&(_e=I.read_shift(4),bt=!0),Se=I.read_shift(4),ke=I.read_shift(4)),Se!=K&&ni(bt,"Bad compressed size: "+K+" != "+Se),ke!=W&&ni(bt,"Bad uncompressed size: "+W+" != "+ke),_i(Y,Je,ut,{unsafe:!0,mt:Ie})}function Gr(I,K){var W=K||{},Y=[],Z=[],q=ir(1),we=W.compression?8:0,Ie=0,_e=0,Se=0,ke=0,Ue=0,$e=I.FullPaths[0],Je=$e,Xe=I.FileIndex[0],We=[],ut=0;for(_e=1;_e<I.FullPaths.length;++_e)if(Je=I.FullPaths[_e].slice($e.length),Xe=I.FileIndex[_e],!(!Xe.size||!Xe.content||Je=="Sh33tJ5")){var bt=ke,Ft=ir(Je.length);for(Se=0;Se<Je.length;++Se)Ft.write_shift(1,Je.charCodeAt(Se)&127);Ft=Ft.slice(0,Ft.l),We[Ue]=oS.buf(Xe.content,0);var Xt=Xe.content;we==8&&(Xt=G(Xt)),q=ir(30),q.write_shift(4,67324752),q.write_shift(2,20),q.write_shift(2,Ie),q.write_shift(2,we),Xe.mt?s(q,Xe.mt):q.write_shift(4,0),q.write_shift(-4,We[Ue]),q.write_shift(4,Xt.length),q.write_shift(4,Xe.content.length),q.write_shift(2,Ft.length),q.write_shift(2,0),ke+=q.length,Y.push(q),ke+=Ft.length,Y.push(Ft),ke+=Xt.length,Y.push(Xt),q=ir(46),q.write_shift(4,33639248),q.write_shift(2,0),q.write_shift(2,20),q.write_shift(2,Ie),q.write_shift(2,we),q.write_shift(4,0),q.write_shift(-4,We[Ue]),q.write_shift(4,Xt.length),q.write_shift(4,Xe.content.length),q.write_shift(2,Ft.length),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(4,0),q.write_shift(4,bt),ut+=q.l,Z.push(q),ut+=Ft.length,Z.push(Ft),++Ue}return q=ir(22),q.write_shift(4,101010256),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,Ue),q.write_shift(2,Ue),q.write_shift(4,ut),q.write_shift(4,ke),q.write_shift(2,0),vs([vs(Y),vs(Z),q])}var xn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function jl(I,K){if(I.ctype)return I.ctype;var W=I.name||"",Y=W.match(/\.([^\.]+)$/);return Y&&xn[Y[1]]||K&&(Y=(W=K).match(/[\.\\]([^\.\\])+$/),Y&&xn[Y[1]])?xn[Y[1]]:"application/octet-stream"}function zl(I){for(var K=jm(I),W=[],Y=0;Y<K.length;Y+=76)W.push(K.slice(Y,Y+76));return W.join(`\r
`)+`\r
`}function Ul(I){var K=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Se){var ke=Se.charCodeAt(0).toString(16).toUpperCase();return"="+(ke.length==1?"0"+ke:ke)});K=K.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),K.charAt(0)==`
`&&(K="=0D"+K.slice(1)),K=K.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var W=[],Y=K.split(`\r
`),Z=0;Z<Y.length;++Z){var q=Y[Z];if(q.length==0){W.push("");continue}for(var we=0;we<q.length;){var Ie=76,_e=q.slice(we,we+Ie);_e.charAt(Ie-1)=="="?Ie--:_e.charAt(Ie-2)=="="?Ie-=2:_e.charAt(Ie-3)=="="&&(Ie-=3),_e=q.slice(we,we+Ie),we+=Ie,we<q.length&&(_e+="="),W.push(_e)}}return W.join(`\r
`)}function Vl(I){for(var K=[],W=0;W<I.length;++W){for(var Y=I[W];W<=I.length&&Y.charAt(Y.length-1)=="=";)Y=Y.slice(0,Y.length-1)+I[++W];K.push(Y)}for(var Z=0;Z<K.length;++Z)K[Z]=K[Z].replace(/[=][0-9A-Fa-f]{2}/g,function(q){return String.fromCharCode(parseInt(q.slice(1),16))});return Kn(K.join(`\r
`))}function uo(I,K,W){for(var Y="",Z="",q="",we,Ie=0;Ie<10;++Ie){var _e=K[Ie];if(!_e||_e.match(/^\s*$/))break;var Se=_e.match(/^(.*?):\s*([^\s].*)$/);if(Se)switch(Se[1].toLowerCase()){case"content-location":Y=Se[2].trim();break;case"content-type":q=Se[2].trim();break;case"content-transfer-encoding":Z=Se[2].trim();break}}switch(++Ie,Z.toLowerCase()){case"base64":we=Kn(gn(K.slice(Ie).join("")));break;case"quoted-printable":we=Vl(K.slice(Ie));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Z)}var ke=_i(I,Y.slice(W.length),we,{unsafe:!0});q&&(ke.ctype=q)}function Wl(I,K){if(X(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var W=K&&K.root||"",Y=(xt&&Buffer.isBuffer(I)?I.toString("binary"):X(I)).split(`\r
`),Z=0,q="";for(Z=0;Z<Y.length;++Z)if(q=Y[Z],!!/^Content-Location:/i.test(q)&&(q=q.slice(q.indexOf("file")),W||(W=q.slice(0,q.lastIndexOf("/")+1)),q.slice(0,W.length)!=W))for(;W.length>0&&(W=W.slice(0,W.length-1),W=W.slice(0,W.lastIndexOf("/")+1),q.slice(0,W.length)!=W););var we=(Y[1]||"").match(/boundary="(.*?)"/);if(!we)throw new Error("MAD cannot find boundary");var Ie="--"+(we[1]||""),_e=[],Se=[],ke={FileIndex:_e,FullPaths:Se};O(ke);var Ue,$e=0;for(Z=0;Z<Y.length;++Z){var Je=Y[Z];Je!==Ie&&Je!==Ie+"--"||($e++&&uo(ke,Y.slice(Ue,Z),W),Ue=Z)}return ke}function Fs(I,K){var W=K||{},Y=W.boundary||"SheetJS";Y="------="+Y;for(var Z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Y.slice(2)+'"',"","",""],q=I.FullPaths[0],we=q,Ie=I.FileIndex[0],_e=1;_e<I.FullPaths.length;++_e)if(we=I.FullPaths[_e].slice(q.length),Ie=I.FileIndex[_e],!(!Ie.size||!Ie.content||we=="Sh33tJ5")){we=we.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ut){return"_x"+ut.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ut){return"_u"+ut.charCodeAt(0).toString(16)+"_"});for(var Se=Ie.content,ke=xt&&Buffer.isBuffer(Se)?Se.toString("binary"):X(Se),Ue=0,$e=Math.min(1024,ke.length),Je=0,Xe=0;Xe<=$e;++Xe)(Je=ke.charCodeAt(Xe))>=32&&Je<128&&++Ue;var We=Ue>=$e*4/5;Z.push(Y),Z.push("Content-Location: "+(W.root||"file:///C:/SheetJS/")+we),Z.push("Content-Transfer-Encoding: "+(We?"quoted-printable":"base64")),Z.push("Content-Type: "+jl(Ie,we)),Z.push(""),Z.push(We?Ul(ke):zl(ke))}return Z.push(Y+`--\r
`),Z.join(`\r
`)}function ho(I){var K={};return O(K,I),K}function _i(I,K,W,Y){var Z=Y&&Y.unsafe;Z||O(I);var q=!Z&&yt.find(I,K);if(!q){var we=I.FullPaths[0];K.slice(0,we.length)==we?we=K:(we.slice(-1)!="/"&&(we+="/"),we=(we+K).replace("//","/")),q={name:i(K),type:2},I.FileIndex.push(q),I.FullPaths.push(we),Z||yt.utils.cfb_gc(I)}return q.content=W,q.size=W?W.length:0,Y&&(Y.CLSID&&(q.clsid=Y.CLSID),Y.mt&&(q.mt=Y.mt),Y.ct&&(q.ct=Y.ct)),q}function Th(I,K){O(I);var W=yt.find(I,K);if(W){for(var Y=0;Y<I.FileIndex.length;++Y)if(I.FileIndex[Y]==W)return I.FileIndex.splice(Y,1),I.FullPaths.splice(Y,1),!0}return!1}function Os(I,K,W){O(I);var Y=yt.find(I,K);if(Y){for(var Z=0;Z<I.FileIndex.length;++Z)if(I.FileIndex[Z]==Y)return I.FileIndex[Z].name=i(W),I.FullPaths[Z]=W,!0}return!1}function fa(I){B(I,!0)}return e.find=ie,e.read=N,e.parse=h,e.write=pe,e.writeFile=xe,e.utils={cfb_new:ho,cfb_add:_i,cfb_del:Th,cfb_mov:Os,cfb_gc:fa,ReadShift:tl,CheckField:wv,prep_blob:yr,bconcat:vs,use_zlib:b,_deflateRaw:Ye,_inflateRaw:yi,consts:le},e})();function lS(r){if(typeof Deno<"u")return Deno.readFileSync(r);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(r);e.open("r"),e.encoding="binary";var t=e.read();return e.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+r)}function gi(r){for(var e=Object.keys(r),t=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(r,e[n])&&t.push(e[n]);return t}function pd(r){for(var e=[],t=gi(r),n=0;n!==t.length;++n)e[r[t[n]]]=t[n];return e}var Hu=new Date(1899,11,30,0,0,0);function Hr(r,e){var t=r.getTime(),n=Hu.getTime()+(r.getTimezoneOffset()-Hu.getTimezoneOffset())*6e4;return(t-n)/(1440*60*1e3)}var ev=new Date,cS=Hu.getTime()+(ev.getTimezoneOffset()-Hu.getTimezoneOffset())*6e4,$m=ev.getTimezoneOffset();function uh(r){var e=new Date;return e.setTime(r*24*60*60*1e3+cS),e.getTimezoneOffset()!==$m&&e.setTime(e.getTime()+(e.getTimezoneOffset()-$m)*6e4),e}function uS(r){var e=0,t=0,n=!1,i=r.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+r+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(t=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=t*parseInt(i[s],10)}return e}var Km=new Date("2017-02-19T19:06:09.000Z"),tv=isNaN(Km.getFullYear())?new Date("2/19/17"):Km,hS=tv.getFullYear()==2017;function gr(r,e){var t=new Date(r);if(hS)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(tv.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return r.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var i=r.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return r.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ra(r,e){if(xt&&Buffer.isBuffer(r)){if(e){if(r[0]==255&&r[1]==254)return Qo(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return Qo(Ux(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(r[0]==255&&r[1]==254)return Qo(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return Qo(new TextDecoder("utf-16be").decode(r.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var n=[],i=0;i!=r.length;++i)n.push(String.fromCharCode(r[i]));return n.join("")}function wr(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=wr(r[t]));return e}function Vt(r,e){for(var t="";t.length<e;)t+=r;return t}function ti(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,n=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(n)))?e/t:e}var fS=["january","february","march","april","may","june","july","august","september","october","november","december"];function qa(r){var e=new Date(r),t=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var o=r.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&fS.indexOf(o)==-1)return t}else if(o.match(/[a-z]/))return t;return n<0||n>8099?t:(i>0||s>1)&&n!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}var dS=(function(){var r="abacaba".split(/(:?b)/i).length==5;return function(t,n,i){if(r||typeof n=="string")return t.split(n);for(var s=t.split(n),o=[s[0]],c=1;c<s.length;++c)o.push(i),o.push(s[c]);return o}})();function rv(r){return r?r.content&&r.type?ra(r.content,!0):r.data?Zo(r.data):r.asNodeBuffer&&xt?Zo(r.asNodeBuffer().toString("binary")):r.asBinary?Zo(r.asBinary()):r._data&&r._data.getContent?Zo(ra(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function nv(r){if(!r)return null;if(r.data)return Lm(r.data);if(r.asNodeBuffer&&xt)return r.asNodeBuffer();if(r._data&&r._data.getContent){var e=r._data.getContent();return typeof e=="string"?Lm(e):Array.prototype.slice.call(e)}return r.content&&r.type?r.content:null}function gS(r){return r&&r.name.slice(-4)===".bin"?nv(r):rv(r)}function An(r,e){for(var t=r.FullPaths||gi(r.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<t.length;++s){var o=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return r.files?r.files[t[s]]:r.FileIndex[s]}return null}function md(r,e){var t=An(r,e);if(t==null)throw new Error("Cannot find file "+e+" in zip");return t}function Qt(r,e,t){if(!t)return gS(md(r,e));if(!e)return null;try{return Qt(r,e)}catch{return null}}function fn(r,e,t){if(!t)return rv(md(r,e));if(!e)return null;try{return fn(r,e)}catch{return null}}function pS(r,e,t){return nv(md(r,e))}function Zm(r){for(var e=r.FullPaths||gi(r.files),t=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&t.push(e[n].replace(/^Root Entry[\/]/,""));return t.sort()}function mS(r,e,t){if(r.FullPaths){if(typeof t=="string"){var n;return xt?n=sa(t):n=Iw(t),yt.utils.cfb_add(r,e,n)}yt.utils.cfb_add(r,e,t)}else r.file(e,t)}function iv(r,e){switch(e.type){case"base64":return yt.read(r,{type:"base64"});case"binary":return yt.read(r,{type:"binary"});case"buffer":case"array":return yt.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Jo(r,e){if(r.charAt(0)=="/")return r.slice(1);var t=e.split("/");e.slice(-1)!="/"&&t.pop();for(var n=r.split("/");n.length!==0;){var i=n.shift();i===".."?t.pop():i!=="."&&t.push(i)}return t.join("/")}var sv=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,xS=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,qm=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,vS=/<[^>]*>/g,Ir=sv.match(qm)?qm:vS,yS=/<\w*:/,_S=/<(\/?)\w+:/;function lt(r,e,t){for(var n={},i=0,s=0;i!==r.length&&!((s=r.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=r.slice(0,i)),i===r.length)return n;var o=r.match(xS),c=0,u="",d=0,h="",g="",x=1;if(o)for(d=0;d!=o.length;++d){for(g=o[d],s=0;s!=g.length&&g.charCodeAt(s)!==61;++s);for(h=g.slice(0,s).trim();g.charCodeAt(s+1)==32;)++s;for(x=(i=g.charCodeAt(s+1))==34||i==39?1:0,u=g.slice(s+1+x,g.length-x),c=0;c!=h.length&&h.charCodeAt(c)!==58;++c);if(c===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=u,n[h.toLowerCase()]=u;else{var m=(c===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(c+1);if(n[m]&&h.slice(c-3,c)=="ext")continue;n[m]=u,n[m.toLowerCase()]=u}}return n}function mi(r){return r.replace(_S,"<$1")}var av={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},wS=pd(av),St=(function(){var r=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function t(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(r,function(c,u){return av[c]||String.fromCharCode(parseInt(u,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,u){return String.fromCharCode(parseInt(u,16))});var o=i.indexOf("]]>");return t(i.slice(0,s))+i.slice(s+9,o)+t(i.slice(o+3))}})(),SS=/[&<>'"]/g,kS=/[\u0000-\u001f]/g;function xd(r){var e=r+"";return e.replace(SS,function(t){return wS[t]}).replace(/\n/g,"<br/>").replace(kS,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var Jm=(function(){var r=/&#(\d+);/g;function e(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(r,e)}})();function Lt(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ff(r){for(var e="",t=0,n=0,i=0,s=0,o=0,c=0;t<r.length;){if(n=r.charCodeAt(t++),n<128){e+=String.fromCharCode(n);continue}if(i=r.charCodeAt(t++),n>191&&n<224){o=(n&31)<<6,o|=i&63,e+=String.fromCharCode(o);continue}if(s=r.charCodeAt(t++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}o=r.charCodeAt(t++),c=((n&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function Qm(r){var e=ks(2*r.length),t,n,i=1,s=0,o=0,c;for(n=0;n<r.length;n+=i)i=1,(c=r.charCodeAt(n))<128?t=c:c<224?(t=(c&31)*64+(r.charCodeAt(n+1)&63),i=2):c<240?(t=(c&15)*4096+(r.charCodeAt(n+1)&63)*64+(r.charCodeAt(n+2)&63),i=3):(i=4,t=(c&7)*262144+(r.charCodeAt(n+1)&63)*4096+(r.charCodeAt(n+2)&63)*64+(r.charCodeAt(n+3)&63),t-=65536,o=55296+(t>>>10&1023),t=56320+(t&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function e1(r){return sa(r,"binary").toString("utf8")}var qc="foo bar baz",Pt=xt&&(e1(qc)==ff(qc)&&e1||Qm(qc)==ff(qc)&&Qm)||ff,Qo=xt?function(r){return sa(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,n=0,i=0;t<r.length;)switch(n=r.charCodeAt(t++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=r.charCodeAt(t++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},xl=(function(){var r={};return function(t,n){var i=t+"|"+(n||"");return r[i]?r[i]:r[i]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}})(),ov=(function(){var r=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<r.length;++i)n=n.replace(r[i][0],r[i][1]);return n}})(),CS=(function(){var r={};return function(t){return r[t]!==void 0?r[t]:r[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),TS=/<\/?(?:vt:)?variant>/g,ES=/<(?:vt:)([^>]*)>([\s\S]*)</;function t1(r,e){var t=lt(r),n=r.match(CS(t.baseType))||[],i=[];if(n.length!=t.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return i}return n.forEach(function(s){var o=s.replace(TS,"").match(ES);o&&i.push({v:Pt(o[2]),t:o[1]})}),i}var AS=/(^\s|\s$|\n)/;function bS(r){return gi(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function FS(r,e,t){return"<"+r+(t!=null?bS(t):"")+(e!=null?(e.match(AS)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function vd(r){if(xt&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return Pt(aa(fd(r)));throw new Error("Bad input format: expected Buffer or string")}var vl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,OS={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},DS=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function PS(r,e){for(var t=1-2*(r[e+7]>>>7),n=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),i=r[e+6]&15,s=5;s>=0;--s)i=i*256+r[e+s];return n==2047?i==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),t*Math.pow(2,n-52)*i)}function MS(r,e,t){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,o=n?-e:e;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var c=0;c<=5;++c,s/=256)r[t+c]=s&255;r[t+6]=(i&15)<<4|s&15,r[t+7]=i>>4|n}var r1=function(r){for(var e=[],t=10240,n=0;n<r[0].length;++n)if(r[0][n])for(var i=0,s=r[0][n].length;i<s;i+=t)e.push.apply(e,r[0][n].slice(i,i+t));return e},n1=xt?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:sa(e)})):r1(r)}:r1,i1=function(r,e,t){for(var n=[],i=e;i<t;i+=2)n.push(String.fromCharCode(Mi(r,i)));return n.join("").replace(Wr,"")},yd=xt?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace(Wr,""):i1(r,e,t)}:i1,s1=function(r,e,t){for(var n=[],i=e;i<e+t;++i)n.push(("0"+r[i].toString(16)).slice(-2));return n.join("")},lv=xt?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):s1(r,e,t)}:s1,a1=function(r,e,t){for(var n=[],i=e;i<t;i++)n.push(String.fromCharCode(ja(r,i)));return n.join("")},Ol=xt?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):a1(e,t,n)}:a1,cv=function(r,e){var t=hn(r,e);return t>0?Ol(r,e+4,e+4+t-1):""},uv=cv,hv=function(r,e){var t=hn(r,e);return t>0?Ol(r,e+4,e+4+t-1):""},fv=hv,dv=function(r,e){var t=2*hn(r,e);return t>0?Ol(r,e+4,e+4+t-1):""},gv=dv,pv=function(e,t){var n=hn(e,t);return n>0?yd(e,t+4,t+4+n):""},mv=pv,xv=function(r,e){var t=hn(r,e);return t>0?Ol(r,e+4,e+4+t):""},vv=xv,yv=function(r,e){return PS(r,e)},Xu=yv,_v=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};xt&&(uv=function(e,t){if(!Buffer.isBuffer(e))return cv(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},fv=function(e,t){if(!Buffer.isBuffer(e))return hv(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},gv=function(e,t){if(!Buffer.isBuffer(e))return dv(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},mv=function(e,t){if(!Buffer.isBuffer(e))return pv(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},vv=function(e,t){if(!Buffer.isBuffer(e))return xv(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},Xu=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):yv(e,t)},_v=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var ja=function(r,e){return r[e]},Mi=function(r,e){return r[e+1]*256+r[e]},NS=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},hn=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},Xs=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},IS=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function tl(r,e){var t="",n,i,s=[],o,c,u,d;switch(e){case"dbcs":if(d=this.l,xt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(u=0;u<r;++u)t+=String.fromCharCode(Mi(this,d)),d+=2;r*=2;break;case"utf8":t=Ol(this,this.l,this.l+r);break;case"utf16le":r*=2,t=yd(this,this.l,this.l+r);break;case"wstr":return tl.call(this,r,"dbcs");case"lpstr-ansi":t=uv(this,this.l),r=4+hn(this,this.l);break;case"lpstr-cp":t=fv(this,this.l),r=4+hn(this,this.l);break;case"lpwstr":t=gv(this,this.l),r=4+2*hn(this,this.l);break;case"lpp4":r=4+hn(this,this.l),t=mv(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+hn(this,this.l),t=vv(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(o=ja(this,this.l+r++))!==0;)s.push(Zc(o));t=s.join("");break;case"_wstr":for(r=0,t="";(o=Mi(this,this.l+r))!==0;)s.push(Zc(o)),r+=2;r+=2,t=s.join("");break;case"dbcs-cont":for(t="",d=this.l,u=0;u<r;++u){if(this.lens&&this.lens.indexOf(d)!==-1)return o=ja(this,d),this.l=d+1,c=tl.call(this,r-u,o?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(Zc(Mi(this,d))),d+=2}t=s.join(""),r*=2;break;case"cpstr":case"sbcs-cont":for(t="",d=this.l,u=0;u!=r;++u){if(this.lens&&this.lens.indexOf(d)!==-1)return o=ja(this,d),this.l=d+1,c=tl.call(this,r-u,o?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(Zc(ja(this,d))),d+=1}t=s.join("");break;default:switch(r){case 1:return n=ja(this,this.l),this.l++,n;case 2:return n=(e==="i"?NS:Mi)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(r>0?Xs:IS)(this,this.l),this.l+=4,n):(i=hn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return r==8?i=Xu(this,this.l):i=Xu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;r=8;case 16:t=lv(this,this.l,r);break}}return this.l+=r,t}var RS=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},LS=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},BS=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function jS(r,e,t){var n=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)BS(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(t==="hex"){for(;i<r;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+r,this.length);for(i=0;i<Math.min(e.length,r);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(r){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,RS(this,e,this.l);break;case 8:if(n=8,t==="f"){MS(this,e,this.l);break}case 16:break;case-4:n=4,LS(this,e,this.l);break}return this.l+=n,this}function wv(r,e){var t=lv(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function yr(r,e){r.l=e,r.read_shift=tl,r.chk=wv,r.write_shift=jS}function Nr(r,e){r.l+=e}function ir(r){var e=ks(r);return yr(e,0),e}function Xi(r,e,t){if(r){var n,i,s;yr(r,r.l||0);for(var o=r.length,c=0,u=0;r.l<o;){c=r.read_shift(1),c&128&&(c=(c&127)+((r.read_shift(1)&127)<<7));var d=qu[c]||qu[65535];for(n=r.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=r.read_shift(1))&127)<<7*i;u=r.l+s;var h=d.f&&d.f(r,s,t);if(r.l=u,e(h,d,c))return}}}function Bf(){var r=[],e=xt?256:2048,t=function(d){var h=ir(d);return yr(h,0),h},n=t(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&r.push(n),n=null)},s=function(d){return n&&d<n.length-n.l?n:(i(),n=t(Math.max(d+1,e)))},o=function(){return i(),vs(r)},c=function(d){i(),n=d,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:c,end:o,_bufs:r}}function rl(r,e,t){var n=wr(r);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function o1(r,e,t){var n=wr(r);return n.s=rl(n.s,e.s,t),n.e=rl(n.e,e.s,t),n}function nl(r,e){if(r.cRel&&r.c<0)for(r=wr(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=wr(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=ht(r);return!r.cRel&&r.cRel!=null&&(t=VS(t)),!r.rRel&&r.rRel!=null&&(t=zS(t)),t}function df(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+sr(r.s.c)+":"+(r.e.cRel?"":"$")+sr(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+Sr(r.s.r)+":"+(r.e.rRel?"":"$")+Sr(r.e.r):nl(r.s,e.biff)+":"+nl(r.e,e.biff)}function _d(r){return parseInt(US(r),10)-1}function Sr(r){return""+(r+1)}function zS(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function US(r){return r.replace(/\$(\d+)$/,"$1")}function wd(r){for(var e=WS(r),t=0,n=0;n!==e.length;++n)t=26*t+e.charCodeAt(n)-64;return t-1}function sr(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function VS(r){return r.replace(/^([A-Z])/,"$$$1")}function WS(r){return r.replace(/^\$([A-Z])/,"$1")}function HS(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Vr(r){for(var e=0,t=0,n=0;n<r.length;++n){var i=r.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function ht(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function to(r){var e=r.indexOf(":");return e==-1?{s:Vr(r),e:Vr(r)}:{s:Vr(r.slice(0,e)),e:Vr(r.slice(e+1))}}function _t(r,e){return typeof e>"u"||typeof e=="number"?_t(r.s,r.e):(typeof r!="string"&&(r=ht(r)),typeof e!="string"&&(e=ht(e)),r==e?r:r+":"+e)}function Wt(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,i=0,s=r.length;for(t=0;n<s&&!((i=r.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(e.s.c=--t,t=0;n<s&&!((i=r.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;if(e.s.r=--t,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,t=0;n!=s&&!((i=r.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(e.e.c=--t,t=0;n!=s&&!((i=r.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;return e.e.r=--t,e}function l1(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=On(r.z,t?Hr(e):e)}catch{}try{return r.w=On((r.XF||{}).numFmtId||(t?14:0),t?Hr(e):e)}catch{return""+e}}function zi(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?ca[r.v]||r.v:e==null?l1(r,r.v):l1(r,e))}function As(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",n={};return n[t]=r,{SheetNames:[t],Sheets:n}}function Sv(r,e,t){var n=t||{},i=r?Array.isArray(r):n.dense,s=r||(i?[]:{}),o=0,c=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Vr(n.origin):n.origin;o=u.r,c=u.c}s["!ref"]||(s["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=Wt(s["!ref"]);d.s.c=h.s.c,d.s.r=h.s.r,d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),o==-1&&(d.e.r=o=h.e.r+1)}for(var g=0;g!=e.length;++g)if(e[g]){if(!Array.isArray(e[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=e[g].length;++x)if(!(typeof e[g][x]>"u")){var m={v:e[g][x]},y=o+g,v=c+x;if(d.s.r>y&&(d.s.r=y),d.s.c>v&&(d.s.c=v),d.e.r<y&&(d.e.r=y),d.e.c<v&&(d.e.c=v),e[g][x]&&typeof e[g][x]=="object"&&!Array.isArray(e[g][x])&&!(e[g][x]instanceof Date))m=e[g][x];else if(Array.isArray(m.v)&&(m.f=e[g][x][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||ft[14],n.cellDates?(m.t="d",m.w=On(m.z,Hr(m.v))):(m.t="n",m.v=Hr(m.v),m.w=On(m.z,m.v))):m.t="s";if(i)s[y]||(s[y]=[]),s[y][v]&&s[y][v].z&&(m.z=s[y][v].z),s[y][v]=m;else{var _=ht({c:v,r:y});s[_]&&s[_].z&&(m.z=s[_].z),s[_]=m}}}return d.s.c<1e7&&(s["!ref"]=_t(d)),s}function ro(r,e){return Sv(null,r,e)}function XS(r){return r.read_shift(4,"i")}function Pr(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function GS(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function Sd(r,e){var t=r.l,n=r.read_shift(1),i=Pr(r),s=[],o={t:i,h:i};if((n&1)!==0){for(var c=r.read_shift(4),u=0;u!=c;++u)s.push(GS(r));o.r=s}else o.r=[{ich:0,ifnt:0}];return r.l=t+e,o}var YS=Sd;function Mn(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function oa(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}var $S=Pr;function kd(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}var KS=Pr,jf=kd;function Cd(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,n=e[0]&2;r.l+=4;var i=n===0?Xu([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Xs(e,0)>>2;return t?i/100:i}function kv(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}var la=kv;function Or(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function ZS(r){var e={},t=r.read_shift(1),n=t>>>1,i=r.read_shift(1),s=r.read_shift(2,"i"),o=r.read_shift(1),c=r.read_shift(1),u=r.read_shift(1);switch(r.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var d=Qs[i];d&&(e.rgb=_l(d));break;case 2:e.rgb=_l([o,c,u]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function qS(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function Cv(r,e){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=r.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[r.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return r.l-=4,r.read_shift(0,e==1?"lpstr":"lpwstr")}function JS(r){return Cv(r,1)}function QS(r){return Cv(r,2)}var Td=2,Qr=3,Jc=11,c1=12,Gu=19,Qc=64,ek=65,tk=71,rk=4108,nk=4126,dr=80,Tv=81,ik=[dr,Tv],sk={1:{n:"CodePage",t:Td},2:{n:"Category",t:dr},3:{n:"PresentationFormat",t:dr},4:{n:"ByteCount",t:Qr},5:{n:"LineCount",t:Qr},6:{n:"ParagraphCount",t:Qr},7:{n:"SlideCount",t:Qr},8:{n:"NoteCount",t:Qr},9:{n:"HiddenCount",t:Qr},10:{n:"MultimediaClipCount",t:Qr},11:{n:"ScaleCrop",t:Jc},12:{n:"HeadingPairs",t:rk},13:{n:"TitlesOfParts",t:nk},14:{n:"Manager",t:dr},15:{n:"Company",t:dr},16:{n:"LinksUpToDate",t:Jc},17:{n:"CharacterCount",t:Qr},19:{n:"SharedDoc",t:Jc},22:{n:"HyperlinksChanged",t:Jc},23:{n:"AppVersion",t:Qr,p:"version"},24:{n:"DigSig",t:ek},26:{n:"ContentType",t:dr},27:{n:"ContentStatus",t:dr},28:{n:"Language",t:dr},29:{n:"Version",t:dr},255:{},2147483648:{n:"Locale",t:Gu},2147483651:{n:"Behavior",t:Gu},1919054434:{}},ak={1:{n:"CodePage",t:Td},2:{n:"Title",t:dr},3:{n:"Subject",t:dr},4:{n:"Author",t:dr},5:{n:"Keywords",t:dr},6:{n:"Comments",t:dr},7:{n:"Template",t:dr},8:{n:"LastAuthor",t:dr},9:{n:"RevNumber",t:dr},10:{n:"EditTime",t:Qc},11:{n:"LastPrinted",t:Qc},12:{n:"CreatedDate",t:Qc},13:{n:"ModifiedDate",t:Qc},14:{n:"PageCount",t:Qr},15:{n:"WordCount",t:Qr},16:{n:"CharCount",t:Qr},17:{n:"Thumbnail",t:tk},18:{n:"Application",t:dr},19:{n:"DocSecurity",t:Qr},255:{},2147483648:{n:"Locale",t:Gu},2147483651:{n:"Behavior",t:Gu},1919054434:{}},u1={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},ok=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function lk(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var ck=lk([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Qs=wr(ck),ca={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ev={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},h1={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function uk(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function hk(r){var e=uk();if(!r||!r.match)return e;var t={};if((r.match(Ir)||[]).forEach(function(n){var i=lt(n);switch(i[0].replace(yS,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[i.Extension]=i.ContentType;break;case"<Override":e[h1[i.ContentType]]!==void 0&&e[h1[i.ContentType]].push(i.PartName);break}}),e.xmlns!==OS.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=t,delete e.calcchains,e}var Ua={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function zf(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function il(r,e){var t={"!id":{}};if(!r)return t;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(r.match(Ir)||[]).forEach(function(i){var s=lt(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var c=s.TargetMode==="External"?s.Target:Jo(s.Target,e);t[c]=o,n[s.Id]=o}}),t["!id"]=n,t}var fk="application/vnd.oasis.opendocument.spreadsheet";function dk(r,e){for(var t=vd(r),n,i;n=vl.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(i=lt(n[0],!1),i.path=="/"&&i.type!==fk)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var sl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],gk=(function(){for(var r=new Array(sl.length),e=0;e<sl.length;++e){var t=sl[e],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);r[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return r})();function Av(r){var e={};r=Pt(r);for(var t=0;t<sl.length;++t){var n=sl[t],i=r.match(gk[t]);i!=null&&i.length>0&&(e[n[1]]=St(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=gr(e[n[1]]))}return e}var pk=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function bv(r,e,t,n){var i=[];if(typeof r=="string")i=t1(r,n);else for(var s=0;s<r.length;++s)i=i.concat(r[s].map(function(h){return{v:h}}));var o=typeof e=="string"?t1(e,n).map(function(h){return h.v}):e,c=0,u=0;if(o.length>0)for(var d=0;d!==i.length;d+=2){switch(u=+i[d+1].v,i[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=u,t.SheetNames=o.slice(c,c+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=u,t.DefinedNames=o.slice(c,c+u);break;case"Charts":case"Diagramme":t.Chartsheets=u,t.ChartNames=o.slice(c,c+u);break}c+=u}}function mk(r,e,t){var n={};return e||(e={}),r=Pt(r),pk.forEach(function(i){var s=(r.match(xl(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=St(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var o=r.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&bv(n.HeadingPairs,n.TitlesOfParts,e,t),e}var xk=/<[^>]+>[^<]*/g;function vk(r,e){var t={},n="",i=r.match(xk);if(i)for(var s=0;s!=i.length;++s){var o=i[s],c=lt(o);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=St(c.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),d=u[0].slice(4),h=u[1];switch(d){case"lpstr":case"bstr":case"lpwstr":t[n]=St(h);break;case"bool":t[n]=Lt(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(h);break;case"filetime":case"date":t[n]=gr(h);break;case"cy":case"error":t[n]=St(h);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,u)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return t}var yk={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},gf;function _k(r,e,t){gf||(gf=pd(yk)),e=gf[e]||e,r[e]=t}function Ed(r){var e=r.read_shift(4),t=r.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Fv(r,e,t){var n=r.l,i=r.read_shift(0,"lpstr-cp");if(t)for(;r.l-n&3;)++r.l;return i}function Ov(r,e,t){var n=r.read_shift(0,"lpwstr");return n}function Dv(r,e,t){return e===31?Ov(r):Fv(r,e,t)}function Uf(r,e,t){return Dv(r,e,t===!1?0:4)}function wk(r,e){if(!e)throw new Error("VtUnalignedString must have positive length");return Dv(r,e,0)}function Sk(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n){var i=r.l;t[n]=r.read_shift(0,"lpwstr").replace(Wr,""),r.l-i&2&&(r.l+=2)}return t}function kk(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n)t[n]=r.read_shift(0,"lpstr-cp").replace(Wr,"");return t}function Ck(r){var e=r.l,t=Yu(r,Tv);r[r.l]==0&&r[r.l+1]==0&&r.l-e&2&&(r.l+=2);var n=Yu(r,Qr);return[t,n]}function Tk(r){for(var e=r.read_shift(4),t=[],n=0;n<e/2;++n)t.push(Ck(r));return t}function f1(r,e){for(var t=r.read_shift(4),n={},i=0;i!=t;++i){var s=r.read_shift(4),o=r.read_shift(4);n[s]=r.read_shift(o,e===1200?"utf16le":"utf8").replace(Wr,"").replace(qo,"!"),e===1200&&o%2&&(r.l+=2)}return r.l&3&&(r.l=r.l>>3<<2),n}function Pv(r){var e=r.read_shift(4),t=r.slice(r.l,r.l+e);return r.l+=e,(e&3)>0&&(r.l+=4-(e&3)&3),t}function Ek(r){var e={};return e.Size=r.read_shift(4),r.l+=e.Size+3-(e.Size-1)%4,e}function Yu(r,e,t){var n=r.read_shift(2),i,s=t||{};if(r.l+=2,e!==c1&&n!==e&&ik.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===c1?n:e){case 2:return i=r.read_shift(2,"i"),s.raw||(r.l+=2),i;case 3:return i=r.read_shift(4,"i"),i;case 11:return r.read_shift(4)!==0;case 19:return i=r.read_shift(4),i;case 30:return Fv(r,n,4).replace(Wr,"");case 31:return Ov(r);case 64:return Ed(r);case 65:return Pv(r);case 71:return Ek(r);case 80:return Uf(r,n,!s.raw).replace(Wr,"");case 81:return wk(r,n).replace(Wr,"");case 4108:return Tk(r);case 4126:case 4127:return n==4127?Sk(r):kk(r);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function d1(r,e){var t=r.l,n=r.read_shift(4),i=r.read_shift(4),s=[],o=0,c=0,u=-1,d={};for(o=0;o!=i;++o){var h=r.read_shift(4),g=r.read_shift(4);s[o]=[h,g+t]}s.sort(function(T,C){return T[1]-C[1]});var x={};for(o=0;o!=i;++o){if(r.l!==s[o][1]){var m=!0;if(o>0&&e)switch(e[s[o-1][0]].t){case 2:r.l+2===s[o][1]&&(r.l+=2,m=!1);break;case 80:r.l<=s[o][1]&&(r.l=s[o][1],m=!1);break;case 4108:r.l<=s[o][1]&&(r.l=s[o][1],m=!1);break}if((!e||o==0)&&r.l<=s[o][1]&&(m=!1,r.l=s[o][1]),m)throw new Error("Read Error: Expected address "+s[o][1]+" at "+r.l+" :"+o)}if(e){var y=e[s[o][0]];if(x[y.n]=Yu(r,y.t,{raw:!0}),y.p==="version"&&(x[y.n]=String(x[y.n]>>16)+"."+("0000"+String(x[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(x[y.n]){case 0:x[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:qn(c=x[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[y.n])}}else if(s[o][0]===1){if(c=x.CodePage=Yu(r,Td),qn(c),u!==-1){var v=r.l;r.l=s[u][1],d=f1(r,c),r.l=v}}else if(s[o][0]===0){if(c===0){u=o,r.l=s[o+1][1];continue}d=f1(r,c)}else{var _=d[s[o][0]],S;switch(r[r.l]){case 65:r.l+=4,S=Pv(r);break;case 30:r.l+=4,S=Uf(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 31:r.l+=4,S=Uf(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,S=r.read_shift(4,"i");break;case 19:r.l+=4,S=r.read_shift(4);break;case 5:r.l+=4,S=r.read_shift(8,"f");break;case 11:r.l+=4,S=$t(r,4);break;case 64:r.l+=4,S=gr(Ed(r));break;default:throw new Error("unparsed value: "+r[r.l])}x[_]=S}}return r.l=t+n,x}function g1(r,e,t){var n=r.content;if(!n)return{};yr(n,0);var i,s,o,c,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),h=n.read_shift(16);if(h!==yt.utils.consts.HEADER_CLSID&&h!==t)throw new Error("Bad PropertySet CLSID "+h);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),c=n.read_shift(4),i===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);i===2&&(o=n.read_shift(16),u=n.read_shift(4));var g=d1(n,e),x={SystemIdentifier:d};for(var m in g)x[m]=g[m];if(x.FMTID=s,i===1)return x;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var y;try{y=d1(n,null)}catch{}for(m in y)x[m]=y[m];return x.FMTID=[s,o],x}function ps(r,e){return r.read_shift(e),null}function Ak(r,e,t){for(var n=[],i=r.l+e;r.l<i;)n.push(t(r,i-r.l));if(i!==r.l)throw new Error("Slurp error");return n}function $t(r,e){return r.read_shift(e)===1}function er(r){return r.read_shift(2,"u")}function Mv(r,e){return Ak(r,e,er)}function bk(r){var e=r.read_shift(1),t=r.read_shift(1);return t===1?e:e===1}function Dl(r,e,t){var n=r.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=r.read_shift(1);s&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var o=n?r.read_shift(n,i):"";return o}function Fk(r){var e=r.read_shift(2),t=r.read_shift(1),n=t&4,i=t&8,s=1+(t&1),o=0,c,u={};i&&(o=r.read_shift(2)),n&&(c=r.read_shift(4));var d=s==2?"dbcs-cont":"sbcs-cont",h=e===0?"":r.read_shift(e,d);return i&&(r.l+=4*o),n&&(r.l+=c),u.t=h,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function na(r,e,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var i=r.read_shift(1);return i===0?n=r.read_shift(e,"sbcs-cont"):n=r.read_shift(e,"dbcs-cont"),n}function Pl(r,e,t){var n=r.read_shift(t&&t.biff==2?1:2);return n===0?(r.l++,""):na(r,n,t)}function ua(r,e,t){if(t.biff>5)return Pl(r,e,t);var n=r.read_shift(1);return n===0?(r.l++,""):r.read_shift(n,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function Ok(r){var e=r.read_shift(1);r.l++;var t=r.read_shift(2);return r.l+=2,[e,t]}function Dk(r){var e=r.read_shift(4),t=r.l,n=!1;e>24&&(r.l+=e-24,r.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),r.l=t);var i=r.read_shift((n?e-24:e)>>1,"utf16le").replace(Wr,"");return n&&(r.l+=24),i}function Pk(r){for(var e=r.read_shift(2),t="";e-- >0;)t+="../";var n=r.read_shift(0,"lpstr-ansi");if(r.l+=2,r.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=r.read_shift(4);if(i===0)return t+n.replace(/\\/g,"/");var s=r.read_shift(4);if(r.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=r.read_shift(s>>1,"utf16le").replace(Wr,"");return t+o}function Mk(r,e){var t=r.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return Dk(r);case"0303000000000000c000000000000046":return Pk(r);default:throw new Error("Unsupported Moniker "+t)}}function eu(r){var e=r.read_shift(4),t=e>0?r.read_shift(e,"utf16le").replace(Wr,""):"";return t}function Nk(r,e){var t=r.l+e,n=r.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=r.read_shift(2);r.l+=2;var s,o,c,u,d="",h,g;i&16&&(s=eu(r,t-r.l)),i&128&&(o=eu(r,t-r.l)),(i&257)===257&&(c=eu(r,t-r.l)),(i&257)===1&&(u=Mk(r,t-r.l)),i&8&&(d=eu(r,t-r.l)),i&32&&(h=r.read_shift(16)),i&64&&(g=Ed(r)),r.l=t;var x=o||c||u||"";x&&d&&(x+="#"+d),x||(x="#"+d),i&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var m={Target:x};return h&&(m.guid=h),g&&(m.time=g),s&&(m.Tooltip=s),m}function Nv(r){var e=r.read_shift(1),t=r.read_shift(1),n=r.read_shift(1),i=r.read_shift(1);return[e,t,n,i]}function Iv(r,e){var t=Nv(r);return t[3]=0,t}function xi(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return{r:e,c:t,ixfe:n}}function Ik(r){var e=r.read_shift(2),t=r.read_shift(2);return r.l+=8,{type:e,flags:t}}function Rk(r,e,t){return e===0?"":ua(r,e,t)}function Lk(r,e,t){var n=t.biff>8?4:2,i=r.read_shift(n),s=r.read_shift(n,"i"),o=r.read_shift(n,"i");return[i,s,o]}function Rv(r){var e=r.read_shift(2),t=Cd(r);return[e,t]}function Bk(r,e,t){r.l+=4,e-=4;var n=r.l+e,i=Dl(r,e,t),s=r.read_shift(2);if(n-=r.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return r.l+=s,i}function hh(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),i=r.read_shift(2);return{s:{c:n,r:e},e:{c:i,r:t}}}function Lv(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(1),i=r.read_shift(1);return{s:{c:n,r:e},e:{c:i,r:t}}}var jk=Lv;function Bv(r){r.l+=4;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return r.l+=12,[t,e,n]}function zk(r){var e={};return r.l+=4,r.l+=16,e.fSharedNote=r.read_shift(2),r.l+=4,e}function Uk(r){var e={};return r.l+=4,r.cf=r.read_shift(2),e}function br(r){r.l+=2,r.l+=r.read_shift(2)}var Vk={0:br,4:br,5:br,6:br,7:Uk,8:br,9:br,10:br,11:br,12:br,13:zk,14:br,15:br,16:br,17:br,18:br,19:br,20:br,21:Bv};function Wk(r,e){for(var t=r.l+e,n=[];r.l<t;){var i=r.read_shift(2);r.l-=2;try{n.push(Vk[i](r,t-r.l))}catch{return r.l=t,n}}return r.l!=t&&(r.l=t),n}function tu(r,e){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=r.read_shift(2),e-=2,e>=2&&(t.dt=r.read_shift(2),r.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return r.read_shift(e),t}function Hk(r,e){return e===0||r.read_shift(2),1200}function Xk(r,e,t){if(t.enc)return r.l+=e,"";var n=r.l,i=ua(r,0,t);return r.read_shift(e+n-r.l),i}function Gk(r,e,t){var n=t&&t.biff==8||e==2?r.read_shift(2):(r.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Yk(r,e,t){var n=r.read_shift(4),i=r.read_shift(1)&3,s=r.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=Dl(r,0,t);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:s,name:o}}function $k(r,e){for(var t=r.l+e,n=r.read_shift(4),i=r.read_shift(4),s=[],o=0;o!=i&&r.l<t;++o)s.push(Fk(r));return s.Count=n,s.Unique=i,s}function Kk(r,e){var t={};return t.dsst=r.read_shift(2),r.l+=e-2,t}function Zk(r){var e={};e.r=r.read_shift(2),e.c=r.read_shift(2),e.cnt=r.read_shift(2)-e.c;var t=r.read_shift(2);r.l+=4;var n=r.read_shift(1);return r.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=t/20),e}function qk(r){var e=Ik(r);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var t=r.read_shift(4);return t!==0}function Jk(r){return r.read_shift(2),r.read_shift(4)}function p1(r,e,t){var n=0;t&&t.biff==2||(n=r.read_shift(2));var i=r.read_shift(2);t&&t.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function Qk(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),o=r.read_shift(2),c=r.read_shift(2),u=r.read_shift(2),d=r.read_shift(2);return{Pos:[e,t],Dim:[n,i],Flags:s,CurTab:o,FirstTab:c,Selected:u,TabRatio:d}}function eC(r,e,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=r.read_shift(2);return{RTL:n&64}}function tC(){}function rC(r,e,t){var n={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10;break}return n.name=Dl(r,0,t),n}function nC(r){var e=xi(r);return e.isst=r.read_shift(4),e}function iC(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=r.l+e,i=xi(r);t.biff==2&&r.l++;var s=Pl(r,n-r.l,t);return i.val=s,i}function sC(r,e,t){var n=r.read_shift(2),i=ua(r,0,t);return[n,i]}var aC=ua;function m1(r,e,t){var n=r.l+e,i=t.biff==8||!t.biff?4:2,s=r.read_shift(i),o=r.read_shift(i),c=r.read_shift(2),u=r.read_shift(2);return r.l=n,{s:{r:s,c},e:{r:o,c:u}}}function oC(r){var e=r.read_shift(2),t=r.read_shift(2),n=Rv(r);return{r:e,c:t,ixfe:n[0],rknum:n[1]}}function lC(r,e){for(var t=r.l+e-2,n=r.read_shift(2),i=r.read_shift(2),s=[];r.l<t;)s.push(Rv(r));if(r.l!==t)throw new Error("MulRK read error");var o=r.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:s}}function cC(r,e){for(var t=r.l+e-2,n=r.read_shift(2),i=r.read_shift(2),s=[];r.l<t;)s.push(r.read_shift(2));if(r.l!==t)throw new Error("MulBlank read error");var o=r.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:s}}function uC(r,e,t,n){var i={},s=r.read_shift(4),o=r.read_shift(4),c=r.read_shift(4),u=r.read_shift(2);return i.patternType=ok[c>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=c&127,i.icvBottom=c>>7&127,i.icvDiag=c>>14&127,i.dgDiag=c>>21&15,i.icvFore=u&127,i.icvBack=u>>7&127,i.fsxButton=u>>14&1),i}function hC(r,e,t){var n={};return n.ifnt=r.read_shift(2),n.numFmtId=r.read_shift(2),n.flags=r.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=uC(r,e,n.fStyle,t),n}function fC(r){r.l+=4;var e=[r.read_shift(2),r.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function x1(r,e,t){var n=xi(r);(t.biff==2||e==9)&&++r.l;var i=bk(r);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function dC(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=xi(r),i=Or(r);return n.val=i,n}var v1=Rk;function gC(r,e,t){var n=r.l+e,i=r.read_shift(2),s=r.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=na(r,s),c=[];n>r.l;)c.push(Pl(r));return[s,i,o,c]}function y1(r,e,t){var n=r.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(i=Bk(r,e-2,t)),s.body=i||r.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var pC=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function _1(r,e,t){var n=r.l+e,i=r.read_shift(2),s=r.read_shift(1),o=r.read_shift(1),c=r.read_shift(t&&t.biff==2?1:2),u=0;(!t||t.biff>=5)&&(t.biff!=5&&(r.l+=2),u=r.read_shift(2),t.biff==5&&(r.l+=2),r.l+=4);var d=na(r,o,t);i&32&&(d=pC[d.charCodeAt(0)]);var h=n-r.l;t&&t.biff==2&&--h;var g=n==r.l||c===0||!(h>0)?[]:Z4(r,h,t,c);return{chKey:s,Name:d,itab:u,rgce:g}}function jv(r,e,t){if(t.biff<8)return mC(r,e,t);for(var n=[],i=r.l+e,s=r.read_shift(t.biff>8?4:2);s--!==0;)n.push(Lk(r,t.biff>8?12:6,t));if(r.l!=i)throw new Error("Bad ExternSheet: "+r.l+" != "+i);return n}function mC(r,e,t){r[r.l+1]==3&&r[r.l]++;var n=Dl(r,e,t);return n.charCodeAt(0)==3?n.slice(1):n}function xC(r,e,t){if(t.biff<8){r.l+=e;return}var n=r.read_shift(2),i=r.read_shift(2),s=na(r,n,t),o=na(r,i,t);return[s,o]}function vC(r,e,t){var n=Lv(r);r.l++;var i=r.read_shift(1);return e-=8,[q4(r,e,t),i,n]}function w1(r,e,t){var n=jk(r);switch(t.biff){case 2:r.l++,e-=7;break;case 3:case 4:r.l+=2,e-=8;break;default:r.l+=6,e-=12}return[n,$4(r,e,t)]}function yC(r){var e=r.read_shift(4)!==0,t=r.read_shift(4)!==0,n=r.read_shift(4);return[e,t,n]}function _C(r,e,t){if(!(t.biff<8)){var n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),o=r.read_shift(2),c=ua(r,0,t);return t.biff<8&&r.read_shift(1),[{r:n,c:i},c,o,s]}}function wC(r,e,t){return _C(r,e,t)}function SC(r,e){for(var t=[],n=r.read_shift(2);n--;)t.push(hh(r));return t}function kC(r,e,t){if(t&&t.biff<8)return TC(r,e,t);var n=Bv(r),i=Wk(r,e-22,n[1]);return{cmo:n,ft:i}}var CC={8:function(r,e){var t=r.l+e;r.l+=10;var n=r.read_shift(2);r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4;var i=r.read_shift(1);return r.l+=i,r.l=t,{fmt:n}}};function TC(r,e,t){r.l+=4;var n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2);r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=6,e-=36;var o=[];return o.push((CC[n]||Nr)(r,e,t)),{cmo:[i,n,s],ft:o}}function EC(r,e,t){var n=r.l,i="";try{r.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?r.l+=6:o=Ok(r,6,t);var c=r.read_shift(2);r.read_shift(2),er(r,2);var u=r.read_shift(2);r.l+=u;for(var d=1;d<r.lens.length-1;++d){if(r.l-n!=r.lens[d])throw new Error("TxO: bad continue record");var h=r[r.l],g=na(r,r.lens[d+1]-r.lens[d]-1);if(i+=g,i.length>=(h?c:2*c))break}if(i.length!==c&&i.length!==c*2)throw new Error("cchText: "+c+" != "+i.length);return r.l=n+e,{t:i}}catch{return r.l=n+e,{t:i}}}function AC(r,e){var t=hh(r);r.l+=16;var n=Nk(r,e-24);return[t,n]}function bC(r,e){r.read_shift(2);var t=hh(r),n=r.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Wr,""),[t,n]}function FC(r){var e=[0,0],t;return t=r.read_shift(2),e[0]=u1[t]||t,t=r.read_shift(2),e[1]=u1[t]||t,e}function OC(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(Iv(r));return t}function DC(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(Iv(r));return t}function PC(r){r.l+=2;var e={cxfs:0,crc:0};return e.cxfs=r.read_shift(2),e.crc=r.read_shift(4),e}function zv(r,e,t){if(!t.cellStyles)return Nr(r,e);var n=t&&t.biff>=12?4:2,i=r.read_shift(n),s=r.read_shift(n),o=r.read_shift(n),c=r.read_shift(n),u=r.read_shift(2);n==2&&(r.l+=2);var d={s:i,e:s,w:o,ixfe:c,flags:u};return(t.biff>=5||!t.biff)&&(d.level=u>>8&7),d}function MC(r,e){var t={};return e<32||(r.l+=16,t.header=Or(r),t.footer=Or(r),r.l+=2),t}function NC(r,e,t){var n={area:!1};if(t.biff!=5)return r.l+=e,n;var i=r.read_shift(1);return r.l+=3,i&16&&(n.area=!0),n}var IC=xi,RC=Mv,LC=Pl;function BC(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),i={fmt:e,env:t,len:n,data:r.slice(r.l,r.l+n)};return r.l+=n,i}function jC(r,e,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=xi(r);++r.l;var i=ua(r,e-7,t);return n.t="str",n.val=i,n}function zC(r){var e=xi(r);++r.l;var t=Or(r);return e.t="n",e.val=t,e}function UC(r){var e=xi(r);++r.l;var t=r.read_shift(2);return e.t="n",e.val=t,e}function VC(r){var e=r.read_shift(1);return e===0?(r.l++,""):r.read_shift(e,"sbcs-cont")}function WC(r,e){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=e-13}function HC(r,e,t){var n=r.l+e,i=xi(r),s=r.read_shift(2),o=na(r,s,t);return r.l=n,i.t="str",i.val=o,i}var XC=[2,3,48,49,131,139,140,245],S1=(function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=pd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,u){var d=[],h=ks(1);switch(u.type){case"base64":h=Kn(gn(c));break;case"binary":h=Kn(c);break;case"buffer":case"array":h=c;break}yr(h,0);var g=h.read_shift(1),x=!!(g&136),m=!1,y=!1;switch(g){case 2:break;case 3:break;case 48:m=!0,x=!0;break;case 49:m=!0,x=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var v=0,_=521;g==2&&(v=h.read_shift(2)),h.l+=3,g!=2&&(v=h.read_shift(4)),v>1048576&&(v=1e6),g!=2&&(_=h.read_shift(2));var S=h.read_shift(2),T=u.codepage||1252;g!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(T=r[h[h.l]]),h.l+=1,h.l+=2),y&&(h.l+=36);for(var C=[],A={},P=Math.min(h.length,g==2?521:_-10-(m?264:0)),N=y?32:11;h.l<P&&h[h.l]!=13;)switch(A={},A.name=pl.utils.decode(T,h.slice(h.l,h.l+N)).replace(/[\u0000\r\n].*$/g,""),h.l+=N,A.type=String.fromCharCode(h.read_shift(1)),g!=2&&!y&&(A.offset=h.read_shift(4)),A.len=h.read_shift(1),g==2&&(A.offset=h.read_shift(2)),A.dec=h.read_shift(1),A.name.length&&C.push(A),g!=2&&(h.l+=y?13:14),A.type){case"B":(!m||A.len!=8)&&u.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+A.type)}if(h[h.l]!==13&&(h.l=_-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=_;var O=0,V=0;for(d[0]=[],V=0;V!=C.length;++V)d[0][V]=C[V].name;for(;v-- >0;){if(h[h.l]===42){h.l+=S;continue}for(++h.l,d[++O]=[],V=0,V=0;V!=C.length;++V){var B=h.slice(h.l,h.l+C[V].len);h.l+=C[V].len,yr(B,0);var te=pl.utils.decode(T,B);switch(C[V].type){case"C":te.trim().length&&(d[O][V]=te.replace(/\s+$/,""));break;case"D":te.length===8?d[O][V]=new Date(+te.slice(0,4),+te.slice(4,6)-1,+te.slice(6,8)):d[O][V]=te;break;case"F":d[O][V]=parseFloat(te.trim());break;case"+":case"I":d[O][V]=y?B.read_shift(-4,"i")^2147483648:B.read_shift(4,"i");break;case"L":switch(te.trim().toUpperCase()){case"Y":case"T":d[O][V]=!0;break;case"N":case"F":d[O][V]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+te+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));d[O][V]="##MEMO##"+(y?parseInt(te.trim(),10):B.read_shift(4));break;case"N":te=te.replace(/\u0000/g,"").trim(),te&&te!="."&&(d[O][V]=+te||0);break;case"@":d[O][V]=new Date(B.read_shift(-8,"f")-621356832e5);break;case"T":d[O][V]=new Date((B.read_shift(4)-2440588)*864e5+B.read_shift(4));break;case"Y":d[O][V]=B.read_shift(4,"i")/1e4+B.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[O][V]=-B.read_shift(-8,"f");break;case"B":if(m&&C[V].len==8){d[O][V]=B.read_shift(8,"f");break}case"G":case"P":B.l+=C[V].len;break;case"0":if(C[V].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[V].type)}}}if(g!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return u&&u.sheetRows&&(d=d.slice(0,u.sheetRows)),u.DBF=C,d}function n(c,u){var d=u||{};d.dateNF||(d.dateNF="yyyymmdd");var h=ro(t(c,d),d);return h["!cols"]=d.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete d.DBF,h}function i(c,u){try{return As(n(c,u),u)}catch(d){if(u&&u.WTF)throw d}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,u){var d=u||{};if(+d.codepage>=0&&qn(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var h=Bf(),g=$f(c,{header:1,raw:!0,cellDates:!0}),x=g[0],m=g.slice(1),y=c["!cols"]||[],v=0,_=0,S=0,T=1;for(v=0;v<x.length;++v){if(((y[v]||{}).DBF||{}).name){x[v]=y[v].DBF.name,++S;continue}if(x[v]!=null){if(++S,typeof x[v]=="number"&&(x[v]=x[v].toString(10)),typeof x[v]!="string")throw new Error("DBF Invalid column name "+x[v]+" |"+typeof x[v]+"|");if(x.indexOf(x[v])!==v){for(_=0;_<1024;++_)if(x.indexOf(x[v]+"_"+_)==-1){x[v]+="_"+_;break}}}}var C=Wt(c["!ref"]),A=[],P=[],N=[];for(v=0;v<=C.e.c-C.s.c;++v){var O="",V="",B=0,te=[];for(_=0;_<m.length;++_)m[_][v]!=null&&te.push(m[_][v]);if(te.length==0||x[v]==null){A[v]="?";continue}for(_=0;_<te.length;++_){switch(typeof te[_]){case"number":V="B";break;case"string":V="C";break;case"boolean":V="L";break;case"object":V=te[_]instanceof Date?"D":"C";break;default:V="C"}B=Math.max(B,String(te[_]).length),O=O&&O!=V?"C":V}B>250&&(B=250),V=((y[v]||{}).DBF||{}).type,V=="C"&&y[v].DBF.len>B&&(B=y[v].DBF.len),O=="B"&&V=="N"&&(O="N",N[v]=y[v].DBF.dec,B=y[v].DBF.len),P[v]=O=="C"||V=="N"?B:s[O]||0,T+=P[v],A[v]=O}var ie=h.next(32);for(ie.write_shift(4,318902576),ie.write_shift(4,m.length),ie.write_shift(2,296+32*S),ie.write_shift(2,T),v=0;v<4;++v)ie.write_shift(4,0);for(ie.write_shift(4,0|(+e[jx]||3)<<8),v=0,_=0;v<x.length;++v)if(x[v]!=null){var D=h.next(32),J=(x[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,J,"sbcs"),D.write_shift(1,A[v]=="?"?"C":A[v],"sbcs"),D.write_shift(4,_),D.write_shift(1,P[v]||s[A[v]]||0),D.write_shift(1,N[v]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),_+=P[v]||s[A[v]]||0}var F=h.next(264);for(F.write_shift(4,13),v=0;v<65;++v)F.write_shift(4,0);for(v=0;v<m.length;++v){var se=h.next(T);for(se.write_shift(1,0),_=0;_<x.length;++_)if(x[_]!=null)switch(A[_]){case"L":se.write_shift(1,m[v][_]==null?63:m[v][_]?84:70);break;case"B":se.write_shift(8,m[v][_]||0,"f");break;case"N":var Ee="0";for(typeof m[v][_]=="number"&&(Ee=m[v][_].toFixed(N[_]||0)),S=0;S<P[_]-Ee.length;++S)se.write_shift(1,32);se.write_shift(1,Ee,"sbcs");break;case"D":m[v][_]?(se.write_shift(4,("0000"+m[v][_].getFullYear()).slice(-4),"sbcs"),se.write_shift(2,("00"+(m[v][_].getMonth()+1)).slice(-2),"sbcs"),se.write_shift(2,("00"+m[v][_].getDate()).slice(-2),"sbcs")):se.write_shift(8,"00000000","sbcs");break;case"C":var le=String(m[v][_]!=null?m[v][_]:"").slice(0,P[_]);for(se.write_shift(1,le,"sbcs"),S=0;S<P[_]-le.length;++S)se.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}})(),GC=(function(){var r={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+gi(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(x,m){var y=r[m];return typeof y=="number"?Bm(y):y},n=function(x,m,y){var v=m.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return v==59?x:Bm(v)};r["|"]=254;function i(x,m){switch(m.type){case"base64":return s(gn(x),m);case"binary":return s(x,m);case"buffer":return s(xt&&Buffer.isBuffer(x)?x.toString("binary"):aa(x),m);case"array":return s(ra(x),m)}throw new Error("Unrecognized type "+m.type)}function s(x,m){var y=x.split(/[\n\r]+/),v=-1,_=-1,S=0,T=0,C=[],A=[],P=null,N={},O=[],V=[],B=[],te=0,ie;for(+m.codepage>=0&&qn(+m.codepage);S!==y.length;++S){te=0;var D=y[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,t),J=D.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),F=J[0],se;if(D.length>0)switch(F){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":J[1].charAt(0)=="P"&&A.push(D.slice(3).replace(/;;/g,";"));break;case"C":var Ee=!1,le=!1,xe=!1,X=!1,pe=-1,R=-1;for(T=1;T<J.length;++T)switch(J[T].charAt(0)){case"A":break;case"X":_=parseInt(J[T].slice(1))-1,le=!0;break;case"Y":for(v=parseInt(J[T].slice(1))-1,le||(_=0),ie=C.length;ie<=v;++ie)C[ie]=[];break;case"K":se=J[T].slice(1),se.charAt(0)==='"'?se=se.slice(1,se.length-1):se==="TRUE"?se=!0:se==="FALSE"?se=!1:isNaN(ti(se))?isNaN(qa(se).getDate())||(se=gr(se)):(se=ti(se),P!==null&&eo(P)&&(se=uh(se))),Ee=!0;break;case"E":X=!0;var b=Ga(J[T].slice(1),{r:v,c:_});C[v][_]=[C[v][_],b];break;case"S":xe=!0,C[v][_]=[C[v][_],"S5S"];break;case"G":break;case"R":pe=parseInt(J[T].slice(1))-1;break;case"C":R=parseInt(J[T].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}if(Ee&&(C[v][_]&&C[v][_].length==2?C[v][_][0]=se:C[v][_]=se,P=null),xe){if(X)throw new Error("SYLK shared formula cannot have own formula");var ee=pe>-1&&C[pe][R];if(!ee||!ee[1])throw new Error("SYLK shared formula cannot find base");C[v][_][1]=Zv(ee[1],{r:v-pe,c:_-R})}break;case"F":var G=0;for(T=1;T<J.length;++T)switch(J[T].charAt(0)){case"X":_=parseInt(J[T].slice(1))-1,++G;break;case"Y":for(v=parseInt(J[T].slice(1))-1,ie=C.length;ie<=v;++ie)C[ie]=[];break;case"M":te=parseInt(J[T].slice(1))/20;break;case"F":break;case"G":break;case"P":P=A[parseInt(J[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(B=J[T].slice(1).split(" "),ie=parseInt(B[0],10);ie<=parseInt(B[1],10);++ie)te=parseInt(B[2],10),V[ie-1]=te===0?{hidden:!0}:{wch:te},Ja(V[ie-1]);break;case"C":_=parseInt(J[T].slice(1))-1,V[_]||(V[_]={});break;case"R":v=parseInt(J[T].slice(1))-1,O[v]||(O[v]={}),te>0?(O[v].hpt=te,O[v].hpx=wl(te)):te===0&&(O[v].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}G<1&&(P=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}}return O.length>0&&(N["!rows"]=O),V.length>0&&(N["!cols"]=V),m&&m.sheetRows&&(C=C.slice(0,m.sheetRows)),[C,N]}function o(x,m){var y=i(x,m),v=y[0],_=y[1],S=ro(v,m);return gi(_).forEach(function(T){S[T]=_[T]}),S}function c(x,m){return As(o(x,m),m)}function u(x,m,y,v){var _="C;Y"+(y+1)+";X"+(v+1)+";K";switch(x.t){case"n":_+=x.v||0,x.f&&!x.F&&(_+=";E"+PE(x.f,{r:y,c:v}));break;case"b":_+=x.v?"TRUE":"FALSE";break;case"e":_+=x.w||x.v;break;case"d":_+='"'+(x.w||x.v)+'"';break;case"s":_+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function d(x,m){m.forEach(function(y,v){var _="F;W"+(v+1)+" "+(v+1)+" ";y.hidden?_+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=Ku(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=Zu(y.wpx)),typeof y.wch=="number"&&(_+=Math.round(y.wch))),_.charAt(_.length-1)!=" "&&x.push(_)})}function h(x,m){m.forEach(function(y,v){var _="F;";y.hidden?_+="M0;":y.hpt?_+="M"+20*y.hpt+";":y.hpx&&(_+="M"+20*Yv(y.hpx)+";"),_.length>2&&x.push(_+"R"+(v+1))})}function g(x,m){var y=["ID;PWXL;N;E"],v=[],_=Wt(x["!ref"]),S,T=Array.isArray(x),C=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),x["!cols"]&&d(y,x["!cols"]),x["!rows"]&&h(y,x["!rows"]),y.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var A=_.s.r;A<=_.e.r;++A)for(var P=_.s.c;P<=_.e.c;++P){var N=ht({r:A,c:P});S=T?(x[A]||[])[P]:x[N],!(!S||S.v==null&&(!S.f||S.F))&&v.push(u(S,x,A,P))}return y.join(C)+C+v.join(C)+C+"E"+C}return{to_workbook:c,to_sheet:o,from_sheet:g}})(),YC=(function(){function r(s,o){switch(o.type){case"base64":return e(gn(s),o);case"binary":return e(s,o);case"buffer":return e(xt&&Buffer.isBuffer(s)?s.toString("binary"):aa(s),o);case"array":return e(ra(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var c=s.split(`
`),u=-1,d=-1,h=0,g=[];h!==c.length;++h){if(c[h].trim()==="BOT"){g[++u]=[],d=0;continue}if(!(u<0)){var x=c[h].trim().split(","),m=x[0],y=x[1];++h;for(var v=c[h]||"";(v.match(/["]/g)||[]).length&1&&h<c.length-1;)v+=`
`+c[++h];switch(v=v.trim(),+m){case-1:if(v==="BOT"){g[++u]=[],d=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?g[u][d]=!0:v==="FALSE"?g[u][d]=!1:isNaN(ti(y))?isNaN(qa(y).getDate())?g[u][d]=y:g[u][d]=gr(y):g[u][d]=ti(y),++d;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),g[u][d++]=v!==""?v:null;break}if(v==="EOD")break}}return o&&o.sheetRows&&(g=g.slice(0,o.sheetRows)),g}function t(s,o){return ro(r(s,o),o)}function n(s,o){return As(t(s,o),o)}var i=(function(){var s=function(u,d,h,g,x){u.push(d),u.push(h+","+g),u.push('"'+x.replace(/"/g,'""')+'"')},o=function(u,d,h,g){u.push(d+","+h),u.push(d==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(u){var d=[],h=Wt(u["!ref"]),g,x=Array.isArray(u);s(d,"TABLE",0,1,"sheetjs"),s(d,"VECTORS",0,h.e.r-h.s.r+1,""),s(d,"TUPLES",0,h.e.c-h.s.c+1,""),s(d,"DATA",0,0,"");for(var m=h.s.r;m<=h.e.r;++m){o(d,-1,0,"BOT");for(var y=h.s.c;y<=h.e.c;++y){var v=ht({r:m,c:y});if(g=x?(u[m]||[])[y]:u[v],!g){o(d,1,0,"");continue}switch(g.t){case"n":var _=g.w;!_&&g.v!=null&&(_=g.v),_==null?g.f&&!g.F?o(d,1,0,"="+g.f):o(d,1,0,""):o(d,0,_,"V");break;case"b":o(d,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=On(g.z||ft[14],Hr(gr(g.v)))),o(d,0,g.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var S=`\r
`,T=d.join(S);return T}})();return{to_workbook:n,to_sheet:t,from_sheet:i}})(),$C=(function(){function r(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(g,x){for(var m=g.split(`
`),y=-1,v=-1,_=0,S=[];_!==m.length;++_){var T=m[_].trim().split(":");if(T[0]==="cell"){var C=Vr(T[1]);if(S.length<=C.r)for(y=S.length;y<=C.r;++y)S[y]||(S[y]=[]);switch(y=C.r,v=C.c,T[2]){case"t":S[y][v]=r(T[3]);break;case"v":S[y][v]=+T[3];break;case"vtf":var A=T[T.length-1];case"vtc":switch(T[3]){case"nl":S[y][v]=!!+T[4];break;default:S[y][v]=+T[4];break}T[2]=="vtf"&&(S[y][v]=[S[y][v],A])}}}return x&&x.sheetRows&&(S=S.slice(0,x.sheetRows)),S}function n(g,x){return ro(t(g,x),x)}function i(g,x){return As(n(g,x),x)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function d(g){if(!g||!g["!ref"])return"";for(var x=[],m=[],y,v="",_=to(g["!ref"]),S=Array.isArray(g),T=_.s.r;T<=_.e.r;++T)for(var C=_.s.c;C<=_.e.c;++C)if(v=ht({r:T,c:C}),y=S?(g[T]||[])[C]:g[v],!(!y||y.v==null||y.t==="z")){switch(m=["cell",v,"t"],y.t){case"s":case"str":m.push(e(y.v));break;case"n":y.f?(m[2]="vtf",m[3]="n",m[4]=y.v,m[5]=e(y.f)):(m[2]="v",m[3]=y.v);break;case"b":m[2]="vt"+(y.f?"f":"c"),m[3]="nl",m[4]=y.v?"1":"0",m[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var A=Hr(gr(y.v));m[2]="vtc",m[3]="nd",m[4]=""+A,m[5]=y.w||On(y.z||ft[14],A);break;case"e":continue}x.push(m.join(":"))}return x.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function h(g){return[s,o,c,o,d(g),u].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:h}})(),yl=(function(){function r(h,g,x,m,y){y.raw?g[x][m]=h:h===""||(h==="TRUE"?g[x][m]=!0:h==="FALSE"?g[x][m]=!1:isNaN(ti(h))?isNaN(qa(h).getDate())?g[x][m]=h:g[x][m]=gr(h):g[x][m]=ti(h))}function e(h,g){var x=g||{},m=[];if(!h||h.length===0)return m;for(var y=h.split(/[\r\n]/),v=y.length-1;v>=0&&y[v].length===0;)--v;for(var _=10,S=0,T=0;T<=v;++T)S=y[T].indexOf(" "),S==-1?S=y[T].length:S++,_=Math.max(_,S);for(T=0;T<=v;++T){m[T]=[];var C=0;for(r(y[T].slice(0,_).trim(),m,T,C,x),C=1;C<=(y[T].length-_)/10+1;++C)r(y[T].slice(_+(C-1)*10,_+C*10).trim(),m,T,C,x)}return x.sheetRows&&(m=m.slice(0,x.sheetRows)),m}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(h){for(var g={},x=!1,m=0,y=0;m<h.length;++m)(y=h.charCodeAt(m))==34?x=!x:!x&&y in t&&(g[y]=(g[y]||0)+1);y=[];for(m in g)Object.prototype.hasOwnProperty.call(g,m)&&y.push([g[m],m]);if(!y.length){g=n;for(m in g)Object.prototype.hasOwnProperty.call(g,m)&&y.push([g[m],m])}return y.sort(function(v,_){return v[0]-_[0]||n[v[1]]-n[_[1]]}),t[y.pop()[1]]||44}function s(h,g){var x=g||{},m="",y=x.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(m=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(m=h.charAt(4),h=h.slice(6)):m=i(h.slice(0,1024)):x&&x.FS?m=x.FS:m=i(h.slice(0,1024));var _=0,S=0,T=0,C=0,A=0,P=m.charCodeAt(0),N=!1,O=0,V=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var B=x.dateNF!=null?sS(x.dateNF):null;function te(){var ie=h.slice(C,A),D={};if(ie.charAt(0)=='"'&&ie.charAt(ie.length-1)=='"'&&(ie=ie.slice(1,-1).replace(/""/g,'"')),ie.length===0)D.t="z";else if(x.raw)D.t="s",D.v=ie;else if(ie.trim().length===0)D.t="s",D.v=ie;else if(ie.charCodeAt(0)==61)ie.charCodeAt(1)==34&&ie.charCodeAt(ie.length-1)==34?(D.t="s",D.v=ie.slice(2,-1).replace(/""/g,'"')):NE(ie)?(D.t="n",D.f=ie.slice(1)):(D.t="s",D.v=ie);else if(ie=="TRUE")D.t="b",D.v=!0;else if(ie=="FALSE")D.t="b",D.v=!1;else if(!isNaN(T=ti(ie)))D.t="n",x.cellText!==!1&&(D.w=ie),D.v=T;else if(!isNaN(qa(ie).getDate())||B&&ie.match(B)){D.z=x.dateNF||ft[14];var J=0;B&&ie.match(B)&&(ie=aS(ie,x.dateNF,ie.match(B)||[]),J=1),x.cellDates?(D.t="d",D.v=gr(ie,J)):(D.t="n",D.v=Hr(gr(ie,J))),x.cellText!==!1&&(D.w=On(D.z,D.v instanceof Date?Hr(D.v):D.v)),x.cellNF||delete D.z}else D.t="s",D.v=ie;if(D.t=="z"||(x.dense?(y[_]||(y[_]=[]),y[_][S]=D):y[ht({c:S,r:_})]=D),C=A+1,V=h.charCodeAt(C),v.e.c<S&&(v.e.c=S),v.e.r<_&&(v.e.r=_),O==P)++S;else if(S=0,++_,x.sheetRows&&x.sheetRows<=_)return!0}e:for(;A<h.length;++A)switch(O=h.charCodeAt(A)){case 34:V===34&&(N=!N);break;case P:case 10:case 13:if(!N&&te())break e;break}return A-C>0&&te(),y["!ref"]=_t(v),y}function o(h,g){return!(g&&g.PRN)||g.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,g):ro(e(h,g),g)}function c(h,g){var x="",m=g.type=="string"?[0,0,0,0]:Nd(h,g);switch(g.type){case"base64":x=gn(h);break;case"binary":x=h;break;case"buffer":g.codepage==65001?x=h.toString("utf8"):g.codepage&&typeof pl<"u"||(x=xt&&Buffer.isBuffer(h)?h.toString("binary"):aa(h));break;case"array":x=ra(h);break;case"string":x=h;break;default:throw new Error("Unrecognized type "+g.type)}return m[0]==239&&m[1]==187&&m[2]==191?x=Pt(x.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?x=Pt(x):g.type=="binary"&&typeof pl<"u",x.slice(0,19)=="socialcalc:version:"?$C.to_sheet(g.type=="string"?x:Pt(x),g):o(x,g)}function u(h,g){return As(c(h,g),g)}function d(h){for(var g=[],x=Wt(h["!ref"]),m,y=Array.isArray(h),v=x.s.r;v<=x.e.r;++v){for(var _=[],S=x.s.c;S<=x.e.c;++S){var T=ht({r:v,c:S});if(m=y?(h[v]||[])[S]:h[T],!m||m.v==null){_.push("          ");continue}for(var C=(m.w||(zi(m),m.w)||"").slice(0,10);C.length<10;)C+=" ";_.push(C+(S===0?" ":""))}g.push(_.join(""))}return g.join(`
`)}return{to_workbook:u,to_sheet:c,from_sheet:d}})();function KC(r,e){var t=e||{},n=!!t.WTF;t.WTF=!0;try{var i=GC.to_workbook(r,t);return t.WTF=n,i}catch(s){if(t.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return yl.to_workbook(r,e)}}var al=(function(){function r(b,ee,G){if(b){yr(b,b.l||0);for(var H=G.Enum||pe;b.l<b.length;){var me=b.read_shift(2),Me=H[me]||H[65535],Fe=b.read_shift(2),be=b.l+Fe,De=Me.f&&Me.f(b,Fe,G);if(b.l=be,ee(De,Me,me))return}}}function e(b,ee){switch(ee.type){case"base64":return t(Kn(gn(b)),ee);case"binary":return t(Kn(b),ee);case"buffer":case"array":return t(b,ee)}throw"Unsupported type "+ee.type}function t(b,ee){if(!b)return b;var G=ee||{},H=G.dense?[]:{},me="Sheet1",Me="",Fe=0,be={},De=[],ne=[],z={s:{r:0,c:0},e:{r:0,c:0}},Le=G.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)G.Enum=pe,r(b,function(j,U,ae){switch(ae){case 0:G.vers=j,j>=4096&&(G.qpro=!0);break;case 6:z=j;break;case 204:j&&(Me=j);break;case 222:Me=j;break;case 15:case 51:G.qpro||(j[1].v=j[1].v.slice(1));case 13:case 14:case 16:ae==14&&(j[2]&112)==112&&(j[2]&15)>1&&(j[2]&15)<15&&(j[1].z=G.dateNF||ft[14],G.cellDates&&(j[1].t="d",j[1].v=uh(j[1].v))),G.qpro&&j[3]>Fe&&(H["!ref"]=_t(z),be[me]=H,De.push(me),H=G.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},Fe=j[3],me=Me||"Sheet"+(Fe+1),Me="");var Ae=G.dense?(H[j[0].r]||[])[j[0].c]:H[ht(j[0])];if(Ae){Ae.t=j[1].t,Ae.v=j[1].v,j[1].z!=null&&(Ae.z=j[1].z),j[1].f!=null&&(Ae.f=j[1].f);break}G.dense?(H[j[0].r]||(H[j[0].r]=[]),H[j[0].r][j[0].c]=j[1]):H[ht(j[0])]=j[1];break}},G);else if(b[2]==26||b[2]==14)G.Enum=R,b[2]==14&&(G.qpro=!0,b.l=0),r(b,function(j,U,ae){switch(ae){case 204:me=j;break;case 22:j[1].v=j[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(j[3]>Fe&&(H["!ref"]=_t(z),be[me]=H,De.push(me),H=G.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},Fe=j[3],me="Sheet"+(Fe+1)),Le>0&&j[0].r>=Le)break;G.dense?(H[j[0].r]||(H[j[0].r]=[]),H[j[0].r][j[0].c]=j[1]):H[ht(j[0])]=j[1],z.e.c<j[0].c&&(z.e.c=j[0].c),z.e.r<j[0].r&&(z.e.r=j[0].r);break;case 27:j[14e3]&&(ne[j[14e3][0]]=j[14e3][1]);break;case 1537:ne[j[0]]=j[1],j[0]==Fe&&(me=j[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(H["!ref"]=_t(z),be[Me||me]=H,De.push(Me||me),!ne.length)return{SheetNames:De,Sheets:be};for(var E={},de=[],ce=0;ce<ne.length;++ce)be[De[ce]]?(de.push(ne[ce]||De[ce]),E[ne[ce]]=be[ne[ce]]||be[De[ce]]):(de.push(ne[ce]),E[ne[ce]]={"!ref":"A1"});return{SheetNames:de,Sheets:E}}function n(b,ee){var G=ee||{};if(+G.codepage>=0&&qn(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var H=Bf(),me=Wt(b["!ref"]),Me=Array.isArray(b),Fe=[];Wn(H,0,s(1030)),Wn(H,6,u(me));for(var be=Math.min(me.e.r,8191),De=me.s.r;De<=be;++De)for(var ne=Sr(De),z=me.s.c;z<=me.e.c;++z){De===me.s.r&&(Fe[z]=sr(z));var Le=Fe[z]+ne,E=Me?(b[De]||[])[z]:b[Le];if(!(!E||E.t=="z"))if(E.t=="n")(E.v|0)==E.v&&E.v>=-32768&&E.v<=32767?Wn(H,13,m(De,z,E.v)):Wn(H,14,v(De,z,E.v));else{var de=zi(E);Wn(H,15,g(De,z,de.slice(0,239)))}}return Wn(H,1),H.end()}function i(b,ee){var G=ee||{};if(+G.codepage>=0&&qn(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var H=Bf();Wn(H,0,o(b));for(var me=0,Me=0;me<b.SheetNames.length;++me)(b.Sheets[b.SheetNames[me]]||{})["!ref"]&&Wn(H,27,X(b.SheetNames[me],Me++));var Fe=0;for(me=0;me<b.SheetNames.length;++me){var be=b.Sheets[b.SheetNames[me]];if(!(!be||!be["!ref"])){for(var De=Wt(be["!ref"]),ne=Array.isArray(be),z=[],Le=Math.min(De.e.r,8191),E=De.s.r;E<=Le;++E)for(var de=Sr(E),ce=De.s.c;ce<=De.e.c;++ce){E===De.s.r&&(z[ce]=sr(ce));var j=z[ce]+de,U=ne?(be[E]||[])[ce]:be[j];if(!(!U||U.t=="z"))if(U.t=="n")Wn(H,23,te(E,ce,Fe,U.v));else{var ae=zi(U);Wn(H,22,O(E,ce,Fe,ae.slice(0,239)))}}++Fe}}return Wn(H,1),H.end()}function s(b){var ee=ir(2);return ee.write_shift(2,b),ee}function o(b){var ee=ir(26);ee.write_shift(2,4096),ee.write_shift(2,4),ee.write_shift(4,0);for(var G=0,H=0,me=0,Me=0;Me<b.SheetNames.length;++Me){var Fe=b.SheetNames[Me],be=b.Sheets[Fe];if(!(!be||!be["!ref"])){++me;var De=to(be["!ref"]);G<De.e.r&&(G=De.e.r),H<De.e.c&&(H=De.e.c)}}return G>8191&&(G=8191),ee.write_shift(2,G),ee.write_shift(1,me),ee.write_shift(1,H),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(1,1),ee.write_shift(1,2),ee.write_shift(4,0),ee.write_shift(4,0),ee}function c(b,ee,G){var H={s:{c:0,r:0},e:{c:0,r:0}};return ee==8&&G.qpro?(H.s.c=b.read_shift(1),b.l++,H.s.r=b.read_shift(2),H.e.c=b.read_shift(1),b.l++,H.e.r=b.read_shift(2),H):(H.s.c=b.read_shift(2),H.s.r=b.read_shift(2),ee==12&&G.qpro&&(b.l+=2),H.e.c=b.read_shift(2),H.e.r=b.read_shift(2),ee==12&&G.qpro&&(b.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function u(b){var ee=ir(8);return ee.write_shift(2,b.s.c),ee.write_shift(2,b.s.r),ee.write_shift(2,b.e.c),ee.write_shift(2,b.e.r),ee}function d(b,ee,G){var H=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(H[0].c=b.read_shift(1),H[3]=b.read_shift(1),H[0].r=b.read_shift(2),b.l+=2):(H[2]=b.read_shift(1),H[0].c=b.read_shift(2),H[0].r=b.read_shift(2)),H}function h(b,ee,G){var H=b.l+ee,me=d(b,ee,G);if(me[1].t="s",G.vers==20768){b.l++;var Me=b.read_shift(1);return me[1].v=b.read_shift(Me,"utf8"),me}return G.qpro&&b.l++,me[1].v=b.read_shift(H-b.l,"cstr"),me}function g(b,ee,G){var H=ir(7+G.length);H.write_shift(1,255),H.write_shift(2,ee),H.write_shift(2,b),H.write_shift(1,39);for(var me=0;me<H.length;++me){var Me=G.charCodeAt(me);H.write_shift(1,Me>=128?95:Me)}return H.write_shift(1,0),H}function x(b,ee,G){var H=d(b,ee,G);return H[1].v=b.read_shift(2,"i"),H}function m(b,ee,G){var H=ir(7);return H.write_shift(1,255),H.write_shift(2,ee),H.write_shift(2,b),H.write_shift(2,G,"i"),H}function y(b,ee,G){var H=d(b,ee,G);return H[1].v=b.read_shift(8,"f"),H}function v(b,ee,G){var H=ir(13);return H.write_shift(1,255),H.write_shift(2,ee),H.write_shift(2,b),H.write_shift(8,G,"f"),H}function _(b,ee,G){var H=b.l+ee,me=d(b,ee,G);if(me[1].v=b.read_shift(8,"f"),G.qpro)b.l=H;else{var Me=b.read_shift(2);A(b.slice(b.l,b.l+Me),me),b.l+=Me}return me}function S(b,ee,G){var H=ee&32768;return ee&=-32769,ee=(H?b:0)+(ee>=8192?ee-16384:ee),(H?"":"$")+(G?sr(ee):Sr(ee))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function A(b,ee){yr(b,0);for(var G=[],H=0,me="",Me="",Fe="",be="";b.l<b.length;){var De=b[b.l++];switch(De){case 0:G.push(b.read_shift(8,"f"));break;case 1:Me=S(ee[0].c,b.read_shift(2),!0),me=S(ee[0].r,b.read_shift(2),!1),G.push(Me+me);break;case 2:{var ne=S(ee[0].c,b.read_shift(2),!0),z=S(ee[0].r,b.read_shift(2),!1);Me=S(ee[0].c,b.read_shift(2),!0),me=S(ee[0].r,b.read_shift(2),!1),G.push(ne+z+":"+Me+me)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(b.read_shift(2));break;case 6:{for(var Le="";De=b[b.l++];)Le+=String.fromCharCode(De);G.push('"'+Le.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:be=G.pop(),Fe=G.pop(),G.push(["AND","OR"][De-20]+"("+Fe+","+be+")");break;default:if(De<32&&C[De])be=G.pop(),Fe=G.pop(),G.push(Fe+C[De]+be);else if(T[De]){if(H=T[De][1],H==69&&(H=b[b.l++]),H>G.length){console.error("WK1 bad formula parse 0x"+De.toString(16)+":|"+G.join("|")+"|");return}var E=G.slice(-H);G.length-=H,G.push(T[De][0]+"("+E.join(",")+")")}else return De<=7?console.error("WK1 invalid opcode "+De.toString(16)):De<=24?console.error("WK1 unsupported op "+De.toString(16)):De<=30?console.error("WK1 invalid opcode "+De.toString(16)):De<=115?console.error("WK1 unsupported function opcode "+De.toString(16)):console.error("WK1 unrecognized opcode "+De.toString(16))}}G.length==1?ee[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function P(b){var ee=[{c:0,r:0},{t:"n",v:0},0];return ee[0].r=b.read_shift(2),ee[3]=b[b.l++],ee[0].c=b[b.l++],ee}function N(b,ee){var G=P(b);return G[1].t="s",G[1].v=b.read_shift(ee-4,"cstr"),G}function O(b,ee,G,H){var me=ir(6+H.length);me.write_shift(2,b),me.write_shift(1,G),me.write_shift(1,ee),me.write_shift(1,39);for(var Me=0;Me<H.length;++Me){var Fe=H.charCodeAt(Me);me.write_shift(1,Fe>=128?95:Fe)}return me.write_shift(1,0),me}function V(b,ee){var G=P(b);G[1].v=b.read_shift(2);var H=G[1].v>>1;if(G[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return G[1].v=H,G}function B(b,ee){var G=P(b),H=b.read_shift(4),me=b.read_shift(4),Me=b.read_shift(2);if(Me==65535)return H===0&&me===3221225472?(G[1].t="e",G[1].v=15):H===0&&me===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var Fe=Me&32768;return Me=(Me&32767)-16446,G[1].v=(1-Fe*2)*(me*Math.pow(2,Me+32)+H*Math.pow(2,Me)),G}function te(b,ee,G,H){var me=ir(14);if(me.write_shift(2,b),me.write_shift(1,G),me.write_shift(1,ee),H==0)return me.write_shift(4,0),me.write_shift(4,0),me.write_shift(2,65535),me;var Me=0,Fe=0,be=0,De=0;return H<0&&(Me=1,H=-H),Fe=Math.log2(H)|0,H/=Math.pow(2,Fe-31),De=H>>>0,(De&2147483648)==0&&(H/=2,++Fe,De=H>>>0),H-=De,De|=2147483648,De>>>=0,H*=Math.pow(2,32),be=H>>>0,me.write_shift(4,be),me.write_shift(4,De),Fe+=16383+(Me?32768:0),me.write_shift(2,Fe),me}function ie(b,ee){var G=B(b);return b.l+=ee-14,G}function D(b,ee){var G=P(b),H=b.read_shift(4);return G[1].v=H>>6,G}function J(b,ee){var G=P(b),H=b.read_shift(8,"f");return G[1].v=H,G}function F(b,ee){var G=J(b);return b.l+=ee-10,G}function se(b,ee){return b[b.l+ee-1]==0?b.read_shift(ee,"cstr"):""}function Ee(b,ee){var G=b[b.l++];G>ee-1&&(G=ee-1);for(var H="";H.length<G;)H+=String.fromCharCode(b[b.l++]);return H}function le(b,ee,G){if(!(!G.qpro||ee<21)){var H=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var me=b.read_shift(ee-21,"cstr");return[H,me]}}function xe(b,ee){for(var G={},H=b.l+ee;b.l<H;){var me=b.read_shift(2);if(me==14e3){for(G[me]=[0,""],G[me][0]=b.read_shift(2);b[b.l];)G[me][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return G}function X(b,ee){var G=ir(5+b.length);G.write_shift(2,14e3),G.write_shift(2,ee);for(var H=0;H<b.length;++H){var me=b.charCodeAt(H);G[G.l++]=me>127?95:me}return G[G.l++]=0,G}var pe={0:{n:"BOF",f:er},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:se},222:{n:"SHEETNAMELP",f:Ee},65535:{n:""}},R={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:N},23:{n:"NUMBER17",f:B},24:{n:"NUMBER18",f:V},25:{n:"FORMULA19",f:ie},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:xe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:J},40:{n:"FORMULA28",f:F},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}})();function ZC(r){var e={},t=r.match(Ir),n=0,i=!1;if(t)for(;n!=t.length;++n){var s=lt(t[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=ud[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var qC=(function(){var r=xl("t"),e=xl("rPr");function t(s){var o=s.match(r);if(!o)return{t:"s",v:""};var c={t:"s",v:St(o[1])},u=s.match(e);return u&&(c.s=ZC(u[1])),c}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(t).filter(function(c){return c.v})}})(),JC=(function(){var e=/(\r\n|\n)/g;function t(i,s,o){var c=[];i.u&&c.push("text-decoration: underline;"),i.uval&&c.push("text-underline-style:"+i.uval+";"),i.sz&&c.push("font-size:"+i.sz+"pt;"),i.outline&&c.push("text-effect: outline;"),i.shadow&&c.push("text-shadow: auto;"),s.push('<span style="'+c.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var u=i.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(s.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&t(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}})(),QC=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,eT=/<(?:\w+:)?r>/,tT=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Ad(r,e){var t=e?e.cellHTML:!0,n={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=St(Pt(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Pt(r),t&&(n.h=xd(n.t))):r.match(eT)&&(n.r=Pt(r),n.t=St(Pt((r.replace(tT,"").match(QC)||[]).join("").replace(Ir,""))),t&&(n.h=JC(qC(n.r)))),n):{t:""}}var rT=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,nT=/<(?:\w+:)?(?:si|sstItem)>/g,iT=/<\/(?:\w+:)?(?:si|sstItem)>/;function sT(r,e){var t=[],n="";if(!r)return t;var i=r.match(rT);if(i){n=i[2].replace(nT,"").split(iT);for(var s=0;s!=n.length;++s){var o=Ad(n[s].trim(),e);o!=null&&(t[t.length]=o)}i=lt(i[1]),t.Count=i.count,t.Unique=i.uniqueCount}return t}function aT(r){return[r.read_shift(4),r.read_shift(4)]}function oT(r,e){var t=[],n=!1;return Xi(r,function(s,o,c){switch(c){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t}function Uv(r){for(var e=[],t=r.split(""),n=0;n<t.length;++n)e[n]=t[n].charCodeAt(0);return e}function Li(r,e){var t={};return t.Major=r.read_shift(2),t.Minor=r.read_shift(2),e>=4&&(r.l+=e-4),t}function lT(r){var e={};return e.id=r.read_shift(0,"lpp4"),e.R=Li(r,4),e.U=Li(r,4),e.W=Li(r,4),e}function cT(r){for(var e=r.read_shift(4),t=r.l+e-4,n={},i=r.read_shift(4),s=[];i-- >0;)s.push({t:r.read_shift(4),v:r.read_shift(0,"lpp4")});if(n.name=r.read_shift(0,"lpp4"),n.comps=s,r.l!=t)throw new Error("Bad DataSpaceMapEntry: "+r.l+" != "+t);return n}function uT(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(cT(r));return e}function hT(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(r.read_shift(0,"lpp4"));return e}function fT(r){var e={};return r.read_shift(4),r.l+=4,e.id=r.read_shift(0,"lpp4"),e.name=r.read_shift(0,"lpp4"),e.R=Li(r,4),e.U=Li(r,4),e.W=Li(r,4),e}function dT(r){var e=fT(r);if(e.ename=r.read_shift(0,"8lpp4"),e.blksz=r.read_shift(4),e.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function Vv(r,e){var t=r.l+e,n={};n.Flags=r.read_shift(4)&63,r.l+=4,n.AlgID=r.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=r.read_shift(4),n.KeySize=r.read_shift(4),n.ProviderType=r.read_shift(4),r.l+=8,n.CSPName=r.read_shift(t-r.l>>1,"utf16le"),r.l=t,n}function Wv(r,e){var t={},n=r.l+e;return r.l+=4,t.Salt=r.slice(r.l,r.l+16),r.l+=16,t.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),t.VerifierHash=r.slice(r.l,n),r.l=n,t}function gT(r){var e=Li(r);switch(e.Minor){case 2:return[e.Minor,pT(r)];case 3:return[e.Minor,mT()];case 4:return[e.Minor,xT(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function pT(r){var e=r.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var t=r.read_shift(4),n=Vv(r,t),i=Wv(r,r.length-r.l);return{t:"Std",h:n,v:i}}function mT(){throw new Error("File is password-protected: ECMA-376 Extensible")}function xT(r){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];r.l+=4;var t=r.read_shift(r.length-r.l,"utf8"),n={};return t.replace(Ir,function(s){var o=lt(s);switch(mi(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){n[c]=o[c]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function vT(r,e){var t={},n=t.EncryptionVersionInfo=Li(r,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=r.read_shift(4),e-=4;var i=r.read_shift(4);return e-=4,t.EncryptionHeader=Vv(r,i),e-=i,t.EncryptionVerifier=Wv(r,e),t}function yT(r){var e={},t=e.EncryptionVersionInfo=Li(r,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return e.Salt=r.read_shift(16),e.EncryptedVerifier=r.read_shift(16),e.EncryptedVerifierHash=r.read_shift(16),e}function _T(r){var e=0,t,n=Uv(r),i=n.length+1,s,o,c,u,d;for(t=ks(i),t[0]=n.length,s=1;s!=i;++s)t[s]=n[s-1];for(s=i-1;s>=0;--s)o=t[s],c=(e&16384)===0?0:1,u=e<<1&32767,d=c|u,e=d^o;return e^52811}var Hv=(function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,c){return n(o^c)},s=function(o){for(var c=e[o.length-1],u=104,d=o.length-1;d>=0;--d)for(var h=o[d],g=0;g!=7;++g)h&64&&(c^=t[u]),h*=2,--u;return c};return function(o){for(var c=Uv(o),u=s(c),d=c.length,h=ks(16),g=0;g!=16;++g)h[g]=0;var x,m,y;for((d&1)===1&&(x=u>>8,h[d]=i(r[0],x),--d,x=u&255,m=c[c.length-1],h[d]=i(m,x));d>0;)--d,x=u>>8,h[d]=i(c[d],x),--d,x=u&255,h[d]=i(c[d],x);for(d=15,y=15-c.length;y>0;)x=u>>8,h[d]=i(r[y],x),--d,--y,x=u&255,h[d]=i(c[d],x),--d,--y;return h}})(),wT=function(r,e,t,n,i){i||(i=e),n||(n=Hv(r));var s,o;for(s=0;s!=e.length;++s)o=e[s],o^=n[t],o=(o>>5|o<<3)&255,i[s]=o,++t;return[i,t,n]},ST=function(r){var e=0,t=Hv(r);return function(n){var i=wT("",n,e,t);return e=i[1],i[0]}};function kT(r,e,t,n){var i={key:er(r),verificationBytes:er(r)};return t.password&&(i.verifier=_T(t.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=ST(t.password)),i}function CT(r,e,t){var n=t||{};return n.Info=r.read_shift(2),r.l-=2,n.Info===1?n.Data=yT(r):n.Data=vT(r,e),n}function TT(r,e,t){var n={Type:t.biff>=8?r.read_shift(2):0};return n.Type?CT(r,e-2,n):kT(r,t.biff>=8?e:e-2,t,n),n}var ET=(function(){function r(i,s){switch(s.type){case"base64":return e(gn(i),s);case"binary":return e(i,s);case"buffer":return e(xt&&Buffer.isBuffer(i)?i.toString("binary"):aa(i),s);case"array":return e(ra(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var o=s||{},c=o.dense?[]:{},u=i.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(h,g){Array.isArray(c)&&(c[g]=[]);for(var x=/\\\w+\b/g,m=0,y,v=-1;y=x.exec(h);){switch(y[0]){case"\\cell":var _=h.slice(m,x.lastIndex-y[0].length);if(_[0]==" "&&(_=_.slice(1)),++v,_.length){var S={v:_,t:"s"};Array.isArray(c)?c[g][v]=S:c[ht({r:g,c:v})]=S}break}m=x.lastIndex}v>d.e.c&&(d.e.c=v)}),c["!ref"]=_t(d),c}function t(i,s){return As(r(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],o=Wt(i["!ref"]),c,u=Array.isArray(i),d=o.s.r;d<=o.e.r;++d){s.push("\\trowd\\trautofit1");for(var h=o.s.c;h<=o.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=o.s.c;h<=o.e.c;++h){var g=ht({r:d,c:h});c=u?(i[d]||[])[h]:i[g],!(!c||c.v==null&&(!c.f||c.F))&&(s.push(" "+(c.w||(zi(c),c.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:n}})();function AT(r){var e=r.slice(r[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function _l(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}function bT(r){var e=r[0]/255,t=r[1]/255,n=r[2]/255,i=Math.max(e,t,n),s=Math.min(e,t,n),o=i-s;if(o===0)return[0,0,e];var c=0,u=0,d=i+s;switch(u=o/(d>1?2-d:d),i){case e:c=((t-n)/o+6)%6;break;case t:c=(n-e)/o+2;break;case n:c=(e-t)/o+4;break}return[c/6,u,d/2]}function FT(r){var e=r[0],t=r[1],n=r[2],i=t*2*(n<.5?n:1-n),s=n-i/2,o=[s,s,s],c=6*e,u;if(t!==0)switch(c|0){case 0:case 6:u=i*c,o[0]+=i,o[1]+=u;break;case 1:u=i*(2-c),o[0]+=u,o[1]+=i;break;case 2:u=i*(c-2),o[1]+=i,o[2]+=u;break;case 3:u=i*(4-c),o[1]+=u,o[2]+=i;break;case 4:u=i*(c-4),o[2]+=i,o[0]+=u;break;case 5:u=i*(6-c),o[2]+=u,o[0]+=i;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function $u(r,e){if(e===0)return r;var t=bT(AT(r));return e<0?t[2]=t[2]*(1+e):t[2]=1-(1-t[2])*(1-e),_l(FT(t))}var Xv=6,OT=15,DT=1,zr=Xv;function Ku(r){return Math.floor((r+Math.round(128/zr)/256)*zr)}function Zu(r){return Math.floor((r-5)/zr*100+.5)/100}function Vf(r){return Math.round((r*zr+5)/zr*256)/256}function pf(r){return Vf(Zu(Ku(r)))}function bd(r){var e=Math.abs(r-pf(r)),t=zr;if(e>.005)for(zr=DT;zr<OT;++zr)Math.abs(r-pf(r))<=e&&(e=Math.abs(r-pf(r)),t=zr);zr=t}function Ja(r){r.width?(r.wpx=Ku(r.width),r.wch=Zu(r.wpx),r.MDW=zr):r.wpx?(r.wch=Zu(r.wpx),r.width=Vf(r.wch),r.MDW=zr):typeof r.wch=="number"&&(r.width=Vf(r.wch),r.wpx=Ku(r.width),r.MDW=zr),r.customWidth&&delete r.customWidth}var PT=96,Gv=PT;function Yv(r){return r*96/Gv}function wl(r){return r*Gv/96}var MT={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function NT(r,e,t,n){e.Borders=[];var i={},s=!1;(r[0].match(Ir)||[]).forEach(function(o){var c=lt(o);switch(mi(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},c.diagonalUp&&(i.diagonalUp=Lt(c.diagonalUp)),c.diagonalDown&&(i.diagonalDown=Lt(c.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+c[0]+" in borders")}})}function IT(r,e,t,n){e.Fills=[];var i={},s=!1;(r[0].match(Ir)||[]).forEach(function(o){var c=lt(o);switch(mi(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":c.patternType&&(i.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),c.indexed&&(i.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(i.bgColor.theme=parseInt(c.theme,10)),c.tint&&(i.bgColor.tint=parseFloat(c.tint)),c.rgb&&(i.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),c.theme&&(i.fgColor.theme=parseInt(c.theme,10)),c.tint&&(i.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(i.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fills")}})}function RT(r,e,t,n){e.Fonts=[];var i={},s=!1;(r[0].match(Ir)||[]).forEach(function(o){var c=lt(o);switch(mi(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":c.val&&(i.name=Pt(c.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=c.val?Lt(c.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=c.val?Lt(c.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(c.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=c.val?Lt(c.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=c.val?Lt(c.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=c.val?Lt(c.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=c.val?Lt(c.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=c.val?Lt(c.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":c.val&&(i.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(i.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(i.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(i.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=ud[parseInt(c.val,10)];break;case"<color":if(i.color||(i.color={}),c.auto&&(i.color.auto=Lt(c.auto)),c.rgb)i.color.rgb=c.rgb.slice(-6);else if(c.indexed){i.color.index=parseInt(c.indexed,10);var u=Qs[i.color.index];i.color.index==81&&(u=Qs[1]),u||(u=Qs[1]),i.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else c.theme&&(i.color.theme=parseInt(c.theme,10),c.tint&&(i.color.tint=parseFloat(c.tint)),c.theme&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=$u(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fonts")}})}function LT(r,e,t){e.NumberFmt=[];for(var n=gi(ft),i=0;i<n.length;++i)e.NumberFmt[n[i]]=ft[n[i]];var s=r[0].match(Ir);if(s)for(i=0;i<s.length;++i){var o=lt(s[i]);switch(mi(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=St(Pt(o.formatCode)),u=parseInt(o.numFmtId,10);if(e.NumberFmt[u]=c,u>0){if(u>392){for(u=392;u>60&&e.NumberFmt[u]!=null;--u);e.NumberFmt[u]=c}Js(c,u)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var ru=["numFmtId","fillId","fontId","borderId","xfId"],nu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function BT(r,e,t){e.CellXf=[];var n,i=!1;(r[0].match(Ir)||[]).forEach(function(s){var o=lt(s),c=0;switch(mi(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],c=0;c<ru.length;++c)n[ru[c]]&&(n[ru[c]]=parseInt(n[ru[c]],10));for(c=0;c<nu.length;++c)n[nu[c]]&&(n[nu[c]]=Lt(n[nu[c]]));if(e.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[c]){n.numFmtId=c;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=Lt(o.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(t&&t.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var jT=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,u,d){var h={};if(!c)return h;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=c.match(e))&&LT(g,h,d),(g=c.match(i))&&RT(g,h,u,d),(g=c.match(n))&&IT(g,h,u,d),(g=c.match(s))&&NT(g,h,u,d),(g=c.match(t))&&BT(g,h,d),h}})();function zT(r,e){var t=r.read_shift(2),n=Pr(r);return[t,n]}function UT(r,e,t){var n={};n.sz=r.read_shift(2)/20;var i=qS(r);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=r.read_shift(2);switch(s===700&&(n.bold=1),r.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=r.read_shift(1);o!=0&&(n.underline=o);var c=r.read_shift(1);c>0&&(n.family=c);var u=r.read_shift(1);switch(u>0&&(n.charset=u),r.l++,n.color=ZS(r),r.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Pr(r),n}var VT=Nr;function WT(r,e){var t=r.l+e,n=r.read_shift(2),i=r.read_shift(2);return r.l=t,{ixfe:n,numFmtId:i}}var HT=Nr;function XT(r,e,t){var n={};n.NumberFmt=[];for(var i in ft)n.NumberFmt[i]=ft[i];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return Xi(r,function(u,d,h){switch(h){case 44:n.NumberFmt[u[0]]=u[1],Js(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(u.color.rgb=$u(e.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(h),o=!0;break;case 38:s.pop(),o=!1;break;default:if(d.T>0)s.push(h);else if(d.T<0)s.pop();else if(!o||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}var GT=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function YT(r,e,t){e.themeElements.clrScheme=[];var n={};(r[0].match(Ir)||[]).forEach(function(i){var s=lt(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[GT.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function $T(){}function KT(){}var ZT=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,qT=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,JT=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function QT(r,e,t){e.themeElements={};var n;[["clrScheme",ZT,YT],["fontScheme",qT,$T],["fmtScheme",JT,KT]].forEach(function(i){if(!(n=r.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,t)})}var eE=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function $v(r,e){(!r||r.length===0)&&(r=tE());var t,n={};if(!(t=r.match(eE)))throw new Error("themeElements not found in theme");return QT(t[0],n,e),n.raw=r,n}function tE(r,e){var t=[sv];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function rE(r,e,t){var n=r.l+e,i=r.read_shift(4);if(i!==124226){if(!t.cellStyles){r.l=n;return}var s=r.slice(r.l);r.l=n;var o;try{o=iv(s,{type:"array"})}catch{return}var c=fn(o,"theme/theme/theme1.xml",!0);if(c)return $v(c,t)}}function nE(r){return r.read_shift(4)}function iE(r){var e={};switch(e.xclrType=r.read_shift(2),e.nTintShade=r.read_shift(2),e.xclrType){case 0:r.l+=4;break;case 1:e.xclrValue=sE(r,4);break;case 2:e.xclrValue=Nv(r);break;case 3:e.xclrValue=nE(r);break;case 4:r.l+=4;break}return r.l+=8,e}function sE(r,e){return Nr(r,e)}function aE(r,e){return Nr(r,e)}function oE(r){var e=r.read_shift(2),t=r.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=iE(r);break;case 6:n[1]=aE(r,t);break;case 14:case 15:n[1]=r.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+t)}return n}function lE(r,e){var t=r.l+e;r.l+=2;var n=r.read_shift(2);r.l+=2;for(var i=r.read_shift(2),s=[];i-- >0;)s.push(oE(r,t-r.l));return{ixfe:n,ext:s}}function cE(r,e){e.forEach(function(t){t[0]})}function uE(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:Pr(r)}}function hE(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function fE(r){return r.l+=4,r.read_shift(4)!=0}function dE(r,e,t){var n={Types:[],Cell:[],Value:[]},i=t||{},s=[],o=!1,c=2;return Xi(r,function(u,d,h){switch(h){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(g){c==1?n.Cell.push({type:n.Types[g[0]-1].name,index:g[1]}):c==0&&n.Value.push({type:n.Types[g[0]-1].name,index:g[1]})});break;case 337:c=u?1:0;break;case 338:c=2;break;case 35:s.push(h),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!d.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function gE(r,e,t){var n={Types:[],Cell:[],Value:[]};if(!r)return n;var i=!1,s=2,o;return r.replace(Ir,function(c){var u=lt(c);switch(mi(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==u.name&&(o=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):s==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!i&&t.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return c}),n}function pE(r){var e=[];if(!r)return e;var t=1;return(r.match(Ir)||[]).forEach(function(n){var i=lt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?t=i.i:i.i=t,e.push(i);break}}),e}function mE(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=ht(t);var n=r.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function xE(r,e,t){var n=[];return Xi(r,function(s,o,c){switch(c){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function vE(r,e,t,n){if(!r)return r;var i=n||{},s=!1;Xi(r,function(c,u,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!u.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},i)}function yE(r,e){if(!r)return"??";var t=(r.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][t].Target}function k1(r,e,t,n){var i=Array.isArray(r),s;e.forEach(function(o){var c=Vr(o.ref);if(i?(r[c.r]||(r[c.r]=[]),s=r[c.r][c.c]):s=r[o.ref],!s){s={t:"z"},i?r[c.r][c.c]=s:r[o.ref]=s;var u=Wt(r["!ref"]||"BDWGO1000001:A1");u.s.r>c.r&&(u.s.r=c.r),u.e.r<c.r&&(u.e.r=c.r),u.s.c>c.c&&(u.s.c=c.c),u.e.c<c.c&&(u.e.c=c.c);var d=_t(u);d!==r["!ref"]&&(r["!ref"]=d)}s.c||(s.c=[]);var h={a:o.author,t:o.t,r:o.r,T:t};o.h&&(h.h=o.h);for(var g=s.c.length-1;g>=0;--g){if(!t&&s.c[g].T)return;t&&!s.c[g].T&&s.c.splice(g,1)}if(t&&n){for(g=0;g<n.length;++g)if(h.a==n[g].id){h.a=n[g].name||h.a;break}}s.c.push(h)})}function _E(r,e){if(r.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],i=r.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&t.push(c[1])}});var s=r.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?comment[^>]*>/);if(c){var u=lt(c[0]),d={author:u.authorId&&t[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},h=Vr(u.ref);if(!(e.sheetRows&&e.sheetRows<=h.r)){var g=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!g&&!!g[1]&&Ad(g[1])||{r:"",t:"",h:""};d.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),d.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=x.h),n.push(d)}}}}),n}function wE(r,e){var t=[],n=!1,i={},s=0;return r.replace(Ir,function(c,u){var d=lt(c);switch(mi(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":i.t!=null&&t.push(i);break;case"<text>":case"<text":s=u+c.length;break;case"</text>":i.t=r.slice(s,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return c}),t}function SE(r,e){var t=[],n=!1;return r.replace(Ir,function(s){var o=lt(s);switch(mi(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),t}function kE(r){var e={};e.iauthor=r.read_shift(4);var t=la(r);return e.rfx=t.s,e.ref=ht(t.s),r.l+=16,e}var CE=Pr;function TE(r,e){var t=[],n=[],i={},s=!1;return Xi(r,function(c,u,d){switch(d){case 632:n.push(c);break;case 635:i=c;break;case 637:i.t=c.t,i.h=c.h,i.r=c.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,t.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),t}var EE="application/vnd.ms-office.vbaProject";function AE(r){var e=yt.utils.cfb_new({root:"R"});return r.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var i=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");yt.utils.cfb_add(e,i,r.FileIndex[n].content)}}),yt.write(e)}function bE(){return{"!type":"dialog"}}function FE(){return{"!type":"dialog"}}function OE(){return{"!type":"macro"}}function DE(){return{"!type":"macro"}}var Ga=(function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(n,i,s,o){var c=!1,u=!1;s.length==0?u=!0:s.charAt(0)=="["&&(u=!0,s=s.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var d=s.length>0?parseInt(s,10)|0:0,h=o.length>0?parseInt(o,10)|0:0;return c?h+=e.c:--h,u?d+=e.r:--d,i+(c?"":"$")+sr(h)+(u?"":"$")+Sr(d)}return function(i,s){return e=s,i.replace(r,t)}})(),Kv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,PE=(function(){return function(e,t){return e.replace(Kv,function(n,i,s,o,c,u){var d=wd(o)-(s?0:t.c),h=_d(u)-(c?0:t.r),g=h==0?"":c?h+1:"["+h+"]",x=d==0?"":s?d+1:"["+d+"]";return i+"R"+g+"C"+x})}})();function Zv(r,e){return r.replace(Kv,function(t,n,i,s,o,c){return n+(i=="$"?i+s:sr(wd(s)+e.c))+(o=="$"?o+c:Sr(_d(c)+e.r))})}function ME(r,e,t){var n=to(e),i=n.s,s=Vr(t),o={r:s.r-i.r,c:s.c-i.c};return Zv(r,o)}function NE(r){return r.length!=1}function C1(r){return r.replace(/_xlfn\./g,"")}function Jt(r){r.l+=1}function Cs(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function qv(r,e,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return Jv(r);t.biff==12&&(n=4)}var i=r.read_shift(n),s=r.read_shift(n),o=Cs(r),c=Cs(r);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function Jv(r){var e=Cs(r),t=Cs(r),n=r.read_shift(1),i=r.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function IE(r,e,t){if(t.biff<8)return Jv(r);var n=r.read_shift(t.biff==12?4:2),i=r.read_shift(t.biff==12?4:2),s=Cs(r),o=Cs(r);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Qv(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return RE(r);var n=r.read_shift(t&&t.biff==12?4:2),i=Cs(r);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function RE(r){var e=Cs(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function LE(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function BE(r,e,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return jE(r);var i=r.read_shift(n>=12?4:2),s=r.read_shift(2),o=(s&16384)>>14,c=(s&32768)>>15;if(s&=16383,c==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:c}}function jE(r){var e=r.read_shift(2),t=r.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:n}}function zE(r,e,t){var n=(r[r.l++]&96)>>5,i=qv(r,t.biff>=2&&t.biff<=5?6:8,t);return[n,i]}function UE(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}var o=qv(r,s,t);return[n,i,o]}function VE(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function WE(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}return r.l+=s,[n,i]}function HE(r,e,t){var n=(r[r.l++]&96)>>5,i=IE(r,e-1,t);return[n,i]}function XE(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[n]}function T1(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function GE(r,e,t){r.l+=2;for(var n=r.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(r.read_shift(t&&t.biff==2?1:2));return i}function YE(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function $E(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function KE(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function ZE(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[n]}function ey(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function qE(r){return r.read_shift(2),ey(r)}function JE(r){return r.read_shift(2),ey(r)}function QE(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=Qv(r,0,t);return[n,i]}function e4(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=BE(r,0,t);return[n,i]}function t4(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var s=Qv(r,0,t);return[n,i,s]}function r4(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(t&&t.biff<=3?1:2);return[n3[i],ny[i],n]}function n4(r,e,t){var n=r[r.l++],i=r.read_shift(1),s=t&&t.biff<=3?[n==88?-1:0,r.read_shift(1)]:i4(r);return[i,(s[0]===0?ny:r3)[s[1]]]}function i4(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function s4(r,e,t){r.l+=t&&t.biff==2?3:4}function a4(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var n=r.read_shift(2),i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function o4(r){return r.l++,ca[r.read_shift(1)]}function l4(r){return r.l++,r.read_shift(2)}function c4(r){return r.l++,r.read_shift(1)!==0}function u4(r){return r.l++,Or(r)}function h4(r,e,t){return r.l++,Dl(r,e-1,t)}function f4(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=$t(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=ca[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=Or(r);break;case 2:t[1]=ua(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function d4(r,e,t){for(var n=r.read_shift(t.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((t.biff==12?la:hh)(r));return i}function g4(r,e,t){var n=0,i=0;t.biff==12?(n=r.read_shift(4),i=r.read_shift(4)):(i=1+r.read_shift(1),n=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--i==0&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var c=0;c!=i;++c)o[s][c]=f4(r,t.biff);return o}function p4(r,e,t){var n=r.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=r.read_shift(i);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[n,0,s]}function m4(r,e,t){if(t.biff==5)return x4(r);var n=r.read_shift(1)>>>5&3,i=r.read_shift(2),s=r.read_shift(4);return[n,i,s]}function x4(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var n=r.read_shift(2);return r.l+=12,[e,t,n]}function v4(r,e,t){var n=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function y4(r,e,t){var n=r.read_shift(1)>>>5&3,i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function _4(r,e,t){var n=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[n]}function w4(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return r.l+=s,[n,i]}var S4=Nr,k4=Nr,C4=Nr;function Ml(r,e,t){return r.l+=2,[LE(r)]}function Fd(r){return r.l+=6,[]}var T4=Ml,E4=Fd,A4=Fd,b4=Ml;function ty(r){return r.l+=2,[er(r),r.read_shift(2)&1]}var F4=Ml,O4=ty,D4=Fd,P4=Ml,M4=Ml,N4=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function I4(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),i=r.read_shift(2),s=r.read_shift(2),o=N4[t>>2&31];return{ixti:e,coltype:t&3,rt:o,idx:n,c:i,C:s}}function R4(r){return r.l+=2,[r.read_shift(4)]}function L4(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function B4(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function j4(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function z4(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function U4(r){return r.l+=4,[0,0]}var E1={1:{n:"PtgExp",f:a4},2:{n:"PtgTbl",f:C4},3:{n:"PtgAdd",f:Jt},4:{n:"PtgSub",f:Jt},5:{n:"PtgMul",f:Jt},6:{n:"PtgDiv",f:Jt},7:{n:"PtgPower",f:Jt},8:{n:"PtgConcat",f:Jt},9:{n:"PtgLt",f:Jt},10:{n:"PtgLe",f:Jt},11:{n:"PtgEq",f:Jt},12:{n:"PtgGe",f:Jt},13:{n:"PtgGt",f:Jt},14:{n:"PtgNe",f:Jt},15:{n:"PtgIsect",f:Jt},16:{n:"PtgUnion",f:Jt},17:{n:"PtgRange",f:Jt},18:{n:"PtgUplus",f:Jt},19:{n:"PtgUminus",f:Jt},20:{n:"PtgPercent",f:Jt},21:{n:"PtgParen",f:Jt},22:{n:"PtgMissArg",f:Jt},23:{n:"PtgStr",f:h4},26:{n:"PtgSheet",f:L4},27:{n:"PtgEndSheet",f:B4},28:{n:"PtgErr",f:o4},29:{n:"PtgBool",f:c4},30:{n:"PtgInt",f:l4},31:{n:"PtgNum",f:u4},32:{n:"PtgArray",f:XE},33:{n:"PtgFunc",f:r4},34:{n:"PtgFuncVar",f:n4},35:{n:"PtgName",f:p4},36:{n:"PtgRef",f:QE},37:{n:"PtgArea",f:zE},38:{n:"PtgMemArea",f:v4},39:{n:"PtgMemErr",f:S4},40:{n:"PtgMemNoMem",f:k4},41:{n:"PtgMemFunc",f:y4},42:{n:"PtgRefErr",f:_4},43:{n:"PtgAreaErr",f:VE},44:{n:"PtgRefN",f:e4},45:{n:"PtgAreaN",f:HE},46:{n:"PtgMemAreaN",f:j4},47:{n:"PtgMemNoMemN",f:z4},57:{n:"PtgNameX",f:m4},58:{n:"PtgRef3d",f:t4},59:{n:"PtgArea3d",f:UE},60:{n:"PtgRefErr3d",f:w4},61:{n:"PtgAreaErr3d",f:WE},255:{}},V4={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},W4={1:{n:"PtgElfLel",f:ty},2:{n:"PtgElfRw",f:P4},3:{n:"PtgElfCol",f:T4},6:{n:"PtgElfRwV",f:M4},7:{n:"PtgElfColV",f:b4},10:{n:"PtgElfRadical",f:F4},11:{n:"PtgElfRadicalS",f:D4},13:{n:"PtgElfColS",f:E4},15:{n:"PtgElfColSV",f:A4},16:{n:"PtgElfRadicalLel",f:O4},25:{n:"PtgList",f:I4},29:{n:"PtgSxName",f:R4},255:{}},H4={0:{n:"PtgAttrNoop",f:U4},1:{n:"PtgAttrSemi",f:ZE},2:{n:"PtgAttrIf",f:$E},4:{n:"PtgAttrChoose",f:GE},8:{n:"PtgAttrGoto",f:YE},16:{n:"PtgAttrSum",f:s4},32:{n:"PtgAttrBaxcel",f:T1},33:{n:"PtgAttrBaxcel",f:T1},64:{n:"PtgAttrSpace",f:qE},65:{n:"PtgAttrSpaceSemi",f:JE},128:{n:"PtgAttrIfError",f:KE},255:{}};function Nl(r,e,t,n){if(n.biff<8)return Nr(r,e);for(var i=r.l+e,s=[],o=0;o!==t.length;++o)switch(t[o][0]){case"PtgArray":t[o][1]=g4(r,0,n),s.push(t[o][1]);break;case"PtgMemArea":t[o][2]=d4(r,t[o][1],n),s.push(t[o][2]);break;case"PtgExp":n&&n.biff==12&&(t[o][1][1]=r.read_shift(4),s.push(t[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[o][0]}return e=i-r.l,e!==0&&s.push(Nr(r,e)),s}function Il(r,e,t){for(var n=r.l+e,i,s,o=[];n!=r.l;)e=n-r.l,s=r[r.l],i=E1[s]||E1[V4[s]],(s===24||s===25)&&(i=(s===24?W4:H4)[r[r.l+1]]),!i||!i.f?Nr(r,e):o.push([i.n,i.f(r,e,t)]);return o}function X4(r){for(var e=[],t=0;t<r.length;++t){for(var n=r[t],i=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var G4={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Y4(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function ry(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var n=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(t.biff>8)switch(r[n[0]][0]){case 357:return i=n[1]==-1?"#REF":r.SheetNames[n[1]],n[1]==n[2]?i:i+":"+r.SheetNames[n[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[n[0]][0];case 355:default:return"SH33TJSSRC"+r[n[0]][0]}switch(r[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":r.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+r.SheetNames[n[2]];case 14849:return r[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return r[n[0]][0][3]?(i=n[1]==-1?"#REF":r[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+r[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function A1(r,e,t){var n=ry(r,e,t);return n=="#REF"?n:Y4(n,t)}function Fr(r,e,t,n,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},c=[],u,d,h,g=0,x=0,m,y="";if(!r[0]||!r[0][0])return"";for(var v=-1,_="",S=0,T=r[0].length;S<T;++S){var C=r[0][S];switch(C[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=c.pop(),d=c.pop(),v>=0){switch(r[0][v][1][0]){case 0:_=Vt(" ",r[0][v][1][1]);break;case 1:_=Vt("\r",r[0][v][1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][v][1][0])}d=d+_,v=-1}c.push(d+G4[C[0]]+u);break;case"PtgIsect":u=c.pop(),d=c.pop(),c.push(d+" "+u);break;case"PtgUnion":u=c.pop(),d=c.pop(),c.push(d+","+u);break;case"PtgRange":u=c.pop(),d=c.pop(),c.push(d+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=rl(C[1][1],o,i),c.push(nl(h,s));break;case"PtgRefN":h=t?rl(C[1][1],t,i):C[1][1],c.push(nl(h,s));break;case"PtgRef3d":g=C[1][1],h=rl(C[1][2],o,i),y=A1(n,g,i),c.push(y+"!"+nl(h,s));break;case"PtgFunc":case"PtgFuncVar":var A=C[1][0],P=C[1][1];A||(A=0),A&=127;var N=A==0?[]:c.slice(-A);c.length-=A,P==="User"&&(P=N.shift()),c.push(P+"("+N.join(",")+")");break;case"PtgBool":c.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(C[1]);break;case"PtgNum":c.push(String(C[1]));break;case"PtgStr":c.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(C[1]);break;case"PtgAreaN":m=o1(C[1][1],t?{s:t}:o,i),c.push(df(m,i));break;case"PtgArea":m=o1(C[1][1],o,i),c.push(df(m,i));break;case"PtgArea3d":g=C[1][1],m=C[1][2],y=A1(n,g,i),c.push(y+"!"+df(m,i));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=C[1][2];var O=(n.names||[])[x-1]||(n[0]||[])[x],V=O?O.Name:"SH33TJSNAME"+String(x);V&&V.slice(0,6)=="_xlfn."&&!i.xlfn&&(V=V.slice(6)),c.push(V);break;case"PtgNameX":var B=C[1][1];x=C[1][2];var te;if(i.biff<=5)B<0&&(B=-B),n[B]&&(te=n[B][x]);else{var ie="";if(((n[B]||[])[0]||[])[0]==14849||(((n[B]||[])[0]||[])[0]==1025?n[B][x]&&n[B][x].itab>0&&(ie=n.SheetNames[n[B][x].itab-1]+"!"):ie=n.SheetNames[x-1]+"!"),n[B]&&n[B][x])ie+=n[B][x].Name;else if(n[0]&&n[0][x])ie+=n[0][x].Name;else{var D=(ry(n,B,i)||"").split(";;");D[x-1]?ie=D[x-1]:ie+="SH33TJSERRX"}c.push(ie);break}te||(te={Name:"SH33TJSERRY"}),c.push(te.Name);break;case"PtgParen":var J="(",F=")";if(v>=0){switch(_="",r[0][v][1][0]){case 2:J=Vt(" ",r[0][v][1][1])+J;break;case 3:J=Vt("\r",r[0][v][1][1])+J;break;case 4:F=Vt(" ",r[0][v][1][1])+F;break;case 5:F=Vt("\r",r[0][v][1][1])+F;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][v][1][0])}v=-1}c.push(J+c.pop()+F);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":h={c:C[1][1],r:C[1][0]};var se={c:t.c,r:t.r};if(n.sharedf[ht(h)]){var Ee=n.sharedf[ht(h)];c.push(Fr(Ee,o,se,n,i))}else{var le=!1;for(u=0;u!=n.arrayf.length;++u)if(d=n.arrayf[u],!(h.c<d[0].s.c||h.c>d[0].e.c)&&!(h.r<d[0].s.r||h.r>d[0].e.r)){c.push(Fr(d[1],o,se,n,i)),le=!0;break}le||c.push(C[1])}break;case"PtgArray":c.push("{"+X4(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var xe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&v>=0&&xe.indexOf(r[0][S][0])==-1){C=r[0][v];var X=!0;switch(C[1][0]){case 4:X=!1;case 0:_=Vt(" ",C[1][1]);break;case 5:X=!1;case 1:_=Vt("\r",C[1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}c.push((X?_:"")+c.pop()+(X?"":_)),v=-1}}if(c.length>1&&i.WTF)throw new Error("bad formula stack");return c[0]}function $4(r,e,t){var n=r.l+e,i=t.biff==2?1:2,s,o=r.read_shift(i);if(o==65535)return[[],Nr(r,e-2)];var c=Il(r,o,t);return e!==o+i&&(s=Nl(r,e-o-i,c,t)),r.l=n,[c,s]}function K4(r,e,t){var n=r.l+e,i=t.biff==2?1:2,s,o=r.read_shift(i);if(o==65535)return[[],Nr(r,e-2)];var c=Il(r,o,t);return e!==o+i&&(s=Nl(r,e-o-i,c,t)),r.l=n,[c,s]}function Z4(r,e,t,n){var i=r.l+e,s=Il(r,n,t),o;return i!==r.l&&(o=Nl(r,i-r.l,s,t)),[s,o]}function q4(r,e,t){var n=r.l+e,i,s=r.read_shift(2),o=Il(r,s,t);return s==65535?[[],Nr(r,e-2)]:(e!==s+2&&(i=Nl(r,n-s-2,o,t)),[o,i])}function J4(r){var e;if(Mi(r,r.l+6)!==65535)return[Or(r),"n"];switch(r[r.l]){case 0:return r.l+=8,["String","s"];case 1:return e=r[r.l+2]===1,r.l+=8,[e,"b"];case 2:return e=r[r.l+2],r.l+=8,[e,"e"];case 3:return r.l+=8,["","s"]}return[]}function mf(r,e,t){var n=r.l+e,i=xi(r);t.biff==2&&++r.l;var s=J4(r),o=r.read_shift(1);t.biff!=2&&(r.read_shift(1),t.biff>=5&&r.read_shift(4));var c=K4(r,n-r.l,t);return{cell:i,val:s[0],formula:c,shared:o>>3&1,tt:s[1]}}function fh(r,e,t){var n=r.read_shift(4),i=Il(r,n,t),s=r.read_shift(4),o=s>0?Nl(r,s,i,t):null;return[i,o]}var Q4=fh,dh=fh,e3=fh,t3=fh,r3={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ny={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},n3={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function b1(r){return r.slice(0,3)=="of:"&&(r=r.slice(3)),r.charCodeAt(0)==61&&(r=r.slice(1),r.charCodeAt(0)==61&&(r=r.slice(1))),r=r.replace(/COM\.MICROSOFT\./g,""),r=r.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")}),r=r.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),r.replace(/[;~]/g,",").replace(/\|/g,";")}function xf(r){var e=r.split(":"),t=e[0].split(".")[0];return[t,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var ol={},Ya={};function ll(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(t=[1,1,1,1,.5,.5]),r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function iy(r,e,t,n,i,s){try{n.cellNF&&(r.z=ft[e])}catch(c){if(n.WTF)throw c}if(!(r.t==="z"&&!n.cellStyles)){if(r.t==="d"&&typeof r.v=="string"&&(r.v=gr(r.v)),(!n||n.cellText!==!1)&&r.t!=="z")try{if(ft[e]==null&&Js(iS[e]||"General",e),r.t==="e")r.w=r.w||ca[r.v];else if(e===0)if(r.t==="n")(r.v|0)===r.v?r.w=r.v.toString(10):r.w=ml(r.v);else if(r.t==="d"){var o=Hr(r.v);(o|0)===o?r.w=o.toString(10):r.w=ml(o)}else{if(r.v===void 0)return"";r.w=ta(r.v,Ya)}else r.t==="d"?r.w=On(e,Hr(r.v),Ya):r.w=On(e,r.v,Ya)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&t!=null)try{r.s=s.Fills[t],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=$u(i.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),n.WTF&&(r.s.fgColor.raw_rgb=i.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=$u(i.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),n.WTF&&(r.s.bgColor.raw_rgb=i.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&s.Fills)throw c}}}function i3(r,e){var t=Wt(e);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(r["!ref"]=_t(t))}var s3=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,a3=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,o3=/<(?:\w:)?hyperlink [^>]*>/mg,l3=/"(\w*:\w*)"/,c3=/<(?:\w:)?col\b[^>]*[\/]?>/g,u3=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,h3=/<(?:\w:)?pageMargins[^>]*\/>/g,sy=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,f3=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,d3=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function g3(r,e,t,n,i,s,o){if(!r)return r;n||(n={"!id":{}});var c=e.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",h="",g=r.match(a3);g?(d=r.slice(0,g.index),h=r.slice(g.index+g[0].length)):d=h=r;var x=d.match(sy);x?Od(x[0],c,i,t):(x=d.match(f3))&&p3(x[0],x[1]||"",c,i,t);var m=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var y=d.slice(m,m+50).match(l3);y&&i3(c,y[1])}var v=d.match(d3);v&&v[1]&&w3(v[1],i);var _=[];if(e.cellStyles){var S=d.match(c3);S&&v3(_,S)}g&&S3(g[1],c,e,u,s,o);var T=h.match(u3);T&&(c["!autofilter"]=y3(T[0]));var C=[],A=h.match(s3);if(A)for(m=0;m!=A.length;++m)C[m]=Wt(A[m].slice(A[m].indexOf('"')+1));var P=h.match(o3);P&&m3(c,P,n);var N=h.match(h3);if(N&&(c["!margins"]=x3(lt(N[0]))),!c["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(c["!ref"]=_t(u)),e.sheetRows>0&&c["!ref"]){var O=Wt(c["!ref"]);e.sheetRows<=+O.e.r&&(O.e.r=e.sheetRows-1,O.e.r>u.e.r&&(O.e.r=u.e.r),O.e.r<O.s.r&&(O.s.r=O.e.r),O.e.c>u.e.c&&(O.e.c=u.e.c),O.e.c<O.s.c&&(O.s.c=O.e.c),c["!fullref"]=c["!ref"],c["!ref"]=_t(O))}return _.length>0&&(c["!cols"]=_),C.length>0&&(c["!merges"]=C),c}function Od(r,e,t,n){var i=lt(r);t.Sheets[n]||(t.Sheets[n]={}),i.codeName&&(t.Sheets[n].CodeName=St(Pt(i.codeName)))}function p3(r,e,t,n,i){Od(r.slice(0,r.indexOf(">")),t,n,i)}function m3(r,e,t){for(var n=Array.isArray(r),i=0;i!=e.length;++i){var s=lt(Pt(e[i]),!0);if(!s.ref)return;var o=((t||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+St(s.location))):(s.Target="#"+St(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var c=Wt(s.ref),u=c.s.r;u<=c.e.r;++u)for(var d=c.s.c;d<=c.e.c;++d){var h=ht({c:d,r:u});n?(r[u]||(r[u]=[]),r[u][d]||(r[u][d]={t:"z",v:void 0}),r[u][d].l=s):(r[h]||(r[h]={t:"z",v:void 0}),r[h].l=s)}}}function x3(r){var e={};return["left","right","top","bottom","header","footer"].forEach(function(t){r[t]&&(e[t]=parseFloat(r[t]))}),e}function v3(r,e){for(var t=!1,n=0;n!=e.length;++n){var i=lt(e[n],!0);i.hidden&&(i.hidden=Lt(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!t&&i.width&&(t=!0,bd(i.width)),Ja(i);s<=o;)r[s++]=wr(i)}}function y3(r){var e={ref:(r.match(/ref="([^"]*)"/)||[])[1]};return e}var _3=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function w3(r,e){e.Views||(e.Views=[{}]),(r.match(_3)||[]).forEach(function(t,n){var i=lt(t);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),Lt(i.rightToLeft)&&(e.Views[n].RTL=!0)})}var S3=(function(){var r=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=xl("v"),o=xl("f");return function(u,d,h,g,x,m){for(var y=0,v="",_=[],S=[],T=0,C=0,A=0,P="",N,O,V=0,B=0,te,ie,D=0,J=0,F=Array.isArray(m.CellXf),se,Ee=[],le=[],xe=Array.isArray(d),X=[],pe={},R=!1,b=!!h.sheetStubs,ee=u.split(e),G=0,H=ee.length;G!=H;++G){v=ee[G].trim();var me=v.length;if(me!==0){var Me=0;e:for(y=0;y<me;++y)switch(v[y]){case">":if(v[y-1]!="/"){++y;break e}if(h&&h.cellStyles){if(O=lt(v.slice(Me,y),!0),V=O.r!=null?parseInt(O.r,10):V+1,B=-1,h.sheetRows&&h.sheetRows<V)continue;pe={},R=!1,O.ht&&(R=!0,pe.hpt=parseFloat(O.ht),pe.hpx=wl(pe.hpt)),O.hidden=="1"&&(R=!0,pe.hidden=!0),O.outlineLevel!=null&&(R=!0,pe.level=+O.outlineLevel),R&&(X[V-1]=pe)}break;case"<":Me=y;break}if(Me>=y)break;if(O=lt(v.slice(Me,y),!0),V=O.r!=null?parseInt(O.r,10):V+1,B=-1,!(h.sheetRows&&h.sheetRows<V)){g.s.r>V-1&&(g.s.r=V-1),g.e.r<V-1&&(g.e.r=V-1),h&&h.cellStyles&&(pe={},R=!1,O.ht&&(R=!0,pe.hpt=parseFloat(O.ht),pe.hpx=wl(pe.hpt)),O.hidden=="1"&&(R=!0,pe.hidden=!0),O.outlineLevel!=null&&(R=!0,pe.level=+O.outlineLevel),R&&(X[V-1]=pe)),_=v.slice(y).split(r);for(var Fe=0;Fe!=_.length&&_[Fe].trim().charAt(0)=="<";++Fe);for(_=_.slice(Fe),y=0;y!=_.length;++y)if(v=_[y].trim(),v.length!==0){if(S=v.match(t),T=y,C=0,A=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,S!=null&&S.length===2){for(T=0,P=S[1],C=0;C!=P.length&&!((A=P.charCodeAt(C)-64)<1||A>26);++C)T=26*T+A;--T,B=T}else++B;for(C=0;C!=v.length&&v.charCodeAt(C)!==62;++C);if(++C,O=lt(v.slice(0,C),!0),O.r||(O.r=ht({r:V-1,c:B})),P=v.slice(C),N={t:""},(S=P.match(s))!=null&&S[1]!==""&&(N.v=St(S[1])),h.cellFormula){if((S=P.match(o))!=null&&S[1]!==""){if(N.f=St(Pt(S[1])).replace(/\r\n/g,`
`),h.xlfn||(N.f=C1(N.f)),S[0].indexOf('t="array"')>-1)N.F=(P.match(i)||[])[1],N.F.indexOf(":")>-1&&Ee.push([Wt(N.F),N.F]);else if(S[0].indexOf('t="shared"')>-1){ie=lt(S[0]);var be=St(Pt(S[1]));h.xlfn||(be=C1(be)),le[parseInt(ie.si,10)]=[ie,be,O.r]}}else(S=P.match(/<f[^>]*\/>/))&&(ie=lt(S[0]),le[ie.si]&&(N.f=ME(le[ie.si][1],le[ie.si][2],O.r)));var De=Vr(O.r);for(C=0;C<Ee.length;++C)De.r>=Ee[C][0].s.r&&De.r<=Ee[C][0].e.r&&De.c>=Ee[C][0].s.c&&De.c<=Ee[C][0].e.c&&(N.F=Ee[C][1])}if(O.t==null&&N.v===void 0)if(N.f||N.F)N.v=0,N.t="n";else if(b)N.t="z";else continue;else N.t=O.t||"n";switch(g.s.c>B&&(g.s.c=B),g.e.c<B&&(g.e.c=B),N.t){case"n":if(N.v==""||N.v==null){if(!b)continue;N.t="z"}else N.v=parseFloat(N.v);break;case"s":if(typeof N.v>"u"){if(!b)continue;N.t="z"}else te=ol[parseInt(N.v,10)],N.v=te.t,N.r=te.r,h.cellHTML&&(N.h=te.h);break;case"str":N.t="s",N.v=N.v!=null?Pt(N.v):"",h.cellHTML&&(N.h=xd(N.v));break;case"inlineStr":S=P.match(n),N.t="s",S!=null&&(te=Ad(S[1]))?(N.v=te.t,h.cellHTML&&(N.h=te.h)):N.v="";break;case"b":N.v=Lt(N.v);break;case"d":h.cellDates?N.v=gr(N.v,1):(N.v=Hr(gr(N.v,1)),N.t="n");break;case"e":(!h||h.cellText!==!1)&&(N.w=N.v),N.v=Ev[N.v];break}if(D=J=0,se=null,F&&O.s!==void 0&&(se=m.CellXf[O.s],se!=null&&(se.numFmtId!=null&&(D=se.numFmtId),h.cellStyles&&se.fillId!=null&&(J=se.fillId))),iy(N,D,J,h,x,m),h.cellDates&&F&&N.t=="n"&&eo(ft[D])&&(N.t="d",N.v=uh(N.v)),O.cm&&h.xlmeta){var ne=(h.xlmeta.Cell||[])[+O.cm-1];ne&&ne.type=="XLDAPR"&&(N.D=!0)}if(xe){var z=Vr(O.r);d[z.r]||(d[z.r]=[]),d[z.r][z.c]=N}else d[O.r]=N}}}}X.length>0&&(d["!rows"]=X)}})();function k3(r,e){var t={},n=r.l+e;t.r=r.read_shift(4),r.l+=4;var i=r.read_shift(2);r.l+=1;var s=r.read_shift(1);return r.l=n,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}var C3=la;function T3(){}function E3(r,e){var t={},n=r[r.l];return++r.l,t.above=!(n&64),t.left=!(n&128),r.l+=18,t.name=$S(r),t}function A3(r){var e=Mn(r);return[e]}function b3(r){var e=oa(r);return[e]}function F3(r){var e=Mn(r),t=r.read_shift(1);return[e,t,"b"]}function O3(r){var e=oa(r),t=r.read_shift(1);return[e,t,"b"]}function D3(r){var e=Mn(r),t=r.read_shift(1);return[e,t,"e"]}function P3(r){var e=oa(r),t=r.read_shift(1);return[e,t,"e"]}function M3(r){var e=Mn(r),t=r.read_shift(4);return[e,t,"s"]}function N3(r){var e=oa(r),t=r.read_shift(4);return[e,t,"s"]}function I3(r){var e=Mn(r),t=Or(r);return[e,t,"n"]}function ay(r){var e=oa(r),t=Or(r);return[e,t,"n"]}function R3(r){var e=Mn(r),t=Cd(r);return[e,t,"n"]}function L3(r){var e=oa(r),t=Cd(r);return[e,t,"n"]}function B3(r){var e=Mn(r),t=Sd(r);return[e,t,"is"]}function j3(r){var e=Mn(r),t=Pr(r);return[e,t,"str"]}function z3(r){var e=oa(r),t=Pr(r);return[e,t,"str"]}function U3(r,e,t){var n=r.l+e,i=Mn(r);i.r=t["!row"];var s=r.read_shift(1),o=[i,s,"b"];if(t.cellFormula){r.l+=2;var c=dh(r,n-r.l,t);o[3]=Fr(c,null,i,t.supbooks,t)}else r.l=n;return o}function V3(r,e,t){var n=r.l+e,i=Mn(r);i.r=t["!row"];var s=r.read_shift(1),o=[i,s,"e"];if(t.cellFormula){r.l+=2;var c=dh(r,n-r.l,t);o[3]=Fr(c,null,i,t.supbooks,t)}else r.l=n;return o}function W3(r,e,t){var n=r.l+e,i=Mn(r);i.r=t["!row"];var s=Or(r),o=[i,s,"n"];if(t.cellFormula){r.l+=2;var c=dh(r,n-r.l,t);o[3]=Fr(c,null,i,t.supbooks,t)}else r.l=n;return o}function H3(r,e,t){var n=r.l+e,i=Mn(r);i.r=t["!row"];var s=Pr(r),o=[i,s,"str"];if(t.cellFormula){r.l+=2;var c=dh(r,n-r.l,t);o[3]=Fr(c,null,i,t.supbooks,t)}else r.l=n;return o}var X3=la;function G3(r,e){var t=r.l+e,n=la(r),i=kd(r),s=Pr(r),o=Pr(r),c=Pr(r);r.l=t;var u={rfx:n,relId:i,loc:s,display:c};return o&&(u.Tooltip=o),u}function Y3(){}function $3(r,e,t){var n=r.l+e,i=kv(r),s=r.read_shift(1),o=[i];if(o[2]=s,t.cellFormula){var c=Q4(r,n-r.l,t);o[1]=c}else r.l=n;return o}function K3(r,e,t){var n=r.l+e,i=la(r),s=[i];if(t.cellFormula){var o=t3(r,n-r.l,t);s[1]=o,r.l=n}else r.l=n;return s}var Z3=["left","right","top","bottom","header","footer"];function q3(r){var e={};return Z3.forEach(function(t){e[t]=Or(r)}),e}function J3(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function Q3(){}function eA(){}function tA(r,e,t,n,i,s,o){if(!r)return r;var c=e||{};n||(n={"!id":{}});var u=c.dense?[]:{},d,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,x=!1,m,y,v,_,S,T,C,A,P,N=[];c.biff=12,c["!row"]=0;var O=0,V=!1,B=[],te={},ie=c.supbooks||i.supbooks||[[]];if(ie.sharedf=te,ie.arrayf=B,ie.SheetNames=i.SheetNames||i.Sheets.map(function(xe){return xe.name}),!c.supbooks&&(c.supbooks=ie,i.Names))for(var D=0;D<i.Names.length;++D)ie[0][D+1]=i.Names[D];var J=[],F=[],se=!1;qu[16]={n:"BrtShortReal",f:ay};var Ee;if(Xi(r,function(X,pe,R){if(!x)switch(R){case 148:d=X;break;case 0:m=X,c.sheetRows&&c.sheetRows<=m.r&&(x=!0),A=Sr(_=m.r),c["!row"]=m.r,(X.hidden||X.hpt||X.level!=null)&&(X.hpt&&(X.hpx=wl(X.hpt)),F[X.r]=X);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:X[2]},X[2]){case"n":y.v=X[1];break;case"s":C=ol[X[1]],y.v=C.t,y.r=C.r;break;case"b":y.v=!!X[1];break;case"e":y.v=X[1],c.cellText!==!1&&(y.w=ca[y.v]);break;case"str":y.t="s",y.v=X[1];break;case"is":y.t="s",y.v=X[1].t;break}if((v=o.CellXf[X[0].iStyleRef])&&iy(y,v.numFmtId,null,c,s,o),S=X[0].c==-1?S+1:X[0].c,c.dense?(u[_]||(u[_]=[]),u[_][S]=y):u[sr(S)+A]=y,c.cellFormula){for(V=!1,O=0;O<B.length;++O){var b=B[O];m.r>=b[0].s.r&&m.r<=b[0].e.r&&S>=b[0].s.c&&S<=b[0].e.c&&(y.F=_t(b[0]),V=!0)}!V&&X.length>3&&(y.f=X[3])}if(h.s.r>m.r&&(h.s.r=m.r),h.s.c>S&&(h.s.c=S),h.e.r<m.r&&(h.e.r=m.r),h.e.c<S&&(h.e.c=S),c.cellDates&&v&&y.t=="n"&&eo(ft[v.numFmtId])){var ee=$s(y.v);ee&&(y.t="d",y.v=new Date(ee.y,ee.m-1,ee.d,ee.H,ee.M,ee.S,ee.u))}Ee&&(Ee.type=="XLDAPR"&&(y.D=!0),Ee=void 0);break;case 1:case 12:if(!c.sheetStubs||g)break;y={t:"z",v:void 0},S=X[0].c==-1?S+1:X[0].c,c.dense?(u[_]||(u[_]=[]),u[_][S]=y):u[sr(S)+A]=y,h.s.r>m.r&&(h.s.r=m.r),h.s.c>S&&(h.s.c=S),h.e.r<m.r&&(h.e.r=m.r),h.e.c<S&&(h.e.c=S),Ee&&(Ee.type=="XLDAPR"&&(y.D=!0),Ee=void 0);break;case 176:N.push(X);break;case 49:Ee=((c.xlmeta||{}).Cell||[])[X-1];break;case 494:var G=n["!id"][X.relId];for(G?(X.Target=G.Target,X.loc&&(X.Target+="#"+X.loc),X.Rel=G):X.relId==""&&(X.Target="#"+X.loc),_=X.rfx.s.r;_<=X.rfx.e.r;++_)for(S=X.rfx.s.c;S<=X.rfx.e.c;++S)c.dense?(u[_]||(u[_]=[]),u[_][S]||(u[_][S]={t:"z",v:void 0}),u[_][S].l=X):(T=ht({c:S,r:_}),u[T]||(u[T]={t:"z",v:void 0}),u[T].l=X);break;case 426:if(!c.cellFormula)break;B.push(X),P=c.dense?u[_][S]:u[sr(S)+A],P.f=Fr(X[1],h,{r:m.r,c:S},ie,c),P.F=_t(X[0]);break;case 427:if(!c.cellFormula)break;te[ht(X[0].s)]=X[1],P=c.dense?u[_][S]:u[sr(S)+A],P.f=Fr(X[1],h,{r:m.r,c:S},ie,c);break;case 60:if(!c.cellStyles)break;for(;X.e>=X.s;)J[X.e--]={width:X.w/256,hidden:!!(X.flags&1),level:X.level},se||(se=!0,bd(X.w/256)),Ja(J[X.e+1]);break;case 161:u["!autofilter"]={ref:_t(X)};break;case 476:u["!margins"]=X;break;case 147:i.Sheets[t]||(i.Sheets[t]={}),X.name&&(i.Sheets[t].CodeName=X.name),(X.above||X.left)&&(u["!outline"]={above:X.above,left:X.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),X.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!pe.T){if(!g||c.WTF)throw new Error("Unexpected record 0x"+R.toString(16))}}},c),delete c.supbooks,delete c["!row"],!u["!ref"]&&(h.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(u["!ref"]=_t(d||h)),c.sheetRows&&u["!ref"]){var le=Wt(u["!ref"]);c.sheetRows<=+le.e.r&&(le.e.r=c.sheetRows-1,le.e.r>h.e.r&&(le.e.r=h.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>h.e.c&&(le.e.c=h.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),u["!fullref"]=u["!ref"],u["!ref"]=_t(le))}return N.length>0&&(u["!merges"]=N),J.length>0&&(u["!cols"]=J),F.length>0&&(u["!rows"]=F),u}function rA(r){var e=[],t=r.match(/^<c:numCache>/),n;(r.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=t?+o[2]:o[2])});var i=St((r.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(r.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function nA(r,e,t,n,i,s){var o=s||{"!type":"chart"};if(!r)return s;var c=0,u=0,d="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var x=rA(g);h.s.r=h.s.c=0,h.e.c=c,d=sr(c),x[0].forEach(function(m,y){o[d+Sr(y)]={t:"n",v:m,z:x[1]},u=y}),h.e.r<u&&(h.e.r=u),++c}),c>0&&(o["!ref"]=_t(h)),o}function iA(r,e,t,n,i){if(!r)return r;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,c=r.match(sy);return c&&Od(c[0],s,i,t),(o=r.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function sA(r,e){r.l+=10;var t=Pr(r);return{name:t}}function aA(r,e,t,n,i){if(!r)return r;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Xi(r,function(u,d,h){switch(h){case 550:s["!rel"]=u;break;case 651:i.Sheets[t]||(i.Sheets[t]={}),u.name&&(i.Sheets[t].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var oy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],oA=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],lA=[],cA=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function F1(r,e){for(var t=0;t!=r.length;++t)for(var n=r[t],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Lt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function O1(r,e){for(var t=0;t!=e.length;++t){var n=e[t];if(r[n[0]]==null)r[n[0]]=n[1];else switch(n[2]){case"bool":typeof r[n[0]]=="string"&&(r[n[0]]=Lt(r[n[0]]));break;case"int":typeof r[n[0]]=="string"&&(r[n[0]]=parseInt(r[n[0]],10));break}}}function ly(r){O1(r.WBProps,oy),O1(r.CalcPr,cA),F1(r.WBView,oA),F1(r.Sheets,lA),Ya.date1904=Lt(r.WBProps.date1904)}var uA="][*?/\\".split("");function hA(r,e){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return uA.forEach(function(n){if(r.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var fA=/<\w+:workbook/;function dA(r,e){if(!r)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},o=0;if(r.replace(Ir,function(u,d){var h=lt(u);switch(mi(h[0])){case"<?xml":break;case"<workbook":u.match(fA)&&(i="xmlns"+u.match(/<(\w+):/)[1]),t.xmlns=h[i];break;case"</workbook>":break;case"<fileVersion":delete h[0],t.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":oy.forEach(function(g){if(h[g[0]]!=null)switch(g[2]){case"bool":t.WBProps[g[0]]=Lt(h[g[0]]);break;case"int":t.WBProps[g[0]]=parseInt(h[g[0]],10);break;default:t.WBProps[g[0]]=h[g[0]]}}),h.codeName&&(t.WBProps.CodeName=Pt(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],t.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=St(Pt(h.name)),delete h[0],t.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Pt(h.name),h.comment&&(s.Comment=h.comment),h.localSheetId&&(s.Sheet=+h.localSheetId),Lt(h.hidden||"0")&&(s.Hidden=!0),o=d+u.length;break;case"</definedName>":s.Ref=St(Pt(r.slice(o,d))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete h[0],t.CalcPr=h;break;case"<calcPr/>":delete h[0],t.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return u}),DS.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return ly(t),t}function gA(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=jf(r),t.name=Pr(r),t}function pA(r,e){var t={},n=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var i=e>8?Pr(r):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function mA(r,e){var t={};return r.read_shift(4),t.ArchID=r.read_shift(4),r.l+=e-8,t}function xA(r,e,t){var n=r.l+e;r.l+=4,r.l+=1;var i=r.read_shift(4),s=KS(r),o=e3(r,0,t),c=kd(r);r.l=n;var u={Name:s,Ptg:o};return i<268435455&&(u.Sheet=i),c&&(u.Comment=c),u}function vA(r,e){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],qu[16]={n:"BrtFRTArchID$",f:mA},Xi(r,function(u,d,h){switch(h){case 156:o.SheetNames.push(u.name),t.Sheets.push(u);break;case 153:t.WBProps=u;break;case 39:u.Sheet!=null&&(e.SID=u.Sheet),u.Ref=Fr(u.Ptg,null,null,o,e),delete e.SID,delete u.Ptg,s.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([h,u]):o[0]=[h,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(h),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!d.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},e),ly(t),t.Names=s,t.supbooks=o,t}function yA(r,e,t){return e.slice(-4)===".bin"?vA(r,t):dA(r,t)}function _A(r,e,t,n,i,s,o,c){return e.slice(-4)===".bin"?tA(r,n,t,i,s,o,c):g3(r,n,t,i,s,o,c)}function wA(r,e,t,n,i,s,o,c){return e.slice(-4)===".bin"?aA(r,n,t,i,s):iA(r,n,t,i,s)}function SA(r,e,t,n,i,s,o,c){return e.slice(-4)===".bin"?OE():DE()}function kA(r,e,t,n,i,s,o,c){return e.slice(-4)===".bin"?bE():FE()}function CA(r,e,t,n){return e.slice(-4)===".bin"?XT(r,t,n):jT(r,t,n)}function TA(r,e,t){return $v(r,t)}function EA(r,e,t){return e.slice(-4)===".bin"?oT(r,t):sT(r,t)}function AA(r,e,t){return e.slice(-4)===".bin"?TE(r,t):_E(r,t)}function bA(r,e,t){return e.slice(-4)===".bin"?xE(r):pE(r)}function FA(r,e,t,n){return t.slice(-4)===".bin"?vE(r,e,t,n):void 0}function OA(r,e,t){return e.slice(-4)===".bin"?dE(r,e,t):gE(r,e,t)}var cy=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,uy=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Vn(r,e){var t=r.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var i=r.match(cy),s,o,c,u;if(i)for(u=0;u!=i.length;++u)s=i[u].match(uy),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(o+1),n[c]=s[2].slice(1,s[2].length-1));return n}function DA(r){var e=r.split(/\s+/),t={};if(e.length===1)return t;var n=r.match(cy),i,s,o,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(uy),(s=i[1].indexOf(":"))===-1?t[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),t[o]=i[2].slice(1,i[2].length-1));return t}var cl;function PA(r,e){var t=cl[r]||St(r);return t==="General"?ta(e):On(t,e)}function MA(r,e,t,n){var i=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Lt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=gr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}r[St(e)]=i}function NA(r,e,t){if(r.t!=="z"){if(!t||t.cellText!==!1)try{r.t==="e"?r.w=r.w||ca[r.v]:e==="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=ml(r.v):r.w=ta(r.v):r.w=PA(e||"General",r.v)}catch(s){if(t.WTF)throw s}try{var n=cl[e]||e||"General";if(t.cellNF&&(r.z=n),t.cellDates&&r.t=="n"&&eo(n)){var i=$s(r.v);i&&(r.t="d",r.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(t.WTF)throw s}}}function IA(r,e,t){if(t.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=MT[n.Pattern]||n.Pattern)}r[e.ID]=e}function RA(r,e,t,n,i,s,o,c,u,d){var h="General",g=n.StyleID,x={};d=d||{};var m=[],y=0;for(g===void 0&&c&&(g=c.StyleID),g===void 0&&o&&(g=o.StyleID);s[g]!==void 0&&(s[g].nf&&(h=s[g].nf),s[g].Interior&&m.push(s[g].Interior),!!s[g].Parent);)g=s[g].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=Lt(r);break;case"String":n.t="s",n.r=Jm(St(r)),n.v=r.indexOf("<")>-1?St(e||r).replace(/<.*?>/g,""):n.r;break;case"DateTime":r.slice(-1)!="Z"&&(r+="Z"),n.v=(gr(r)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=St(r):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+r),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Ev[r],d.cellText!==!1&&(n.w=r);break;default:r==""&&e==""?n.t="z":(n.t="s",n.v=Jm(e||r));break}if(NA(n,h,d),d.cellFormula!==!1)if(n.Formula){var v=St(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=Ga(v,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Ga("RC:RC",i):n.ArrayRange&&(n.F=Ga(n.ArrayRange,i),u.push([Wt(n.F),n.F]))}else for(y=0;y<u.length;++y)i.r>=u[y][0].s.r&&i.r<=u[y][0].e.r&&i.c>=u[y][0].s.c&&i.c<=u[y][0].e.c&&(n.F=u[y][1]);d.cellStyles&&(m.forEach(function(_){!x.patternType&&_.patternType&&(x.patternType=_.patternType)}),n.s=x),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function LA(r){r.t=r.v||"",r.t=r.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.v=r.w=r.ixfe=void 0}function vf(r,e){var t=e||{};Jx();var n=Zo(vd(r));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=Pt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=wr(t);return o.type="string",yl.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(U){i.indexOf("<"+U)>=0&&(s=!0)}),s)return GA(n,t);cl={"General Number":"General","General Date":ft[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ft[15],"Short Date":ft[14],"Long Time":ft[19],"Medium Time":ft[18],"Short Time":ft[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ft[2],Standard:ft[4],Percent:ft[10],Scientific:ft[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,u=[],d,h={},g=[],x=t.dense?[]:{},m="",y={},v={},_=Vn('<Data ss:Type="String">'),S=0,T=0,C=0,A={s:{r:2e6,c:2e6},e:{r:0,c:0}},P={},N={},O="",V=0,B=[],te={},ie={},D=0,J=[],F=[],se={},Ee=[],le,xe=!1,X=[],pe=[],R={},b=0,ee=0,G={Sheets:[],WBProps:{date1904:!1}},H={};vl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var me="";c=vl.exec(n);)switch(c[3]=(me=c[3]).toLowerCase()){case"data":if(me=="data"){if(c[1]==="/"){if((d=u.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break}if(u[u.length-1][1])break;c[1]==="/"?RA(n.slice(S,c.index),O,_,u[u.length-1][0]=="comment"?se:y,{c:T,r:C},P,Ee[T],v,X,t):(O="",_=Vn(c[0]),S=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(F.length>0&&(y.c=F),(!t.sheetRows||t.sheetRows>C)&&y.v!==void 0&&(t.dense?(x[C]||(x[C]=[]),x[C][T]=y):x[sr(T)+Sr(C)]=y),y.HRef&&(y.l={Target:St(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(b=T+(parseInt(y.MergeAcross,10)|0),ee=C+(parseInt(y.MergeDown,10)|0),B.push({s:{c:T,r:C},e:{c:b,r:ee}})),!t.sheetStubs)y.MergeAcross?T=b+1:++T;else if(y.MergeAcross||y.MergeDown){for(var Me=T;Me<=b;++Me)for(var Fe=C;Fe<=ee;++Fe)(Me>T||Fe>C)&&(t.dense?(x[Fe]||(x[Fe]=[]),x[Fe][Me]={t:"z"}):x[sr(Me)+Sr(Fe)]={t:"z"});T=b+1}else++T;else y=DA(c[0]),y.Index&&(T=+y.Index-1),T<A.s.c&&(A.s.c=T),T>A.e.c&&(A.e.c=T),c[0].slice(-2)==="/>"&&++T,F=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(C<A.s.r&&(A.s.r=C),C>A.e.r&&(A.e.r=C),c[0].slice(-2)==="/>"&&(v=Vn(c[0]),v.Index&&(C=+v.Index-1)),T=0,++C):(v=Vn(c[0]),v.Index&&(C=+v.Index-1),R={},(v.AutoFitHeight=="0"||v.Height)&&(R.hpx=parseInt(v.Height,10),R.hpt=Yv(R.hpx),pe[C]=R),v.Hidden=="1"&&(R.hidden=!0,pe[C]=R));break;case"worksheet":if(c[1]==="/"){if((d=u.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));g.push(m),A.s.r<=A.e.r&&A.s.c<=A.e.c&&(x["!ref"]=_t(A),t.sheetRows&&t.sheetRows<=A.e.r&&(x["!fullref"]=x["!ref"],A.e.r=t.sheetRows-1,x["!ref"]=_t(A))),B.length&&(x["!merges"]=B),Ee.length>0&&(x["!cols"]=Ee),pe.length>0&&(x["!rows"]=pe),h[m]=x}else A={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=T=0,u.push([c[3],!1]),d=Vn(c[0]),m=St(d.Name),x=t.dense?[]:{},B=[],X=[],pe=[],H={name:m,Hidden:0},G.Sheets.push(H);break;case"table":if(c[1]==="/"){if((d=u.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else{if(c[0].slice(-2)=="/>")break;u.push([c[3],!1]),Ee=[],xe=!1}break;case"style":c[1]==="/"?IA(P,N,t):N=Vn(c[0]);break;case"numberformat":N.nf=St(Vn(c[0]).Format||"General"),cl[N.nf]&&(N.nf=cl[N.nf]);for(var be=0;be!=392&&ft[be]!=N.nf;++be);if(be==392){for(be=57;be!=392;++be)if(ft[be]==null){Js(N.nf,be);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(le=Vn(c[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!xe&&le.wpx>10){xe=!0,zr=Xv;for(var De=0;De<Ee.length;++De)Ee[De]&&Ja(Ee[De])}xe&&Ja(le),Ee[le.Index-1||Ee.length]=le;for(var ne=0;ne<+le.Span;++ne)Ee[Ee.length]=wr(le);break;case"namedrange":if(c[1]==="/")break;G.Names||(G.Names=[]);var z=lt(c[0]),Le={Name:z.Name,Ref:Ga(z.RefersTo.slice(1),{r:0,c:0})};G.Sheets.length>0&&(Le.Sheet=G.Sheets.length-1),G.Names.push(Le);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?O+=n.slice(V,c.index):V=c.index+c[0].length;break;case"interior":if(!t.cellStyles)break;N.Interior=Vn(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?_k(te,me,n.slice(D,c.index)):D=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((d=u.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else u.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((d=u.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));LA(se),F.push(se)}else u.push([c[3],!1]),d=Vn(c[0]),se={a:d.Author};break;case"autofilter":if(c[1]==="/"){if((d=u.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var E=Vn(c[0]);x["!autofilter"]={ref:Ga(E.Range).replace(/\$/g,"")},u.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((d=u.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((d=u.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"null":break;default:if(u.length==0&&c[3]=="document"||u.length==0&&c[3]=="uof")return R1(n,t);var de=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:de=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:de=!1}break;case"excelworkbook":switch(c[3]){case"date1904":G.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:de=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:de=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(D,c.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else D=c.index+c[0].length;break;case"header":x["!margins"]||ll(x["!margins"]={},"xlml"),isNaN(+lt(c[0]).Margin)||(x["!margins"].header=+lt(c[0]).Margin);break;case"footer":x["!margins"]||ll(x["!margins"]={},"xlml"),isNaN(+lt(c[0]).Margin)||(x["!margins"].footer=+lt(c[0]).Margin);break;case"pagemargins":var ce=lt(c[0]);x["!margins"]||ll(x["!margins"]={},"xlml"),isNaN(+ce.Top)||(x["!margins"].top=+ce.Top),isNaN(+ce.Left)||(x["!margins"].left=+ce.Left),isNaN(+ce.Right)||(x["!margins"].right=+ce.Right),isNaN(+ce.Bottom)||(x["!margins"].bottom=+ce.Bottom);break;case"displayrighttoleft":G.Views||(G.Views=[]),G.Views[0]||(G.Views[0]={}),G.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:de=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:de=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:de=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:de=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:de=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:de=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:de=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:de=!1}break;case"smarttags":break;default:de=!1;break}if(de||c[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?MA(ie,me,J,n.slice(D,c.index)):(J=c,D=c.index+c[0].length);break}if(t.WTF)throw"Unrecognized tag: "+c[3]+"|"+u.join("|")}var j={};return!t.bookSheets&&!t.bookProps&&(j.Sheets=h),j.SheetNames=g,j.Workbook=G,j.SSF=wr(ft),j.Props=te,j.Custprops=ie,j}function Wf(r,e){switch(Md(e=e||{}),e.type||"base64"){case"base64":return vf(gn(r),e);case"binary":case"buffer":case"file":return vf(r,e);case"array":return vf(aa(r),e)}}function BA(r){var e={},t=r.content;if(t.l=28,e.AnsiUserType=t.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=JS(t),t.length-t.l<=4)return e;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,e.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=QS(t),n=t.read_shift(4),n==0||n>40))return e;t.l-=4,e.Reserved2=t.read_shift(0,"lpwstr")}var jA=[60,1084,2066,2165,2175];function zA(r,e,t,n,i){var s=n,o=[],c=t.slice(t.l,t.l+s);if(i&&i.enc&&i.enc.insitu&&c.length>0)switch(r){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(c)}o.push(c),t.l+=s;for(var u=Mi(t,t.l),d=Hf[u],h=0;d!=null&&jA.indexOf(u)>-1;)s=Mi(t,t.l+2),h=t.l+4,u==2066?h+=4:(u==2165||u==2175)&&(h+=12),c=t.slice(h,t.l+4+s),o.push(c),t.l+=4+s,d=Hf[u=Mi(t,t.l)];var g=vs(o);yr(g,0);var x=0;g.lens=[];for(var m=0;m<o.length;++m)g.lens.push(x),x+=o[m].length;if(g.length<n)throw"XLS Record 0x"+r.toString(16)+" Truncated: "+g.length+" < "+n;return e.f(g,g.length,i)}function ci(r,e,t){if(r.t!=="z"&&r.XF){var n=0;try{n=r.z||r.XF.numFmtId||0,e.cellNF&&(r.z=ft[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{r.t==="e"?r.w=r.w||ca[r.v]:n===0||n=="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=ml(r.v):r.w=ta(r.v):r.w=On(n,r.v,{date1904:!!t,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&r.t=="n"&&eo(ft[n]||String(n))){var i=$s(r.v);i&&(r.t="d",r.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function iu(r,e,t){return{v:r,ixfe:e,t}}function UA(r,e){var t={opts:{}},n={},i=e.dense?[]:{},s={},o={},c=null,u=[],d="",h={},g,x="",m,y,v,_,S={},T=[],C,A,P=[],N=[],O={Sheets:[],WBProps:{date1904:!1},Views:[{}]},V={},B=function(Ye){return Ye<8?Qs[Ye]:Ye<64&&N[Ye-8]||Qs[Ye]},te=function(Ye,Ze,dt){var st=Ze.XF.data;if(!(!st||!st.patternType||!dt||!dt.cellStyles)){Ze.s={},Ze.s.patternType=st.patternType;var Ht;(Ht=_l(B(st.icvFore)))&&(Ze.s.fgColor={rgb:Ht}),(Ht=_l(B(st.icvBack)))&&(Ze.s.bgColor={rgb:Ht})}},ie=function(Ye,Ze,dt){if(!(R>1)&&!(dt.sheetRows&&Ye.r>=dt.sheetRows)){if(dt.cellStyles&&Ze.XF&&Ze.XF.data&&te(Ye,Ze,dt),delete Ze.ixfe,delete Ze.XF,g=Ye,x=ht(Ye),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Ye.r<o.s.r&&(o.s.r=Ye.r),Ye.c<o.s.c&&(o.s.c=Ye.c),Ye.r+1>o.e.r&&(o.e.r=Ye.r+1),Ye.c+1>o.e.c&&(o.e.c=Ye.c+1),dt.cellFormula&&Ze.f){for(var st=0;st<T.length;++st)if(!(T[st][0].s.c>Ye.c||T[st][0].s.r>Ye.r)&&!(T[st][0].e.c<Ye.c||T[st][0].e.r<Ye.r)){Ze.F=_t(T[st][0]),(T[st][0].s.c!=Ye.c||T[st][0].s.r!=Ye.r)&&delete Ze.f,Ze.f&&(Ze.f=""+Fr(T[st][1],o,Ye,X,D));break}}dt.dense?(i[Ye.r]||(i[Ye.r]=[]),i[Ye.r][Ye.c]=Ze):i[x]=Ze}},D={enc:!1,sbcch:0,snames:[],sharedf:S,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(D.password=e.password);var J,F=[],se=[],Ee=[],le=[],xe=!1,X=[];X.SheetNames=D.snames,X.sharedf=D.sharedf,X.arrayf=D.arrayf,X.names=[],X.XTI=[];var pe=0,R=0,b=0,ee=[],G=[],H;D.codepage=1200,qn(1200);for(var me=!1;r.l<r.length-1;){var Me=r.l,Fe=r.read_shift(2);if(Fe===0&&pe===10)break;var be=r.l===r.length?0:r.read_shift(2),De=Hf[Fe];if(De&&De.f){if(e.bookSheets&&pe===133&&Fe!==133)break;if(pe=Fe,De.r===2||De.r==12){var ne=r.read_shift(2);if(be-=2,!D.enc&&ne!==Fe&&((ne&255)<<8|ne>>8)!==Fe)throw new Error("rt mismatch: "+ne+"!="+Fe);De.r==12&&(r.l+=10,be-=10)}var z={};if(Fe===10?z=De.f(r,be,D):z=zA(Fe,De,r,be,D),R==0&&[9,521,1033,2057].indexOf(pe)===-1)continue;switch(Fe){case 34:t.opts.Date1904=O.WBProps.date1904=z;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(D.enc||(r.l=0),D.enc=z,!e.password)throw new Error("File is password-protected");if(z.valid==null)throw new Error("Encryption scheme unsupported");if(!z.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=z;break;case 66:var Le=Number(z);switch(Le){case 21010:Le=1200;break;case 32768:Le=1e4;break;case 32769:Le=1252;break}qn(D.codepage=Le),me=!0;break;case 317:D.rrtabid=z;break;case 25:D.winlocked=z;break;case 439:t.opts.RefreshAll=z;break;case 12:t.opts.CalcCount=z;break;case 16:t.opts.CalcDelta=z;break;case 17:t.opts.CalcIter=z;break;case 13:t.opts.CalcMode=z;break;case 14:t.opts.CalcPrecision=z;break;case 95:t.opts.CalcSaveRecalc=z;break;case 15:D.CalcRefMode=z;break;case 2211:t.opts.FullCalc=z;break;case 129:z.fDialog&&(i["!type"]="dialog"),z.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),z.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:P.push(z);break;case 430:X.push([z]),X[X.length-1].XTI=[];break;case 35:case 547:X[X.length-1].push(z);break;case 24:case 536:H={Name:z.Name,Ref:Fr(z.rgce,o,null,X,D)},z.itab>0&&(H.Sheet=z.itab-1),X.names.push(H),X[0]||(X[0]=[],X[0].XTI=[]),X[X.length-1].push(z),z.Name=="_xlnm._FilterDatabase"&&z.itab>0&&z.rgce&&z.rgce[0]&&z.rgce[0][0]&&z.rgce[0][0][0]=="PtgArea3d"&&(G[z.itab-1]={ref:_t(z.rgce[0][0][1][2])});break;case 22:D.ExternCount=z;break;case 23:X.length==0&&(X[0]=[],X[0].XTI=[]),X[X.length-1].XTI=X[X.length-1].XTI.concat(z),X.XTI=X.XTI.concat(z);break;case 2196:if(D.biff<8)break;H!=null&&(H.Comment=z[1]);break;case 18:i["!protect"]=z;break;case 19:z!==0&&D.WTF&&console.error("Password verifier: "+z);break;case 133:s[z.pos]=z,D.snames.push(z.name);break;case 10:{if(--R)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=_t(o),e.sheetRows&&e.sheetRows<=o.e.r){var E=o.e.r;o.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=_t(o),o.e.r=E}o.e.r++,o.e.c++}F.length>0&&(i["!merges"]=F),se.length>0&&(i["!objects"]=se),Ee.length>0&&(i["!cols"]=Ee),le.length>0&&(i["!rows"]=le),O.Sheets.push(V)}d===""?h=i:n[d]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[Fe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[z.BIFFVer]||8),D.biffguess=z.BIFFVer==0,z.BIFFVer==0&&z.dt==4096&&(D.biff=5,me=!0,qn(D.codepage=28591)),D.biff==8&&z.BIFFVer==0&&z.dt==16&&(D.biff=2),R++)break;if(i=e.dense?[]:{},D.biff<8&&!me&&(me=!0,qn(D.codepage=e.codepage||1252)),D.biff<5||z.BIFFVer==0&&z.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var de={pos:r.l-be,name:d};s[de.pos]=de,D.snames.push(d)}else d=(s[Me]||{name:""}).name;z.dt==32&&(i["!type"]="chart"),z.dt==64&&(i["!type"]="macro"),F=[],se=[],D.arrayf=T=[],Ee=[],le=[],xe=!1,V={Hidden:(s[Me]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[z.r]||[])[z.c]:i[ht({c:z.c,r:z.r})])&&++z.c,C={ixfe:z.ixfe,XF:P[z.ixfe]||{},v:z.val,t:"n"},b>0&&(C.z=ee[C.ixfe>>8&63]),ci(C,e,t.opts.Date1904),ie({c:z.c,r:z.r},C,e);break;case 5:case 517:C={ixfe:z.ixfe,XF:P[z.ixfe],v:z.val,t:z.t},b>0&&(C.z=ee[C.ixfe>>8&63]),ci(C,e,t.opts.Date1904),ie({c:z.c,r:z.r},C,e);break;case 638:C={ixfe:z.ixfe,XF:P[z.ixfe],v:z.rknum,t:"n"},b>0&&(C.z=ee[C.ixfe>>8&63]),ci(C,e,t.opts.Date1904),ie({c:z.c,r:z.r},C,e);break;case 189:for(var ce=z.c;ce<=z.C;++ce){var j=z.rkrec[ce-z.c][0];C={ixfe:j,XF:P[j],v:z.rkrec[ce-z.c][1],t:"n"},b>0&&(C.z=ee[C.ixfe>>8&63]),ci(C,e,t.opts.Date1904),ie({c:ce,r:z.r},C,e)}break;case 6:case 518:case 1030:{if(z.val=="String"){c=z;break}if(C=iu(z.val,z.cell.ixfe,z.tt),C.XF=P[C.ixfe],e.cellFormula){var U=z.formula;if(U&&U[0]&&U[0][0]&&U[0][0][0]=="PtgExp"){var ae=U[0][0][1][0],Ae=U[0][0][1][1],Pe=ht({r:ae,c:Ae});S[Pe]?C.f=""+Fr(z.formula,o,z.cell,X,D):C.F=((e.dense?(i[ae]||[])[Ae]:i[Pe])||{}).F}else C.f=""+Fr(z.formula,o,z.cell,X,D)}b>0&&(C.z=ee[C.ixfe>>8&63]),ci(C,e,t.opts.Date1904),ie(z.cell,C,e),c=z}break;case 7:case 519:if(c)c.val=z,C=iu(z,c.cell.ixfe,"s"),C.XF=P[C.ixfe],e.cellFormula&&(C.f=""+Fr(c.formula,o,c.cell,X,D)),b>0&&(C.z=ee[C.ixfe>>8&63]),ci(C,e,t.opts.Date1904),ie(c.cell,C,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(z);var ge=ht(z[0].s);if(m=e.dense?(i[z[0].s.r]||[])[z[0].s.c]:i[ge],e.cellFormula&&m){if(!c||!ge||!m)break;m.f=""+Fr(z[1],o,z[0],X,D),m.F=_t(z[0])}}break;case 1212:{if(!e.cellFormula)break;if(x){if(!c)break;S[ht(c.cell)]=z[0],m=e.dense?(i[c.cell.r]||[])[c.cell.c]:i[ht(c.cell)],(m||{}).f=""+Fr(z[0],o,g,X,D)}}break;case 253:C=iu(u[z.isst].t,z.ixfe,"s"),u[z.isst].h&&(C.h=u[z.isst].h),C.XF=P[C.ixfe],b>0&&(C.z=ee[C.ixfe>>8&63]),ci(C,e,t.opts.Date1904),ie({c:z.c,r:z.r},C,e);break;case 513:e.sheetStubs&&(C={ixfe:z.ixfe,XF:P[z.ixfe],t:"z"},b>0&&(C.z=ee[C.ixfe>>8&63]),ci(C,e,t.opts.Date1904),ie({c:z.c,r:z.r},C,e));break;case 190:if(e.sheetStubs)for(var Oe=z.c;Oe<=z.C;++Oe){var Re=z.ixfe[Oe-z.c];C={ixfe:Re,XF:P[Re],t:"z"},b>0&&(C.z=ee[C.ixfe>>8&63]),ci(C,e,t.opts.Date1904),ie({c:Oe,r:z.r},C,e)}break;case 214:case 516:case 4:C=iu(z.val,z.ixfe,"s"),C.XF=P[C.ixfe],b>0&&(C.z=ee[C.ixfe>>8&63]),ci(C,e,t.opts.Date1904),ie({c:z.c,r:z.r},C,e);break;case 0:case 512:R===1&&(o=z);break;case 252:u=z;break;case 1054:if(D.biff==4){ee[b++]=z[1];for(var Be=0;Be<b+163&&ft[Be]!=z[1];++Be);Be>=163&&Js(z[1],b+163)}else Js(z[1],z[0]);break;case 30:{ee[b++]=z;for(var re=0;re<b+163&&ft[re]!=z;++re);re>=163&&Js(z,b+163)}break;case 229:F=F.concat(z);break;case 93:se[z.cmo[0]]=D.lastobj=z;break;case 438:D.lastobj.TxO=z;break;case 127:D.lastobj.ImData=z;break;case 440:for(_=z[0].s.r;_<=z[0].e.r;++_)for(v=z[0].s.c;v<=z[0].e.c;++v)m=e.dense?(i[_]||[])[v]:i[ht({c:v,r:_})],m&&(m.l=z[1]);break;case 2048:for(_=z[0].s.r;_<=z[0].e.r;++_)for(v=z[0].s.c;v<=z[0].e.c;++v)m=e.dense?(i[_]||[])[v]:i[ht({c:v,r:_})],m&&m.l&&(m.l.Tooltip=z[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;m=e.dense?(i[z[0].r]||[])[z[0].c]:i[ht(z[0])];var nt=se[z[2]];m||(e.dense?(i[z[0].r]||(i[z[0].r]=[]),m=i[z[0].r][z[0].c]={t:"z"}):m=i[ht(z[0])]={t:"z"},o.e.r=Math.max(o.e.r,z[0].r),o.s.r=Math.min(o.s.r,z[0].r),o.e.c=Math.max(o.e.c,z[0].c),o.s.c=Math.min(o.s.c,z[0].c)),m.c||(m.c=[]),y={a:z[1],t:nt.TxO.t},m.c.push(y)}break;case 2173:cE(P[z.ixfe],z.ext);break;case 125:{if(!D.cellStyles)break;for(;z.e>=z.s;)Ee[z.e--]={width:z.w/256,level:z.level||0,hidden:!!(z.flags&1)},xe||(xe=!0,bd(z.w/256)),Ja(Ee[z.e+1])}break;case 520:{var He={};z.level!=null&&(le[z.r]=He,He.level=z.level),z.hidden&&(le[z.r]=He,He.hidden=!0),z.hpt&&(le[z.r]=He,He.hpt=z.hpt,He.hpx=wl(z.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||ll(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Fe]]=z;break;case 161:i["!margins"]||ll(i["!margins"]={}),i["!margins"].header=z.header,i["!margins"].footer=z.footer;break;case 574:z.RTL&&(O.Views[0].RTL=!0);break;case 146:N=z;break;case 2198:J=z;break;case 140:A=z;break;case 442:d?V.CodeName=z||V.name:O.WBProps.CodeName=z||"ThisWorkbook";break}}else De||console.error("Missing Info for XLS Record 0x"+Fe.toString(16)),r.l+=be}return t.SheetNames=gi(s).sort(function(Ne,Ye){return Number(Ne)-Number(Ye)}).map(function(Ne){return s[Ne].name}),e.bookSheets||(t.Sheets=n),!t.SheetNames.length&&h["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=h)):t.Preamble=h,t.Sheets&&G.forEach(function(Ne,Ye){t.Sheets[t.SheetNames[Ye]]["!autofilter"]=Ne}),t.Strings=u,t.SSF=wr(ft),D.enc&&(t.Encryption=D.enc),J&&(t.Themes=J),t.Metadata={},A!==void 0&&(t.Metadata.Country=A),X.names.length>0&&(O.Names=X.names),t.Workbook=O,t}var D1={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function VA(r,e,t){var n=yt.find(r,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=g1(n,sk,D1.DSI);for(var s in i)e[s]=i[s]}catch(d){if(t.WTF)throw d}var o=yt.find(r,"/!SummaryInformation");if(o&&o.size>0)try{var c=g1(o,ak,D1.SI);for(var u in c)e[u]==null&&(e[u]=c[u])}catch(d){if(t.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(bv(e.HeadingPairs,e.TitlesOfParts,e,t),delete e.HeadingPairs,delete e.TitlesOfParts)}function hy(r,e){e||(e={}),Md(e),zx(),e.codepage&&hd(e.codepage);var t,n;if(r.FullPaths){if(yt.find(r,"/encryption"))throw new Error("File is password-protected");t=yt.find(r,"!CompObj"),n=yt.find(r,"/Workbook")||yt.find(r,"/Book")}else{switch(e.type){case"base64":r=Kn(gn(r));break;case"binary":r=Kn(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r));break}yr(r,0),n={content:r}}var i,s;if(t&&BA(t),e.bookProps&&!e.bookSheets)i={};else{var o=xt?"buffer":"array";if(n&&n.content)i=UA(n.content,e);else if((s=yt.find(r,"PerfectOffice_MAIN"))&&s.content)i=al.to_workbook(s.content,(e.type=o,e));else if((s=yt.find(r,"NativeContent_MAIN"))&&s.content)i=al.to_workbook(s.content,(e.type=o,e));else throw(s=yt.find(r,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&r.FullPaths&&yt.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=AE(r))}var c={};return r.FullPaths&&VA(r,c,e),i.Props=i.Custprops=c,e.bookFiles&&(i.cfb=r),i}var qu={0:{f:k3},1:{f:A3},2:{f:R3},3:{f:D3},4:{f:F3},5:{f:I3},6:{f:j3},7:{f:M3},8:{f:H3},9:{f:W3},10:{f:U3},11:{f:V3},12:{f:b3},13:{f:L3},14:{f:P3},15:{f:O3},16:{f:ay},17:{f:z3},18:{f:N3},19:{f:Sd},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:xA},40:{},42:{},43:{f:UT},44:{f:zT},45:{f:VT},46:{f:HT},47:{f:WT},48:{},49:{f:XS},50:{},51:{f:hE},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zv},62:{f:B3},63:{f:mE},64:{f:Q3},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Nr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:J3},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:E3},148:{f:C3,p:16},151:{f:Y3},152:{},153:{f:pA},154:{},155:{},156:{f:gA},157:{},158:{},159:{T:1,f:aT},160:{T:-1},161:{T:1,f:la},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:X3},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:uE},336:{T:-1},337:{f:fE,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:jf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:jv},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:$3},427:{f:K3},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:q3},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:T3},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:G3},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:jf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:CE},633:{T:1},634:{T:-1},635:{T:1,f:kE},636:{T:-1},637:{f:YS},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:sA},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:eA},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Hf={6:{f:mf},10:{f:ps},12:{f:er},13:{f:er},14:{f:$t},15:{f:$t},16:{f:Or},17:{f:$t},18:{f:$t},19:{f:er},20:{f:v1},21:{f:v1},23:{f:jv},24:{f:_1},25:{f:$t},26:{},27:{},28:{f:wC},29:{},34:{f:$t},35:{f:y1},38:{f:Or},39:{f:Or},40:{f:Or},41:{f:Or},42:{f:$t},43:{f:$t},47:{f:TT},49:{f:rC},51:{f:er},60:{},61:{f:Qk},64:{f:$t},65:{f:tC},66:{f:er},77:{},80:{},81:{},82:{},85:{f:er},89:{},90:{},91:{},92:{f:Xk},93:{f:kC},94:{},95:{f:$t},96:{},97:{},99:{f:$t},125:{f:zv},128:{f:fC},129:{f:Gk},130:{f:er},131:{f:$t},132:{f:$t},133:{f:Yk},134:{},140:{f:FC},141:{f:er},144:{},146:{f:DC},151:{},152:{},153:{},154:{},155:{},156:{f:er},157:{},158:{},160:{f:RC},161:{f:MC},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:lC},190:{f:cC},193:{f:ps},197:{},198:{},199:{},200:{},201:{},202:{f:$t},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:er},220:{},221:{f:$t},222:{},224:{f:hC},225:{f:Hk},226:{f:ps},227:{},229:{f:SC},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:$k},253:{f:nC},255:{f:Kk},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Mv},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:$t},353:{f:ps},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:gC},431:{f:$t},432:{},433:{},434:{},437:{},438:{f:EC},439:{f:$t},440:{f:AC},441:{},442:{f:Pl},443:{},444:{f:er},445:{},446:{},448:{f:ps},449:{f:Jk,r:2},450:{f:ps},512:{f:m1},513:{f:IC},515:{f:dC},516:{f:iC},517:{f:x1},519:{f:LC},520:{f:Zk},523:{},545:{f:w1},549:{f:p1},566:{},574:{f:eC},638:{f:oC},659:{},1048:{},1054:{f:sC},1084:{},1212:{f:vC},2048:{f:bC},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:tu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ps},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:PC,r:12},2173:{f:lE,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:$t,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:xC,r:12},2197:{},2198:{f:rE,r:12},2199:{},2200:{},2201:{},2202:{f:yC,r:12},2203:{f:ps},2204:{},2205:{},2206:{},2207:{},2211:{f:qk},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:er},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:NC},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:OC},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:m1},1:{},2:{f:UC},3:{f:zC},4:{f:jC},5:{f:x1},7:{f:VC},8:{},9:{f:tu},11:{},22:{f:er},30:{f:aC},31:{},32:{},33:{f:w1},36:{},37:{f:p1},50:{f:WC},62:{},52:{},67:{},68:{f:er},69:{},86:{},126:{},127:{f:BC},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:HC},223:{},234:{},354:{},421:{},518:{f:mf},521:{f:tu},536:{f:_1},547:{f:y1},561:{},579:{},1030:{f:mf},1033:{f:tu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Wn(r,e,t,n){var i=e;if(!isNaN(i)){var s=(t||[]).length||0,o=r.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&_v(t)&&r.push(t)}}function P1(r,e){var t=e||{},n=t.dense?[]:{};r=r.replace(/<!--.*?-->/g,"");var i=r.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=r.match(/<\/table/i),o=i.index,c=s&&s.index||r.length,u=dS(r.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,h=0,g=0,x=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(o=0;o<u.length;++o){var v=u[o].trim(),_=v.slice(0,3).toLowerCase();if(_=="<tr"){if(++d,t.sheetRows&&t.sheetRows<=d){--d;break}h=0;continue}if(!(_!="<td"&&_!="<th")){var S=v.split(/<\/t[dh]>/i);for(c=0;c<S.length;++c){var T=S[c].trim();if(T.match(/<t[dh]/i)){for(var C=T,A=0;C.charAt(0)=="<"&&(A=C.indexOf(">"))>-1;)C=C.slice(A+1);for(var P=0;P<y.length;++P){var N=y[P];N.s.c==h&&N.s.r<d&&d<=N.e.r&&(h=N.e.c+1,P=-1)}var O=lt(T.slice(0,T.indexOf(">")));x=O.colspan?+O.colspan:1,((g=+O.rowspan)>1||x>1)&&y.push({s:{r:d,c:h},e:{r:d+(g||1)-1,c:h+x-1}});var V=O.t||O["data-t"]||"";if(!C.length){h+=x;continue}if(C=ov(C),m.s.r>d&&(m.s.r=d),m.e.r<d&&(m.e.r=d),m.s.c>h&&(m.s.c=h),m.e.c<h&&(m.e.c=h),!C.length){h+=x;continue}var B={t:"s",v:C};t.raw||!C.trim().length||V=="s"||(C==="TRUE"?B={t:"b",v:!0}:C==="FALSE"?B={t:"b",v:!1}:isNaN(ti(C))?isNaN(qa(C).getDate())||(B={t:"d",v:gr(C)},t.cellDates||(B={t:"n",v:Hr(B.v)}),B.z=t.dateNF||ft[14]):B={t:"n",v:ti(C)}),t.dense?(n[d]||(n[d]=[]),n[d][h]=B):n[ht({r:d,c:h})]=B,h+=x}}}}return n["!ref"]=_t(m),y.length&&(n["!merges"]=y),n}function WA(r,e,t,n){for(var i=r["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var c=0,u=0,d=0;d<i.length;++d)if(!(i[d].s.r>t||i[d].s.c>o)&&!(i[d].e.r<t||i[d].e.c<o)){if(i[d].s.r<t||i[d].s.c<o){c=-1;break}c=i[d].e.r-i[d].s.r+1,u=i[d].e.c-i[d].s.c+1;break}if(!(c<0)){var h=ht({r:t,c:o}),g=n.dense?(r[t]||[])[o]:r[h],x=g&&g.v!=null&&(g.h||xd(g.w||(zi(g),g.w)||""))||"",m={};c>1&&(m.rowspan=c),u>1&&(m.colspan=u),n.editable?x='<span contenteditable="true">'+x+"</span>":g&&(m["data-t"]=g&&g.t||"z",g.v!=null&&(m["data-v"]=g.v),g.z!=null&&(m["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+g.l.Target+'">'+x+"</a>")),m.id=(n.id||"sjs")+"-"+h,s.push(FS("td",x,m))}}var y="<tr>";return y+s.join("")+"</tr>"}var HA='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',XA="</body></html>";function GA(r,e){var t=r.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return As(P1(t[0],e),e);var n=Id();return t.forEach(function(i,s){Rd(n,P1(i,e),"Sheet"+(s+1))}),n}function YA(r,e,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function $A(r,e){var t=e||{},n=t.header!=null?t.header:HA,i=t.footer!=null?t.footer:XA,s=[n],o=to(r["!ref"]);t.dense=Array.isArray(r),s.push(YA(r,o,t));for(var c=o.s.r;c<=o.e.r;++c)s.push(WA(r,o,c,t));return s.push("</table>"+i),s.join("")}function fy(r,e,t){var n=t||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?Vr(n.origin):n.origin;i=o.r,s=o.c}var c=e.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,c.length),d={s:{r:0,c:0},e:{r:i,c:s}};if(r["!ref"]){var h=to(r["!ref"]);d.s.r=Math.min(d.s.r,h.s.r),d.s.c=Math.min(d.s.c,h.s.c),d.e.r=Math.max(d.e.r,h.e.r),d.e.c=Math.max(d.e.c,h.e.c),i==-1&&(d.e.r=i=h.e.r+1)}var g=[],x=0,m=r["!rows"]||(r["!rows"]=[]),y=0,v=0,_=0,S=0,T=0,C=0;for(r["!cols"]||(r["!cols"]=[]);y<c.length&&v<u;++y){var A=c[y];if(M1(A)){if(n.display)continue;m[v]={hidden:!0}}var P=A.children;for(_=S=0;_<P.length;++_){var N=P[_];if(!(n.display&&M1(N))){var O=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):ov(N.innerHTML),V=N.getAttribute("data-z")||N.getAttribute("z");for(x=0;x<g.length;++x){var B=g[x];B.s.c==S+s&&B.s.r<v+i&&v+i<=B.e.r&&(S=B.e.c+1-s,x=-1)}C=+N.getAttribute("colspan")||1,((T=+N.getAttribute("rowspan")||1)>1||C>1)&&g.push({s:{r:v+i,c:S+s},e:{r:v+i+(T||1)-1,c:S+s+(C||1)-1}});var te={t:"s",v:O},ie=N.getAttribute("data-t")||N.getAttribute("t")||"";O!=null&&(O.length==0?te.t=ie||"z":n.raw||O.trim().length==0||ie=="s"||(O==="TRUE"?te={t:"b",v:!0}:O==="FALSE"?te={t:"b",v:!1}:isNaN(ti(O))?isNaN(qa(O).getDate())||(te={t:"d",v:gr(O)},n.cellDates||(te={t:"n",v:Hr(te.v)}),te.z=n.dateNF||ft[14]):te={t:"n",v:ti(O)})),te.z===void 0&&V!=null&&(te.z=V);var D="",J=N.getElementsByTagName("A");if(J&&J.length)for(var F=0;F<J.length&&!(J[F].hasAttribute("href")&&(D=J[F].getAttribute("href"),D.charAt(0)!="#"));++F);D&&D.charAt(0)!="#"&&(te.l={Target:D}),n.dense?(r[v+i]||(r[v+i]=[]),r[v+i][S+s]=te):r[ht({c:S+s,r:v+i})]=te,d.e.c<S+s&&(d.e.c=S+s),S+=C}}++v}return g.length&&(r["!merges"]=(r["!merges"]||[]).concat(g)),d.e.r=Math.max(d.e.r,v-1+i),r["!ref"]=_t(d),v>=u&&(r["!fullref"]=_t((d.e.r=c.length-y+v-1+i,d))),r}function dy(r,e){var t=e||{},n=t.dense?[]:{};return fy(n,r,e)}function KA(r,e){return As(dy(r,e),e)}function M1(r){var e="",t=ZA(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function ZA(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function qA(r){var e=r.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=St(e.replace(/<[^>]*>/g,""));return[t]}var N1={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function gy(r,e){var t=e||{},n=vd(r),i=[],s,o,c={name:""},u="",d=0,h,g,x={},m=[],y=t.dense?[]:{},v,_,S={value:""},T="",C=0,A=[],P=-1,N=-1,O={s:{r:1e6,c:1e7},e:{r:0,c:0}},V=0,B={},te=[],ie={},D=0,J=0,F=[],se=1,Ee=1,le=[],xe={Names:[]},X={},pe=["",""],R=[],b={},ee="",G=0,H=!1,me=!1,Me=0;for(vl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=vl.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(O.e.c>=O.s.c&&O.e.r>=O.s.r?y["!ref"]=_t(O):y["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=O.e.r&&(y["!fullref"]=y["!ref"],O.e.r=t.sheetRows-1,y["!ref"]=_t(O)),te.length&&(y["!merges"]=te),F.length&&(y["!rows"]=F),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),m.push(h.name),x[h.name]=y,me=!1):v[0].charAt(v[0].length-2)!=="/"&&(h=lt(v[0],!1),P=N=-1,O.s.r=O.s.c=1e7,O.e.r=O.e.c=0,y=t.dense?[]:{},te=[],F=[],me=!0);break;case"table-row-group":v[1]==="/"?--V:++V;break;case"table-row":case"":if(v[1]==="/"){P+=se,se=1;break}if(g=lt(v[0],!1),g.?P=g.-1:P==-1&&(P=0),se=+g["number-rows-repeated"]||1,se<10)for(Me=0;Me<se;++Me)V>0&&(F[P+Me]={level:V});N=-1;break;case"covered-table-cell":v[1]!=="/"&&++N,t.sheetStubs&&(t.dense?(y[P]||(y[P]=[]),y[P][N]={t:"z"}):y[ht({r:P,c:N})]={t:"z"}),T="",A=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++N,S=lt(v[0],!1),Ee=parseInt(S["number-columns-repeated"]||"1",10),_={t:"z",v:null},S.formula&&t.cellFormula!=!1&&(_.f=b1(St(S.formula))),(S.||S["value-type"])=="string"&&(_.t="s",_.v=St(S["string-value"]||""),t.dense?(y[P]||(y[P]=[]),y[P][N]=_):y[ht({r:P,c:N})]=_),N+=Ee-1;else if(v[1]!=="/"){++N,T="",C=0,A=[],Ee=1;var Fe=se?P+se-1:P;if(N>O.e.c&&(O.e.c=N),N<O.s.c&&(O.s.c=N),P<O.s.r&&(O.s.r=P),Fe>O.e.r&&(O.e.r=Fe),S=lt(v[0],!1),R=[],b={},_={t:S.||S["value-type"],v:null},t.cellFormula)if(S.formula&&(S.formula=St(S.formula)),S["number-matrix-columns-spanned"]&&S["number-matrix-rows-spanned"]&&(D=parseInt(S["number-matrix-rows-spanned"],10)||0,J=parseInt(S["number-matrix-columns-spanned"],10)||0,ie={s:{r:P,c:N},e:{r:P+D-1,c:N+J-1}},_.F=_t(ie),le.push([ie,_.F])),S.formula)_.f=b1(S.formula);else for(Me=0;Me<le.length;++Me)P>=le[Me][0].s.r&&P<=le[Me][0].e.r&&N>=le[Me][0].s.c&&N<=le[Me][0].e.c&&(_.F=le[Me][1]);switch((S["number-columns-spanned"]||S["number-rows-spanned"])&&(D=parseInt(S["number-rows-spanned"],10)||0,J=parseInt(S["number-columns-spanned"],10)||0,ie={s:{r:P,c:N},e:{r:P+D-1,c:N+J-1}},te.push(ie)),S["number-columns-repeated"]&&(Ee=parseInt(S["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Lt(S["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(S.value);break;case"percentage":_.t="n",_.v=parseFloat(S.value);break;case"currency":_.t="n",_.v=parseFloat(S.value);break;case"date":_.t="d",_.v=gr(S["date-value"]),t.cellDates||(_.t="n",_.v=Hr(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=uS(S["time-value"])/86400,t.cellDates&&(_.t="d",_.v=uh(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(S.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",S["string-value"]!=null&&(T=St(S["string-value"]),A=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(H=!1,_.t==="s"&&(_.v=T||"",A.length&&(_.R=A),H=C==0),X.Target&&(_.l=X),R.length>0&&(_.c=R,R=[]),T&&t.cellText!==!1&&(_.w=T),H&&(_.t="z",delete _.v),(!H||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=P))for(var be=0;be<se;++be){if(Ee=parseInt(S["number-columns-repeated"]||"1",10),t.dense)for(y[P+be]||(y[P+be]=[]),y[P+be][N]=be==0?_:wr(_);--Ee>0;)y[P+be][N+Ee]=wr(_);else for(y[ht({r:P+be,c:N})]=_;--Ee>0;)y[ht({r:P+be,c:N+Ee})]=wr(_);O.e.c<=N&&(O.e.c=N)}Ee=parseInt(S["number-columns-repeated"]||"1",10),N+=Ee-1,Ee=0,_={},T="",A=[]}X={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((s=i.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&i.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((s=i.pop())[0]!==v[3])throw"Bad state: "+s;b.t=T,A.length&&(b.R=A),b.a=ee,R.push(b)}else v[0].charAt(v[0].length-2)!=="/"&&i.push([v[3],!1]);ee="",G=0,T="",C=0,A=[];break;case"creator":v[1]==="/"?ee=n.slice(G,v.index):G=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((s=i.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&i.push([v[3],!1]);T="",C=0,A=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(B[c.name]=u,(s=i.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&(u="",c=lt(v[0],!1),i.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=lt(v[0],!1),u+=N1[v[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=lt(v[0],!1),u+=N1[v[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(d,v.index);break}else d=v.index+v[0].length;break;case"named-range":o=lt(v[0],!1),pe=xf(o["cell-range-address"]);var De={Name:o.name,Ref:pe[0]+"!"+pe[1]};me&&(De.Sheet=m.length),xe.Names.push(De);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(v[1]==="/"&&(!S||!S["string-value"])){var ne=qA(n.slice(C,v.index));T=(T.length>0?T+`
`:"")+ne[0]}else lt(v[0],!1),C=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{pe=xf(lt(v[0])["target-range-address"]),x[pe[0]]["!autofilter"]={ref:pe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(X=lt(v[0],!1),!X.href)break;X.Target=St(X.href),delete X.href,X.Target.charAt(0)=="#"&&X.Target.indexOf(".")>-1?(pe=xf(X.Target.slice(1)),X.Target="#"+pe[0]+"!"+pe[1]):X.Target.match(/^\.\.[\\\/]/)&&(X.Target=X.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(v)}}var z={Sheets:x,SheetNames:m,Workbook:xe};return t.bookSheets&&delete z.Sheets,z}function I1(r,e){e=e||{},An(r,"META-INF/manifest.xml")&&dk(Qt(r,"META-INF/manifest.xml"),e);var t=fn(r,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=gy(Pt(t),e);return An(r,"meta.xml")&&(n.Props=Av(Qt(r,"meta.xml"))),n}function R1(r,e){return gy(r,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Dd(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Xf(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):Pt(aa(r))}function Gf(r){var e=r.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),n=0;return r.forEach(function(i){t.set(i,n),n+=i.length}),t}function L1(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>>24}function JA(r,e){for(var t=(r[e+15]&127)<<7|r[e+14]>>1,n=r[e+14]&1,i=e+13;i>=e;--i)n=n*256+r[i];return(r[e+15]&128?-n:n)*Math.pow(10,t-6176)}function Sl(r,e){var t=e?e[0]:0,n=r[t]&127;e:if(r[t++]>=128&&(n|=(r[t]&127)<<7,r[t++]<128||(n|=(r[t]&127)<<14,r[t++]<128)||(n|=(r[t]&127)<<21,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),n}function ar(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function Dr(r){for(var e=[],t=[0];t[0]<r.length;){var n=t[0],i=Sl(r,t),s=i&7;i=Math.floor(i/8);var o=0,c;if(i==0)break;switch(s){case 0:{for(var u=t[0];r[t[0]++]>=128;);c=r.slice(u,t[0])}break;case 5:o=4,c=r.slice(t[0],t[0]+o),t[0]+=o;break;case 1:o=8,c=r.slice(t[0],t[0]+o),t[0]+=o;break;case 2:o=Sl(r,t),c=r.slice(t[0],t[0]+o),t[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var d={data:c,type:s};e[i]==null?e[i]=[d]:e[i].push(d)}return e}function Pd(r,e){return(r==null?void 0:r.map(function(t){return e(t.data)}))||[]}function QA(r){for(var e,t=[],n=[0];n[0]<r.length;){var i=Sl(r,n),s=Dr(r.slice(n[0],n[0]+i));n[0]+=i;var o={id:ar(s[1][0].data),messages:[]};s[2].forEach(function(c){var u=Dr(c.data),d=ar(u[3][0].data);o.messages.push({meta:u,data:r.slice(n[0],n[0]+d)}),n[0]+=d}),(e=s[3])!=null&&e[0]&&(o.merge=ar(s[3][0].data)>>>0>0),t.push(o)}return t}function eb(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],n=Sl(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var o=e[t[0]++]>>2;if(o<60)++o;else{var c=o-59;o=e[t[0]],c>1&&(o|=e[t[0]+1]<<8),c>2&&(o|=e[t[0]+2]<<16),c>3&&(o|=e[t[0]+3]<<24),o>>>=0,o++,t[0]+=c}i.push(e.slice(t[0],t[0]+o)),t[0]+=o;continue}else{var u=0,d=0;if(s==1?(d=(e[t[0]]>>2&7)+4,u=(e[t[0]++]&224)<<3,u|=e[t[0]++]):(d=(e[t[0]++]>>2)+1,s==2?(u=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(u=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[Gf(i)],u==0)throw new Error("Invalid offset 0");if(u>i[0].length)throw new Error("Invalid offset beyond length");if(d>=u)for(i.push(i[0].slice(-u)),d-=u;d>=i[i.length-1].length;)i.push(i[i.length-1]),d-=i[i.length-1].length;i.push(i[0].slice(-u,-u+d))}}var h=Gf(i);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function tb(r){for(var e=[],t=0;t<r.length;){var n=r[t++],i=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(eb(n,r.slice(t,t+i))),t+=i}if(t!==r.length)throw new Error("data is not a valid framed stream!");return Gf(e)}function rb(r,e,t,n){var i=Dd(r),s=i.getUint32(4,!0),o=(n>1?12:8)+L1(s&(n>1?3470:398))*4,c=-1,u=-1,d=NaN,h=new Date(2001,0,1);s&512&&(c=i.getUint32(o,!0),o+=4),o+=L1(s&(n>1?12288:4096))*4,s&16&&(u=i.getUint32(o,!0),o+=4),s&32&&(d=i.getFloat64(o,!0),o+=8),s&64&&(h.setTime(h.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var g;switch(r[2]){case 0:break;case 2:g={t:"n",v:d};break;case 3:g={t:"s",v:e[u]};break;case 5:g={t:"d",v:h};break;case 6:g={t:"b",v:d>0};break;case 7:g={t:"n",v:d/86400};break;case 8:g={t:"e",v:0};break;case 9:if(c>-1)g={t:"s",v:t[c]};else if(u>-1)g={t:"s",v:e[u]};else if(!isNaN(d))g={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(r.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(r.slice(0,4)))}return g}function nb(r,e,t){var n=Dd(r),i=n.getUint32(8,!0),s=12,o=-1,c=-1,u=NaN,d=NaN,h=new Date(2001,0,1);i&1&&(u=JA(r,s),s+=16),i&2&&(d=n.getFloat64(s,!0),s+=8),i&4&&(h.setTime(h.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(c=n.getUint32(s,!0),s+=4),i&16&&(o=n.getUint32(s,!0),s+=4);var g;switch(r[1]){case 0:break;case 2:g={t:"n",v:u};break;case 3:g={t:"s",v:e[c]};break;case 5:g={t:"d",v:h};break;case 6:g={t:"b",v:d>0};break;case 7:g={t:"n",v:d/86400};break;case 8:g={t:"e",v:0};break;case 9:if(o>-1)g={t:"s",v:t[o]};else throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(i&31," : ").concat(r.slice(0,4)));break;case 10:g={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(i&31," : ").concat(r.slice(0,4)))}return g}function ib(r,e,t){switch(r[0]){case 0:case 1:case 2:case 3:return rb(r,e,t,r[0]);case 5:return nb(r,e,t);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function Ss(r){var e=Dr(r);return Sl(e[1][0].data)}function B1(r,e){var t=Dr(e.data),n=ar(t[1][0].data),i=t[3],s=[];return(i||[]).forEach(function(o){var c=Dr(o.data),u=ar(c[1][0].data)>>>0;switch(n){case 1:s[u]=Xf(c[3][0].data);break;case 8:{var d=r[Ss(c[9][0].data)][0],h=Dr(d.data),g=r[Ss(h[1][0].data)][0],x=ar(g.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var m=Dr(g.data);s[u]=m[3].map(function(y){return Xf(y.data)}).join("")}break}}),s}function sb(r,e){var t,n,i,s,o,c,u,d,h,g,x,m,y,v,_=Dr(r),S=ar(_[1][0].data)>>>0,T=ar(_[2][0].data)>>>0,C=((n=(t=_[8])==null?void 0:t[0])==null?void 0:n.data)&&ar(_[8][0].data)>0||!1,A,P;if((s=(i=_[7])==null?void 0:i[0])!=null&&s.data&&e!=0)A=(c=(o=_[7])==null?void 0:o[0])==null?void 0:c.data,P=(d=(u=_[6])==null?void 0:u[0])==null?void 0:d.data;else if((g=(h=_[4])==null?void 0:h[0])!=null&&g.data&&e!=1)A=(m=(x=_[4])==null?void 0:x[0])==null?void 0:m.data,P=(v=(y=_[3])==null?void 0:y[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var N=C?4:1,O=Dd(A),V=[],B=0;B<A.length/2;++B){var te=O.getUint16(B*2,!0);te<65535&&V.push([B,te])}if(V.length!=T)throw"Expected ".concat(T," cells, found ").concat(V.length);var ie=[];for(B=0;B<V.length-1;++B)ie[V[B][0]]=P.subarray(V[B][1]*N,V[B+1][1]*N);return V.length>=1&&(ie[V[V.length-1][0]]=P.subarray(V[V.length-1][1]*N)),{R:S,cells:ie}}function ab(r,e){var t,n=Dr(e.data),i=(t=n==null?void 0:n[7])!=null&&t[0]?ar(n[7][0].data)>>>0>0?1:0:-1,s=Pd(n[5],function(o){return sb(o,i)});return{nrows:ar(n[4][0].data)>>>0,data:s.reduce(function(o,c){return o[c.R]||(o[c.R]=[]),c.cells.forEach(function(u,d){if(o[c.R][d])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(d));o[c.R][d]=u}),o},[])}}function ob(r,e,t){var n,i=Dr(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(ar(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(ar(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));t["!ref"]=_t(s);var o=Dr(i[4][0].data),c=B1(r,r[Ss(o[4][0].data)][0]),u=(n=o[17])!=null&&n[0]?B1(r,r[Ss(o[17][0].data)][0]):[],d=Dr(o[3][0].data),h=0;d[1].forEach(function(g){var x=Dr(g.data),m=r[Ss(x[2][0].data)][0],y=ar(m.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var v=ab(r,m);v.data.forEach(function(_,S){_.forEach(function(T,C){var A=ht({r:h+S,c:C}),P=ib(T,c,u);P&&(t[A]=P)})}),h+=v.nrows})}function lb(r,e){var t=Dr(e.data),n={"!ref":"A1"},i=r[Ss(t[2][0].data)],s=ar(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return ob(r,i[0],n),n}function cb(r,e){var t,n=Dr(e.data),i={name:(t=n[1])!=null&&t[0]?Xf(n[1][0].data):"",sheets:[]},s=Pd(n[2],Ss);return s.forEach(function(o){r[o].forEach(function(c){var u=ar(c.meta[1][0].data);u==6e3&&i.sheets.push(lb(r,c))})}),i}function ub(r,e){var t=Id(),n=Dr(e.data),i=Pd(n[1],Ss);if(i.forEach(function(s){r[s].forEach(function(o){var c=ar(o.meta[1][0].data);if(c==2){var u=cb(r,o);u.sheets.forEach(function(d,h){Rd(t,d,h==0?u.name:u.name+"_"+h,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function yf(r){var e,t,n,i,s={},o=[];if(r.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var d;try{d=tb(u.content)}catch(g){return console.log("?? "+u.content.length+" "+(g.message||g))}var h;try{h=QA(d)}catch(g){return console.log("## "+(g.message||g))}h.forEach(function(g){s[g.id]=g.messages,o.push(g.id)})}}),!o.length)throw new Error("File has no messages");var c=((i=(n=(t=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&ar(s[1][0].meta[1][0].data)==1&&s[1][0];if(c||o.forEach(function(u){s[u].forEach(function(d){var h=ar(d.meta[1][0].data)>>>0;if(h==1)if(!c)c=d;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return ub(s,c)}function hb(r){return function(t){for(var n=0;n!=r.length;++n){var i=r[n];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function Md(r){hb([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function fb(r){return Ua.WS.indexOf(r)>-1?"sheet":r==Ua.CS?"chart":r==Ua.DS?"dialog":r==Ua.MS?"macro":r&&r.length?r:"sheet"}function db(r,e){if(!r)return 0;try{r=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,r["!id"][n.id].Target,fb(r["!id"][n.id].Type)]})}catch{return null}return!r||r.length===0?null:r}function gb(r,e,t,n,i,s,o,c,u,d,h,g){try{s[n]=il(fn(r,t,!0),e);var x=Qt(r,e),m;switch(c){case"sheet":m=_A(x,e,i,u,s[n],d,h,g);break;case"chart":if(m=wA(x,e,i,u,s[n],d,h,g),!m||!m["!drawel"])break;var y=Jo(m["!drawel"].Target,e),v=zf(y),_=yE(fn(r,y,!0),il(fn(r,v,!0),y)),S=Jo(_,y),T=zf(S);m=nA(fn(r,S,!0),S,u,il(fn(r,T,!0),S),d,m);break;case"macro":m=SA(x,e,i,u,s[n],d,h,g);break;case"dialog":m=kA(x,e,i,u,s[n],d,h,g);break;default:throw new Error("Unrecognized sheet type "+c)}o[n]=m;var C=[];s&&s[n]&&gi(s[n]).forEach(function(A){var P="";if(s[n][A].Type==Ua.CMNT){P=Jo(s[n][A].Target,e);var N=AA(Qt(r,P,!0),P,u);if(!N||!N.length)return;k1(m,N,!1)}s[n][A].Type==Ua.TCMNT&&(P=Jo(s[n][A].Target,e),C=C.concat(wE(Qt(r,P,!0),u)))}),C&&C.length&&k1(m,C,!0,u.people||[])}catch(A){if(u.WTF)throw A}}function Cn(r){return r.charAt(0)=="/"?r.slice(1):r}function pb(r,e){if(Jx(),e=e||{},Md(e),An(r,"META-INF/manifest.xml")||An(r,"objectdata.xml"))return I1(r,e);if(An(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof yf<"u"){if(r.FileIndex)return yf(r);var t=yt.utils.cfb_new();return Zm(r).forEach(function(F){mS(t,F,pS(r,F))}),yf(t)}throw new Error("Unsupported NUMBERS file")}if(!An(r,"[Content_Types].xml"))throw An(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):An(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Zm(r),i=hk(fn(r,"[Content_Types].xml")),s=!1,o,c;if(i.workbooks.length===0&&(c="xl/workbook.xml",Qt(r,c,!0)&&i.workbooks.push(c)),i.workbooks.length===0){if(c="xl/workbook.bin",!Qt(r,c,!0))throw new Error("Could not find workbook");i.workbooks.push(c),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var u={},d={};if(!e.bookSheets&&!e.bookProps){if(ol=[],i.sst)try{ol=EA(Qt(r,Cn(i.sst)),i.sst,e)}catch(F){if(e.WTF)throw F}e.cellStyles&&i.themes.length&&(u=TA(fn(r,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(d=CA(Qt(r,Cn(i.style)),i.style,u,e))}i.links.map(function(F){try{var se=il(fn(r,zf(Cn(F))),F);return FA(Qt(r,Cn(F)),se,F,e)}catch{}});var h=yA(Qt(r,Cn(i.workbooks[0])),i.workbooks[0],e),g={},x="";i.coreprops.length&&(x=Qt(r,Cn(i.coreprops[0]),!0),x&&(g=Av(x)),i.extprops.length!==0&&(x=Qt(r,Cn(i.extprops[0]),!0),x&&mk(x,g,e)));var m={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(x=fn(r,Cn(i.custprops[0]),!0),x&&(m=vk(x,e)));var y={};if((e.bookSheets||e.bookProps)&&(h.Sheets?o=h.Sheets.map(function(se){return se.name}):g.Worksheets&&g.SheetNames.length>0&&(o=g.SheetNames),e.bookProps&&(y.Props=g,y.Custprops=m),e.bookSheets&&typeof o<"u"&&(y.SheetNames=o),e.bookSheets?y.SheetNames:e.bookProps))return y;o={};var v={};e.bookDeps&&i.calcchain&&(v=bA(Qt(r,Cn(i.calcchain)),i.calcchain));var _=0,S={},T,C;{var A=h.Sheets;g.Worksheets=A.length,g.SheetNames=[];for(var P=0;P!=A.length;++P)g.SheetNames[P]=A[P].name}var N=s?"bin":"xml",O=i.workbooks[0].lastIndexOf("/"),V=(i.workbooks[0].slice(0,O+1)+"_rels/"+i.workbooks[0].slice(O+1)+".rels").replace(/^\//,"");An(r,V)||(V="xl/_rels/workbook."+N+".rels");var B=il(fn(r,V,!0),V.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=OA(Qt(r,Cn(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=SE(Qt(r,Cn(i.people[0])),e)),B&&(B=db(B,h.Sheets));var te=Qt(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=g.Worksheets;++_){var ie="sheet";if(B&&B[_]?(T="xl/"+B[_][1].replace(/[\/]?xl\//,""),An(r,T)||(T=B[_][1]),An(r,T)||(T=V.replace(/_rels\/.*$/,"")+B[_][1]),ie=B[_][2]):(T="xl/worksheets/sheet"+(_+1-te)+"."+N,T=T.replace(/sheet0\./,"sheet.")),C=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(_!=e.sheets)continue e;break;case"string":if(g.SheetNames[_].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var D=!1,J=0;J!=e.sheets.length;++J)typeof e.sheets[J]=="number"&&e.sheets[J]==_&&(D=1),typeof e.sheets[J]=="string"&&e.sheets[J].toLowerCase()==g.SheetNames[_].toLowerCase()&&(D=1);if(!D)continue e}}gb(r,T,C,g.SheetNames[_],_,S,o,ie,e,h,u,d)}return y={Directory:i,Workbook:h,Props:g,Custprops:m,Deps:v,Sheets:o,SheetNames:g.SheetNames,Strings:ol,Styles:d,Themes:u,SSF:wr(ft)},e&&e.bookFiles&&(r.files?(y.keys=n,y.files=r.files):(y.keys=[],y.files={},r.FullPaths.forEach(function(F,se){F=F.replace(/^Root Entry[\/]/,""),y.keys.push(F),y.files[F]=r.FileIndex[se]}))),e&&e.bookVBA&&(i.vba.length>0?y.vbaraw=Qt(r,Cn(i.vba[0]),!0):i.defaults&&i.defaults.bin===EE&&(y.vbaraw=Qt(r,"xl/vbaProject.bin",!0))),y}function mb(r,e){var t=e||{},n="Workbook",i=yt.find(r,n);try{if(n="/!DataSpaces/Version",i=yt.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(lT(i.content),n="/!DataSpaces/DataSpaceMap",i=yt.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=uT(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=yt.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=hT(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=yt.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);dT(i.content)}catch{}if(n="/EncryptionInfo",i=yt.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=gT(i.content);if(n="/EncryptedPackage",i=yt.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],i.content,t.password||"",t);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],i.content,t.password||"",t);throw new Error("File is password-protected")}function Nd(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=gn(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function xb(r,e){return yt.find(r,"EncryptedPackage")?mb(r,e):hy(r,e)}function vb(r,e){var t,n=r,i=e||{};return i.type||(i.type=xt&&Buffer.isBuffer(r)?"buffer":"base64"),t=iv(n,i),pb(t,i)}function py(r,e){var t=0;e:for(;t<r.length;)switch(r.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Wf(r.slice(t),e);default:break e}return yl.to_workbook(r,e)}function yb(r,e){var t="",n=Nd(r,e);switch(e.type){case"base64":t=gn(r);break;case"binary":t=r;break;case"buffer":t=r.toString("binary");break;case"array":t=ra(r);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=Pt(t)),e.type="binary",py(t,e)}function _b(r,e){var t=r;return e.type=="base64"&&(t=gn(t)),t=pl.utils.decode(1200,t.slice(2),"str"),e.type="binary",py(t,e)}function wb(r){return r.match(/[^\x00-\x7F]/)?Qo(r):r}function _f(r,e,t,n){return n?(t.type="string",yl.to_workbook(r,t)):yl.to_workbook(e,t)}function Yf(r,e){zx();var t=e||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return Yf(new Uint8Array(r),(t=wr(t),t.type="array",t));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=r,i=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Ya={},t.dateNF&&(Ya.dateNF=t.dateNF),t.type||(t.type=xt&&Buffer.isBuffer(r)?"buffer":"base64"),t.type=="file"&&(t.type=xt?"buffer":"binary",n=lS(r),typeof Uint8Array<"u"&&!xt&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,n=wb(r)),t.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),c=new Uint8Array(o);if(c.foo="bar",!c.foo)return t=wr(t),t.type="array",Yf(fd(n),t)}switch((i=Nd(n,t))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return xb(yt.read(n,t),t);break;case 9:if(i[1]<=8)return hy(n,t);break;case 60:return Wf(n,t);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return KC(n,t);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return YC.to_workbook(n,t);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?vb(n,t):_f(r,n,t,s);case 239:return i[3]===60?Wf(n,t):_f(r,n,t,s);case 255:if(i[1]===254)return _b(n,t);if(i[1]===0&&i[2]===2&&i[3]===0)return al.to_workbook(n,t);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return al.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return S1.to_workbook(n,t);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return ET.to_workbook(n,t);break;case 10:case 13:case 32:return yb(n,t);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return XC.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?S1.to_workbook(n,t):_f(r,n,t,s)}function Sb(r,e,t,n,i,s,o,c){var u=Sr(t),d=c.defval,h=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),g=!0,x=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:t,enumerable:!1})}catch{x.__rowNum__=t}else x.__rowNum__=t;if(!o||r[t])for(var m=e.s.c;m<=e.e.c;++m){var y=o?r[t][m]:r[n[m]+u];if(y===void 0||y.t===void 0){if(d===void 0)continue;s[m]!=null&&(x[s[m]]=d);continue}var v=y.v;switch(y.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[m]!=null){if(v==null)if(y.t=="e"&&v===null)x[s[m]]=null;else if(d!==void 0)x[s[m]]=d;else if(h&&v===null)x[s[m]]=null;else continue;else x[s[m]]=h&&(y.t!=="n"||y.t==="n"&&c.rawNumbers!==!1)?v:zi(y,v,c);v!=null&&(g=!1)}}return{row:x,isempty:g}}function $f(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},n=0,i=1,s=[],o=0,c="",u={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},h=d.range!=null?d.range:r["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof h){case"string":u=Wt(h);break;case"number":u=Wt(r["!ref"]),u.s.r=h;break;default:u=h}n>0&&(i=0);var g=Sr(u.s.r),x=[],m=[],y=0,v=0,_=Array.isArray(r),S=u.s.r,T=0,C={};_&&!r[S]&&(r[S]=[]);var A=d.skipHidden&&r["!cols"]||[],P=d.skipHidden&&r["!rows"]||[];for(T=u.s.c;T<=u.e.c;++T)if(!(A[T]||{}).hidden)switch(x[T]=sr(T),t=_?r[S][T]:r[x[T]+g],n){case 1:s[T]=T-u.s.c;break;case 2:s[T]=x[T];break;case 3:s[T]=d.header[T-u.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=o=zi(t,null,d),v=C[o]||0,!v)C[o]=1;else{do c=o+"_"+v++;while(C[c]);C[o]=v,C[c]=1}s[T]=c}for(S=u.s.r+i;S<=u.e.r;++S)if(!(P[S]||{}).hidden){var N=Sb(r,u,S,x,n,s,_,d);(N.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(m[y++]=N.row)}return m.length=y,m}var j1=/"/g;function kb(r,e,t,n,i,s,o,c){for(var u=!0,d=[],h="",g=Sr(t),x=e.s.c;x<=e.e.c;++x)if(n[x]){var m=c.dense?(r[t]||[])[x]:r[n[x]+g];if(m==null)h="";else if(m.v!=null){u=!1,h=""+(c.rawNumbers&&m.t=="n"?m.v:zi(m,null,c));for(var y=0,v=0;y!==h.length;++y)if((v=h.charCodeAt(y))===i||v===s||v===34||c.forceQuotes){h='"'+h.replace(j1,'""')+'"';break}h=="ID"&&(h='"ID"')}else m.f!=null&&!m.F?(u=!1,h="="+m.f,h.indexOf(",")>=0&&(h='"'+h.replace(j1,'""')+'"')):h="";d.push(h)}return c.blankrows===!1&&u?null:d.join(o)}function my(r,e){var t=[],n=e??{};if(r==null||r["!ref"]==null)return"";var i=Wt(r["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,u=c.charCodeAt(0),d=new RegExp((s=="|"?"\\|":s)+"+$"),h="",g=[];n.dense=Array.isArray(r);for(var x=n.skipHidden&&r["!cols"]||[],m=n.skipHidden&&r["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(x[y]||{}).hidden||(g[y]=sr(y));for(var v=0,_=i.s.r;_<=i.e.r;++_)(m[_]||{}).hidden||(h=kb(r,i,_,g,o,u,s,n),h!=null&&(n.strip&&(h=h.replace(d,"")),(h||n.blankrows!==!1)&&t.push((v++?c:"")+h)));return delete n.dense,t.join("")}function Cb(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=my(r,e);return t}function Tb(r){var e="",t,n="";if(r==null||r["!ref"]==null)return[];var i=Wt(r["!ref"]),s="",o=[],c,u=[],d=Array.isArray(r);for(c=i.s.c;c<=i.e.c;++c)o[c]=sr(c);for(var h=i.s.r;h<=i.e.r;++h)for(s=Sr(h),c=i.s.c;c<=i.e.c;++c)if(e=o[c]+s,t=d?(r[h]||[])[c]:r[e],n="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;n=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}u[u.length]=e+"="+n}return u}function xy(r,e,t){var n=t||{},i=+!n.skipHeader,s=r||{},o=0,c=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Vr(n.origin):n.origin;o=u.r,c=u.c}var d,h={s:{c:0,r:0},e:{c,r:o+e.length-1+i}};if(s["!ref"]){var g=Wt(s["!ref"]);h.e.c=Math.max(h.e.c,g.e.c),h.e.r=Math.max(h.e.r,g.e.r),o==-1&&(o=g.e.r+1,h.e.r=o+e.length-1+i)}else o==-1&&(o=0,h.e.r=e.length-1+i);var x=n.header||[],m=0;e.forEach(function(v,_){gi(v).forEach(function(S){(m=x.indexOf(S))==-1&&(x[m=x.length]=S);var T=v[S],C="z",A="",P=ht({c:c+m,r:o+_+i});d=kl(s,P),T&&typeof T=="object"&&!(T instanceof Date)?s[P]=T:(typeof T=="number"?C="n":typeof T=="boolean"?C="b":typeof T=="string"?C="s":T instanceof Date?(C="d",n.cellDates||(C="n",T=Hr(T)),A=n.dateNF||ft[14]):T===null&&n.nullError&&(C="e",T=0),d?(d.t=C,d.v=T,delete d.w,delete d.R,A&&(d.z=A)):s[P]=d={t:C,v:T},A&&(d.z=A))})}),h.e.c=Math.max(h.e.c,c+x.length-1);var y=Sr(o);if(i)for(m=0;m<x.length;++m)s[sr(m+c)+y]={t:"s",v:x[m]};return s["!ref"]=_t(h),s}function Eb(r,e){return xy(null,r,e)}function kl(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var n=Vr(e);return r[n.r]||(r[n.r]=[]),r[n.r][n.c]||(r[n.r][n.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?kl(r,ht(e)):kl(r,ht({r:e,c:t||0}))}function Ab(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Id(){return{SheetNames:[],Sheets:{}}}function Rd(r,e,t,n){var i=1;if(!t)for(;i<=65535&&r.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&r.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||t;for(++i;i<=65535&&r.SheetNames.indexOf(t=o+i)!=-1;++i);}if(hA(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function bb(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var n=Ab(r,e);switch(r.Workbook.Sheets[n]||(r.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[n].Hidden=t}function Fb(r,e){return r.z=e,r}function vy(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function Ob(r,e,t){return vy(r,"#"+e,t)}function Db(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function Pb(r,e,t,n){for(var i=typeof e!="string"?e:Wt(e),s=typeof e=="string"?e:_t(e),o=i.s.r;o<=i.e.r;++o)for(var c=i.s.c;c<=i.e.c;++c){var u=kl(r,o,c);u.t="n",u.F=s,delete u.v,o==i.s.r&&c==i.s.c&&(u.f=t,n&&(u.D=!0))}return r}var Mb={encode_col:sr,encode_row:Sr,encode_cell:ht,encode_range:_t,decode_col:wd,decode_row:_d,split_cell:HS,decode_cell:Vr,decode_range:to,format_cell:zi,sheet_add_aoa:Sv,sheet_add_json:xy,sheet_add_dom:fy,aoa_to_sheet:ro,json_to_sheet:Eb,table_to_sheet:dy,table_to_book:KA,sheet_to_csv:my,sheet_to_txt:Cb,sheet_to_json:$f,sheet_to_html:$A,sheet_to_formulae:Tb,sheet_to_row_object_array:$f,sheet_get_cell:kl,book_new:Id,book_append_sheet:Rd,book_set_sheet_visibility:bb,cell_set_number_format:Fb,cell_set_hyperlink:vy,cell_set_internal_link:Ob,cell_add_comment:Db,sheet_set_array_formula:Pb,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},yy=(r=>(r[r.timeHour=0]="timeHour",r[r.timeHourLow=1]="timeHourLow",r[r.timeHourHigh=2]="timeHourHigh",r[r.timeMinute=3]="timeMinute",r[r.timeMinuteLow=4]="timeMinuteLow",r[r.timeMinuteHigh=5]="timeMinuteHigh",r[r.timeSecond=6]="timeSecond",r[r.timeSecondLow=7]="timeSecondLow",r[r.timeSecondHigh=8]="timeSecondHigh",r[r.timeCentiSecond=9]="timeCentiSecond",r[r.timeCentiSecondLow=10]="timeCentiSecondLow",r[r.timeCentiSecondHigh=11]="timeCentiSecondHigh",r[r.dateYear=12]="dateYear",r[r.dateYearDigit1=13]="dateYearDigit1",r[r.dateYearDigit2=14]="dateYearDigit2",r[r.dateYearDigit3=15]="dateYearDigit3",r[r.dateYearDigit4=16]="dateYearDigit4",r[r.dateMonth=17]="dateMonth",r[r.dateMonthLow=18]="dateMonthLow",r[r.dateMonthHigh=19]="dateMonthHigh",r[r.dateDay=20]="dateDay",r[r.dateDayLow=21]="dateDayLow",r[r.dateDayHigh=22]="dateDayHigh",r[r.dateWeek=23]="dateWeek",r[r.dateLunarYear=24]="dateLunarYear",r[r.dateLunarMonth=25]="dateLunarMonth",r[r.dateLunarDay=26]="dateLunarDay",r[r.miscIsAM=27]="miscIsAM",r[r.miscIsPM=28]="miscIsPM",r[r.miscTimeSection=29]="miscTimeSection",r[r.miscIs24H=30]="miscIs24H",r[r.healthStepCount=31]="healthStepCount",r[r.healthStepCountDigit1=32]="healthStepCountDigit1",r[r.healthStepCountDigit2=33]="healthStepCountDigit2",r[r.healthStepCountDigit3=34]="healthStepCountDigit3",r[r.healthStepCountDigit4=35]="healthStepCountDigit4",r[r.healthStepCountDigit5=36]="healthStepCountDigit5",r[r.healthStepProgress=37]="healthStepProgress",r[r.healthStepKiloMeter=38]="healthStepKiloMeter",r[r.healthHeartRate=39]="healthHeartRate",r[r.healthHearRateZone=40]="healthHearRateZone",r[r.healthHeartRateMin=41]="healthHeartRateMin",r[r.healthHeartRateMax=42]="healthHeartRateMax",r[r.healthCalorie=43]="healthCalorie",r[r.healthCalorieProgress=44]="healthCalorieProgress",r[r.healthStandCount=45]="healthStandCount",r[r.healthStandProgress=46]="healthStandProgress",r[r.healthSleepDuration=47]="healthSleepDuration",r[r.healthSleepScore=48]="healthSleepScore",r[r.healthMiscRecoveryTime=49]="healthMiscRecoveryTime",r[r.healthMiscRunPowerIndex=50]="healthMiscRunPowerIndex",r[r.healthBloodPressureUnit=51]="healthBloodPressureUnit",r[r.weatherCurrentSunRiseHour=52]="weatherCurrentSunRiseHour",r[r.weatherCurrentSunRiseMinute=53]="weatherCurrentSunRiseMinute",r[r.weatherCurrentSunSetHour=54]="weatherCurrentSunSetHour",r[r.weatherCurrentSunSetMinute=55]="weatherCurrentSunSetMinute",r[r.weatherCurrentTemperature=56]="weatherCurrentTemperature",r[r.weatherCurrentTemperatureFeel=57]="weatherCurrentTemperatureFeel",r[r.weatherCurrentHumidity=58]="weatherCurrentHumidity",r[r.weatherCurrentWeather=59]="weatherCurrentWeather",r[r.weatherCurrentWindDirection=60]="weatherCurrentWindDirection",r[r.weatherCurrentWindAngle=61]="weatherCurrentWindAngle",r[r.weatherCurrentWindSpeed=62]="weatherCurrentWindSpeed",r[r.weatherCurrentWindLevel=63]="weatherCurrentWindLevel",r[r.weatherCurrentAirQualityIndex=64]="weatherCurrentAirQualityIndex",r[r.weatherCurrentAirQualityLevel=65]="weatherCurrentAirQualityLevel",r[r.weatherCurrentChanceOfRain=66]="weatherCurrentChanceOfRain",r[r.weatherCurrentPressure=67]="weatherCurrentPressure",r[r.weatherCurrentVisibility=68]="weatherCurrentVisibility",r[r.weatherCurrentUVIndex=69]="weatherCurrentUVIndex",r[r.weatherCurrentUVLevel=70]="weatherCurrentUVLevel",r[r.weatherCurrentDressIndex=71]="weatherCurrentDressIndex",r[r.weatherCurrentWeatherIndex=72]="weatherCurrentWeatherIndex",r[r.weatherCurrentWeatherCode=73]="weatherCurrentWeatherCode",r[r.weatherTemperatureUnit=74]="weatherTemperatureUnit",r[r.systemStatusBattery=75]="systemStatusBattery",r[r.systemStatusCharge=76]="systemStatusCharge",r[r.systemSensorFusionAltitude=77]="systemSensorFusionAltitude",r[r.systemStatusBluetooth=78]="systemStatusBluetooth",r[r.healthExerciseDuration=79]="healthExerciseDuration",r[r.healthOxygenSpO2=80]="healthOxygenSpO2",r[r.healthPressureIndex=81]="healthPressureIndex",r[r.healthMiscSevenDaysVitalityValue=82]="healthMiscSevenDaysVitalityValue",r[r.healthBloodDiastolicPressureMmhg=83]="healthBloodDiastolicPressureMmhg",r[r.healthBloodDiastolicPressureKpa=84]="healthBloodDiastolicPressureKpa",r[r.healthBloodSystolicPressureMmhg=85]="healthBloodSystolicPressureMmhg",r[r.healthBloodSystolicPressureKpa=86]="healthBloodSystolicPressureKpa",r[r.weatherTodayTemperatureMax=87]="weatherTodayTemperatureMax",r[r.weatherTodayTemperatureMin=88]="weatherTodayTemperatureMin",r[r.healthBloodSugarValue=89]="healthBloodSugarValue",r[r.healthSleepTargetProgress=90]="healthSleepTargetProgress",r[r.healthExerciseProgress=91]="healthExerciseProgress",r[r.systemStatusDisturb=92]="systemStatusDisturb",r[r.healthStressLevel=93]="healthStressLevel",r[r.healthDistancePrecent=94]="healthDistancePrecent",r))(yy||{});class dn{}Ke(dn,"DataItemTypes",{Year:12,Month:17,Day:20,Hour:0,Minute:3,Second:6,Week:23,"Month (Normal)":17,"Day (Normal)":20,"Hour (Normal)":0,"Step Progress":37,"Calorie Progress":44,"Sleep Target Progress":90,"Exercise Progress":91,"Hour (Tens)":2,"Hour (Ones)":1,"Minute (Tens)":5,"Minute (Ones)":4,"Second (Tens)":8,"Second (Ones)":7,"Year (Thousands)":16,"Year (Hundreds)":15,"Year (Tens)":14,"Year (Ones)":13,"Month (Tens)":19,"Month (Ones)":18,"Day (Tens)":22,"Day (Ones)":21,"Steps (Ten Thousands)":36,"Steps (Thousands)":35,"Steps (Hundreds)":34,"Steps (Tens)":33,"Steps (Ones)":32,"24H":30,"Blood Pressure Unit":51,"Current Charging Status 24H":76,"Do Not Disturb Mode":92,"Bluetooth Status":78,"Temperature Unit":74,"AM/PM":28,Steps:31,"Heart Rate":39,Calories:43,Battery:75,"Step Distance":38,"Stand Count":45,"Exercise Duration":79,"Min Heart Rate":41,"Max Heart Rate":42,"Blood Oxygen":80,"Stress Index":81,"Recovery Time":49,"7-Day Vitality":82,"Wind Speed":62,"Wind Direction Angle":61,AQI:64,Visibility:68,"UV Index":69,Temperature:56,"Today's High":87,"Today's Low":88,"Feels Like":57,Humidity:58,"Running Power Index":50,"Rain Chance":66,"Sea Level Pressure":67,"Sleep Duration":47,"Blood Sugar":89,"Clothing Index":71,"Wind Level":63,"Wind Direction":60,"Heart Rate Zone":40,Weather:59,"Air Quality Level":64,"Time Section":29,"Stand Progress":46,"Blood Oxygen Progress":80,"Stress Progress":81,"Battery Progress":75,Hand:29,"Stress Level":93,"Distance Progress":94}),Ke(dn,"VerifyNullNum",["Heart Rate","Blood Oxygen","Stress Level","Sleep Duration","Sleep Target Progress","Feels Like","Temperature","Humidity","Wind Direction Angle","Wind Speed","AQI","Rain Chance","Visibility","UV Index","Today's High","Today's Low","Steps","Step Distance","Exercise Duration"]);var mt=(r=>(r[r.Time=0]="Time",r[r.BloodOxygen=1]="BloodOxygen",r[r.Battery=2]="Battery",r[r.Steps=3]="Steps",r[r.HeartRate=4]="HeartRate",r[r.Calories=5]="Calories",r[r.Distance=6]="Distance",r[r.Sleep=7]="Sleep",r[r.Weather=8]="Weather",r))(mt||{});class pn{constructor(){Ke(this,"dragName");Ke(this,"width",0);Ke(this,"height",0);Ke(this,"left");Ke(this,"top");Ke(this,"x");Ke(this,"y");Ke(this,"align",0);Ke(this,"elementType");Ke(this,"dragId");Ke(this,"maxNum",0);Ke(this,"minNum",0);Ke(this,"subItems",[]);Ke(this,"visible",!0);Ke(this,"itemName");Ke(this,"defaultNum");Ke(this,"imageSource",[]);Ke(this,"propertyChangeHandlers",new Map);Ke(this,"propertyChangeListeners",[]);this.dragId=this.generateGuid(),this.subItems=[],this.visible=!0}generateGuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}get verifyNullNum(){return dn.VerifyNullNum.includes(this.itemName||"")}getLeft(){return this.align===1?Math.floor((this.left||0)-(this.width||0)/2):this.align===2?Math.floor((this.left||0)-(this.width||0)):Math.floor(this.left||0)}addPropertyChangeListener(e){this.propertyChangeListeners.push(e)}removePropertyChangeListener(e){const t=this.propertyChangeListeners.indexOf(e);t>-1&&this.propertyChangeListeners.splice(t,1)}notifyPropertyChanged(e){var n;this.propertyChangeListeners.forEach(i=>i(e));const t=(n=this.propertyChangeHandlers)==null?void 0:n.get(e);t&&t.forEach(i=>i(this,e))}setWidth(e){this.width=e,this.notifyPropertyChanged("width")}setHeight(e){this.height=e,this.notifyPropertyChanged("height")}setLeft(e){this.left=e,this.notifyPropertyChanged("left")}setTop(e){this.top=e,this.notifyPropertyChanged("top")}setVisible(e){this.visible=e,this.notifyPropertyChanged("visible")}}class wf extends pn{constructor(){super();Ke(this,"dateTimeFormat");Ke(this,"setDateTime");Ke(this,"currentNum",0);Ke(this,"imageSource",[])}getAllImages(){return this.imageSource||[]}getOutXml(){var o,c;const t={imageArrays:[],dataItemImageValues:[],layout:null},n={name:this.generateElementName(),images:((o=this.imageSource)==null?void 0:o.map(u=>({src:u})))||[]};t.imageArrays.push(n);const i={name:this.generateElementName(),source:((c=dn.DataItemTypes[this.itemName||""])==null?void 0:c.toString())||"",ref:`@${n.name}`};t.dataItemImageValues.push(i);const s={ref:`@${i.name}`,x:Math.floor(this.left||0),y:Math.floor(this.top||0)};return t.layout=s,t}generateElementName(){return`element_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}setDateTimeFormat(t){this.dateTimeFormat=t,this.notifyPropertyChanged("dateTimeFormat")}setSetDateTime(t){this.setDateTime=t,this.notifyPropertyChanged("setDateTime")}setCurrentNum(t){this.currentNum=t,this.notifyPropertyChanged("currentNum")}setImageSource(t){this.imageSource=t,this.notifyPropertyChanged("imageSource")}}class z1 extends pn{constructor(t,n,i){super();Ke(this,"currentNum",0);Ke(this,"unitSource");Ke(this,"doubleImageSource");Ke(this,"pointSource");Ke(this,"emptySource");Ke(this,"decimalOffsetX",0);Ke(this,"trailingZero",!1);Ke(this,"decimalPlaces",1);t!==void 0&&n!==void 0&&i!==void 0&&(this.maxNum=t,this.minNum=n,this.currentNum=i)}get CurrentNum(){return Math.round(this.currentNum*Math.pow(10,this.decimalPlaces))/Math.pow(10,this.decimalPlaces)}set CurrentNum(t){this.currentNum!==t&&(this.currentNum=t,this.notifyPropertyChanged("CurrentNum"))}get UnitSource(){return this.unitSource}set UnitSource(t){this.unitSource!==t&&(this.unitSource=t,this.notifyPropertyChanged("UnitSource"))}get ImageSource(){return this.doubleImageSource}set ImageSource(t){this.doubleImageSource!==t&&(this.doubleImageSource=t,this.notifyPropertyChanged("ImageSource"))}get PointSource(){return this.pointSource}set PointSource(t){this.pointSource!==t&&(this.pointSource=t,this.notifyPropertyChanged("PointSource"))}get EmptySource(){return this.emptySource}set EmptySource(t){this.emptySource!==t&&(this.emptySource=t,this.notifyPropertyChanged("EmptySource"))}get DecimalOffsetX(){return this.decimalOffsetX}set DecimalOffsetX(t){this.decimalOffsetX!==t&&(this.decimalOffsetX=t,this.notifyPropertyChanged("DecimalOffsetX"))}get TrailingZero(){return this.trailingZero}set TrailingZero(t){this.trailingZero!==t&&(this.trailingZero=t,this.notifyPropertyChanged("TrailingZero"))}notifyPropertyChanged(t){var i;const n=(i=this.propertyChangeHandlers)==null?void 0:i.get(t);n&&n.forEach(s=>s(this,t))}getAllImages(){const t=[];return this.doubleImageSource&&this.doubleImageSource.length>0&&t.push(...this.doubleImageSource),t.push(this.unitSource),t.push(this.pointSource),t.push(this.emptySource),t}getNumStr(t,n,i){return t?n.toFixed(i):n.toFixed(1).replace(/\.?0+$/,"")}getOutXml(){var o,c;if(this.verifyNullNum&&this.doubleImageSource&&this.doubleImageSource.length!==11)throw new Error(`${this.dragName}`);const t={images:[],imageArrays:[],dataItemImageNumbers:[],layout:null};let n=null;this.unitSource&&(n={src:this.unitSource,name:`unit_${Date.now()}`},t.images.push(n));const i={name:`array_${Date.now()}`,images:((o=this.doubleImageSource)==null?void 0:o.map(u=>({src:u})))||[]};this.emptySource&&i.images.push({src:this.emptySource}),this.pointSource&&i.images.push({src:this.pointSource}),t.imageArrays.push(i);const s={name:`dataItem_${Date.now()}`,source:((c=dn.DataItemTypes[this.itemName])==null?void 0:c.toString())||"0",ref:`@${i.name}`,unitIcon:n?`@${n.name}`:"",align:this.align.toString(),totalDigits:5,decimalDigits:this.itemName==="Step Distance"?2:1,decimalOffsetX:this.decimalOffsetX,trailingZero:this.trailingZero,renderRule:"alwaysShow"};return t.dataItemImageNumbers.push(s),t.layout={ref:`@${s.name}`,x:Math.floor(this.left||0),y:Math.floor(this.top||0)},t}}class U1 extends pn{constructor(t,n){super();Ke(this,"keyValueMaxNum",0);Ke(this,"currentNum",0);Ke(this,"keyValueImageSource");Ke(this,"keyValues",new Map);Ke(this,"valueDataImages");if(t&&n){if(this.keyValues=t,this.keyValueMaxNum=t.size-1,this.minNum=0,n.length<t.size){const i=[...n],s=t.size-n.length;for(let o=0;o<s;o++)i.push("");this.keyValueImageSource=i}else this.keyValueImageSource=[...n];this.valueDataImages=Array.from(t.entries()).map(([i,s],o)=>({key:s,value:this.keyValueImageSource[o]}))}}get KeyValue(){if(this.keyValues.size>0&&this.currentNum<=this.keyValues.size-1){const t=Array.from(this.keyValues.entries());return{key:t[this.currentNum][0],value:t[this.currentNum][1]}}}get CurrentNum(){return this.currentNum}set CurrentNum(t){this.currentNum!==t&&(this.currentNum=t,this.notifyPropertyChanged("CurrentNum"),this.notifyPropertyChanged("KeyValue"))}get ImageSource(){return this.keyValueImageSource}set ImageSource(t){this.keyValueImageSource!==t&&(this.keyValueImageSource=t,this.notifyPropertyChanged("ImageSource"))}notifyPropertyChanged(t){var i;const n=(i=this.propertyChangeHandlers)==null?void 0:i.get(t);n&&n.forEach(s=>s(this,t))}getAllImages(){return this.keyValueImageSource||[]}getImageArrayByWeather(){const t=Array.from(this.keyValues.entries()).map(([n,i],s)=>{var o;return(o=this.keyValueImageSource)==null?void 0:o[s]}).filter(n=>n);return{name:`weather_array_${Date.now()}`,images:(t==null?void 0:t.map(n=>({src:n})))||[]}}getOutXml(){var s,o;const t={images:[],imageArrays:[],dataItemImageValues:[],layout:null};let n;this.itemName==="Weather"?n=this.getImageArrayByWeather():n={name:`array_${Date.now()}`,images:((s=this.keyValueImageSource)==null?void 0:s.map(c=>({src:c})))||[]},t.imageArrays.push(n);const i={name:`dataItem_${Date.now()}`,source:((o=dn.DataItemTypes[this.itemName])==null?void 0:o.toString())||"0",ref:`@${n.name}`};return this.itemName==="Weather"?i.params=Array.from(this.keyValues.entries()).map(([c,u])=>({value:c,label:u})):i.params=Array.from(this.keyValues.entries()).map(([c,u])=>({value:c,label:u})),t.dataItemImageValues.push(i),t.layout={ref:`@${i.name}`,x:Math.floor(this.left||0),y:Math.floor(this.top||0)},t}}class V1 extends pn{constructor(t){super();Ke(this,"startAngle",0);Ke(this,"endAngle",360);Ke(this,"originPointX",0);Ke(this,"originPointY",0);Ke(this,"pointSource");Ke(this,"pointValue",0);Ke(this,"pointAngle",0);Ke(this,"valueIndex",0);t&&(this.pointSource=t,this.originPointX=25,this.originPointY=25)}get StartAngle(){return this.startAngle}set StartAngle(t){this.startAngle!==t&&(this.startAngle=t,this.notifyPropertyChanged("StartAngle"))}get EndAngle(){return this.endAngle}set EndAngle(t){this.endAngle!==t&&(this.endAngle=t,this.notifyPropertyChanged("EndAngle"))}get OriginPointX(){return this.originPointX}set OriginPointX(t){this.originPointX!==t&&(this.originPointX=t,this.notifyPropertyChanged("OriginPointX"))}get OriginPointY(){return this.originPointY}set OriginPointY(t){this.originPointY!==t&&(this.originPointY=t,this.notifyPropertyChanged("OriginPointY"))}get Source(){return this.pointSource}set Source(t){this.pointSource!==t&&(this.pointSource=t,this.notifyPropertyChanged("Source"))}get Value(){return this.pointValue}set Value(t){this.pointValue!==t&&(this.pointValue=t,this.notifyPropertyChanged("Value"))}get Angle(){return this.pointAngle}set Angle(t){this.pointAngle!==t&&(this.pointAngle=t,this.notifyPropertyChanged("Angle"))}get ValueIndex(){return this.valueIndex}set ValueIndex(t){this.valueIndex!==t&&(this.valueIndex=t,this.endAngle=t===0?720:360,this.notifyPropertyChanged("ValueIndex"))}notifyPropertyChanged(t){var i;const n=(i=this.propertyChangeHandlers)==null?void 0:i.get(t);n&&n.forEach(s=>s(this,t))}getAllImages(){return[this.pointSource]}getOutXml(){var s,o,c;const t={images:[],dataItemPointers:[],layout:null},n={name:`pointer_${Date.now()}`,src:this.pointSource,isPointer:!0};t.images.push(n);const i={name:`pointer_data_${Date.now()}`,source:this.valueIndex===0?(s=dn.DataItemTypes.Hour)==null?void 0:s.toString():this.valueIndex===1?(o=dn.DataItemTypes.Minute)==null?void 0:o.toString():(c=dn.DataItemTypes.Second)==null?void 0:c.toString(),ref:`@${n.name}`,angleStart:0,angleRange:this.valueIndex===0?720:360,valueStart:0,valueRange:this.valueIndex===0?24:60,pivotX:this.originPointX,pivotY:this.originPointY};return t.dataItemPointers.push(i),t.layout={ref:`@${i.name}`,x:Math.floor(this.left||0),y:Math.floor(this.top||0)},t}}class W1 extends pn{constructor(){super(...arguments);Ke(this,"animImageSource");Ke(this,"repeatCount");Ke(this,"frameRate");Ke(this,"isRepeat",!1);Ke(this,"isPlay",!1)}get ImageSource(){return this.animImageSource}set ImageSource(t){this.animImageSource!==t&&(this.animImageSource=t,this.notifyPropertyChanged("ImageSource"))}get RepeatCount(){return this.repeatCount}set RepeatCount(t){this.repeatCount!==t&&(this.repeatCount=t,this.notifyPropertyChanged("RepeatCount"))}get FrameRate(){return this.frameRate}set FrameRate(t){this.frameRate!==t&&(this.frameRate=t,this.notifyPropertyChanged("FrameRate"))}get IsRepeat(){return this.isRepeat}set IsRepeat(t){this.isRepeat!==t&&(this.isRepeat=t,this.notifyPropertyChanged("IsRepeat"))}get IsPlay(){return this.isPlay}set IsPlay(t){this.isPlay!==t&&(this.isPlay=t,this.notifyPropertyChanged("IsPlay"))}notifyPropertyChanged(t){var i;const n=(i=this.propertyChangeHandlers)==null?void 0:i.get(t);n&&n.forEach(s=>s(this,t))}getAllImages(){return this.animImageSource||[]}getOutXml(){var s,o;const t={imageArrays:[],sprites:[],layout:null},n={name:`anim_array_${Date.now()}`,images:((s=this.animImageSource)==null?void 0:s.map(c=>({src:c})))||[]};t.imageArrays.push(n);const i={name:`sprite_${Date.now()}`,ref:`@${n.name}`,interval:this.frameRate?Math.floor(1e3/this.frameRate):100,repeatCount:this.isRepeat?0:this.repeatCount||1,imageCount:((o=this.animImageSource)==null?void 0:o.length)||0};return t.sprites.push(i),t.layout={ref:`@${i.name}`,x:Math.floor(this.left||0),y:Math.floor(this.top||0)},t}}class Sf extends pn{constructor(){super();Ke(this,"dateTimeFormat");Ke(this,"setDateTime");Ke(this,"leadingZero",!1);Ke(this,"unitIcon");Ke(this,"imageSource",[])}getAllImages(){const t=[...this.imageSource||[]];return this.unitIcon&&t.push(this.unitIcon),t}getOutXml(){var o,c;const t={imageArrays:[],dataItemImageValues:[],layout:null},n={name:this.generateElementName(),images:((o=this.imageSource)==null?void 0:o.map(u=>({src:u})))||[]};t.imageArrays.push(n);const i={name:this.generateElementName(),source:((c=dn.DataItemTypes[this.itemName||""])==null?void 0:c.toString())||"",ref:`@${n.name}`,format:this.dateTimeFormat,leadingZero:this.leadingZero};if(t.dataItemImageValues.push(i),this.unitIcon){const u={name:this.generateElementName(),images:[{src:this.unitIcon}]};t.imageArrays.push(u)}const s={ref:`@${i.name}`,x:Math.floor(this.left||0),y:Math.floor(this.top||0)};return t.layout=s,t}generateElementName(){return`element_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}class Ra extends pn{constructor(t=100,n=0,i=50){super();Ke(this,"imageSource",[]);Ke(this,"targetValue",0);this.maxNum=t,this.minNum=n,this.defaultNum=i}getAllImages(){return this.imageSource||[]}getOutXml(){var o,c;const t={imageArrays:[],dataItemImageValues:[],layout:null},n={name:this.generateElementName(),images:((o=this.imageSource)==null?void 0:o.map(u=>({src:u})))||[]};t.imageArrays.push(n);const i={name:this.generateElementName(),source:((c=dn.DataItemTypes[this.itemName||""])==null?void 0:c.toString())||"",ref:`@${n.name}`,maxValue:this.maxNum,minValue:this.minNum,targetValue:this.targetValue};t.dataItemImageValues.push(i);const s={ref:`@${i.name}`,x:Math.floor(this.left||0),y:Math.floor(this.top||0)};return t.layout=s,t}generateElementName(){return`element_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}class su extends pn{constructor(t=100,n=0,i=0){super();Ke(this,"imageSource",[]);this.maxNum=t,this.minNum=n,this.defaultNum=i}getAllImages(){return this.imageSource||[]}getOutXml(){var o,c;const t={imageArrays:[],dataItemImageValues:[],layout:null},n={name:this.generateElementName(),images:((o=this.imageSource)==null?void 0:o.map(u=>({src:u})))||[]};t.imageArrays.push(n);const i={name:this.generateElementName(),source:((c=dn.DataItemTypes[this.itemName||""])==null?void 0:c.toString())||"",ref:`@${n.name}`,maxValue:this.maxNum,minValue:this.minNum,defaultValue:this.defaultNum};t.dataItemImageValues.push(i);const s={ref:`@${i.name}`,x:Math.floor(this.left||0),y:Math.floor(this.top||0)};return t.layout=s,t}generateElementName(){return`element_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}class H1 extends pn{constructor(){super();Ke(this,"openSource");Ke(this,"closeSource")}getAllImages(){return[this.openSource,this.closeSource].filter(t=>t!==void 0)}getOutXml(){var o;const t={imageArrays:[],dataItemImageValues:[],layout:null},n={name:this.generateElementName(),images:[{src:this.openSource},{src:this.closeSource}].filter(c=>c.src)};t.imageArrays.push(n);const i={name:this.generateElementName(),source:((o=dn.DataItemTypes[this.itemName||""])==null?void 0:o.toString())||"",ref:`@${n.name}`};t.dataItemImageValues.push(i);const s={ref:`@${i.name}`,x:Math.floor(this.left||0),y:Math.floor(this.top||0)};return t.layout=s,t}generateElementName(){return`element_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}class X1 extends pn{constructor(){super();Ke(this,"amSource");Ke(this,"pmSource")}getAllImages(){return[this.amSource,this.pmSource].filter(t=>t!==void 0)}getOutXml(){const t={imageArrays:[],dataItemImageValues:[],layout:null},n={name:this.generateElementName(),images:[{src:this.amSource},{src:this.pmSource}].filter(o=>o.src)};t.imageArrays.push(n);const i={name:this.generateElementName(),source:yy.miscIsPM.toString(),ref:`@${n.name}`};t.dataItemImageValues.push(i);const s={ref:`@${i.name}`,x:Math.floor(this.left||0),y:Math.floor(this.top||0)};return t.layout=s,t}generateElementName(){return`element_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}class Nb extends pn{constructor(){super();Ke(this,"source")}getAllImages(){return this.source?[this.source]:[]}getOutXml(){const t={imageArrays:[],dataItemImageValues:[],layout:null};if(this.source){const n={name:this.generateElementName(),images:[{src:this.source}]};t.imageArrays.push(n);const i={ref:`@${n.name}`,x:Math.floor(this.left||0),y:Math.floor(this.top||0)};t.layout=i}return t}generateElementName(){return`element_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}var Iu=(r=>(r.split="split",r.unit="unit",r))(Iu||{});class ul{static getLeadingZeroStr(e,t){return e?t.toString().padStart(2,"0"):t.toString()}static getDateTime(e,t,n,i){const s=n?this.iconStr:"";switch(e){case"Year":return`${i.getFullYear()}${s}`;case"Month":return`${this.getLeadingZeroStr(t,i.getMonth()+1)}${s}`;case"Day":return`${this.getLeadingZeroStr(t,i.getDate())}${s}`;case"Hour":return`${this.getLeadingZeroStr(t,i.getHours())}${s}`;case"Minute":return`${this.getLeadingZeroStr(t,i.getMinutes())}${s}`;case"Second":return`${this.getLeadingZeroStr(t,i.getSeconds())}${s}`;case"Time":return`${this.getLeadingZeroStr(t,i.getHours())}${s}${i.getMinutes().toString().padStart(2,"0")}`;default:throw new Error(`DateTime format '${e}' not implemented`)}}static getMonthDay(e,t,n,i,s,o){const c=this.getLeadingZeroStr(e,o.getMonth()+1),u=this.getLeadingZeroStr(e,o.getDate());return t==="unit"?`${c}${i?this.monthStr:""}${u}${s?this.dayStr:""}`:t==="split"?`${c}${n?this.iconStr:""}${u}`:`${c}${u}`}static getWeekDay(e,t="short"){return e.toLocaleDateString("en-US",{weekday:t})}static getMonthName(e,t="short"){return e.toLocaleDateString("en-US",{month:t})}static get12HourTime(e,t=!0){let n=e.getHours();const i=e.getMinutes().toString().padStart(2,"0"),s=n>=12?"PM":"AM";n=n%12,n=n||12;const o=`${n}:${i}`;return t?`${o} ${s}`:o}static get24HourTime(e){const t=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0");return`${t}:${n}`}static getAmPm(e){return e.getHours()>=12?"PM":"AM"}static getFormattedDate(e,t){switch(t.toLowerCase()){case"mm/dd/yyyy":return`${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getDate().toString().padStart(2,"0")}/${e.getFullYear()}`;case"dd/mm/yyyy":return`${e.getDate().toString().padStart(2,"0")}/${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getFullYear()}`;case"yyyy-mm-dd":return`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`;default:return e.toLocaleDateString()}}static parseTimeFormat(e,t){return e.replace(/yyyy/g,t.getFullYear().toString()).replace(/MM/g,(t.getMonth()+1).toString().padStart(2,"0")).replace(/dd/g,t.getDate().toString().padStart(2,"0")).replace(/HH/g,t.getHours().toString().padStart(2,"0")).replace(/mm/g,t.getMinutes().toString().padStart(2,"0")).replace(/ss/g,t.getSeconds().toString().padStart(2,"0"))}}Ke(ul,"iconStr","&"),Ke(ul,"monthStr","@"),Ke(ul,"dayStr","#");class Ib extends pn{constructor(){super();Ke(this,"leadingZero",!0);Ke(this,"monthDayMode",Iu.split);Ke(this,"unitIcon");Ke(this,"monthIcon");Ke(this,"dayIcon");Ke(this,"setDateTime")}getAllImages(){const t=[...this.imageSource||[]];return this.unitIcon&&t.push(this.unitIcon),this.monthIcon&&t.push(this.monthIcon),this.dayIcon&&t.push(this.dayIcon),t}getOutXml(){var n;const t=this.setDateTime||new Date;return ul.getMonthDay(this.leadingZero||!1,this.monthDayMode||Iu.split,!!this.unitIcon,!!this.monthIcon,!!this.dayIcon,t),{MonthDay:{"@_X":this.x||0,"@_Y":this.y||0,"@_LeadingZero":this.leadingZero,"@_Mode":this.monthDayMode,Images:(n=this.imageSource)==null?void 0:n.map((i,s)=>({"@_Index":s,"@_Path":i})),UnitIcon:this.unitIcon?{"@_Path":this.unitIcon}:void 0,MonthIcon:this.monthIcon?{"@_Path":this.monthIcon}:void 0,DayIcon:this.dayIcon?{"@_Path":this.dayIcon}:void 0}}}setCurrentDateTime(t){this.setDateTime=t,this.notifyPropertyChanged("setDateTime")}getCurrentValue(){const t=this.setDateTime||new Date;return ul.getMonthDay(this.leadingZero||!1,this.monthDayMode||Iu.split,!!this.unitIcon,!!this.monthIcon,!!this.dayIcon,t)}setMonthDayMode(t){this.monthDayMode=t,this.notifyPropertyChanged("monthDayMode")}toggleLeadingZero(){this.leadingZero=!this.leadingZero,this.notifyPropertyChanged("leadingZero")}}var Hs=(r=>(r.Month="Month",r.Day="Day",r.Hour="Hour",r.Minute="Minute",r.Second="Second",r.Week="Week",r))(Hs||{});class G1 extends pn{constructor(){super();Ke(this,"setDateTime");Ke(this,"dateTimeType","Week")}getAllImages(){return[...this.imageSource||[]]}getOutXml(){var n;const t=this.getIndex(this.dateTimeType);return{Week:{"@_X":this.x||0,"@_Y":this.y||0,"@_DateTimeType":this.dateTimeType,"@_Index":t,Images:(n=this.imageSource)==null?void 0:n.map((i,s)=>({"@_Index":s,"@_Path":i}))}}}getIndex(t){if(!this.setDateTime)return null;switch(t){case"Month":return this.setDateTime.getMonth();case"Day":return this.setDateTime.getDate()-1;case"Hour":return this.setDateTime.getHours();case"Minute":return this.setDateTime.getMinutes();case"Second":return this.setDateTime.getSeconds();case"Week":return this.setDateTime.getDay();default:return null}}setCurrentDateTime(t){this.setDateTime=t,this.notifyPropertyChanged("setDateTime")}setDateTimeType(t){this.dateTimeType=t,this.notifyPropertyChanged("dateTimeType")}getCurrentValue(){return this.getIndex(this.dateTimeType)}getDisplayString(){if(!this.setDateTime)return"";switch(this.dateTimeType){case"Month":return this.setDateTime.toLocaleDateString("en-US",{month:"short"});case"Day":return this.setDateTime.getDate().toString();case"Hour":return this.setDateTime.getHours().toString();case"Minute":return this.setDateTime.getMinutes().toString().padStart(2,"0");case"Second":return this.setDateTime.getSeconds().toString().padStart(2,"0");case"Week":return this.setDateTime.toLocaleDateString("en-US",{weekday:"short"});default:return""}}static getWeekDayNames(t="long"){const n=new Date,i=[];for(let s=0;s<7;s++)n.setDate(n.getDate()-n.getDay()+s),i.push(n.toLocaleDateString("en-US",{weekday:t}));return i}static getMonthNames(t="long"){const n=[];for(let i=0;i<12;i++){const s=new Date(2e3,i,1);n.push(s.toLocaleDateString("en-US",{month:t}))}return n}isValidValue(){const t=this.getCurrentValue();if(t===null)return!1;switch(this.dateTimeType){case"Month":return t>=0&&t<=11;case"Day":return t>=0&&t<=30;case"Hour":return t>=0&&t<=23;case"Minute":case"Second":return t>=0&&t<=59;case"Week":return t>=0&&t<=6;default:return!1}}}class $n{static async loadWatchSettings(){try{const t=await(await fetch("/WatchFace.xlsx")).arrayBuffer(),n=Yf(t,{type:"array"}),i=n.SheetNames[0],s=n.Sheets[i],o=Mb.sheet_to_json(s);this._watchSettings=o.map(c=>({ItemName:c.ItemName||c["Item Name"]||"",ControlType:c.ControlType||c["Control Type"]||"",BindMonitorType:this.parseBindMonitorType(c.BindMonitorType||c["Bind Monitor Type"]),MaxNum:c.MaxNum||c["Max Num"],MinNum:c.MinNum||c["Min Num"],Default:c.Default,TargetValue:c.TargetValue||c["Target Value"]})),console.log("Loaded watch settings:",this._watchSettings)}catch(e){console.error("Error loading watch settings:",e),this._watchSettings=[]}}static parseBindMonitorType(e){if(typeof e=="string")switch(e.toLowerCase()){case"time":return mt.Time;case"bloodoxygen":return mt.BloodOxygen;case"battery":return mt.Battery;case"steps":return mt.Steps;case"heartrate":return mt.HeartRate;case"calories":return mt.Calories;case"distance":return mt.Distance;case"sleep":return mt.Sleep;case"weather":return mt.Weather;default:return mt.Time}return e||mt.Time}static get watchSettings(){return this._watchSettings||[]}static getWatchSettingByItemName(e){var t;return(t=this._watchSettings)==null?void 0:t.find(n=>n.ItemName===e)}static getDecimalPlaces(e){switch(e){case"Sleep Duration":case"Step Distance":return 2;default:return 1}}static get dateTimeTypes(){return{Week:Hs.Week,"Month (Normal)":Hs.Month,"Day (Normal)":Hs.Day,"Hour (Normal)":Hs.Hour,"Minute (Normal)":Hs.Minute,"Second (Normal)":Hs.Second}}static mapControlTypeToComponentType(e){switch(e){case"DragNormalDateTime":case"DragSingleDigit":return"dateTime";case"DragNums":case"DragDouble":return"number";case"DragProgress":return"progress";case"DragImage":case"DragPoint":return"image";case"DragSwitch":case"DragAMPM":return"switch";case"DragAnimFrame":return"animation";default:return"image"}}static mapBindMonitorTypeToElementType(e){return e}static getComponentConfig(e){return{dateTimeFormat:e.ItemName,leadingZero:!0,minValue:e.MinNum||0,maxValue:e.MaxNum||100,defaultValue:e.Default||0,targetValue:e.TargetValue||0}}static getDragBindBase(e,t,n,i){if(!t)return null;let s=i;if(t.ControlType==="DragImage")s=i;else{if((t.ControlType==="DragSwitch"||t.ControlType==="DragAMPM")&&i.length<2)return console.error("Please select at least 2 images"),null;s=i}switch(t.ControlType){case"DragNormalDateTime":{const o=new Sf;return o.dragName=n,o.imageSource=s,o.elementType=t.BindMonitorType,o.dateTimeFormat=t.ItemName,o.itemName=t.ItemName,o}case"DragSingleDigit":{const o=new wf;return o.dragName=n,o.imageSource=s,o.elementType=t.BindMonitorType,o.dateTimeFormat=t.ItemName,o.itemName=t.ItemName,o}case"DragNums":{const o=new su(t.MaxNum||0,t.MinNum||0,t.Default||0);return o.dragName=n,o.imageSource=s,o.elementType=t.BindMonitorType,o.itemName=t.ItemName,o.defaultNum=t.Default,o}case"DragProgress":{const o=new Ra(t.MaxNum||0,t.MinNum||0,t.Default||0);return o.dragName=n,o.imageSource=s,o.elementType=t.BindMonitorType,o.itemName=t.ItemName,o.defaultNum=t.Default,o.targetValue=t.TargetValue||0,o}case"DragSwitch":{const o=new H1;return o.dragName=n,o.openSource=s[0],o.closeSource=s[1],o.elementType=t.BindMonitorType,o.itemName=t.ItemName,o}case"DragAMPM":{const o=new X1;return o.dragName=n,o.amSource=s[0],o.pmSource=s[1],o.elementType=t.BindMonitorType,o.itemName=t.ItemName,o}case"DragImage":{const o=new Nb;return o.dragName=n,o.source=s[0],o.itemName=t.ItemName,o}case"DragMonthDay":{const o=new Ib;return o.dragName=n,o.imageSource=s,o.elementType=t.BindMonitorType,o.itemName=t.ItemName,o}case"DragWeek":{const o=new G1;return o.dragName=n,o.imageSource=s,o.elementType=t.BindMonitorType,o.itemName=t.ItemName,o}case"DragDouble":{const o=new z1(t.MaxNum||99.99,t.MinNum||0,t.Default||0);return o.dragName=n,o.ImageSource=s,o.elementType=t.BindMonitorType,o.itemName=t.ItemName,o}case"DragKeyValue":{const o=new Map,c=new U1(o,s);return c.dragName=n,c.elementType=t.BindMonitorType,c.itemName=t.ItemName,c}case"DragPoint":{const o=new V1(s[0]);return o.dragName=n,o.elementType=t.BindMonitorType,o.itemName=t.ItemName,o}case"DragAnimFrame":{const o=new W1;return o.dragName=n,o.ImageSource=s,o.elementType=t.BindMonitorType,o.itemName=t.ItemName,o}default:return console.warn(`Unknown control type: ${t.ControlType}`),null}}static createComponent(e,t){switch(e){case"time-hour":return this.createTimeComponent("Hour",t);case"time-minute":return this.createTimeComponent("Minute",t);case"time-second":return this.createTimeComponent("Second",t);case"date-day":return this.createTimeComponent("Day",t);case"date-month":return this.createTimeComponent("Month",t);case"date-week":return this.createWeekComponent(t);case"health-steps":return this.createHealthComponent("Steps",t);case"health-heartrate":return this.createHealthComponent("HeartRate",t);case"health-calories":return this.createHealthComponent("Calories",t);case"system-battery":return this.createSystemComponent("Battery",t);case"double-value":return this.createDoubleComponent(t);case"key-value":return this.createKeyValueComponent(t);case"pointer":return this.createPointerComponent(t);case"animation":return this.createAnimationComponent(t);default:return console.warn(`Unknown component type: ${e}`),null}}static createTimeComponent(e,t){if(t.multiDigit){const n=new Sf;return n.dateTimeFormat=e,n.imageSource=t.images||[],n.elementType=mt.Time,n}else{const n=new wf;return n.dateTimeFormat=e,n.imageSource=t.images||[],n.elementType=mt.Time,n}}static createWeekComponent(e){const t=new G1;return t.imageSource=e.images||[],t.elementType=mt.Time,t}static createHealthComponent(e,t){let n;switch(e){case"Steps":n=mt.Steps;break;case"HeartRate":n=mt.HeartRate;break;case"Calories":n=mt.Calories;break;default:n=mt.Steps}if(t.displayType==="progress"){const i=new Ra(t.maxValue||100,t.minValue||0,t.defaultValue||0);return i.imageSource=t.images||[],i.elementType=n,i}else{const i=new su(t.maxValue||9999,t.minValue||0,t.defaultValue||0);return i.imageSource=t.images||[],i.elementType=n,i}}static createSystemComponent(e,t){const n=new Ra(100,0,50);return n.imageSource=t.images||[],n.elementType=mt.Battery,n}static createDoubleComponent(e){const t=new z1(e.maxValue||99.99,e.minValue||0,e.defaultValue||0);return t.ImageSource=e.images||[],t.decimalPlaces=e.decimalPlaces||1,t.TrailingZero=e.trailingZero||!1,t.UnitSource=e.unitImage,t.PointSource=e.decimalPointImage,t.elementType=this.mapTypeToBindMonitorType(e.dataType),t}static createKeyValueComponent(e){const t=new Map;e.keyValues&&Object.entries(e.keyValues).forEach(([i,s])=>{t.set(parseInt(i),s)});const n=new U1(t,e.images||[]);return n.elementType=this.mapTypeToBindMonitorType(e.dataType),n}static createPointerComponent(e){var n;const t=new V1((n=e.images)==null?void 0:n[0]);return t.StartAngle=e.startAngle||0,t.EndAngle=e.endAngle||360,t.ValueIndex=e.valueIndex||0,t.elementType=mt.Time,t}static createAnimationComponent(e){const t=new W1;return t.ImageSource=e.images||[],t.FrameRate=e.frameRate,t.RepeatCount=e.repeatCount,t.IsRepeat=e.isRepeat||!1,t.elementType=this.mapTypeToBindMonitorType(e.dataType),t}static mapTypeToBindMonitorType(e){switch(e){case"time":return mt.Time;case"battery":return mt.Battery;case"steps":return mt.Steps;case"heartrate":return mt.HeartRate;case"calories":return mt.Calories;default:return mt.Time}}static validateComponent(e){const t=[];return e.dragName||t.push("Component must have a name"),(!e.imageSource||e.imageSource.length===0)&&t.push("Component must have at least one image"),(e instanceof H1||e instanceof X1)&&e.imageSource&&e.imageSource.length<2&&t.push("Switch/AMPM components require at least 2 images"),(e instanceof Ra||e instanceof su)&&e.maxNum<=e.minNum&&t.push("Maximum value must be greater than minimum value"),t}static exportComponent(e){return{type:e.constructor.name,config:{dragName:e.dragName,elementType:e.elementType,itemName:e.itemName,imageSource:e.imageSource,position:{x:e.x||0,y:e.y||0},size:{width:e.width||0,height:e.height||0},properties:this.getComponentProperties(e)},xml:e.getOutXml()}}static getComponentProperties(e){const t={};return(e instanceof Sf||e instanceof wf)&&(t.dateTimeFormat=e.dateTimeFormat),(e instanceof Ra||e instanceof su)&&(t.maxNum=e.maxNum,t.minNum=e.minNum,t.defaultNum=e.defaultNum),e instanceof Ra&&(t.targetValue=e.targetValue,t.fillType=e.fillType),t}}Ke($n,"_watchSettings",null);const Rb=[{name:"Year",format:"Year",icon:Mu,timeComponent:0,isMultiDigit:!0,digitCount:4,subComponents:[{name:"Year (Thousands)",position:"thousands"},{name:"Year (Hundreds)",position:"hundreds"},{name:"Year (Tens)",position:"tens"},{name:"Year (Ones)",position:"ones"}]},{name:"Month",format:"Month",icon:Mu,timeComponent:1,isMultiDigit:!0,digitCount:2,subComponents:[{name:"Month (Tens)",position:"tens"},{name:"Month (Ones)",position:"ones"}]},{name:"Day",format:"Day",icon:Mu,timeComponent:2,isMultiDigit:!0,digitCount:2,subComponents:[{name:"Day (Tens)",position:"tens"},{name:"Day (Ones)",position:"ones"}]},{name:"Hour",format:"Hour",icon:ys,timeComponent:3,isMultiDigit:!0,digitCount:2,subComponents:[{name:"Hour (Tens)",position:"tens"},{name:"Hour (Ones)",position:"ones"}]},{name:"Minute",format:"Minute",icon:ys,timeComponent:4,isMultiDigit:!0,digitCount:2,subComponents:[{name:"Minute (Tens)",position:"tens"},{name:"Minute (Ones)",position:"ones"}]},{name:"Second",format:"Second",icon:ys,timeComponent:5,isMultiDigit:!0,digitCount:2,subComponents:[{name:"Second (Tens)",position:"tens"},{name:"Second (Ones)",position:"ones"}]},{name:"AM/PM",format:"AMPM",icon:ys,timeComponent:7,isMultiDigit:!1}],Lb=({onAddTimeComponent:r,onAddProgressComponent:e,onAddNumberComponent:t,onAddImageComponent:n,onAddComponent:i,onAddAnalogComponent:s})=>{const[o,c]=vt.useState(!1),[u,d]=vt.useState(null),[h,g]=vt.useState(!1),[x,m]=vt.useState([]),[y,v]=vt.useState(!1);vt.useEffect(()=>{(async()=>{v(!0);try{await $n.loadWatchSettings();const P=$n.watchSettings,N=["Hour","Minute","Second","Day","Month","Year","AM/PM","AMPM"],O=P.filter(V=>V.ItemName&&N.some(B=>{var te;return V.ItemName===B||((te=V.ItemName)==null?void 0:te.toLowerCase())===B.toLowerCase()}));m(O)}catch(P){console.error("Failed to load Excel data:",P)}finally{v(!1)}})()},[]);const _=()=>{c(!0),g(!1),d(null)},S=A=>{if(A.isMultiDigit)d(A),g(!0);else{const P=A.watchSetting?$n.mapBindMonitorTypeToElementType(A.watchSetting.BindMonitorType||0):A.timeComponent||0;r(P,A.format,"single"),c(!1)}},T=A=>{if(u)if(u.elementType!==void 0)t(u.elementType,"single",A.position);else{const P=u.watchSetting?$n.mapBindMonitorTypeToElementType(u.watchSetting.BindMonitorType||0):u.timeComponent||0;r(P,u.format,"single",A.position)}c(!1),g(!1),d(null)},C=()=>{if(u)if(u.elementType!==void 0)t(u.elementType,"multi");else{const A=u.watchSetting?$n.mapBindMonitorTypeToElementType(u.watchSetting.BindMonitorType||0):u.timeComponent||0;r(A,u.format,"multi")}c(!1),g(!1),d(null)};return h&&u?L.jsxs("div",{className:"component-library",children:[L.jsxs("div",{className:"component-list-header",children:[L.jsxs("h3",{children:[u.name," Options"]}),L.jsxs("div",{className:"header-buttons",children:[L.jsx("button",{className:"btn btn-secondary",onClick:()=>g(!1),children:"Back"}),L.jsx("button",{className:"close-btn",onClick:()=>c(!1),children:"Close"})]})]}),L.jsxs("div",{className:"component-list",children:[L.jsxs("button",{className:"component-list-item multi-digit",onClick:C,children:[Lx.createElement(u.icon,{size:20}),L.jsxs("span",{children:[u.name," (All ",u.digitCount," digits)"]})]}),L.jsx("div",{className:"component-section-divider",children:"Individual Digits"}),u.subComponents.map((A,P)=>{const N=u.icon;return L.jsxs("button",{className:"component-list-item",onClick:()=>T(A),children:[L.jsx(N,{size:20}),L.jsx("span",{children:A.name})]},P)})]})]}):o?L.jsxs("div",{className:"component-library",children:[L.jsxs("div",{className:"component-list-header",children:[L.jsx("h3",{children:"Select Component Type"}),L.jsx("button",{className:"close-btn",onClick:()=>c(!1),children:"Close"})]}),L.jsxs("div",{className:"component-list",children:[y?L.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#fff"},children:"Loading components from Excel..."}):L.jsxs(L.Fragment,{children:[x.map((A,P)=>{var B,te,ie,D,J,F,se,Ee,le,xe,X;const N=((B=A.ItemName)==null?void 0:B.includes("Hour"))||((te=A.ItemName)==null?void 0:te.includes("Minute"))||((ie=A.ItemName)==null?void 0:ie.includes("Second"))||((D=A.ItemName)==null?void 0:D.includes("Day"))||((J=A.ItemName)==null?void 0:J.includes("Month"))||((F=A.ItemName)==null?void 0:F.includes("Year")),O={name:A.ItemName||"",format:A.ItemName||"",icon:(se=A.ItemName)!=null&&se.includes("Hour")||(Ee=A.ItemName)!=null&&Ee.includes("Minute")||(le=A.ItemName)!=null&&le.includes("Second")?ys:Mu,timeComponent:$n.mapBindMonitorTypeToElementType(A.BindMonitorType||0),isMultiDigit:N,digitCount:(xe=A.ItemName)!=null&&xe.includes("Year")?4:2,subComponents:N?(X=A.ItemName)!=null&&X.includes("Year")?[{name:`${A.ItemName} (Thousands)`,position:"thousands"},{name:`${A.ItemName} (Hundreds)`,position:"hundreds"},{name:`${A.ItemName} (Tens)`,position:"tens"},{name:`${A.ItemName} (Ones)`,position:"ones"}]:[{name:`${A.ItemName} (Tens)`,position:"tens"},{name:`${A.ItemName} (Ones)`,position:"ones"}]:void 0,watchSetting:A},V=O.icon;return L.jsxs("button",{className:"component-list-item",onClick:()=>S(O),children:[L.jsx(V,{size:20}),L.jsx("span",{children:O.name})]},`excel-${P}`)}),x.length===0&&Rb.map((A,P)=>{const N=A.icon;return L.jsxs("button",{className:"component-list-item",onClick:()=>S(A),children:[L.jsx(N,{size:20}),L.jsx("span",{children:A.name})]},`fallback-${P}`)})]}),L.jsx("div",{className:"component-section-divider",children:"Health & Fitness"}),L.jsxs("button",{className:"component-list-item",onClick:()=>S({name:"Blood Oxygen",format:"Blood Oxygen",icon:Im,elementType:1,isMultiDigit:!0,digitCount:3,subComponents:[{name:"Blood Oxygen (Hundreds)",position:"hundreds"},{name:"Blood Oxygen (Tens)",position:"tens"},{name:"Blood Oxygen (Ones)",position:"ones"}]}),children:[L.jsx(Im,{size:20}),L.jsx("span",{children:"Blood Oxygen"})]}),L.jsxs("button",{className:"component-list-item",onClick:()=>{e(2),c(!1)},children:[L.jsx(Sw,{size:20}),L.jsx("span",{children:"Battery Progress"})]}),L.jsxs("button",{className:"component-list-item",onClick:()=>S({name:"Steps",format:"Steps",icon:Kc,elementType:3,isMultiDigit:!0,digitCount:5,subComponents:[{name:"Steps (Ten Thousands)",position:"ten-thousands"},{name:"Steps (Thousands)",position:"thousands"},{name:"Steps (Hundreds)",position:"hundreds"},{name:"Steps (Tens)",position:"tens"},{name:"Steps (Ones)",position:"ones"}]}),children:[L.jsx(Kc,{size:20}),L.jsx("span",{children:"Steps"})]}),L.jsxs("button",{className:"component-list-item",onClick:()=>S({name:"Heart Rate",format:"Heart Rate",icon:Rm,elementType:4,isMultiDigit:!0,digitCount:3,subComponents:[{name:"Heart Rate (Hundreds)",position:"hundreds"},{name:"Heart Rate (Tens)",position:"tens"},{name:"Heart Rate (Ones)",position:"ones"}]}),children:[L.jsx(Rm,{size:20}),L.jsx("span",{children:"Heart Rate"})]}),L.jsxs("button",{className:"component-list-item",onClick:()=>S({name:"Calories",format:"Calories",icon:Kc,elementType:5,isMultiDigit:!0,digitCount:4,subComponents:[{name:"Calories (Thousands)",position:"thousands"},{name:"Calories (Hundreds)",position:"hundreds"},{name:"Calories (Tens)",position:"tens"},{name:"Calories (Ones)",position:"ones"}]}),children:[L.jsx(Kc,{size:20}),L.jsx("span",{children:"Calories"})]}),L.jsx("div",{className:"component-section-divider",children:"Analog Time"}),L.jsxs("button",{className:"component-list-item",onClick:()=>{s("hour"),c(!1)},children:[L.jsx(ys,{size:20}),L.jsx("span",{children:"Hour Hand"})]}),L.jsxs("button",{className:"component-list-item",onClick:()=>{s("minute"),c(!1)},children:[L.jsx(ys,{size:20}),L.jsx("span",{children:"Minute Hand"})]}),L.jsxs("button",{className:"component-list-item",onClick:()=>{s("second"),c(!1)},children:[L.jsx(ys,{size:20}),L.jsx("span",{children:"Second Hand"})]}),L.jsx("div",{className:"component-section-divider",children:"Graphics"}),L.jsxs("button",{className:"component-list-item",onClick:()=>{n(),c(!1)},children:[L.jsx(Tw,{size:20}),L.jsx("span",{children:"Background Image"})]})]}),L.jsxs("div",{className:"component-list-footer",children:[L.jsx("button",{className:"btn btn-secondary",onClick:()=>c(!1),children:"Close"}),L.jsx("button",{className:"btn btn-primary",onClick:()=>c(!1),children:"Add"})]})]}):L.jsxs("div",{className:"component-library",children:[L.jsxs("div",{className:"component-section",children:[L.jsx("h4",{children:"Component Selection"}),L.jsx("button",{className:"select-file-btn",onClick:_,children:"Select File"}),L.jsx("p",{className:"help-text",children:'Click "Select File" to choose from available component types, just like in the Windows app.'})]}),L.jsxs("div",{className:"component-section",children:[L.jsx("h4",{children:"Instructions"}),L.jsxs("div",{className:"instruction-text",children:[L.jsxs("p",{children:[L.jsx("strong",{children:"1. Select File:"})," Choose component type from the list"]}),L.jsxs("p",{children:[L.jsx("strong",{children:"2. Upload Images:"})," For digits upload 10 images (0-9)"]}),L.jsxs("p",{children:[L.jsx("strong",{children:"3. Position:"})," Drag elements on the canvas"]}),L.jsxs("p",{children:[L.jsx("strong",{children:"4. Preview:"})," Use sliders to test your watch face"]})]})]})]})},Bb=({component:r,onUpdate:e,onDelete:t})=>{const[n,i]=vt.useState(null),[s,o]=vt.useState(null),c=(y,v)=>{if(y.startsWith("config.")){const _=y.replace("config.","");e({...r,config:{...r.config,[_]:v}})}else if(y.startsWith("position.")){const _=y.replace("position.","");e({...r,position:{...r.position,[_]:parseFloat(v)||0}})}else if(y.startsWith("size.")){const _=y.replace("size.","");e({...r,size:{...r.size,[_]:parseFloat(v)||0}})}else e({...r,[y]:v})},u=y=>{i(y)},d=(y,v)=>{y.preventDefault(),o(v)},h=()=>{o(null)},g=(y,v)=>{if(y.preventDefault(),n===null||n===v){i(null),o(null);return}const _=[...r.images],[S]=_.splice(n,1);_.splice(v,0,S),e({...r,images:_}),i(null),o(null)},x=()=>{i(null),o(null)},m=()=>["Hour","Minute","Second","Day","Month","Year","WeekDay"];return L.jsxs("div",{className:"component-properties",children:[L.jsxs("div",{className:"property-group",children:[L.jsx("h4",{children:"Basic Properties"}),L.jsxs("div",{className:"property-row",children:[L.jsx("label",{className:"property-label",children:"Name:"}),L.jsx("input",{type:"text",className:"property-input",value:r.name,onChange:y=>c("name",y.target.value)})]}),L.jsxs("div",{className:"property-row",children:[L.jsx("label",{className:"property-label",children:"Type:"}),L.jsxs("select",{className:"property-input",value:r.type,onChange:y=>c("type",y.target.value),children:[L.jsx("option",{value:"image",children:"Static Image"}),L.jsx("option",{value:"dateTime",children:"Date/Time"}),L.jsx("option",{value:"progress",children:"Progress Bar"}),L.jsx("option",{value:"number",children:"Number Display"})]})]}),L.jsxs("div",{className:"property-row",children:[L.jsx("label",{className:"property-label",children:"Element:"}),L.jsxs("select",{className:"property-input",value:r.elementType!==null?r.elementType.toString():"",onChange:y=>{const v=y.target.value,_=v?parseInt(v):null;c("elementType",_)},children:[L.jsx("option",{value:"",children:"Static"}),L.jsx("option",{value:"0",children:"Time"}),L.jsx("option",{value:"1",children:"Blood Oxygen"}),L.jsx("option",{value:"2",children:"Battery"}),L.jsx("option",{value:"3",children:"Steps"}),L.jsx("option",{value:"4",children:"Heart Rate"})]})]}),r.elementType===0&&L.jsxs("div",{className:"property-row",children:[L.jsx("label",{className:"property-label",children:"Time Component:"}),L.jsxs("select",{className:"property-input",value:r.timeComponent!==void 0?r.timeComponent.toString():"",onChange:y=>{const v=y.target.value,_=v?parseInt(v):void 0;c("timeComponent",_)},children:[L.jsx("option",{value:"",children:"Select Component"}),L.jsx("option",{value:"0",children:"Year"}),L.jsx("option",{value:"1",children:"Month"}),L.jsx("option",{value:"2",children:"Day"}),L.jsx("option",{value:"3",children:"Hour"}),L.jsx("option",{value:"4",children:"Minute"}),L.jsx("option",{value:"5",children:"Second"}),L.jsx("option",{value:"6",children:"Week"}),L.jsx("option",{value:"7",children:"AM/PM"})]})]}),r.config.digitPosition&&L.jsxs("div",{className:"property-row",children:[L.jsx("label",{className:"property-label",children:"Digit Position:"}),L.jsxs("select",{className:"property-input",value:r.config.digitPosition,onChange:y=>c("config.digitPosition",y.target.value),children:[L.jsx("option",{value:"single",children:"Single Digit"}),L.jsx("option",{value:"multi",children:"Multi-Digit (Full Number)"}),L.jsx("option",{value:"thousands",children:"Thousands Digit"}),L.jsx("option",{value:"hundreds",children:"Hundreds Digit"}),L.jsx("option",{value:"tens",children:"Tens Digit"}),L.jsx("option",{value:"ones",children:"Ones Digit"})]})]})]}),L.jsxs("div",{className:"property-group",children:[L.jsx("h4",{children:"Position & Size"}),L.jsxs("div",{className:"property-row",children:[L.jsx("label",{className:"property-label",children:"X:"}),L.jsx("input",{type:"number",className:"property-input",value:r.position.x,onChange:y=>c("position.x",y.target.value)})]}),L.jsxs("div",{className:"property-row",children:[L.jsx("label",{className:"property-label",children:"Y:"}),L.jsx("input",{type:"number",className:"property-input",value:r.position.y,onChange:y=>c("position.y",y.target.value)})]}),L.jsxs("div",{className:"property-row",children:[L.jsx("label",{className:"property-label",children:"Width:"}),L.jsx("input",{type:"number",className:"property-input",value:r.size.width,onChange:y=>c("size.width",y.target.value)})]}),L.jsxs("div",{className:"property-row",children:[L.jsx("label",{className:"property-label",children:"Height:"}),L.jsx("input",{type:"number",className:"property-input",value:r.size.height,onChange:y=>c("size.height",y.target.value)})]})]}),r.type==="dateTime"&&L.jsxs("div",{className:"property-group",children:[L.jsx("h4",{children:"Date/Time Configuration"}),L.jsxs("div",{className:"property-row",children:[L.jsx("label",{className:"property-label",children:"Format:"}),L.jsx("select",{className:"property-input",value:r.config.dateTimeFormat||"Hour",onChange:y=>c("config.dateTimeFormat",y.target.value),children:m().map(y=>L.jsx("option",{value:y,children:y},y))})]}),L.jsxs("div",{className:"property-row",children:[L.jsx("label",{className:"property-label",children:"Leading Zero:"}),L.jsx("input",{type:"checkbox",className:"property-checkbox",checked:r.config.leadingZero||!1,onChange:y=>c("config.leadingZero",y.target.checked)})]})]}),r.type==="progress"&&L.jsxs("div",{className:"property-group",children:[L.jsx("h4",{children:"Progress Configuration"}),L.jsxs("div",{className:"property-row",children:[L.jsx("label",{className:"property-label",children:"Min Value:"}),L.jsx("input",{type:"number",className:"property-input",value:r.config.minValue||0,onChange:y=>c("config.minValue",parseInt(y.target.value))})]}),L.jsxs("div",{className:"property-row",children:[L.jsx("label",{className:"property-label",children:"Max Value:"}),L.jsx("input",{type:"number",className:"property-input",value:r.config.maxValue||100,onChange:y=>c("config.maxValue",parseInt(y.target.value))})]}),L.jsxs("div",{className:"property-row",children:[L.jsx("label",{className:"property-label",children:"Default:"}),L.jsx("input",{type:"number",className:"property-input",value:r.config.defaultValue||50,onChange:y=>c("config.defaultValue",parseInt(y.target.value))})]}),L.jsxs("div",{className:"property-row",children:[L.jsx("label",{className:"property-label",children:"Fill Type:"}),L.jsx("input",{type:"checkbox",className:"property-checkbox",checked:r.config.fillType||!1,onChange:y=>c("config.fillType",y.target.checked)})]})]}),L.jsxs("div",{className:"property-group",children:[L.jsxs("h4",{children:["Images (",r.images.length,")"]}),L.jsx("p",{className:"help-text",children:"Drag and drop to reorder images"}),L.jsx("div",{className:"image-gallery",children:r.images.map((y,v)=>L.jsxs("div",{className:`image-thumbnail ${n===v?"dragging":""} ${s===v?"drag-over":""}`,draggable:!0,onDragStart:()=>u(v),onDragOver:_=>d(_,v),onDragLeave:h,onDrop:_=>g(_,v),onDragEnd:x,children:[L.jsx("div",{className:"drag-handle",children:L.jsx(Cw,{size:16})}),L.jsx("img",{src:y,alt:`Image ${v}`}),L.jsx("span",{className:"image-index",children:v})]},v))}),r.images.length===0&&L.jsx("div",{className:"no-images",children:L.jsx("p",{children:"No images uploaded"})})]}),L.jsxs("div",{className:"property-group",children:[L.jsx("h4",{children:"Actions"}),L.jsxs("div",{className:"action-buttons",children:[L.jsxs("button",{className:"btn btn-secondary",children:[L.jsx(Nu,{size:16}),"Replace Images"]}),L.jsxs("button",{className:"btn btn-danger",onClick:t,children:[L.jsx(Dw,{size:16}),"Delete Component"]})]})]})]})};function au(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var kf={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var Y1;function jb(){return Y1||(Y1=1,(function(r,e){(function(t){r.exports=t()})(function(){return(function t(n,i,s){function o(d,h){if(!i[d]){if(!n[d]){var g=typeof au=="function"&&au;if(!h&&g)return g(d,!0);if(c)return c(d,!0);var x=new Error("Cannot find module '"+d+"'");throw x.code="MODULE_NOT_FOUND",x}var m=i[d]={exports:{}};n[d][0].call(m.exports,function(y){var v=n[d][1][y];return o(v||y)},m,m.exports,t,n,i,s)}return i[d].exports}for(var c=typeof au=="function"&&au,u=0;u<s.length;u++)o(s[u]);return o})({1:[function(t,n,i){var s=t("./utils"),o=t("./support"),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(u){for(var d,h,g,x,m,y,v,_=[],S=0,T=u.length,C=T,A=s.getTypeOf(u)!=="string";S<u.length;)C=T-S,g=A?(d=u[S++],h=S<T?u[S++]:0,S<T?u[S++]:0):(d=u.charCodeAt(S++),h=S<T?u.charCodeAt(S++):0,S<T?u.charCodeAt(S++):0),x=d>>2,m=(3&d)<<4|h>>4,y=1<C?(15&h)<<2|g>>6:64,v=2<C?63&g:64,_.push(c.charAt(x)+c.charAt(m)+c.charAt(y)+c.charAt(v));return _.join("")},i.decode=function(u){var d,h,g,x,m,y,v=0,_=0,S="data:";if(u.substr(0,S.length)===S)throw new Error("Invalid base64 input, it looks like a data url.");var T,C=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===c.charAt(64)&&C--,u.charAt(u.length-2)===c.charAt(64)&&C--,C%1!=0)throw new Error("Invalid base64 input, bad content length.");for(T=o.uint8array?new Uint8Array(0|C):new Array(0|C);v<u.length;)d=c.indexOf(u.charAt(v++))<<2|(x=c.indexOf(u.charAt(v++)))>>4,h=(15&x)<<4|(m=c.indexOf(u.charAt(v++)))>>2,g=(3&m)<<6|(y=c.indexOf(u.charAt(v++))),T[_++]=d,m!==64&&(T[_++]=h),y!==64&&(T[_++]=g);return T}},{"./support":30,"./utils":32}],2:[function(t,n,i){var s=t("./external"),o=t("./stream/DataWorker"),c=t("./stream/Crc32Probe"),u=t("./stream/DataLengthProbe");function d(h,g,x,m,y){this.compressedSize=h,this.uncompressedSize=g,this.crc32=x,this.compression=m,this.compressedContent=y}d.prototype={getContentWorker:function(){var h=new o(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),g=this;return h.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new o(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},d.createWorkerFrom=function(h,g,x){return h.pipe(new c).pipe(new u("uncompressedSize")).pipe(g.compressWorker(x)).pipe(new u("compressedSize")).withStreamInfo("compression",g)},n.exports=d},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,n,i){var s=t("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,n,i){var s=t("./utils"),o=(function(){for(var c,u=[],d=0;d<256;d++){c=d;for(var h=0;h<8;h++)c=1&c?3988292384^c>>>1:c>>>1;u[d]=c}return u})();n.exports=function(c,u){return c!==void 0&&c.length?s.getTypeOf(c)!=="string"?(function(d,h,g,x){var m=o,y=x+g;d^=-1;for(var v=x;v<y;v++)d=d>>>8^m[255&(d^h[v])];return-1^d})(0|u,c,c.length,0):(function(d,h,g,x){var m=o,y=x+g;d^=-1;for(var v=x;v<y;v++)d=d>>>8^m[255&(d^h.charCodeAt(v))];return-1^d})(0|u,c,c.length,0):0}},{"./utils":32}],5:[function(t,n,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(t,n,i){var s=null;s=typeof Promise<"u"?Promise:t("lie"),n.exports={Promise:s}},{lie:37}],7:[function(t,n,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=t("pako"),c=t("./utils"),u=t("./stream/GenericWorker"),d=s?"uint8array":"array";function h(g,x){u.call(this,"FlateWorker/"+g),this._pako=null,this._pakoAction=g,this._pakoOptions=x,this.meta={}}i.magic="\b\0",c.inherits(h,u),h.prototype.processChunk=function(g){this.meta=g.meta,this._pako===null&&this._createPako(),this._pako.push(c.transformTo(d,g.data),!1)},h.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var g=this;this._pako.onData=function(x){g.push({data:x,meta:g.meta})}},i.compressWorker=function(g){return new h("Deflate",g)},i.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,n,i){function s(m,y){var v,_="";for(v=0;v<y;v++)_+=String.fromCharCode(255&m),m>>>=8;return _}function o(m,y,v,_,S,T){var C,A,P=m.file,N=m.compression,O=T!==d.utf8encode,V=c.transformTo("string",T(P.name)),B=c.transformTo("string",d.utf8encode(P.name)),te=P.comment,ie=c.transformTo("string",T(te)),D=c.transformTo("string",d.utf8encode(te)),J=B.length!==P.name.length,F=D.length!==te.length,se="",Ee="",le="",xe=P.dir,X=P.date,pe={crc32:0,compressedSize:0,uncompressedSize:0};y&&!v||(pe.crc32=m.crc32,pe.compressedSize=m.compressedSize,pe.uncompressedSize=m.uncompressedSize);var R=0;y&&(R|=8),O||!J&&!F||(R|=2048);var b=0,ee=0;xe&&(b|=16),S==="UNIX"?(ee=798,b|=(function(H,me){var Me=H;return H||(Me=me?16893:33204),(65535&Me)<<16})(P.unixPermissions,xe)):(ee=20,b|=(function(H){return 63&(H||0)})(P.dosPermissions)),C=X.getUTCHours(),C<<=6,C|=X.getUTCMinutes(),C<<=5,C|=X.getUTCSeconds()/2,A=X.getUTCFullYear()-1980,A<<=4,A|=X.getUTCMonth()+1,A<<=5,A|=X.getUTCDate(),J&&(Ee=s(1,1)+s(h(V),4)+B,se+="up"+s(Ee.length,2)+Ee),F&&(le=s(1,1)+s(h(ie),4)+D,se+="uc"+s(le.length,2)+le);var G="";return G+=`
\0`,G+=s(R,2),G+=N.magic,G+=s(C,2),G+=s(A,2),G+=s(pe.crc32,4),G+=s(pe.compressedSize,4),G+=s(pe.uncompressedSize,4),G+=s(V.length,2),G+=s(se.length,2),{fileRecord:g.LOCAL_FILE_HEADER+G+V+se,dirRecord:g.CENTRAL_FILE_HEADER+s(ee,2)+G+s(ie.length,2)+"\0\0\0\0"+s(b,4)+s(_,4)+V+se+ie}}var c=t("../utils"),u=t("../stream/GenericWorker"),d=t("../utf8"),h=t("../crc32"),g=t("../signature");function x(m,y,v,_){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=v,this.encodeFileName=_,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}c.inherits(x,u),x.prototype.push=function(m){var y=m.meta.percent||0,v=this.entriesCount,_=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,u.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:v?(y+100*(v-_-1))/v:100}}))},x.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var y=this.streamFiles&&!m.file.dir;if(y){var v=o(m,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},x.prototype.closedSource=function(m){this.accumulate=!1;var y=this.streamFiles&&!m.file.dir,v=o(m,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),y)this.push({data:(function(_){return g.DATA_DESCRIPTOR+s(_.crc32,4)+s(_.compressedSize,4)+s(_.uncompressedSize,4)})(m),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},x.prototype.flush=function(){for(var m=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var v=this.bytesWritten-m,_=(function(S,T,C,A,P){var N=c.transformTo("string",P(A));return g.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(S,2)+s(S,2)+s(T,4)+s(C,4)+s(N.length,2)+N})(this.dirRecords.length,v,m,this.zipComment,this.encodeFileName);this.push({data:_,meta:{percent:100}})},x.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},x.prototype.registerPrevious=function(m){this._sources.push(m);var y=this;return m.on("data",function(v){y.processChunk(v)}),m.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),m.on("error",function(v){y.error(v)}),this},x.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},x.prototype.error=function(m){var y=this._sources;if(!u.prototype.error.call(this,m))return!1;for(var v=0;v<y.length;v++)try{y[v].error(m)}catch{}return!0},x.prototype.lock=function(){u.prototype.lock.call(this);for(var m=this._sources,y=0;y<m.length;y++)m[y].lock()},n.exports=x},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,n,i){var s=t("../compressions"),o=t("./ZipFileWorker");i.generateWorker=function(c,u,d){var h=new o(u.streamFiles,d,u.platform,u.encodeFileName),g=0;try{c.forEach(function(x,m){g++;var y=(function(T,C){var A=T||C,P=s[A];if(!P)throw new Error(A+" is not a valid compression method !");return P})(m.options.compression,u.compression),v=m.options.compressionOptions||u.compressionOptions||{},_=m.dir,S=m.date;m._compressWorker(y,v).withStreamInfo("file",{name:x,dir:_,date:S,comment:m.comment||"",unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions}).pipe(h)}),h.entriesCount=g}catch(x){h.error(x)}return h}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,n,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new s;for(var c in this)typeof this[c]!="function"&&(o[c]=this[c]);return o}}(s.prototype=t("./object")).loadAsync=t("./load"),s.support=t("./support"),s.defaults=t("./defaults"),s.version="3.10.1",s.loadAsync=function(o,c){return new s().loadAsync(o,c)},s.external=t("./external"),n.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,n,i){var s=t("./utils"),o=t("./external"),c=t("./utf8"),u=t("./zipEntries"),d=t("./stream/Crc32Probe"),h=t("./nodejsUtils");function g(x){return new o.Promise(function(m,y){var v=x.decompressed.getContentWorker().pipe(new d);v.on("error",function(_){y(_)}).on("end",function(){v.streamInfo.crc32!==x.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):m()}).resume()})}n.exports=function(x,m){var y=this;return m=s.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:c.utf8decode}),h.isNode&&h.isStream(x)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",x,!0,m.optimizedBinaryString,m.base64).then(function(v){var _=new u(m);return _.load(v),_}).then(function(v){var _=[o.Promise.resolve(v)],S=v.files;if(m.checkCRC32)for(var T=0;T<S.length;T++)_.push(g(S[T]));return o.Promise.all(_)}).then(function(v){for(var _=v.shift(),S=_.files,T=0;T<S.length;T++){var C=S[T],A=C.fileNameStr,P=s.resolve(C.fileNameStr);y.file(P,C.decompressed,{binary:!0,optimizedBinaryString:!0,date:C.date,dir:C.dir,comment:C.fileCommentStr.length?C.fileCommentStr:null,unixPermissions:C.unixPermissions,dosPermissions:C.dosPermissions,createFolders:m.createFolders}),C.dir||(y.file(P).unsafeOriginalName=A)}return _.zipComment.length&&(y.comment=_.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,n,i){var s=t("../utils"),o=t("../stream/GenericWorker");function c(u,d){o.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(d)}s.inherits(c,o),c.prototype._bindStream=function(u){var d=this;(this._stream=u).pause(),u.on("data",function(h){d.push({data:h,meta:{percent:0}})}).on("error",function(h){d.isPaused?this.generatedError=h:d.error(h)}).on("end",function(){d.isPaused?d._upstreamEnded=!0:d.end()})},c.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},c.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=c},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,n,i){var s=t("readable-stream").Readable;function o(c,u,d){s.call(this,u),this._helper=c;var h=this;c.on("data",function(g,x){h.push(g)||h._helper.pause(),d&&d(x)}).on("error",function(g){h.emit("error",g)}).on("end",function(){h.push(null)})}t("../utils").inherits(o,s),o.prototype._read=function(){this._helper.resume()},n.exports=o},{"../utils":32,"readable-stream":16}],14:[function(t,n,i){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,o);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,o)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var o=new Buffer(s);return o.fill(0),o},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(t,n,i){function s(P,N,O){var V,B=c.getTypeOf(N),te=c.extend(O||{},h);te.date=te.date||new Date,te.compression!==null&&(te.compression=te.compression.toUpperCase()),typeof te.unixPermissions=="string"&&(te.unixPermissions=parseInt(te.unixPermissions,8)),te.unixPermissions&&16384&te.unixPermissions&&(te.dir=!0),te.dosPermissions&&16&te.dosPermissions&&(te.dir=!0),te.dir&&(P=S(P)),te.createFolders&&(V=_(P))&&T.call(this,V,!0);var ie=B==="string"&&te.binary===!1&&te.base64===!1;O&&O.binary!==void 0||(te.binary=!ie),(N instanceof g&&N.uncompressedSize===0||te.dir||!N||N.length===0)&&(te.base64=!1,te.binary=!0,N="",te.compression="STORE",B="string");var D=null;D=N instanceof g||N instanceof u?N:y.isNode&&y.isStream(N)?new v(P,N):c.prepareContent(P,N,te.binary,te.optimizedBinaryString,te.base64);var J=new x(P,D,te);this.files[P]=J}var o=t("./utf8"),c=t("./utils"),u=t("./stream/GenericWorker"),d=t("./stream/StreamHelper"),h=t("./defaults"),g=t("./compressedObject"),x=t("./zipObject"),m=t("./generate"),y=t("./nodejsUtils"),v=t("./nodejs/NodejsStreamInputAdapter"),_=function(P){P.slice(-1)==="/"&&(P=P.substring(0,P.length-1));var N=P.lastIndexOf("/");return 0<N?P.substring(0,N):""},S=function(P){return P.slice(-1)!=="/"&&(P+="/"),P},T=function(P,N){return N=N!==void 0?N:h.createFolders,P=S(P),this.files[P]||s.call(this,P,null,{dir:!0,createFolders:N}),this.files[P]};function C(P){return Object.prototype.toString.call(P)==="[object RegExp]"}var A={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(P){var N,O,V;for(N in this.files)V=this.files[N],(O=N.slice(this.root.length,N.length))&&N.slice(0,this.root.length)===this.root&&P(O,V)},filter:function(P){var N=[];return this.forEach(function(O,V){P(O,V)&&N.push(V)}),N},file:function(P,N,O){if(arguments.length!==1)return P=this.root+P,s.call(this,P,N,O),this;if(C(P)){var V=P;return this.filter(function(te,ie){return!ie.dir&&V.test(te)})}var B=this.files[this.root+P];return B&&!B.dir?B:null},folder:function(P){if(!P)return this;if(C(P))return this.filter(function(B,te){return te.dir&&P.test(B)});var N=this.root+P,O=T.call(this,N),V=this.clone();return V.root=O.name,V},remove:function(P){P=this.root+P;var N=this.files[P];if(N||(P.slice(-1)!=="/"&&(P+="/"),N=this.files[P]),N&&!N.dir)delete this.files[P];else for(var O=this.filter(function(B,te){return te.name.slice(0,P.length)===P}),V=0;V<O.length;V++)delete this.files[O[V].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(P){var N,O={};try{if((O=c.extend(P||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=O.type.toLowerCase(),O.compression=O.compression.toUpperCase(),O.type==="binarystring"&&(O.type="string"),!O.type)throw new Error("No output type specified.");c.checkSupport(O.type),O.platform!=="darwin"&&O.platform!=="freebsd"&&O.platform!=="linux"&&O.platform!=="sunos"||(O.platform="UNIX"),O.platform==="win32"&&(O.platform="DOS");var V=O.comment||this.comment||"";N=m.generateWorker(this,O,V)}catch(B){(N=new u("error")).error(B)}return new d(N,O.type||"string",O.mimeType)},generateAsync:function(P,N){return this.generateInternalStream(P).accumulate(N)},generateNodeStream:function(P,N){return(P=P||{}).type||(P.type="nodebuffer"),this.generateInternalStream(P).toNodejsStream(N)}};n.exports=A},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,n,i){n.exports=t("stream")},{stream:void 0}],17:[function(t,n,i){var s=t("./DataReader");function o(c){s.call(this,c);for(var u=0;u<this.data.length;u++)c[u]=255&c[u]}t("../utils").inherits(o,s),o.prototype.byteAt=function(c){return this.data[this.zero+c]},o.prototype.lastIndexOfSignature=function(c){for(var u=c.charCodeAt(0),d=c.charCodeAt(1),h=c.charCodeAt(2),g=c.charCodeAt(3),x=this.length-4;0<=x;--x)if(this.data[x]===u&&this.data[x+1]===d&&this.data[x+2]===h&&this.data[x+3]===g)return x-this.zero;return-1},o.prototype.readAndCheckSignature=function(c){var u=c.charCodeAt(0),d=c.charCodeAt(1),h=c.charCodeAt(2),g=c.charCodeAt(3),x=this.readData(4);return u===x[0]&&d===x[1]&&h===x[2]&&g===x[3]},o.prototype.readData=function(c){if(this.checkOffset(c),c===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,u},n.exports=o},{"../utils":32,"./DataReader":18}],18:[function(t,n,i){var s=t("../utils");function o(c){this.data=c,this.length=c.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(c){this.checkIndex(this.index+c)},checkIndex:function(c){if(this.length<this.zero+c||c<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+c+"). Corrupted zip ?")},setIndex:function(c){this.checkIndex(c),this.index=c},skip:function(c){this.setIndex(this.index+c)},byteAt:function(){},readInt:function(c){var u,d=0;for(this.checkOffset(c),u=this.index+c-1;u>=this.index;u--)d=(d<<8)+this.byteAt(u);return this.index+=c,d},readString:function(c){return s.transformTo("string",this.readData(c))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var c=this.readInt(4);return new Date(Date.UTC(1980+(c>>25&127),(c>>21&15)-1,c>>16&31,c>>11&31,c>>5&63,(31&c)<<1))}},n.exports=o},{"../utils":32}],19:[function(t,n,i){var s=t("./Uint8ArrayReader");function o(c){s.call(this,c)}t("../utils").inherits(o,s),o.prototype.readData=function(c){this.checkOffset(c);var u=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,u},n.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,n,i){var s=t("./DataReader");function o(c){s.call(this,c)}t("../utils").inherits(o,s),o.prototype.byteAt=function(c){return this.data.charCodeAt(this.zero+c)},o.prototype.lastIndexOfSignature=function(c){return this.data.lastIndexOf(c)-this.zero},o.prototype.readAndCheckSignature=function(c){return c===this.readData(4)},o.prototype.readData=function(c){this.checkOffset(c);var u=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,u},n.exports=o},{"../utils":32,"./DataReader":18}],21:[function(t,n,i){var s=t("./ArrayReader");function o(c){s.call(this,c)}t("../utils").inherits(o,s),o.prototype.readData=function(c){if(this.checkOffset(c),c===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+c);return this.index+=c,u},n.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(t,n,i){var s=t("../utils"),o=t("../support"),c=t("./ArrayReader"),u=t("./StringReader"),d=t("./NodeBufferReader"),h=t("./Uint8ArrayReader");n.exports=function(g){var x=s.getTypeOf(g);return s.checkSupport(x),x!=="string"||o.uint8array?x==="nodebuffer"?new d(g):o.uint8array?new h(s.transformTo("uint8array",g)):new c(s.transformTo("array",g)):new u(g)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,n,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,n,i){var s=t("./GenericWorker"),o=t("../utils");function c(u){s.call(this,"ConvertWorker to "+u),this.destType=u}o.inherits(c,s),c.prototype.processChunk=function(u){this.push({data:o.transformTo(this.destType,u.data),meta:u.meta})},n.exports=c},{"../utils":32,"./GenericWorker":28}],25:[function(t,n,i){var s=t("./GenericWorker"),o=t("../crc32");function c(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(c,s),c.prototype.processChunk=function(u){this.streamInfo.crc32=o(u.data,this.streamInfo.crc32||0),this.push(u)},n.exports=c},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,n,i){var s=t("../utils"),o=t("./GenericWorker");function c(u){o.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}s.inherits(c,o),c.prototype.processChunk=function(u){if(u){var d=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=d+u.data.length}o.prototype.processChunk.call(this,u)},n.exports=c},{"../utils":32,"./GenericWorker":28}],27:[function(t,n,i){var s=t("../utils"),o=t("./GenericWorker");function c(u){o.call(this,"DataWorker");var d=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(h){d.dataIsReady=!0,d.data=h,d.max=h&&h.length||0,d.type=s.getTypeOf(h),d.isPaused||d._tickAndRepeat()},function(h){d.error(h)})}s.inherits(c,o),c.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},c.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},c.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},c.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,d=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,d);break;case"uint8array":u=this.data.subarray(this.index,d);break;case"array":case"nodebuffer":u=this.data.slice(this.index,d)}return this.index=d,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=c},{"../utils":32,"./GenericWorker":28}],28:[function(t,n,i){function s(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,c){return this._listeners[o].push(c),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,c){if(this._listeners[o])for(var u=0;u<this._listeners[o].length;u++)this._listeners[o][u].call(this,c)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var c=this;return o.on("data",function(u){c.processChunk(u)}),o.on("end",function(){c.end()}),o.on("error",function(u){c.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,c){return this.extraStreamInfo[o]=c,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},n.exports=s},{}],29:[function(t,n,i){var s=t("../utils"),o=t("./ConvertWorker"),c=t("./GenericWorker"),u=t("../base64"),d=t("../support"),h=t("../external"),g=null;if(d.nodestream)try{g=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function x(y,v){return new h.Promise(function(_,S){var T=[],C=y._internalType,A=y._outputType,P=y._mimeType;y.on("data",function(N,O){T.push(N),v&&v(O)}).on("error",function(N){T=[],S(N)}).on("end",function(){try{var N=(function(O,V,B){switch(O){case"blob":return s.newBlob(s.transformTo("arraybuffer",V),B);case"base64":return u.encode(V);default:return s.transformTo(O,V)}})(A,(function(O,V){var B,te=0,ie=null,D=0;for(B=0;B<V.length;B++)D+=V[B].length;switch(O){case"string":return V.join("");case"array":return Array.prototype.concat.apply([],V);case"uint8array":for(ie=new Uint8Array(D),B=0;B<V.length;B++)ie.set(V[B],te),te+=V[B].length;return ie;case"nodebuffer":return Buffer.concat(V);default:throw new Error("concat : unsupported type '"+O+"'")}})(C,T),P);_(N)}catch(O){S(O)}T=[]}).resume()})}function m(y,v,_){var S=v;switch(v){case"blob":case"arraybuffer":S="uint8array";break;case"base64":S="string"}try{this._internalType=S,this._outputType=v,this._mimeType=_,s.checkSupport(S),this._worker=y.pipe(new o(S)),y.lock()}catch(T){this._worker=new c("error"),this._worker.error(T)}}m.prototype={accumulate:function(y){return x(this,y)},on:function(y,v){var _=this;return y==="data"?this._worker.on(y,function(S){v.call(_,S.data,S.meta)}):this._worker.on(y,function(){s.delay(v,arguments,_)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new g(this,{objectMode:this._outputType!=="nodebuffer"},y)}},n.exports=m},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,n,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(s),i.blob=o.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!t("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(t,n,i){for(var s=t("./utils"),o=t("./support"),c=t("./nodejsUtils"),u=t("./stream/GenericWorker"),d=new Array(256),h=0;h<256;h++)d[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;d[254]=d[254]=1;function g(){u.call(this,"utf-8 decode"),this.leftOver=null}function x(){u.call(this,"utf-8 encode")}i.utf8encode=function(m){return o.nodebuffer?c.newBufferFrom(m,"utf-8"):(function(y){var v,_,S,T,C,A=y.length,P=0;for(T=0;T<A;T++)(64512&(_=y.charCodeAt(T)))==55296&&T+1<A&&(64512&(S=y.charCodeAt(T+1)))==56320&&(_=65536+(_-55296<<10)+(S-56320),T++),P+=_<128?1:_<2048?2:_<65536?3:4;for(v=o.uint8array?new Uint8Array(P):new Array(P),T=C=0;C<P;T++)(64512&(_=y.charCodeAt(T)))==55296&&T+1<A&&(64512&(S=y.charCodeAt(T+1)))==56320&&(_=65536+(_-55296<<10)+(S-56320),T++),_<128?v[C++]=_:(_<2048?v[C++]=192|_>>>6:(_<65536?v[C++]=224|_>>>12:(v[C++]=240|_>>>18,v[C++]=128|_>>>12&63),v[C++]=128|_>>>6&63),v[C++]=128|63&_);return v})(m)},i.utf8decode=function(m){return o.nodebuffer?s.transformTo("nodebuffer",m).toString("utf-8"):(function(y){var v,_,S,T,C=y.length,A=new Array(2*C);for(v=_=0;v<C;)if((S=y[v++])<128)A[_++]=S;else if(4<(T=d[S]))A[_++]=65533,v+=T-1;else{for(S&=T===2?31:T===3?15:7;1<T&&v<C;)S=S<<6|63&y[v++],T--;1<T?A[_++]=65533:S<65536?A[_++]=S:(S-=65536,A[_++]=55296|S>>10&1023,A[_++]=56320|1023&S)}return A.length!==_&&(A.subarray?A=A.subarray(0,_):A.length=_),s.applyFromCharCode(A)})(m=s.transformTo(o.uint8array?"uint8array":"array",m))},s.inherits(g,u),g.prototype.processChunk=function(m){var y=s.transformTo(o.uint8array?"uint8array":"array",m.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var v=y;(y=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),y.set(v,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var _=(function(T,C){var A;for((C=C||T.length)>T.length&&(C=T.length),A=C-1;0<=A&&(192&T[A])==128;)A--;return A<0||A===0?C:A+d[T[A]]>C?A:C})(y),S=y;_!==y.length&&(o.uint8array?(S=y.subarray(0,_),this.leftOver=y.subarray(_,y.length)):(S=y.slice(0,_),this.leftOver=y.slice(_,y.length))),this.push({data:i.utf8decode(S),meta:m.meta})},g.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=g,s.inherits(x,u),x.prototype.processChunk=function(m){this.push({data:i.utf8encode(m.data),meta:m.meta})},i.Utf8EncodeWorker=x},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,n,i){var s=t("./support"),o=t("./base64"),c=t("./nodejsUtils"),u=t("./external");function d(v){return v}function h(v,_){for(var S=0;S<v.length;++S)_[S]=255&v.charCodeAt(S);return _}t("setimmediate"),i.newBlob=function(v,_){i.checkSupport("blob");try{return new Blob([v],{type:_})}catch{try{var S=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return S.append(v),S.getBlob(_)}catch{throw new Error("Bug : can't construct the Blob.")}}};var g={stringifyByChunk:function(v,_,S){var T=[],C=0,A=v.length;if(A<=S)return String.fromCharCode.apply(null,v);for(;C<A;)_==="array"||_==="nodebuffer"?T.push(String.fromCharCode.apply(null,v.slice(C,Math.min(C+S,A)))):T.push(String.fromCharCode.apply(null,v.subarray(C,Math.min(C+S,A)))),C+=S;return T.join("")},stringifyByChar:function(v){for(var _="",S=0;S<v.length;S++)_+=String.fromCharCode(v[S]);return _},applyCanBeUsed:{uint8array:(function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,c.allocBuffer(1)).length===1}catch{return!1}})()}};function x(v){var _=65536,S=i.getTypeOf(v),T=!0;if(S==="uint8array"?T=g.applyCanBeUsed.uint8array:S==="nodebuffer"&&(T=g.applyCanBeUsed.nodebuffer),T)for(;1<_;)try{return g.stringifyByChunk(v,S,_)}catch{_=Math.floor(_/2)}return g.stringifyByChar(v)}function m(v,_){for(var S=0;S<v.length;S++)_[S]=v[S];return _}i.applyFromCharCode=x;var y={};y.string={string:d,array:function(v){return h(v,new Array(v.length))},arraybuffer:function(v){return y.string.uint8array(v).buffer},uint8array:function(v){return h(v,new Uint8Array(v.length))},nodebuffer:function(v){return h(v,c.allocBuffer(v.length))}},y.array={string:x,array:d,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return c.newBufferFrom(v)}},y.arraybuffer={string:function(v){return x(new Uint8Array(v))},array:function(v){return m(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:d,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return c.newBufferFrom(new Uint8Array(v))}},y.uint8array={string:x,array:function(v){return m(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:d,nodebuffer:function(v){return c.newBufferFrom(v)}},y.nodebuffer={string:x,array:function(v){return m(v,new Array(v.length))},arraybuffer:function(v){return y.nodebuffer.uint8array(v).buffer},uint8array:function(v){return m(v,new Uint8Array(v.length))},nodebuffer:d},i.transformTo=function(v,_){if(_=_||"",!v)return _;i.checkSupport(v);var S=i.getTypeOf(_);return y[S][v](_)},i.resolve=function(v){for(var _=v.split("/"),S=[],T=0;T<_.length;T++){var C=_[T];C==="."||C===""&&T!==0&&T!==_.length-1||(C===".."?S.pop():S.push(C))}return S.join("/")},i.getTypeOf=function(v){return typeof v=="string"?"string":Object.prototype.toString.call(v)==="[object Array]"?"array":s.nodebuffer&&c.isBuffer(v)?"nodebuffer":s.uint8array&&v instanceof Uint8Array?"uint8array":s.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(v){if(!s[v.toLowerCase()])throw new Error(v+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(v){var _,S,T="";for(S=0;S<(v||"").length;S++)T+="\\x"+((_=v.charCodeAt(S))<16?"0":"")+_.toString(16).toUpperCase();return T},i.delay=function(v,_,S){setImmediate(function(){v.apply(S||null,_||[])})},i.inherits=function(v,_){function S(){}S.prototype=_.prototype,v.prototype=new S},i.extend=function(){var v,_,S={};for(v=0;v<arguments.length;v++)for(_ in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],_)&&S[_]===void 0&&(S[_]=arguments[v][_]);return S},i.prepareContent=function(v,_,S,T,C){return u.Promise.resolve(_).then(function(A){return s.blob&&(A instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(A))!==-1)&&typeof FileReader<"u"?new u.Promise(function(P,N){var O=new FileReader;O.onload=function(V){P(V.target.result)},O.onerror=function(V){N(V.target.error)},O.readAsArrayBuffer(A)}):A}).then(function(A){var P=i.getTypeOf(A);return P?(P==="arraybuffer"?A=i.transformTo("uint8array",A):P==="string"&&(C?A=o.decode(A):S&&T!==!0&&(A=(function(N){return h(N,s.uint8array?new Uint8Array(N.length):new Array(N.length))})(A))),A):u.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,n,i){var s=t("./reader/readerFor"),o=t("./utils"),c=t("./signature"),u=t("./zipEntry"),d=t("./support");function h(g){this.files=[],this.loadOptions=g}h.prototype={checkSignature:function(g){if(!this.reader.readAndCheckSignature(g)){this.reader.index-=4;var x=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(x)+", expected "+o.pretty(g)+")")}},isSignature:function(g,x){var m=this.reader.index;this.reader.setIndex(g);var y=this.reader.readString(4)===x;return this.reader.setIndex(m),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var g=this.reader.readData(this.zipCommentLength),x=d.uint8array?"uint8array":"array",m=o.transformTo(x,g);this.zipComment=this.loadOptions.decodeFileName(m)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var g,x,m,y=this.zip64EndOfCentralSize-44;0<y;)g=this.reader.readInt(2),x=this.reader.readInt(4),m=this.reader.readData(x),this.zip64ExtensibleData[g]={id:g,length:x,value:m}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var g,x;for(g=0;g<this.files.length;g++)x=this.files[g],this.reader.setIndex(x.localHeaderOffset),this.checkSignature(c.LOCAL_FILE_HEADER),x.readLocalPart(this.reader),x.handleUTF8(),x.processAttributes()},readCentralDir:function(){var g;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(c.CENTRAL_FILE_HEADER);)(g=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(g);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var g=this.reader.lastIndexOfSignature(c.CENTRAL_DIRECTORY_END);if(g<0)throw this.isSignature(0,c.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(g);var x=g;if(this.checkSignature(c.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(g=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(g),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,c.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var m=this.centralDirOffset+this.centralDirSize;this.zip64&&(m+=20,m+=12+this.zip64EndOfCentralSize);var y=x-m;if(0<y)this.isSignature(x,c.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(g){this.reader=s(g)},load:function(g){this.prepareReader(g),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,n,i){var s=t("./reader/readerFor"),o=t("./utils"),c=t("./compressedObject"),u=t("./crc32"),d=t("./utf8"),h=t("./compressions"),g=t("./support");function x(m,y){this.options=m,this.loadOptions=y}x.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(m){var y,v;if(m.skip(22),this.fileNameLength=m.readInt(2),v=m.readInt(2),this.fileName=m.readData(this.fileNameLength),m.skip(v),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=(function(_){for(var S in h)if(Object.prototype.hasOwnProperty.call(h,S)&&h[S].magic===_)return h[S];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new c(this.compressedSize,this.uncompressedSize,this.crc32,y,m.readData(this.compressedSize))},readCentralPart:function(m){this.versionMadeBy=m.readInt(2),m.skip(2),this.bitFlag=m.readInt(2),this.compressionMethod=m.readString(2),this.date=m.readDate(),this.crc32=m.readInt(4),this.compressedSize=m.readInt(4),this.uncompressedSize=m.readInt(4);var y=m.readInt(2);if(this.extraFieldsLength=m.readInt(2),this.fileCommentLength=m.readInt(2),this.diskNumberStart=m.readInt(2),this.internalFileAttributes=m.readInt(2),this.externalFileAttributes=m.readInt(4),this.localHeaderOffset=m.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");m.skip(y),this.readExtraFields(m),this.parseZIP64ExtraField(m),this.fileComment=m.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var m=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),m==0&&(this.dosPermissions=63&this.externalFileAttributes),m==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var m=s(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=m.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=m.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=m.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=m.readInt(4))}},readExtraFields:function(m){var y,v,_,S=m.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});m.index+4<S;)y=m.readInt(2),v=m.readInt(2),_=m.readData(v),this.extraFields[y]={id:y,length:v,value:_};m.setIndex(S)},handleUTF8:function(){var m=g.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=d.utf8decode(this.fileName),this.fileCommentStr=d.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var v=o.transformTo(m,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var _=this.findExtraFieldUnicodeComment();if(_!==null)this.fileCommentStr=_;else{var S=o.transformTo(m,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(S)}}},findExtraFieldUnicodePath:function(){var m=this.extraFields[28789];if(m){var y=s(m.value);return y.readInt(1)!==1||u(this.fileName)!==y.readInt(4)?null:d.utf8decode(y.readData(m.length-5))}return null},findExtraFieldUnicodeComment:function(){var m=this.extraFields[25461];if(m){var y=s(m.value);return y.readInt(1)!==1||u(this.fileComment)!==y.readInt(4)?null:d.utf8decode(y.readData(m.length-5))}return null}},n.exports=x},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,n,i){function s(y,v,_){this.name=y,this.dir=_.dir,this.date=_.date,this.comment=_.comment,this.unixPermissions=_.unixPermissions,this.dosPermissions=_.dosPermissions,this._data=v,this._dataBinary=_.binary,this.options={compression:_.compression,compressionOptions:_.compressionOptions}}var o=t("./stream/StreamHelper"),c=t("./stream/DataWorker"),u=t("./utf8"),d=t("./compressedObject"),h=t("./stream/GenericWorker");s.prototype={internalStream:function(y){var v=null,_="string";try{if(!y)throw new Error("No output type specified.");var S=(_=y.toLowerCase())==="string"||_==="text";_!=="binarystring"&&_!=="text"||(_="string"),v=this._decompressWorker();var T=!this._dataBinary;T&&!S&&(v=v.pipe(new u.Utf8EncodeWorker)),!T&&S&&(v=v.pipe(new u.Utf8DecodeWorker))}catch(C){(v=new h("error")).error(C)}return new o(v,_,"")},async:function(y,v){return this.internalStream(y).accumulate(v)},nodeStream:function(y,v){return this.internalStream(y||"nodebuffer").toNodejsStream(v)},_compressWorker:function(y,v){if(this._data instanceof d&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var _=this._decompressWorker();return this._dataBinary||(_=_.pipe(new u.Utf8EncodeWorker)),d.createWorkerFrom(_,y,v)},_decompressWorker:function(){return this._data instanceof d?this._data.getContentWorker():this._data instanceof h?this._data:new c(this._data)}};for(var g=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],x=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},m=0;m<g.length;m++)s.prototype[g[m]]=x;n.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,n,i){(function(s){var o,c,u=s.MutationObserver||s.WebKitMutationObserver;if(u){var d=0,h=new u(y),g=s.document.createTextNode("");h.observe(g,{characterData:!0}),o=function(){g.data=d=++d%2}}else if(s.setImmediate||s.MessageChannel===void 0)o="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var v=s.document.createElement("script");v.onreadystatechange=function(){y(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},s.document.documentElement.appendChild(v)}:function(){setTimeout(y,0)};else{var x=new s.MessageChannel;x.port1.onmessage=y,o=function(){x.port2.postMessage(0)}}var m=[];function y(){var v,_;c=!0;for(var S=m.length;S;){for(_=m,m=[],v=-1;++v<S;)_[v]();S=m.length}c=!1}n.exports=function(v){m.push(v)!==1||c||o()}}).call(this,typeof Yc<"u"?Yc:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,n,i){var s=t("immediate");function o(){}var c={},u=["REJECTED"],d=["FULFILLED"],h=["PENDING"];function g(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,S!==o&&v(this,S)}function x(S,T,C){this.promise=S,typeof T=="function"&&(this.onFulfilled=T,this.callFulfilled=this.otherCallFulfilled),typeof C=="function"&&(this.onRejected=C,this.callRejected=this.otherCallRejected)}function m(S,T,C){s(function(){var A;try{A=T(C)}catch(P){return c.reject(S,P)}A===S?c.reject(S,new TypeError("Cannot resolve promise with itself")):c.resolve(S,A)})}function y(S){var T=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof T=="function")return function(){T.apply(S,arguments)}}function v(S,T){var C=!1;function A(O){C||(C=!0,c.reject(S,O))}function P(O){C||(C=!0,c.resolve(S,O))}var N=_(function(){T(P,A)});N.status==="error"&&A(N.value)}function _(S,T){var C={};try{C.value=S(T),C.status="success"}catch(A){C.status="error",C.value=A}return C}(n.exports=g).prototype.finally=function(S){if(typeof S!="function")return this;var T=this.constructor;return this.then(function(C){return T.resolve(S()).then(function(){return C})},function(C){return T.resolve(S()).then(function(){throw C})})},g.prototype.catch=function(S){return this.then(null,S)},g.prototype.then=function(S,T){if(typeof S!="function"&&this.state===d||typeof T!="function"&&this.state===u)return this;var C=new this.constructor(o);return this.state!==h?m(C,this.state===d?S:T,this.outcome):this.queue.push(new x(C,S,T)),C},x.prototype.callFulfilled=function(S){c.resolve(this.promise,S)},x.prototype.otherCallFulfilled=function(S){m(this.promise,this.onFulfilled,S)},x.prototype.callRejected=function(S){c.reject(this.promise,S)},x.prototype.otherCallRejected=function(S){m(this.promise,this.onRejected,S)},c.resolve=function(S,T){var C=_(y,T);if(C.status==="error")return c.reject(S,C.value);var A=C.value;if(A)v(S,A);else{S.state=d,S.outcome=T;for(var P=-1,N=S.queue.length;++P<N;)S.queue[P].callFulfilled(T)}return S},c.reject=function(S,T){S.state=u,S.outcome=T;for(var C=-1,A=S.queue.length;++C<A;)S.queue[C].callRejected(T);return S},g.resolve=function(S){return S instanceof this?S:c.resolve(new this(o),S)},g.reject=function(S){var T=new this(o);return c.reject(T,S)},g.all=function(S){var T=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=S.length,A=!1;if(!C)return this.resolve([]);for(var P=new Array(C),N=0,O=-1,V=new this(o);++O<C;)B(S[O],O);return V;function B(te,ie){T.resolve(te).then(function(D){P[ie]=D,++N!==C||A||(A=!0,c.resolve(V,P))},function(D){A||(A=!0,c.reject(V,D))})}},g.race=function(S){var T=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=S.length,A=!1;if(!C)return this.resolve([]);for(var P=-1,N=new this(o);++P<C;)O=S[P],T.resolve(O).then(function(V){A||(A=!0,c.resolve(N,V))},function(V){A||(A=!0,c.reject(N,V))});var O;return N}},{immediate:36}],38:[function(t,n,i){var s={};(0,t("./lib/utils/common").assign)(s,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),n.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,n,i){var s=t("./zlib/deflate"),o=t("./utils/common"),c=t("./utils/strings"),u=t("./zlib/messages"),d=t("./zlib/zstream"),h=Object.prototype.toString,g=0,x=-1,m=0,y=8;function v(S){if(!(this instanceof v))return new v(S);this.options=o.assign({level:x,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},S||{});var T=this.options;T.raw&&0<T.windowBits?T.windowBits=-T.windowBits:T.gzip&&0<T.windowBits&&T.windowBits<16&&(T.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var C=s.deflateInit2(this.strm,T.level,T.method,T.windowBits,T.memLevel,T.strategy);if(C!==g)throw new Error(u[C]);if(T.header&&s.deflateSetHeader(this.strm,T.header),T.dictionary){var A;if(A=typeof T.dictionary=="string"?c.string2buf(T.dictionary):h.call(T.dictionary)==="[object ArrayBuffer]"?new Uint8Array(T.dictionary):T.dictionary,(C=s.deflateSetDictionary(this.strm,A))!==g)throw new Error(u[C]);this._dict_set=!0}}function _(S,T){var C=new v(T);if(C.push(S,!0),C.err)throw C.msg||u[C.err];return C.result}v.prototype.push=function(S,T){var C,A,P=this.strm,N=this.options.chunkSize;if(this.ended)return!1;A=T===~~T?T:T===!0?4:0,typeof S=="string"?P.input=c.string2buf(S):h.call(S)==="[object ArrayBuffer]"?P.input=new Uint8Array(S):P.input=S,P.next_in=0,P.avail_in=P.input.length;do{if(P.avail_out===0&&(P.output=new o.Buf8(N),P.next_out=0,P.avail_out=N),(C=s.deflate(P,A))!==1&&C!==g)return this.onEnd(C),!(this.ended=!0);P.avail_out!==0&&(P.avail_in!==0||A!==4&&A!==2)||(this.options.to==="string"?this.onData(c.buf2binstring(o.shrinkBuf(P.output,P.next_out))):this.onData(o.shrinkBuf(P.output,P.next_out)))}while((0<P.avail_in||P.avail_out===0)&&C!==1);return A===4?(C=s.deflateEnd(this.strm),this.onEnd(C),this.ended=!0,C===g):A!==2||(this.onEnd(g),!(P.avail_out=0))},v.prototype.onData=function(S){this.chunks.push(S)},v.prototype.onEnd=function(S){S===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=S,this.msg=this.strm.msg},i.Deflate=v,i.deflate=_,i.deflateRaw=function(S,T){return(T=T||{}).raw=!0,_(S,T)},i.gzip=function(S,T){return(T=T||{}).gzip=!0,_(S,T)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,n,i){var s=t("./zlib/inflate"),o=t("./utils/common"),c=t("./utils/strings"),u=t("./zlib/constants"),d=t("./zlib/messages"),h=t("./zlib/zstream"),g=t("./zlib/gzheader"),x=Object.prototype.toString;function m(v){if(!(this instanceof m))return new m(v);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},v||{});var _=this.options;_.raw&&0<=_.windowBits&&_.windowBits<16&&(_.windowBits=-_.windowBits,_.windowBits===0&&(_.windowBits=-15)),!(0<=_.windowBits&&_.windowBits<16)||v&&v.windowBits||(_.windowBits+=32),15<_.windowBits&&_.windowBits<48&&(15&_.windowBits)==0&&(_.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var S=s.inflateInit2(this.strm,_.windowBits);if(S!==u.Z_OK)throw new Error(d[S]);this.header=new g,s.inflateGetHeader(this.strm,this.header)}function y(v,_){var S=new m(_);if(S.push(v,!0),S.err)throw S.msg||d[S.err];return S.result}m.prototype.push=function(v,_){var S,T,C,A,P,N,O=this.strm,V=this.options.chunkSize,B=this.options.dictionary,te=!1;if(this.ended)return!1;T=_===~~_?_:_===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof v=="string"?O.input=c.binstring2buf(v):x.call(v)==="[object ArrayBuffer]"?O.input=new Uint8Array(v):O.input=v,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new o.Buf8(V),O.next_out=0,O.avail_out=V),(S=s.inflate(O,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&B&&(N=typeof B=="string"?c.string2buf(B):x.call(B)==="[object ArrayBuffer]"?new Uint8Array(B):B,S=s.inflateSetDictionary(this.strm,N)),S===u.Z_BUF_ERROR&&te===!0&&(S=u.Z_OK,te=!1),S!==u.Z_STREAM_END&&S!==u.Z_OK)return this.onEnd(S),!(this.ended=!0);O.next_out&&(O.avail_out!==0&&S!==u.Z_STREAM_END&&(O.avail_in!==0||T!==u.Z_FINISH&&T!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(C=c.utf8border(O.output,O.next_out),A=O.next_out-C,P=c.buf2string(O.output,C),O.next_out=A,O.avail_out=V-A,A&&o.arraySet(O.output,O.output,C,A,0),this.onData(P)):this.onData(o.shrinkBuf(O.output,O.next_out)))),O.avail_in===0&&O.avail_out===0&&(te=!0)}while((0<O.avail_in||O.avail_out===0)&&S!==u.Z_STREAM_END);return S===u.Z_STREAM_END&&(T=u.Z_FINISH),T===u.Z_FINISH?(S=s.inflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===u.Z_OK):T!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(O.avail_out=0))},m.prototype.onData=function(v){this.chunks.push(v)},m.prototype.onEnd=function(v){v===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},i.Inflate=m,i.inflate=y,i.inflateRaw=function(v,_){return(_=_||{}).raw=!0,y(v,_)},i.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,n,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(u){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var h=d.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var g in h)h.hasOwnProperty(g)&&(u[g]=h[g])}}return u},i.shrinkBuf=function(u,d){return u.length===d?u:u.subarray?u.subarray(0,d):(u.length=d,u)};var o={arraySet:function(u,d,h,g,x){if(d.subarray&&u.subarray)u.set(d.subarray(h,h+g),x);else for(var m=0;m<g;m++)u[x+m]=d[h+m]},flattenChunks:function(u){var d,h,g,x,m,y;for(d=g=0,h=u.length;d<h;d++)g+=u[d].length;for(y=new Uint8Array(g),d=x=0,h=u.length;d<h;d++)m=u[d],y.set(m,x),x+=m.length;return y}},c={arraySet:function(u,d,h,g,x){for(var m=0;m<g;m++)u[x+m]=d[h+m]},flattenChunks:function(u){return[].concat.apply([],u)}};i.setTyped=function(u){u?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,o)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,c))},i.setTyped(s)},{}],42:[function(t,n,i){var s=t("./common"),o=!0,c=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{c=!1}for(var u=new s.Buf8(256),d=0;d<256;d++)u[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;function h(g,x){if(x<65537&&(g.subarray&&c||!g.subarray&&o))return String.fromCharCode.apply(null,s.shrinkBuf(g,x));for(var m="",y=0;y<x;y++)m+=String.fromCharCode(g[y]);return m}u[254]=u[254]=1,i.string2buf=function(g){var x,m,y,v,_,S=g.length,T=0;for(v=0;v<S;v++)(64512&(m=g.charCodeAt(v)))==55296&&v+1<S&&(64512&(y=g.charCodeAt(v+1)))==56320&&(m=65536+(m-55296<<10)+(y-56320),v++),T+=m<128?1:m<2048?2:m<65536?3:4;for(x=new s.Buf8(T),v=_=0;_<T;v++)(64512&(m=g.charCodeAt(v)))==55296&&v+1<S&&(64512&(y=g.charCodeAt(v+1)))==56320&&(m=65536+(m-55296<<10)+(y-56320),v++),m<128?x[_++]=m:(m<2048?x[_++]=192|m>>>6:(m<65536?x[_++]=224|m>>>12:(x[_++]=240|m>>>18,x[_++]=128|m>>>12&63),x[_++]=128|m>>>6&63),x[_++]=128|63&m);return x},i.buf2binstring=function(g){return h(g,g.length)},i.binstring2buf=function(g){for(var x=new s.Buf8(g.length),m=0,y=x.length;m<y;m++)x[m]=g.charCodeAt(m);return x},i.buf2string=function(g,x){var m,y,v,_,S=x||g.length,T=new Array(2*S);for(m=y=0;m<S;)if((v=g[m++])<128)T[y++]=v;else if(4<(_=u[v]))T[y++]=65533,m+=_-1;else{for(v&=_===2?31:_===3?15:7;1<_&&m<S;)v=v<<6|63&g[m++],_--;1<_?T[y++]=65533:v<65536?T[y++]=v:(v-=65536,T[y++]=55296|v>>10&1023,T[y++]=56320|1023&v)}return h(T,y)},i.utf8border=function(g,x){var m;for((x=x||g.length)>g.length&&(x=g.length),m=x-1;0<=m&&(192&g[m])==128;)m--;return m<0||m===0?x:m+u[g[m]]>x?m:x}},{"./common":41}],43:[function(t,n,i){n.exports=function(s,o,c,u){for(var d=65535&s|0,h=s>>>16&65535|0,g=0;c!==0;){for(c-=g=2e3<c?2e3:c;h=h+(d=d+o[u++]|0)|0,--g;);d%=65521,h%=65521}return d|h<<16|0}},{}],44:[function(t,n,i){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,n,i){var s=(function(){for(var o,c=[],u=0;u<256;u++){o=u;for(var d=0;d<8;d++)o=1&o?3988292384^o>>>1:o>>>1;c[u]=o}return c})();n.exports=function(o,c,u,d){var h=s,g=d+u;o^=-1;for(var x=d;x<g;x++)o=o>>>8^h[255&(o^c[x])];return-1^o}},{}],46:[function(t,n,i){var s,o=t("../utils/common"),c=t("./trees"),u=t("./adler32"),d=t("./crc32"),h=t("./messages"),g=0,x=4,m=0,y=-2,v=-1,_=4,S=2,T=8,C=9,A=286,P=30,N=19,O=2*A+1,V=15,B=3,te=258,ie=te+B+1,D=42,J=113,F=1,se=2,Ee=3,le=4;function xe(E,de){return E.msg=h[de],de}function X(E){return(E<<1)-(4<E?9:0)}function pe(E){for(var de=E.length;0<=--de;)E[de]=0}function R(E){var de=E.state,ce=de.pending;ce>E.avail_out&&(ce=E.avail_out),ce!==0&&(o.arraySet(E.output,de.pending_buf,de.pending_out,ce,E.next_out),E.next_out+=ce,de.pending_out+=ce,E.total_out+=ce,E.avail_out-=ce,de.pending-=ce,de.pending===0&&(de.pending_out=0))}function b(E,de){c._tr_flush_block(E,0<=E.block_start?E.block_start:-1,E.strstart-E.block_start,de),E.block_start=E.strstart,R(E.strm)}function ee(E,de){E.pending_buf[E.pending++]=de}function G(E,de){E.pending_buf[E.pending++]=de>>>8&255,E.pending_buf[E.pending++]=255&de}function H(E,de){var ce,j,U=E.max_chain_length,ae=E.strstart,Ae=E.prev_length,Pe=E.nice_match,ge=E.strstart>E.w_size-ie?E.strstart-(E.w_size-ie):0,Oe=E.window,Re=E.w_mask,Be=E.prev,re=E.strstart+te,nt=Oe[ae+Ae-1],He=Oe[ae+Ae];E.prev_length>=E.good_match&&(U>>=2),Pe>E.lookahead&&(Pe=E.lookahead);do if(Oe[(ce=de)+Ae]===He&&Oe[ce+Ae-1]===nt&&Oe[ce]===Oe[ae]&&Oe[++ce]===Oe[ae+1]){ae+=2,ce++;do;while(Oe[++ae]===Oe[++ce]&&Oe[++ae]===Oe[++ce]&&Oe[++ae]===Oe[++ce]&&Oe[++ae]===Oe[++ce]&&Oe[++ae]===Oe[++ce]&&Oe[++ae]===Oe[++ce]&&Oe[++ae]===Oe[++ce]&&Oe[++ae]===Oe[++ce]&&ae<re);if(j=te-(re-ae),ae=re-te,Ae<j){if(E.match_start=de,Pe<=(Ae=j))break;nt=Oe[ae+Ae-1],He=Oe[ae+Ae]}}while((de=Be[de&Re])>ge&&--U!=0);return Ae<=E.lookahead?Ae:E.lookahead}function me(E){var de,ce,j,U,ae,Ae,Pe,ge,Oe,Re,Be=E.w_size;do{if(U=E.window_size-E.lookahead-E.strstart,E.strstart>=Be+(Be-ie)){for(o.arraySet(E.window,E.window,Be,Be,0),E.match_start-=Be,E.strstart-=Be,E.block_start-=Be,de=ce=E.hash_size;j=E.head[--de],E.head[de]=Be<=j?j-Be:0,--ce;);for(de=ce=Be;j=E.prev[--de],E.prev[de]=Be<=j?j-Be:0,--ce;);U+=Be}if(E.strm.avail_in===0)break;if(Ae=E.strm,Pe=E.window,ge=E.strstart+E.lookahead,Oe=U,Re=void 0,Re=Ae.avail_in,Oe<Re&&(Re=Oe),ce=Re===0?0:(Ae.avail_in-=Re,o.arraySet(Pe,Ae.input,Ae.next_in,Re,ge),Ae.state.wrap===1?Ae.adler=u(Ae.adler,Pe,Re,ge):Ae.state.wrap===2&&(Ae.adler=d(Ae.adler,Pe,Re,ge)),Ae.next_in+=Re,Ae.total_in+=Re,Re),E.lookahead+=ce,E.lookahead+E.insert>=B)for(ae=E.strstart-E.insert,E.ins_h=E.window[ae],E.ins_h=(E.ins_h<<E.hash_shift^E.window[ae+1])&E.hash_mask;E.insert&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[ae+B-1])&E.hash_mask,E.prev[ae&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=ae,ae++,E.insert--,!(E.lookahead+E.insert<B)););}while(E.lookahead<ie&&E.strm.avail_in!==0)}function Me(E,de){for(var ce,j;;){if(E.lookahead<ie){if(me(E),E.lookahead<ie&&de===g)return F;if(E.lookahead===0)break}if(ce=0,E.lookahead>=B&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+B-1])&E.hash_mask,ce=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart),ce!==0&&E.strstart-ce<=E.w_size-ie&&(E.match_length=H(E,ce)),E.match_length>=B)if(j=c._tr_tally(E,E.strstart-E.match_start,E.match_length-B),E.lookahead-=E.match_length,E.match_length<=E.max_lazy_match&&E.lookahead>=B){for(E.match_length--;E.strstart++,E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+B-1])&E.hash_mask,ce=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart,--E.match_length!=0;);E.strstart++}else E.strstart+=E.match_length,E.match_length=0,E.ins_h=E.window[E.strstart],E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+1])&E.hash_mask;else j=c._tr_tally(E,0,E.window[E.strstart]),E.lookahead--,E.strstart++;if(j&&(b(E,!1),E.strm.avail_out===0))return F}return E.insert=E.strstart<B-1?E.strstart:B-1,de===x?(b(E,!0),E.strm.avail_out===0?Ee:le):E.last_lit&&(b(E,!1),E.strm.avail_out===0)?F:se}function Fe(E,de){for(var ce,j,U;;){if(E.lookahead<ie){if(me(E),E.lookahead<ie&&de===g)return F;if(E.lookahead===0)break}if(ce=0,E.lookahead>=B&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+B-1])&E.hash_mask,ce=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart),E.prev_length=E.match_length,E.prev_match=E.match_start,E.match_length=B-1,ce!==0&&E.prev_length<E.max_lazy_match&&E.strstart-ce<=E.w_size-ie&&(E.match_length=H(E,ce),E.match_length<=5&&(E.strategy===1||E.match_length===B&&4096<E.strstart-E.match_start)&&(E.match_length=B-1)),E.prev_length>=B&&E.match_length<=E.prev_length){for(U=E.strstart+E.lookahead-B,j=c._tr_tally(E,E.strstart-1-E.prev_match,E.prev_length-B),E.lookahead-=E.prev_length-1,E.prev_length-=2;++E.strstart<=U&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+B-1])&E.hash_mask,ce=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart),--E.prev_length!=0;);if(E.match_available=0,E.match_length=B-1,E.strstart++,j&&(b(E,!1),E.strm.avail_out===0))return F}else if(E.match_available){if((j=c._tr_tally(E,0,E.window[E.strstart-1]))&&b(E,!1),E.strstart++,E.lookahead--,E.strm.avail_out===0)return F}else E.match_available=1,E.strstart++,E.lookahead--}return E.match_available&&(j=c._tr_tally(E,0,E.window[E.strstart-1]),E.match_available=0),E.insert=E.strstart<B-1?E.strstart:B-1,de===x?(b(E,!0),E.strm.avail_out===0?Ee:le):E.last_lit&&(b(E,!1),E.strm.avail_out===0)?F:se}function be(E,de,ce,j,U){this.good_length=E,this.max_lazy=de,this.nice_length=ce,this.max_chain=j,this.func=U}function De(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=T,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*O),this.dyn_dtree=new o.Buf16(2*(2*P+1)),this.bl_tree=new o.Buf16(2*(2*N+1)),pe(this.dyn_ltree),pe(this.dyn_dtree),pe(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(V+1),this.heap=new o.Buf16(2*A+1),pe(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*A+1),pe(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ne(E){var de;return E&&E.state?(E.total_in=E.total_out=0,E.data_type=S,(de=E.state).pending=0,de.pending_out=0,de.wrap<0&&(de.wrap=-de.wrap),de.status=de.wrap?D:J,E.adler=de.wrap===2?0:1,de.last_flush=g,c._tr_init(de),m):xe(E,y)}function z(E){var de=ne(E);return de===m&&(function(ce){ce.window_size=2*ce.w_size,pe(ce.head),ce.max_lazy_match=s[ce.level].max_lazy,ce.good_match=s[ce.level].good_length,ce.nice_match=s[ce.level].nice_length,ce.max_chain_length=s[ce.level].max_chain,ce.strstart=0,ce.block_start=0,ce.lookahead=0,ce.insert=0,ce.match_length=ce.prev_length=B-1,ce.match_available=0,ce.ins_h=0})(E.state),de}function Le(E,de,ce,j,U,ae){if(!E)return y;var Ae=1;if(de===v&&(de=6),j<0?(Ae=0,j=-j):15<j&&(Ae=2,j-=16),U<1||C<U||ce!==T||j<8||15<j||de<0||9<de||ae<0||_<ae)return xe(E,y);j===8&&(j=9);var Pe=new De;return(E.state=Pe).strm=E,Pe.wrap=Ae,Pe.gzhead=null,Pe.w_bits=j,Pe.w_size=1<<Pe.w_bits,Pe.w_mask=Pe.w_size-1,Pe.hash_bits=U+7,Pe.hash_size=1<<Pe.hash_bits,Pe.hash_mask=Pe.hash_size-1,Pe.hash_shift=~~((Pe.hash_bits+B-1)/B),Pe.window=new o.Buf8(2*Pe.w_size),Pe.head=new o.Buf16(Pe.hash_size),Pe.prev=new o.Buf16(Pe.w_size),Pe.lit_bufsize=1<<U+6,Pe.pending_buf_size=4*Pe.lit_bufsize,Pe.pending_buf=new o.Buf8(Pe.pending_buf_size),Pe.d_buf=1*Pe.lit_bufsize,Pe.l_buf=3*Pe.lit_bufsize,Pe.level=de,Pe.strategy=ae,Pe.method=ce,z(E)}s=[new be(0,0,0,0,function(E,de){var ce=65535;for(ce>E.pending_buf_size-5&&(ce=E.pending_buf_size-5);;){if(E.lookahead<=1){if(me(E),E.lookahead===0&&de===g)return F;if(E.lookahead===0)break}E.strstart+=E.lookahead,E.lookahead=0;var j=E.block_start+ce;if((E.strstart===0||E.strstart>=j)&&(E.lookahead=E.strstart-j,E.strstart=j,b(E,!1),E.strm.avail_out===0)||E.strstart-E.block_start>=E.w_size-ie&&(b(E,!1),E.strm.avail_out===0))return F}return E.insert=0,de===x?(b(E,!0),E.strm.avail_out===0?Ee:le):(E.strstart>E.block_start&&(b(E,!1),E.strm.avail_out),F)}),new be(4,4,8,4,Me),new be(4,5,16,8,Me),new be(4,6,32,32,Me),new be(4,4,16,16,Fe),new be(8,16,32,32,Fe),new be(8,16,128,128,Fe),new be(8,32,128,256,Fe),new be(32,128,258,1024,Fe),new be(32,258,258,4096,Fe)],i.deflateInit=function(E,de){return Le(E,de,T,15,8,0)},i.deflateInit2=Le,i.deflateReset=z,i.deflateResetKeep=ne,i.deflateSetHeader=function(E,de){return E&&E.state?E.state.wrap!==2?y:(E.state.gzhead=de,m):y},i.deflate=function(E,de){var ce,j,U,ae;if(!E||!E.state||5<de||de<0)return E?xe(E,y):y;if(j=E.state,!E.output||!E.input&&E.avail_in!==0||j.status===666&&de!==x)return xe(E,E.avail_out===0?-5:y);if(j.strm=E,ce=j.last_flush,j.last_flush=de,j.status===D)if(j.wrap===2)E.adler=0,ee(j,31),ee(j,139),ee(j,8),j.gzhead?(ee(j,(j.gzhead.text?1:0)+(j.gzhead.hcrc?2:0)+(j.gzhead.extra?4:0)+(j.gzhead.name?8:0)+(j.gzhead.comment?16:0)),ee(j,255&j.gzhead.time),ee(j,j.gzhead.time>>8&255),ee(j,j.gzhead.time>>16&255),ee(j,j.gzhead.time>>24&255),ee(j,j.level===9?2:2<=j.strategy||j.level<2?4:0),ee(j,255&j.gzhead.os),j.gzhead.extra&&j.gzhead.extra.length&&(ee(j,255&j.gzhead.extra.length),ee(j,j.gzhead.extra.length>>8&255)),j.gzhead.hcrc&&(E.adler=d(E.adler,j.pending_buf,j.pending,0)),j.gzindex=0,j.status=69):(ee(j,0),ee(j,0),ee(j,0),ee(j,0),ee(j,0),ee(j,j.level===9?2:2<=j.strategy||j.level<2?4:0),ee(j,3),j.status=J);else{var Ae=T+(j.w_bits-8<<4)<<8;Ae|=(2<=j.strategy||j.level<2?0:j.level<6?1:j.level===6?2:3)<<6,j.strstart!==0&&(Ae|=32),Ae+=31-Ae%31,j.status=J,G(j,Ae),j.strstart!==0&&(G(j,E.adler>>>16),G(j,65535&E.adler)),E.adler=1}if(j.status===69)if(j.gzhead.extra){for(U=j.pending;j.gzindex<(65535&j.gzhead.extra.length)&&(j.pending!==j.pending_buf_size||(j.gzhead.hcrc&&j.pending>U&&(E.adler=d(E.adler,j.pending_buf,j.pending-U,U)),R(E),U=j.pending,j.pending!==j.pending_buf_size));)ee(j,255&j.gzhead.extra[j.gzindex]),j.gzindex++;j.gzhead.hcrc&&j.pending>U&&(E.adler=d(E.adler,j.pending_buf,j.pending-U,U)),j.gzindex===j.gzhead.extra.length&&(j.gzindex=0,j.status=73)}else j.status=73;if(j.status===73)if(j.gzhead.name){U=j.pending;do{if(j.pending===j.pending_buf_size&&(j.gzhead.hcrc&&j.pending>U&&(E.adler=d(E.adler,j.pending_buf,j.pending-U,U)),R(E),U=j.pending,j.pending===j.pending_buf_size)){ae=1;break}ae=j.gzindex<j.gzhead.name.length?255&j.gzhead.name.charCodeAt(j.gzindex++):0,ee(j,ae)}while(ae!==0);j.gzhead.hcrc&&j.pending>U&&(E.adler=d(E.adler,j.pending_buf,j.pending-U,U)),ae===0&&(j.gzindex=0,j.status=91)}else j.status=91;if(j.status===91)if(j.gzhead.comment){U=j.pending;do{if(j.pending===j.pending_buf_size&&(j.gzhead.hcrc&&j.pending>U&&(E.adler=d(E.adler,j.pending_buf,j.pending-U,U)),R(E),U=j.pending,j.pending===j.pending_buf_size)){ae=1;break}ae=j.gzindex<j.gzhead.comment.length?255&j.gzhead.comment.charCodeAt(j.gzindex++):0,ee(j,ae)}while(ae!==0);j.gzhead.hcrc&&j.pending>U&&(E.adler=d(E.adler,j.pending_buf,j.pending-U,U)),ae===0&&(j.status=103)}else j.status=103;if(j.status===103&&(j.gzhead.hcrc?(j.pending+2>j.pending_buf_size&&R(E),j.pending+2<=j.pending_buf_size&&(ee(j,255&E.adler),ee(j,E.adler>>8&255),E.adler=0,j.status=J)):j.status=J),j.pending!==0){if(R(E),E.avail_out===0)return j.last_flush=-1,m}else if(E.avail_in===0&&X(de)<=X(ce)&&de!==x)return xe(E,-5);if(j.status===666&&E.avail_in!==0)return xe(E,-5);if(E.avail_in!==0||j.lookahead!==0||de!==g&&j.status!==666){var Pe=j.strategy===2?(function(ge,Oe){for(var Re;;){if(ge.lookahead===0&&(me(ge),ge.lookahead===0)){if(Oe===g)return F;break}if(ge.match_length=0,Re=c._tr_tally(ge,0,ge.window[ge.strstart]),ge.lookahead--,ge.strstart++,Re&&(b(ge,!1),ge.strm.avail_out===0))return F}return ge.insert=0,Oe===x?(b(ge,!0),ge.strm.avail_out===0?Ee:le):ge.last_lit&&(b(ge,!1),ge.strm.avail_out===0)?F:se})(j,de):j.strategy===3?(function(ge,Oe){for(var Re,Be,re,nt,He=ge.window;;){if(ge.lookahead<=te){if(me(ge),ge.lookahead<=te&&Oe===g)return F;if(ge.lookahead===0)break}if(ge.match_length=0,ge.lookahead>=B&&0<ge.strstart&&(Be=He[re=ge.strstart-1])===He[++re]&&Be===He[++re]&&Be===He[++re]){nt=ge.strstart+te;do;while(Be===He[++re]&&Be===He[++re]&&Be===He[++re]&&Be===He[++re]&&Be===He[++re]&&Be===He[++re]&&Be===He[++re]&&Be===He[++re]&&re<nt);ge.match_length=te-(nt-re),ge.match_length>ge.lookahead&&(ge.match_length=ge.lookahead)}if(ge.match_length>=B?(Re=c._tr_tally(ge,1,ge.match_length-B),ge.lookahead-=ge.match_length,ge.strstart+=ge.match_length,ge.match_length=0):(Re=c._tr_tally(ge,0,ge.window[ge.strstart]),ge.lookahead--,ge.strstart++),Re&&(b(ge,!1),ge.strm.avail_out===0))return F}return ge.insert=0,Oe===x?(b(ge,!0),ge.strm.avail_out===0?Ee:le):ge.last_lit&&(b(ge,!1),ge.strm.avail_out===0)?F:se})(j,de):s[j.level].func(j,de);if(Pe!==Ee&&Pe!==le||(j.status=666),Pe===F||Pe===Ee)return E.avail_out===0&&(j.last_flush=-1),m;if(Pe===se&&(de===1?c._tr_align(j):de!==5&&(c._tr_stored_block(j,0,0,!1),de===3&&(pe(j.head),j.lookahead===0&&(j.strstart=0,j.block_start=0,j.insert=0))),R(E),E.avail_out===0))return j.last_flush=-1,m}return de!==x?m:j.wrap<=0?1:(j.wrap===2?(ee(j,255&E.adler),ee(j,E.adler>>8&255),ee(j,E.adler>>16&255),ee(j,E.adler>>24&255),ee(j,255&E.total_in),ee(j,E.total_in>>8&255),ee(j,E.total_in>>16&255),ee(j,E.total_in>>24&255)):(G(j,E.adler>>>16),G(j,65535&E.adler)),R(E),0<j.wrap&&(j.wrap=-j.wrap),j.pending!==0?m:1)},i.deflateEnd=function(E){var de;return E&&E.state?(de=E.state.status)!==D&&de!==69&&de!==73&&de!==91&&de!==103&&de!==J&&de!==666?xe(E,y):(E.state=null,de===J?xe(E,-3):m):y},i.deflateSetDictionary=function(E,de){var ce,j,U,ae,Ae,Pe,ge,Oe,Re=de.length;if(!E||!E.state||(ae=(ce=E.state).wrap)===2||ae===1&&ce.status!==D||ce.lookahead)return y;for(ae===1&&(E.adler=u(E.adler,de,Re,0)),ce.wrap=0,Re>=ce.w_size&&(ae===0&&(pe(ce.head),ce.strstart=0,ce.block_start=0,ce.insert=0),Oe=new o.Buf8(ce.w_size),o.arraySet(Oe,de,Re-ce.w_size,ce.w_size,0),de=Oe,Re=ce.w_size),Ae=E.avail_in,Pe=E.next_in,ge=E.input,E.avail_in=Re,E.next_in=0,E.input=de,me(ce);ce.lookahead>=B;){for(j=ce.strstart,U=ce.lookahead-(B-1);ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[j+B-1])&ce.hash_mask,ce.prev[j&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=j,j++,--U;);ce.strstart=j,ce.lookahead=B-1,me(ce)}return ce.strstart+=ce.lookahead,ce.block_start=ce.strstart,ce.insert=ce.lookahead,ce.lookahead=0,ce.match_length=ce.prev_length=B-1,ce.match_available=0,E.next_in=Pe,E.input=ge,E.avail_in=Ae,ce.wrap=ae,m},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,n,i){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,n,i){n.exports=function(s,o){var c,u,d,h,g,x,m,y,v,_,S,T,C,A,P,N,O,V,B,te,ie,D,J,F,se;c=s.state,u=s.next_in,F=s.input,d=u+(s.avail_in-5),h=s.next_out,se=s.output,g=h-(o-s.avail_out),x=h+(s.avail_out-257),m=c.dmax,y=c.wsize,v=c.whave,_=c.wnext,S=c.window,T=c.hold,C=c.bits,A=c.lencode,P=c.distcode,N=(1<<c.lenbits)-1,O=(1<<c.distbits)-1;e:do{C<15&&(T+=F[u++]<<C,C+=8,T+=F[u++]<<C,C+=8),V=A[T&N];t:for(;;){if(T>>>=B=V>>>24,C-=B,(B=V>>>16&255)===0)se[h++]=65535&V;else{if(!(16&B)){if((64&B)==0){V=A[(65535&V)+(T&(1<<B)-1)];continue t}if(32&B){c.mode=12;break e}s.msg="invalid literal/length code",c.mode=30;break e}te=65535&V,(B&=15)&&(C<B&&(T+=F[u++]<<C,C+=8),te+=T&(1<<B)-1,T>>>=B,C-=B),C<15&&(T+=F[u++]<<C,C+=8,T+=F[u++]<<C,C+=8),V=P[T&O];r:for(;;){if(T>>>=B=V>>>24,C-=B,!(16&(B=V>>>16&255))){if((64&B)==0){V=P[(65535&V)+(T&(1<<B)-1)];continue r}s.msg="invalid distance code",c.mode=30;break e}if(ie=65535&V,C<(B&=15)&&(T+=F[u++]<<C,(C+=8)<B&&(T+=F[u++]<<C,C+=8)),m<(ie+=T&(1<<B)-1)){s.msg="invalid distance too far back",c.mode=30;break e}if(T>>>=B,C-=B,(B=h-g)<ie){if(v<(B=ie-B)&&c.sane){s.msg="invalid distance too far back",c.mode=30;break e}if(J=S,(D=0)===_){if(D+=y-B,B<te){for(te-=B;se[h++]=S[D++],--B;);D=h-ie,J=se}}else if(_<B){if(D+=y+_-B,(B-=_)<te){for(te-=B;se[h++]=S[D++],--B;);if(D=0,_<te){for(te-=B=_;se[h++]=S[D++],--B;);D=h-ie,J=se}}}else if(D+=_-B,B<te){for(te-=B;se[h++]=S[D++],--B;);D=h-ie,J=se}for(;2<te;)se[h++]=J[D++],se[h++]=J[D++],se[h++]=J[D++],te-=3;te&&(se[h++]=J[D++],1<te&&(se[h++]=J[D++]))}else{for(D=h-ie;se[h++]=se[D++],se[h++]=se[D++],se[h++]=se[D++],2<(te-=3););te&&(se[h++]=se[D++],1<te&&(se[h++]=se[D++]))}break}}break}}while(u<d&&h<x);u-=te=C>>3,T&=(1<<(C-=te<<3))-1,s.next_in=u,s.next_out=h,s.avail_in=u<d?d-u+5:5-(u-d),s.avail_out=h<x?x-h+257:257-(h-x),c.hold=T,c.bits=C}},{}],49:[function(t,n,i){var s=t("../utils/common"),o=t("./adler32"),c=t("./crc32"),u=t("./inffast"),d=t("./inftrees"),h=1,g=2,x=0,m=-2,y=1,v=852,_=592;function S(D){return(D>>>24&255)+(D>>>8&65280)+((65280&D)<<8)+((255&D)<<24)}function T(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function C(D){var J;return D&&D.state?(J=D.state,D.total_in=D.total_out=J.total=0,D.msg="",J.wrap&&(D.adler=1&J.wrap),J.mode=y,J.last=0,J.havedict=0,J.dmax=32768,J.head=null,J.hold=0,J.bits=0,J.lencode=J.lendyn=new s.Buf32(v),J.distcode=J.distdyn=new s.Buf32(_),J.sane=1,J.back=-1,x):m}function A(D){var J;return D&&D.state?((J=D.state).wsize=0,J.whave=0,J.wnext=0,C(D)):m}function P(D,J){var F,se;return D&&D.state?(se=D.state,J<0?(F=0,J=-J):(F=1+(J>>4),J<48&&(J&=15)),J&&(J<8||15<J)?m:(se.window!==null&&se.wbits!==J&&(se.window=null),se.wrap=F,se.wbits=J,A(D))):m}function N(D,J){var F,se;return D?(se=new T,(D.state=se).window=null,(F=P(D,J))!==x&&(D.state=null),F):m}var O,V,B=!0;function te(D){if(B){var J;for(O=new s.Buf32(512),V=new s.Buf32(32),J=0;J<144;)D.lens[J++]=8;for(;J<256;)D.lens[J++]=9;for(;J<280;)D.lens[J++]=7;for(;J<288;)D.lens[J++]=8;for(d(h,D.lens,0,288,O,0,D.work,{bits:9}),J=0;J<32;)D.lens[J++]=5;d(g,D.lens,0,32,V,0,D.work,{bits:5}),B=!1}D.lencode=O,D.lenbits=9,D.distcode=V,D.distbits=5}function ie(D,J,F,se){var Ee,le=D.state;return le.window===null&&(le.wsize=1<<le.wbits,le.wnext=0,le.whave=0,le.window=new s.Buf8(le.wsize)),se>=le.wsize?(s.arraySet(le.window,J,F-le.wsize,le.wsize,0),le.wnext=0,le.whave=le.wsize):(se<(Ee=le.wsize-le.wnext)&&(Ee=se),s.arraySet(le.window,J,F-se,Ee,le.wnext),(se-=Ee)?(s.arraySet(le.window,J,F-se,se,0),le.wnext=se,le.whave=le.wsize):(le.wnext+=Ee,le.wnext===le.wsize&&(le.wnext=0),le.whave<le.wsize&&(le.whave+=Ee))),0}i.inflateReset=A,i.inflateReset2=P,i.inflateResetKeep=C,i.inflateInit=function(D){return N(D,15)},i.inflateInit2=N,i.inflate=function(D,J){var F,se,Ee,le,xe,X,pe,R,b,ee,G,H,me,Me,Fe,be,De,ne,z,Le,E,de,ce,j,U=0,ae=new s.Buf8(4),Ae=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!D||!D.state||!D.output||!D.input&&D.avail_in!==0)return m;(F=D.state).mode===12&&(F.mode=13),xe=D.next_out,Ee=D.output,pe=D.avail_out,le=D.next_in,se=D.input,X=D.avail_in,R=F.hold,b=F.bits,ee=X,G=pe,de=x;e:for(;;)switch(F.mode){case y:if(F.wrap===0){F.mode=13;break}for(;b<16;){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}if(2&F.wrap&&R===35615){ae[F.check=0]=255&R,ae[1]=R>>>8&255,F.check=c(F.check,ae,2,0),b=R=0,F.mode=2;break}if(F.flags=0,F.head&&(F.head.done=!1),!(1&F.wrap)||(((255&R)<<8)+(R>>8))%31){D.msg="incorrect header check",F.mode=30;break}if((15&R)!=8){D.msg="unknown compression method",F.mode=30;break}if(b-=4,E=8+(15&(R>>>=4)),F.wbits===0)F.wbits=E;else if(E>F.wbits){D.msg="invalid window size",F.mode=30;break}F.dmax=1<<E,D.adler=F.check=1,F.mode=512&R?10:12,b=R=0;break;case 2:for(;b<16;){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}if(F.flags=R,(255&F.flags)!=8){D.msg="unknown compression method",F.mode=30;break}if(57344&F.flags){D.msg="unknown header flags set",F.mode=30;break}F.head&&(F.head.text=R>>8&1),512&F.flags&&(ae[0]=255&R,ae[1]=R>>>8&255,F.check=c(F.check,ae,2,0)),b=R=0,F.mode=3;case 3:for(;b<32;){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}F.head&&(F.head.time=R),512&F.flags&&(ae[0]=255&R,ae[1]=R>>>8&255,ae[2]=R>>>16&255,ae[3]=R>>>24&255,F.check=c(F.check,ae,4,0)),b=R=0,F.mode=4;case 4:for(;b<16;){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}F.head&&(F.head.xflags=255&R,F.head.os=R>>8),512&F.flags&&(ae[0]=255&R,ae[1]=R>>>8&255,F.check=c(F.check,ae,2,0)),b=R=0,F.mode=5;case 5:if(1024&F.flags){for(;b<16;){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}F.length=R,F.head&&(F.head.extra_len=R),512&F.flags&&(ae[0]=255&R,ae[1]=R>>>8&255,F.check=c(F.check,ae,2,0)),b=R=0}else F.head&&(F.head.extra=null);F.mode=6;case 6:if(1024&F.flags&&(X<(H=F.length)&&(H=X),H&&(F.head&&(E=F.head.extra_len-F.length,F.head.extra||(F.head.extra=new Array(F.head.extra_len)),s.arraySet(F.head.extra,se,le,H,E)),512&F.flags&&(F.check=c(F.check,se,H,le)),X-=H,le+=H,F.length-=H),F.length))break e;F.length=0,F.mode=7;case 7:if(2048&F.flags){if(X===0)break e;for(H=0;E=se[le+H++],F.head&&E&&F.length<65536&&(F.head.name+=String.fromCharCode(E)),E&&H<X;);if(512&F.flags&&(F.check=c(F.check,se,H,le)),X-=H,le+=H,E)break e}else F.head&&(F.head.name=null);F.length=0,F.mode=8;case 8:if(4096&F.flags){if(X===0)break e;for(H=0;E=se[le+H++],F.head&&E&&F.length<65536&&(F.head.comment+=String.fromCharCode(E)),E&&H<X;);if(512&F.flags&&(F.check=c(F.check,se,H,le)),X-=H,le+=H,E)break e}else F.head&&(F.head.comment=null);F.mode=9;case 9:if(512&F.flags){for(;b<16;){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}if(R!==(65535&F.check)){D.msg="header crc mismatch",F.mode=30;break}b=R=0}F.head&&(F.head.hcrc=F.flags>>9&1,F.head.done=!0),D.adler=F.check=0,F.mode=12;break;case 10:for(;b<32;){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}D.adler=F.check=S(R),b=R=0,F.mode=11;case 11:if(F.havedict===0)return D.next_out=xe,D.avail_out=pe,D.next_in=le,D.avail_in=X,F.hold=R,F.bits=b,2;D.adler=F.check=1,F.mode=12;case 12:if(J===5||J===6)break e;case 13:if(F.last){R>>>=7&b,b-=7&b,F.mode=27;break}for(;b<3;){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}switch(F.last=1&R,b-=1,3&(R>>>=1)){case 0:F.mode=14;break;case 1:if(te(F),F.mode=20,J!==6)break;R>>>=2,b-=2;break e;case 2:F.mode=17;break;case 3:D.msg="invalid block type",F.mode=30}R>>>=2,b-=2;break;case 14:for(R>>>=7&b,b-=7&b;b<32;){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}if((65535&R)!=(R>>>16^65535)){D.msg="invalid stored block lengths",F.mode=30;break}if(F.length=65535&R,b=R=0,F.mode=15,J===6)break e;case 15:F.mode=16;case 16:if(H=F.length){if(X<H&&(H=X),pe<H&&(H=pe),H===0)break e;s.arraySet(Ee,se,le,H,xe),X-=H,le+=H,pe-=H,xe+=H,F.length-=H;break}F.mode=12;break;case 17:for(;b<14;){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}if(F.nlen=257+(31&R),R>>>=5,b-=5,F.ndist=1+(31&R),R>>>=5,b-=5,F.ncode=4+(15&R),R>>>=4,b-=4,286<F.nlen||30<F.ndist){D.msg="too many length or distance symbols",F.mode=30;break}F.have=0,F.mode=18;case 18:for(;F.have<F.ncode;){for(;b<3;){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}F.lens[Ae[F.have++]]=7&R,R>>>=3,b-=3}for(;F.have<19;)F.lens[Ae[F.have++]]=0;if(F.lencode=F.lendyn,F.lenbits=7,ce={bits:F.lenbits},de=d(0,F.lens,0,19,F.lencode,0,F.work,ce),F.lenbits=ce.bits,de){D.msg="invalid code lengths set",F.mode=30;break}F.have=0,F.mode=19;case 19:for(;F.have<F.nlen+F.ndist;){for(;be=(U=F.lencode[R&(1<<F.lenbits)-1])>>>16&255,De=65535&U,!((Fe=U>>>24)<=b);){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}if(De<16)R>>>=Fe,b-=Fe,F.lens[F.have++]=De;else{if(De===16){for(j=Fe+2;b<j;){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}if(R>>>=Fe,b-=Fe,F.have===0){D.msg="invalid bit length repeat",F.mode=30;break}E=F.lens[F.have-1],H=3+(3&R),R>>>=2,b-=2}else if(De===17){for(j=Fe+3;b<j;){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}b-=Fe,E=0,H=3+(7&(R>>>=Fe)),R>>>=3,b-=3}else{for(j=Fe+7;b<j;){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}b-=Fe,E=0,H=11+(127&(R>>>=Fe)),R>>>=7,b-=7}if(F.have+H>F.nlen+F.ndist){D.msg="invalid bit length repeat",F.mode=30;break}for(;H--;)F.lens[F.have++]=E}}if(F.mode===30)break;if(F.lens[256]===0){D.msg="invalid code -- missing end-of-block",F.mode=30;break}if(F.lenbits=9,ce={bits:F.lenbits},de=d(h,F.lens,0,F.nlen,F.lencode,0,F.work,ce),F.lenbits=ce.bits,de){D.msg="invalid literal/lengths set",F.mode=30;break}if(F.distbits=6,F.distcode=F.distdyn,ce={bits:F.distbits},de=d(g,F.lens,F.nlen,F.ndist,F.distcode,0,F.work,ce),F.distbits=ce.bits,de){D.msg="invalid distances set",F.mode=30;break}if(F.mode=20,J===6)break e;case 20:F.mode=21;case 21:if(6<=X&&258<=pe){D.next_out=xe,D.avail_out=pe,D.next_in=le,D.avail_in=X,F.hold=R,F.bits=b,u(D,G),xe=D.next_out,Ee=D.output,pe=D.avail_out,le=D.next_in,se=D.input,X=D.avail_in,R=F.hold,b=F.bits,F.mode===12&&(F.back=-1);break}for(F.back=0;be=(U=F.lencode[R&(1<<F.lenbits)-1])>>>16&255,De=65535&U,!((Fe=U>>>24)<=b);){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}if(be&&(240&be)==0){for(ne=Fe,z=be,Le=De;be=(U=F.lencode[Le+((R&(1<<ne+z)-1)>>ne)])>>>16&255,De=65535&U,!(ne+(Fe=U>>>24)<=b);){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}R>>>=ne,b-=ne,F.back+=ne}if(R>>>=Fe,b-=Fe,F.back+=Fe,F.length=De,be===0){F.mode=26;break}if(32&be){F.back=-1,F.mode=12;break}if(64&be){D.msg="invalid literal/length code",F.mode=30;break}F.extra=15&be,F.mode=22;case 22:if(F.extra){for(j=F.extra;b<j;){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}F.length+=R&(1<<F.extra)-1,R>>>=F.extra,b-=F.extra,F.back+=F.extra}F.was=F.length,F.mode=23;case 23:for(;be=(U=F.distcode[R&(1<<F.distbits)-1])>>>16&255,De=65535&U,!((Fe=U>>>24)<=b);){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}if((240&be)==0){for(ne=Fe,z=be,Le=De;be=(U=F.distcode[Le+((R&(1<<ne+z)-1)>>ne)])>>>16&255,De=65535&U,!(ne+(Fe=U>>>24)<=b);){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}R>>>=ne,b-=ne,F.back+=ne}if(R>>>=Fe,b-=Fe,F.back+=Fe,64&be){D.msg="invalid distance code",F.mode=30;break}F.offset=De,F.extra=15&be,F.mode=24;case 24:if(F.extra){for(j=F.extra;b<j;){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}F.offset+=R&(1<<F.extra)-1,R>>>=F.extra,b-=F.extra,F.back+=F.extra}if(F.offset>F.dmax){D.msg="invalid distance too far back",F.mode=30;break}F.mode=25;case 25:if(pe===0)break e;if(H=G-pe,F.offset>H){if((H=F.offset-H)>F.whave&&F.sane){D.msg="invalid distance too far back",F.mode=30;break}me=H>F.wnext?(H-=F.wnext,F.wsize-H):F.wnext-H,H>F.length&&(H=F.length),Me=F.window}else Me=Ee,me=xe-F.offset,H=F.length;for(pe<H&&(H=pe),pe-=H,F.length-=H;Ee[xe++]=Me[me++],--H;);F.length===0&&(F.mode=21);break;case 26:if(pe===0)break e;Ee[xe++]=F.length,pe--,F.mode=21;break;case 27:if(F.wrap){for(;b<32;){if(X===0)break e;X--,R|=se[le++]<<b,b+=8}if(G-=pe,D.total_out+=G,F.total+=G,G&&(D.adler=F.check=F.flags?c(F.check,Ee,G,xe-G):o(F.check,Ee,G,xe-G)),G=pe,(F.flags?R:S(R))!==F.check){D.msg="incorrect data check",F.mode=30;break}b=R=0}F.mode=28;case 28:if(F.wrap&&F.flags){for(;b<32;){if(X===0)break e;X--,R+=se[le++]<<b,b+=8}if(R!==(4294967295&F.total)){D.msg="incorrect length check",F.mode=30;break}b=R=0}F.mode=29;case 29:de=1;break e;case 30:de=-3;break e;case 31:return-4;case 32:default:return m}return D.next_out=xe,D.avail_out=pe,D.next_in=le,D.avail_in=X,F.hold=R,F.bits=b,(F.wsize||G!==D.avail_out&&F.mode<30&&(F.mode<27||J!==4))&&ie(D,D.output,D.next_out,G-D.avail_out)?(F.mode=31,-4):(ee-=D.avail_in,G-=D.avail_out,D.total_in+=ee,D.total_out+=G,F.total+=G,F.wrap&&G&&(D.adler=F.check=F.flags?c(F.check,Ee,G,D.next_out-G):o(F.check,Ee,G,D.next_out-G)),D.data_type=F.bits+(F.last?64:0)+(F.mode===12?128:0)+(F.mode===20||F.mode===15?256:0),(ee==0&&G===0||J===4)&&de===x&&(de=-5),de)},i.inflateEnd=function(D){if(!D||!D.state)return m;var J=D.state;return J.window&&(J.window=null),D.state=null,x},i.inflateGetHeader=function(D,J){var F;return D&&D.state?(2&(F=D.state).wrap)==0?m:((F.head=J).done=!1,x):m},i.inflateSetDictionary=function(D,J){var F,se=J.length;return D&&D.state?(F=D.state).wrap!==0&&F.mode!==11?m:F.mode===11&&o(1,J,se,0)!==F.check?-3:ie(D,J,se,se)?(F.mode=31,-4):(F.havedict=1,x):m},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,n,i){var s=t("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],c=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(h,g,x,m,y,v,_,S){var T,C,A,P,N,O,V,B,te,ie=S.bits,D=0,J=0,F=0,se=0,Ee=0,le=0,xe=0,X=0,pe=0,R=0,b=null,ee=0,G=new s.Buf16(16),H=new s.Buf16(16),me=null,Me=0;for(D=0;D<=15;D++)G[D]=0;for(J=0;J<m;J++)G[g[x+J]]++;for(Ee=ie,se=15;1<=se&&G[se]===0;se--);if(se<Ee&&(Ee=se),se===0)return y[v++]=20971520,y[v++]=20971520,S.bits=1,0;for(F=1;F<se&&G[F]===0;F++);for(Ee<F&&(Ee=F),D=X=1;D<=15;D++)if(X<<=1,(X-=G[D])<0)return-1;if(0<X&&(h===0||se!==1))return-1;for(H[1]=0,D=1;D<15;D++)H[D+1]=H[D]+G[D];for(J=0;J<m;J++)g[x+J]!==0&&(_[H[g[x+J]]++]=J);if(O=h===0?(b=me=_,19):h===1?(b=o,ee-=257,me=c,Me-=257,256):(b=u,me=d,-1),D=F,N=v,xe=J=R=0,A=-1,P=(pe=1<<(le=Ee))-1,h===1&&852<pe||h===2&&592<pe)return 1;for(;;){for(V=D-xe,te=_[J]<O?(B=0,_[J]):_[J]>O?(B=me[Me+_[J]],b[ee+_[J]]):(B=96,0),T=1<<D-xe,F=C=1<<le;y[N+(R>>xe)+(C-=T)]=V<<24|B<<16|te|0,C!==0;);for(T=1<<D-1;R&T;)T>>=1;if(T!==0?(R&=T-1,R+=T):R=0,J++,--G[D]==0){if(D===se)break;D=g[x+_[J]]}if(Ee<D&&(R&P)!==A){for(xe===0&&(xe=Ee),N+=F,X=1<<(le=D-xe);le+xe<se&&!((X-=G[le+xe])<=0);)le++,X<<=1;if(pe+=1<<le,h===1&&852<pe||h===2&&592<pe)return 1;y[A=R&P]=Ee<<24|le<<16|N-v|0}}return R!==0&&(y[N+R]=D-xe<<24|64<<16|0),S.bits=Ee,0}},{"../utils/common":41}],51:[function(t,n,i){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,n,i){var s=t("../utils/common"),o=0,c=1;function u(U){for(var ae=U.length;0<=--ae;)U[ae]=0}var d=0,h=29,g=256,x=g+1+h,m=30,y=19,v=2*x+1,_=15,S=16,T=7,C=256,A=16,P=17,N=18,O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],V=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=new Array(2*(x+2));u(ie);var D=new Array(2*m);u(D);var J=new Array(512);u(J);var F=new Array(256);u(F);var se=new Array(h);u(se);var Ee,le,xe,X=new Array(m);function pe(U,ae,Ae,Pe,ge){this.static_tree=U,this.extra_bits=ae,this.extra_base=Ae,this.elems=Pe,this.max_length=ge,this.has_stree=U&&U.length}function R(U,ae){this.dyn_tree=U,this.max_code=0,this.stat_desc=ae}function b(U){return U<256?J[U]:J[256+(U>>>7)]}function ee(U,ae){U.pending_buf[U.pending++]=255&ae,U.pending_buf[U.pending++]=ae>>>8&255}function G(U,ae,Ae){U.bi_valid>S-Ae?(U.bi_buf|=ae<<U.bi_valid&65535,ee(U,U.bi_buf),U.bi_buf=ae>>S-U.bi_valid,U.bi_valid+=Ae-S):(U.bi_buf|=ae<<U.bi_valid&65535,U.bi_valid+=Ae)}function H(U,ae,Ae){G(U,Ae[2*ae],Ae[2*ae+1])}function me(U,ae){for(var Ae=0;Ae|=1&U,U>>>=1,Ae<<=1,0<--ae;);return Ae>>>1}function Me(U,ae,Ae){var Pe,ge,Oe=new Array(_+1),Re=0;for(Pe=1;Pe<=_;Pe++)Oe[Pe]=Re=Re+Ae[Pe-1]<<1;for(ge=0;ge<=ae;ge++){var Be=U[2*ge+1];Be!==0&&(U[2*ge]=me(Oe[Be]++,Be))}}function Fe(U){var ae;for(ae=0;ae<x;ae++)U.dyn_ltree[2*ae]=0;for(ae=0;ae<m;ae++)U.dyn_dtree[2*ae]=0;for(ae=0;ae<y;ae++)U.bl_tree[2*ae]=0;U.dyn_ltree[2*C]=1,U.opt_len=U.static_len=0,U.last_lit=U.matches=0}function be(U){8<U.bi_valid?ee(U,U.bi_buf):0<U.bi_valid&&(U.pending_buf[U.pending++]=U.bi_buf),U.bi_buf=0,U.bi_valid=0}function De(U,ae,Ae,Pe){var ge=2*ae,Oe=2*Ae;return U[ge]<U[Oe]||U[ge]===U[Oe]&&Pe[ae]<=Pe[Ae]}function ne(U,ae,Ae){for(var Pe=U.heap[Ae],ge=Ae<<1;ge<=U.heap_len&&(ge<U.heap_len&&De(ae,U.heap[ge+1],U.heap[ge],U.depth)&&ge++,!De(ae,Pe,U.heap[ge],U.depth));)U.heap[Ae]=U.heap[ge],Ae=ge,ge<<=1;U.heap[Ae]=Pe}function z(U,ae,Ae){var Pe,ge,Oe,Re,Be=0;if(U.last_lit!==0)for(;Pe=U.pending_buf[U.d_buf+2*Be]<<8|U.pending_buf[U.d_buf+2*Be+1],ge=U.pending_buf[U.l_buf+Be],Be++,Pe===0?H(U,ge,ae):(H(U,(Oe=F[ge])+g+1,ae),(Re=O[Oe])!==0&&G(U,ge-=se[Oe],Re),H(U,Oe=b(--Pe),Ae),(Re=V[Oe])!==0&&G(U,Pe-=X[Oe],Re)),Be<U.last_lit;);H(U,C,ae)}function Le(U,ae){var Ae,Pe,ge,Oe=ae.dyn_tree,Re=ae.stat_desc.static_tree,Be=ae.stat_desc.has_stree,re=ae.stat_desc.elems,nt=-1;for(U.heap_len=0,U.heap_max=v,Ae=0;Ae<re;Ae++)Oe[2*Ae]!==0?(U.heap[++U.heap_len]=nt=Ae,U.depth[Ae]=0):Oe[2*Ae+1]=0;for(;U.heap_len<2;)Oe[2*(ge=U.heap[++U.heap_len]=nt<2?++nt:0)]=1,U.depth[ge]=0,U.opt_len--,Be&&(U.static_len-=Re[2*ge+1]);for(ae.max_code=nt,Ae=U.heap_len>>1;1<=Ae;Ae--)ne(U,Oe,Ae);for(ge=re;Ae=U.heap[1],U.heap[1]=U.heap[U.heap_len--],ne(U,Oe,1),Pe=U.heap[1],U.heap[--U.heap_max]=Ae,U.heap[--U.heap_max]=Pe,Oe[2*ge]=Oe[2*Ae]+Oe[2*Pe],U.depth[ge]=(U.depth[Ae]>=U.depth[Pe]?U.depth[Ae]:U.depth[Pe])+1,Oe[2*Ae+1]=Oe[2*Pe+1]=ge,U.heap[1]=ge++,ne(U,Oe,1),2<=U.heap_len;);U.heap[--U.heap_max]=U.heap[1],(function(He,Ne){var Ye,Ze,dt,st,Ht,Nn,pr=Ne.dyn_tree,mn=Ne.max_code,yi=Ne.stat_desc.static_tree,ni=Ne.stat_desc.has_stree,$i=Ne.stat_desc.extra_bits,In=Ne.stat_desc.extra_base,Gr=Ne.stat_desc.max_length,xn=0;for(st=0;st<=_;st++)He.bl_count[st]=0;for(pr[2*He.heap[He.heap_max]+1]=0,Ye=He.heap_max+1;Ye<v;Ye++)Gr<(st=pr[2*pr[2*(Ze=He.heap[Ye])+1]+1]+1)&&(st=Gr,xn++),pr[2*Ze+1]=st,mn<Ze||(He.bl_count[st]++,Ht=0,In<=Ze&&(Ht=$i[Ze-In]),Nn=pr[2*Ze],He.opt_len+=Nn*(st+Ht),ni&&(He.static_len+=Nn*(yi[2*Ze+1]+Ht)));if(xn!==0){do{for(st=Gr-1;He.bl_count[st]===0;)st--;He.bl_count[st]--,He.bl_count[st+1]+=2,He.bl_count[Gr]--,xn-=2}while(0<xn);for(st=Gr;st!==0;st--)for(Ze=He.bl_count[st];Ze!==0;)mn<(dt=He.heap[--Ye])||(pr[2*dt+1]!==st&&(He.opt_len+=(st-pr[2*dt+1])*pr[2*dt],pr[2*dt+1]=st),Ze--)}})(U,ae),Me(Oe,nt,U.bl_count)}function E(U,ae,Ae){var Pe,ge,Oe=-1,Re=ae[1],Be=0,re=7,nt=4;for(Re===0&&(re=138,nt=3),ae[2*(Ae+1)+1]=65535,Pe=0;Pe<=Ae;Pe++)ge=Re,Re=ae[2*(Pe+1)+1],++Be<re&&ge===Re||(Be<nt?U.bl_tree[2*ge]+=Be:ge!==0?(ge!==Oe&&U.bl_tree[2*ge]++,U.bl_tree[2*A]++):Be<=10?U.bl_tree[2*P]++:U.bl_tree[2*N]++,Oe=ge,nt=(Be=0)===Re?(re=138,3):ge===Re?(re=6,3):(re=7,4))}function de(U,ae,Ae){var Pe,ge,Oe=-1,Re=ae[1],Be=0,re=7,nt=4;for(Re===0&&(re=138,nt=3),Pe=0;Pe<=Ae;Pe++)if(ge=Re,Re=ae[2*(Pe+1)+1],!(++Be<re&&ge===Re)){if(Be<nt)for(;H(U,ge,U.bl_tree),--Be!=0;);else ge!==0?(ge!==Oe&&(H(U,ge,U.bl_tree),Be--),H(U,A,U.bl_tree),G(U,Be-3,2)):Be<=10?(H(U,P,U.bl_tree),G(U,Be-3,3)):(H(U,N,U.bl_tree),G(U,Be-11,7));Oe=ge,nt=(Be=0)===Re?(re=138,3):ge===Re?(re=6,3):(re=7,4)}}u(X);var ce=!1;function j(U,ae,Ae,Pe){G(U,(d<<1)+(Pe?1:0),3),(function(ge,Oe,Re,Be){be(ge),ee(ge,Re),ee(ge,~Re),s.arraySet(ge.pending_buf,ge.window,Oe,Re,ge.pending),ge.pending+=Re})(U,ae,Ae)}i._tr_init=function(U){ce||((function(){var ae,Ae,Pe,ge,Oe,Re=new Array(_+1);for(ge=Pe=0;ge<h-1;ge++)for(se[ge]=Pe,ae=0;ae<1<<O[ge];ae++)F[Pe++]=ge;for(F[Pe-1]=ge,ge=Oe=0;ge<16;ge++)for(X[ge]=Oe,ae=0;ae<1<<V[ge];ae++)J[Oe++]=ge;for(Oe>>=7;ge<m;ge++)for(X[ge]=Oe<<7,ae=0;ae<1<<V[ge]-7;ae++)J[256+Oe++]=ge;for(Ae=0;Ae<=_;Ae++)Re[Ae]=0;for(ae=0;ae<=143;)ie[2*ae+1]=8,ae++,Re[8]++;for(;ae<=255;)ie[2*ae+1]=9,ae++,Re[9]++;for(;ae<=279;)ie[2*ae+1]=7,ae++,Re[7]++;for(;ae<=287;)ie[2*ae+1]=8,ae++,Re[8]++;for(Me(ie,x+1,Re),ae=0;ae<m;ae++)D[2*ae+1]=5,D[2*ae]=me(ae,5);Ee=new pe(ie,O,g+1,x,_),le=new pe(D,V,0,m,_),xe=new pe(new Array(0),B,0,y,T)})(),ce=!0),U.l_desc=new R(U.dyn_ltree,Ee),U.d_desc=new R(U.dyn_dtree,le),U.bl_desc=new R(U.bl_tree,xe),U.bi_buf=0,U.bi_valid=0,Fe(U)},i._tr_stored_block=j,i._tr_flush_block=function(U,ae,Ae,Pe){var ge,Oe,Re=0;0<U.level?(U.strm.data_type===2&&(U.strm.data_type=(function(Be){var re,nt=4093624447;for(re=0;re<=31;re++,nt>>>=1)if(1&nt&&Be.dyn_ltree[2*re]!==0)return o;if(Be.dyn_ltree[18]!==0||Be.dyn_ltree[20]!==0||Be.dyn_ltree[26]!==0)return c;for(re=32;re<g;re++)if(Be.dyn_ltree[2*re]!==0)return c;return o})(U)),Le(U,U.l_desc),Le(U,U.d_desc),Re=(function(Be){var re;for(E(Be,Be.dyn_ltree,Be.l_desc.max_code),E(Be,Be.dyn_dtree,Be.d_desc.max_code),Le(Be,Be.bl_desc),re=y-1;3<=re&&Be.bl_tree[2*te[re]+1]===0;re--);return Be.opt_len+=3*(re+1)+5+5+4,re})(U),ge=U.opt_len+3+7>>>3,(Oe=U.static_len+3+7>>>3)<=ge&&(ge=Oe)):ge=Oe=Ae+5,Ae+4<=ge&&ae!==-1?j(U,ae,Ae,Pe):U.strategy===4||Oe===ge?(G(U,2+(Pe?1:0),3),z(U,ie,D)):(G(U,4+(Pe?1:0),3),(function(Be,re,nt,He){var Ne;for(G(Be,re-257,5),G(Be,nt-1,5),G(Be,He-4,4),Ne=0;Ne<He;Ne++)G(Be,Be.bl_tree[2*te[Ne]+1],3);de(Be,Be.dyn_ltree,re-1),de(Be,Be.dyn_dtree,nt-1)})(U,U.l_desc.max_code+1,U.d_desc.max_code+1,Re+1),z(U,U.dyn_ltree,U.dyn_dtree)),Fe(U),Pe&&be(U)},i._tr_tally=function(U,ae,Ae){return U.pending_buf[U.d_buf+2*U.last_lit]=ae>>>8&255,U.pending_buf[U.d_buf+2*U.last_lit+1]=255&ae,U.pending_buf[U.l_buf+U.last_lit]=255&Ae,U.last_lit++,ae===0?U.dyn_ltree[2*Ae]++:(U.matches++,ae--,U.dyn_ltree[2*(F[Ae]+g+1)]++,U.dyn_dtree[2*b(ae)]++),U.last_lit===U.lit_bufsize-1},i._tr_align=function(U){G(U,2,3),H(U,C,ie),(function(ae){ae.bi_valid===16?(ee(ae,ae.bi_buf),ae.bi_buf=0,ae.bi_valid=0):8<=ae.bi_valid&&(ae.pending_buf[ae.pending++]=255&ae.bi_buf,ae.bi_buf>>=8,ae.bi_valid-=8)})(U)}},{"../utils/common":41}],53:[function(t,n,i){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,n,i){(function(s){(function(o,c){if(!o.setImmediate){var u,d,h,g,x=1,m={},y=!1,v=o.document,_=Object.getPrototypeOf&&Object.getPrototypeOf(o);_=_&&_.setTimeout?_:o,u={}.toString.call(o.process)==="[object process]"?function(A){process.nextTick(function(){T(A)})}:(function(){if(o.postMessage&&!o.importScripts){var A=!0,P=o.onmessage;return o.onmessage=function(){A=!1},o.postMessage("","*"),o.onmessage=P,A}})()?(g="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",C,!1):o.attachEvent("onmessage",C),function(A){o.postMessage(g+A,"*")}):o.MessageChannel?((h=new MessageChannel).port1.onmessage=function(A){T(A.data)},function(A){h.port2.postMessage(A)}):v&&"onreadystatechange"in v.createElement("script")?(d=v.documentElement,function(A){var P=v.createElement("script");P.onreadystatechange=function(){T(A),P.onreadystatechange=null,d.removeChild(P),P=null},d.appendChild(P)}):function(A){setTimeout(T,0,A)},_.setImmediate=function(A){typeof A!="function"&&(A=new Function(""+A));for(var P=new Array(arguments.length-1),N=0;N<P.length;N++)P[N]=arguments[N+1];var O={callback:A,args:P};return m[x]=O,u(x),x++},_.clearImmediate=S}function S(A){delete m[A]}function T(A){if(y)setTimeout(T,0,A);else{var P=m[A];if(P){y=!0;try{(function(N){var O=N.callback,V=N.args;switch(V.length){case 0:O();break;case 1:O(V[0]);break;case 2:O(V[0],V[1]);break;case 3:O(V[0],V[1],V[2]);break;default:O.apply(c,V)}})(P)}finally{S(A),y=!1}}}}function C(A){A.source===o&&typeof A.data=="string"&&A.data.indexOf(g)===0&&T(+A.data.slice(g.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof Yc<"u"?Yc:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(kf)),kf.exports}var zb=jb();const $1=ld(zb);var vr=[];for(var Cf=0;Cf<256;++Cf)vr.push((Cf+256).toString(16).slice(1));function Ub(r,e=0){return(vr[r[e+0]]+vr[r[e+1]]+vr[r[e+2]]+vr[r[e+3]]+"-"+vr[r[e+4]]+vr[r[e+5]]+"-"+vr[r[e+6]]+vr[r[e+7]]+"-"+vr[r[e+8]]+vr[r[e+9]]+"-"+vr[r[e+10]]+vr[r[e+11]]+vr[r[e+12]]+vr[r[e+13]]+vr[r[e+14]]+vr[r[e+15]]).toLowerCase()}var ou,Vb=new Uint8Array(16);function Wb(){if(!ou&&(ou=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ou))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ou(Vb)}var Hb=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const K1={randomUUID:Hb};function Hn(r,e,t){if(K1.randomUUID&&!r)return K1.randomUUID();r=r||{};var n=r.random||(r.rng||Wb)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Ub(n)}function ue(r,e,t){return(e=(function(n){var i=(function(s,o){if(typeof s!="object"||!s)return s;var c=s[Symbol.toPrimitive];if(c!==void 0){var u=c.call(s,o);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(s)})(n,"string");return typeof i=="symbol"?i:i+""})(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Z1(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable}))),t.push.apply(t,n)}return t}function he(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Z1(Object(t),!0).forEach((function(n){ue(r,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Z1(Object(t)).forEach((function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))}))}return r}function It(r,e){if(r==null)return{};var t,n,i=(function(o,c){if(o==null)return{};var u={};for(var d in o)if({}.hasOwnProperty.call(o,d)){if(c.indexOf(d)>=0)continue;u[d]=o[d]}return u})(r,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(n=0;n<s.length;n++)t=s[n],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(r,t)&&(i[t]=r[t])}return i}function vi(r,e){return e||(e=r.slice(0)),Object.freeze(Object.defineProperties(r,{raw:{value:Object.freeze(e)}}))}class q1{constructor(){ue(this,"browserShadowBlurConstant",1),ue(this,"DPI",96),ue(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),ue(this,"perfLimitSizeTotal",2097152),ue(this,"maxCacheSideLimit",4096),ue(this,"minCacheSideLimit",256),ue(this,"disableStyleCopyPaste",!1),ue(this,"enableGLFiltering",!0),ue(this,"textureSize",4096),ue(this,"forceGLPutImageData",!1),ue(this,"cachesBoundsOfCurve",!1),ue(this,"fontPaths",{}),ue(this,"NUM_FRACTION_DIGITS",4)}}const kt=new class extends q1{constructor(r){super(),this.configure(r)}configure(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,r)}addFonts(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=he(he({},this.fontPaths),r)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach((r=>{delete this.fontPaths[r]}))}clearFonts(){this.fontPaths={}}restoreDefaults(r){const e=new q1,t=(r==null?void 0:r.reduce(((n,i)=>(n[i]=e[i],n)),{}))||e;this.configure(t)}},Ts=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return console[r]("fabric",...t)};class di extends Error{constructor(e,t){super("fabric: ".concat(e),t)}}class Xb extends di{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}}class Gb{}class Yb extends Gb{testPrecision(e,t){const n="precision ".concat(t,` float;
void main(){}`),i=e.createShader(e.FRAGMENT_SHADER);return!!i&&(e.shaderSource(i,n),e.compileShader(i),!!e.getShaderParameter(i,e.COMPILE_STATUS))}queryWebGL(e){const t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find((n=>this.testPrecision(t,n))),t.getExtension("WEBGL_lose_context").loseContext(),Ts("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}}const $b={};let J1;const pi=()=>J1||(J1={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new Yb,dispose(){},copyPasteData:$b}),no=()=>pi().document,gh=()=>pi().window,_y=()=>{var r;return Math.max((r=kt.devicePixelRatio)!==null&&r!==void 0?r:gh().devicePixelRatio,1)},hl=new class{constructor(){ue(this,"boundsOfCurveCache",{}),this.charWidthsCache=new Map}getFontCache(r){let{fontFamily:e,fontStyle:t,fontWeight:n}=r;e=e.toLowerCase();const i=this.charWidthsCache;i.has(e)||i.set(e,new Map);const s=i.get(e),o="".concat(t.toLowerCase(),"_").concat((n+"").toLowerCase());return s.has(o)||s.set(o,new Map),s.get(o)}clearFontCache(r){r?this.charWidthsCache.delete((r||"").toLowerCase()):this.charWidthsCache=new Map}limitDimsByArea(r){const{perfLimitSizeTotal:e}=kt,t=Math.sqrt(e*r);return[Math.floor(t),Math.floor(e/t)]}},Kf="6.9.0";function Ru(){}const Rl=Math.PI/2,Ju=2*Math.PI,Ld=Math.PI/180,Xr=Object.freeze([1,0,0,1,0,0]),Bd=16,ms=.4477152502,gt="center",Tt="left",tn="top",Zf="bottom",Kt="right",rn="none",jd=/\r?\n/,wy="moving",ph="scaling",Sy="rotating",zd="rotate",ky="skewing",Cl="resizing",Kb="modifyPoly",Zb="modifyPath",Qu="changed",mh="scale",sn="scaleX",Dn="scaleY",io="skewX",so="skewY",or="fill",nn="stroke",eh="modified",La="json",Tf="svg",Qe=new class{constructor(){this[La]=new Map,this[Tf]=new Map}has(r){return this[La].has(r)}getClass(r){const e=this[La].get(r);if(!e)throw new di("No class registered for ".concat(r));return e}setClass(r,e){e?this[La].set(e,r):(this[La].set(r.type,r),this[La].set(r.type.toLowerCase(),r))}getSVGClass(r){return this[Tf].get(r)}setSVGClass(r,e){this[Tf].set(e??r.type.toLowerCase(),r)}},th=new class extends Array{remove(r){const e=this.indexOf(r);e>-1&&this.splice(e,1)}cancelAll(){const r=this.splice(0);return r.forEach((e=>e.abort())),r}cancelByCanvas(r){if(!r)return[];const e=this.filter((t=>{var n;return t.target===r||typeof t.target=="object"&&((n=t.target)===null||n===void 0?void 0:n.canvas)===r}));return e.forEach((t=>t.abort())),e}cancelByTarget(r){if(!r)return[];const e=this.filter((t=>t.target===r));return e.forEach((t=>t.abort())),e}};class qb{constructor(){ue(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach((n=>{let[i,s]=n;this.on(i,s)})),()=>this.off(e);if(t){const n=e;return this.__eventListeners[n]||(this.__eventListeners[n]=[]),this.__eventListeners[n].push(t),()=>this.off(n,t)}return()=>!1}once(e,t){if(typeof e=="object"){const n=[];return Object.entries(e).forEach((i=>{let[s,o]=i;n.push(this.once(s,o))})),()=>n.forEach((i=>i()))}if(t){const n=this.on(e,(function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];t.call(this,...s),n()}));return n}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){const n=this.__eventListeners[e],i=n.indexOf(t);i>-1&&n.splice(i,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(e===void 0)for(const n in this.__eventListeners)this._removeEventListener(n);else typeof e=="object"?Object.entries(e).forEach((n=>{let[i,s]=n;this._removeEventListener(i,s)})):this._removeEventListener(e,t)}fire(e,t){var n;if(!this.__eventListeners)return;const i=(n=this.__eventListeners[e])===null||n===void 0?void 0:n.concat();if(i)for(let s=0;s<i.length;s++)i[s].call(this,t||{})}}const za=(r,e)=>{const t=r.indexOf(e);return t!==-1&&r.splice(t,1),r},Ui=r=>{if(r===0)return 1;switch(Math.abs(r)/Rl){case 1:case 3:return 0;case 2:return-1}return Math.cos(r)},Vi=r=>{if(r===0)return 0;const e=r/Rl,t=Math.sign(r);switch(e){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(r)};class Ce{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new Ce(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new Ce(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new Ce(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new Ce(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new Ce(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new Ce(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new Ce(this.x/e.x,this.y/e.y)}scalarDivide(e){return new Ce(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new Ce(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){const t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)}midPointFrom(e){return this.lerp(e)}min(e){return new Ce(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new Ce(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){const t=this.x,n=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=n}clone(){return new Ce(this.x,this.y)}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ud;const n=Vi(e),i=Ui(e),s=this.subtract(t);return new Ce(s.x*i-s.y*n,s.x*n+s.y*i).add(t)}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new Ce(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}}const Ud=new Ce(0,0),Lu=r=>!!r&&Array.isArray(r._objects);function Cy(r){class e extends r{constructor(){super(...arguments),ue(this,"_objects",[])}_onObjectAdded(n){}_onObjectRemoved(n){}_onStackOrderChanged(n){}add(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];const o=this._objects.push(...i);return i.forEach((c=>this._onObjectAdded(c))),o}insertAt(n){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];return this._objects.splice(n,0,...s),s.forEach((c=>this._onObjectAdded(c))),this._objects.length}remove(){const n=this._objects,i=[];for(var s=arguments.length,o=new Array(s),c=0;c<s;c++)o[c]=arguments[c];return o.forEach((u=>{const d=n.indexOf(u);d!==-1&&(n.splice(d,1),i.push(u),this._onObjectRemoved(u))})),i}forEachObject(n){this.getObjects().forEach(((i,s,o)=>n(i,s,o)))}getObjects(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return i.length===0?[...this._objects]:this._objects.filter((o=>o.isType(...i)))}item(n){return this._objects[n]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(n,i){return!!this._objects.includes(n)||!!i&&this._objects.some((s=>s instanceof e&&s.contains(n,!0)))}complexity(){return this._objects.reduce(((n,i)=>n+=i.complexity?i.complexity():0),0)}sendObjectToBack(n){return!(!n||n===this._objects[0])&&(za(this._objects,n),this._objects.unshift(n),this._onStackOrderChanged(n),!0)}bringObjectToFront(n){return!(!n||n===this._objects[this._objects.length-1])&&(za(this._objects,n),this._objects.push(n),this._onStackOrderChanged(n),!0)}sendObjectBackwards(n,i){if(!n)return!1;const s=this._objects.indexOf(n);if(s!==0){const o=this.findNewLowerIndex(n,s,i);return za(this._objects,n),this._objects.splice(o,0,n),this._onStackOrderChanged(n),!0}return!1}bringObjectForward(n,i){if(!n)return!1;const s=this._objects.indexOf(n);if(s!==this._objects.length-1){const o=this.findNewUpperIndex(n,s,i);return za(this._objects,n),this._objects.splice(o,0,n),this._onStackOrderChanged(n),!0}return!1}moveObjectTo(n,i){return n!==this._objects[i]&&(za(this._objects,n),this._objects.splice(i,0,n),this._onStackOrderChanged(n),!0)}findNewLowerIndex(n,i,s){let o;if(s){o=i;for(let c=i-1;c>=0;--c)if(n.isOverlapping(this._objects[c])){o=c;break}}else o=i-1;return o}findNewUpperIndex(n,i,s){let o;if(s){o=i;for(let c=i+1;c<this._objects.length;++c)if(n.isOverlapping(this._objects[c])){o=c;break}}else o=i+1;return o}collectObjects(n){let{left:i,top:s,width:o,height:c}=n,{includeIntersecting:u=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const d=[],h=new Ce(i,s),g=h.add(new Ce(o,c));for(let x=this._objects.length-1;x>=0;x--){const m=this._objects[x];m.selectable&&m.visible&&(u&&m.intersectsWithRect(h,g)||m.isContainedWithinRect(h,g)||u&&m.containsPoint(h)||u&&m.containsPoint(g))&&d.push(m)}return d}}return e}class Ty extends qb{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const t in e)this.set(t,e[t])}_setObject(e){for(const t in e)this._set(t,e[t])}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){const t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this}get(e){return this[e]}}function Bu(r){return gh().requestAnimationFrame(r)}function Jb(r){return gh().cancelAnimationFrame(r)}let Qb=0;const Es=()=>Qb++,Wi=()=>{const r=no().createElement("canvas");if(!r||r.getContext===void 0)throw new di("Failed to create `canvas` element");return r},eF=()=>no().createElement("img"),Pn=r=>{const e=Wi();return e.width=r.width,e.height=r.height,e},Ey=(r,e,t)=>r.toDataURL("image/".concat(e),t),Ay=(r,e,t)=>new Promise(((n,i)=>{r.toBlob(n,"image/".concat(e),t)})),Zt=r=>r*Ld,Hi=r=>r/Ld,tF=r=>r.every(((e,t)=>e===Xr[t])),en=(r,e,t)=>new Ce(r).transform(e,t),Qn=r=>{const e=1/(r[0]*r[3]-r[1]*r[2]),t=[e*r[3],-e*r[1],-e*r[2],e*r[0],0,0],{x:n,y:i}=new Ce(r[4],r[5]).transform(t,!0);return t[4]=-n,t[5]=-i,t},_r=(r,e,t)=>[r[0]*e[0]+r[2]*e[1],r[1]*e[0]+r[3]*e[1],r[0]*e[2]+r[2]*e[3],r[1]*e[2]+r[3]*e[3],t?0:r[0]*e[4]+r[2]*e[5]+r[4],t?0:r[1]*e[4]+r[3]*e[5]+r[5]],Vd=(r,e)=>r.reduceRight(((t,n)=>n&&t?_r(n,t,e):n||t),void 0)||Xr.concat(),by=r=>{let[e,t]=r;return Math.atan2(t,e)},rh=r=>{const e=by(r),t=Math.pow(r[0],2)+Math.pow(r[1],2),n=Math.sqrt(t),i=(r[0]*r[3]-r[2]*r[1])/n,s=Math.atan2(r[0]*r[2]+r[1]*r[3],t);return{angle:Hi(e),scaleX:n,scaleY:i,skewX:Hi(s),skewY:0,translateX:r[4]||0,translateY:r[5]||0}},Ll=function(r){return[1,0,0,1,r,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function ao(){let{angle:r=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=Zt(r),i=Ui(n),s=Vi(n);return[i,s,-s,i,e?e-(i*e-s*t):0,t?t-(s*e+i*t):0]}const Wd=function(r){return[r,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,0,0]},Fy=r=>Math.tan(Zt(r)),Oy=r=>[1,0,Fy(r),1,0,0],Dy=r=>[1,Fy(r),0,1,0,0],xh=r=>{let{scaleX:e=1,scaleY:t=1,flipX:n=!1,flipY:i=!1,skewX:s=0,skewY:o=0}=r,c=Wd(n?-e:e,i?-t:t);return s&&(c=_r(c,Oy(s),!0)),o&&(c=_r(c,Dy(o),!0)),c},rF=r=>{const{translateX:e=0,translateY:t=0,angle:n=0}=r;let i=Ll(e,t);n&&(i=_r(i,ao({angle:n})));const s=xh(r);return tF(s)||(i=_r(i,s)),i},ju=function(r){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((function(n,i){if(e&&e.aborted)return i(new Xb("loadImage"));const s=eF();let o;e&&(o=function(u){s.src="",i(u)},e.addEventListener("abort",o,{once:!0}));const c=function(){s.onload=s.onerror=null,o&&(e==null||e.removeEventListener("abort",o)),n(s)};r?(s.onload=c,s.onerror=function(){o&&(e==null||e.removeEventListener("abort",o)),i(new di("Error loading ".concat(s.src)))},t&&(s.crossOrigin=t),s.src=r):c()}))},Tl=function(r){let{signal:e,reviver:t=Ru}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(((n,i)=>{const s=[];e&&e.addEventListener("abort",i,{once:!0}),Promise.all(r.map((o=>Qe.getClass(o.type).fromObject(o,{signal:e}).then((c=>(t(o,c),s.push(c),c)))))).then(n).catch((o=>{s.forEach((c=>{c.dispose&&c.dispose()})),i(o)})).finally((()=>{e&&e.removeEventListener("abort",i)}))}))},vh=function(r){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(((t,n)=>{const i=[];e&&e.addEventListener("abort",n,{once:!0});const s=Object.values(r).map((c=>c&&c.type&&Qe.has(c.type)?Tl([c],{signal:e}).then((u=>{let[d]=u;return i.push(d),d})):c)),o=Object.keys(r);Promise.all(s).then((c=>c.reduce(((u,d,h)=>(u[o[h]]=d,u)),{}))).then(t).catch((c=>{i.forEach((u=>{u.dispose&&u.dispose()})),n(c)})).finally((()=>{e&&e.removeEventListener("abort",n)}))}))},oo=function(r){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce(((e,t)=>(t in r&&(e[t]=r[t]),e)),{})},Hd=(r,e)=>Object.keys(r).reduce(((t,n)=>(e(r[n],n,r)&&(t[n]=r[n]),t)),{}),Dt=(r,e)=>parseFloat(Number(r).toFixed(e)),El=r=>"matrix("+r.map((e=>Dt(e,kt.NUM_FRACTION_DIGITS))).join(" ")+")",Fn=r=>!!r&&r.toLive!==void 0,Q1=r=>!!r&&typeof r.toObject=="function",ex=r=>!!r&&r.offsetX!==void 0&&"source"in r,Gs=r=>!!r&&"multiSelectionStacking"in r;function Py(r){const e=r&&Zn(r);let t=0,n=0;if(!r||!e)return{left:t,top:n};let i=r;const s=e.documentElement,o=e.body||{scrollLeft:0,scrollTop:0};for(;i&&(i.parentNode||i.host)&&(i=i.parentNode||i.host,i===e?(t=o.scrollLeft||s.scrollLeft||0,n=o.scrollTop||s.scrollTop||0):(t+=i.scrollLeft||0,n+=i.scrollTop||0),i.nodeType!==1||i.style.position!=="fixed"););return{left:t,top:n}}const Zn=r=>r.ownerDocument||null,My=r=>{var e;return((e=r.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},Ny=function(r,e,t){let{width:n,height:i}=t,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;r.width=n,r.height=i,s>1&&(r.setAttribute("width",(n*s).toString()),r.setAttribute("height",(i*s).toString()),e.scale(s,s))},qf=(r,e)=>{let{width:t,height:n}=e;t&&(r.style.width=typeof t=="number"?"".concat(t,"px"):t),n&&(r.style.height=typeof n=="number"?"".concat(n,"px"):n)};function tx(r){return r.onselectstart!==void 0&&(r.onselectstart=()=>!1),r.style.userSelect=rn,r}class Iy{constructor(e){ue(this,"_originalCanvasStyle",void 0),ue(this,"lower",void 0);const t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){const t=(n=e)&&n.getContext!==void 0?e:e&&no().getElementById(e)||Wi();var n;if(t.hasAttribute("data-fabric"))throw new di("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:n}=e;const{el:i}=this.lower;i.classList.remove("lower-canvas"),i.removeAttribute("data-fabric"),i.setAttribute("width","".concat(t)),i.setAttribute("height","".concat(n)),i.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){const{el:n,ctx:i}=this.lower;Ny(n,i,e,t)}setCSSDimensions(e){qf(this.lower.el,e)}calcOffset(){return(function(e){var t;const n=e&&Zn(e),i={left:0,top:0};if(!n)return i;const s=((t=My(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};i.left+=parseInt(s.borderLeftWidth,10)||0,i.top+=parseInt(s.borderTopWidth,10)||0,i.left+=parseInt(s.paddingLeft,10)||0,i.top+=parseInt(s.paddingTop,10)||0;let o={left:0,top:0};const c=n.documentElement;e.getBoundingClientRect!==void 0&&(o=e.getBoundingClientRect());const u=Py(e);return{left:o.left+u.left-(c.clientLeft||0)+i.left,top:o.top+u.top-(c.clientTop||0)+i.top}})(this.lower.el)}dispose(){pi().dispose(this.lower.el),delete this.lower}}const nF={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...Xr]},iF=["objects"];class Bl extends Cy(Ty){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return Bl.ownDefaults}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new Iy(e)}add(){const e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const s=super.insertAt(e,...n);return n.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),s}remove(){const e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(Ts("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?_y():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,t){return this.setDimensions({width:e},t)}setHeight(e,t){return this.setDimensions({height:e},t)}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:n=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){const i=he({width:this.width,height:this.height},e);this.elements.setDimensions(i,this.getRetinaScaling()),this.hasLostContext=!0,this.width=i.width,this.height=i.height}n||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){const n=e,i=[...this.viewportTransform],s=en(e,Qn(i));i[0]=t,i[3]=t;const o=en(s,i);i[4]+=n.x-o.x,i[5]+=n.y-o.y,this.setViewportTransform(i)}setZoom(e){this.zoomToPoint(new Ce(0,0),e)}absolutePan(e){const t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new Ce(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=Bu((()=>this.renderAndReset())))}calcViewportBoundaries(){const e=this.width,t=this.height,n=Qn(this.viewportTransform),i=en({x:0,y:0},n),s=en({x:e,y:t},n),o=i.min(s),c=i.max(s);return this.vptCoords={tl:o,tr:new Ce(c.x,o.y),bl:new Ce(o.x,c.y),br:c}}cancelRequestedRender(){this.nextRenderHandle&&(Jb(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;const n=this.viewportTransform,i=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),i&&(i._set("canvas",this),i.shouldCache(),i._transformDone=!0,i.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,i)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){const n=this.viewportTransform;e.save(),e.transform(...n),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let n=0,i=t.length;n<i;++n)t[n]&&t[n].render(e)}_renderBackgroundOrOverlay(e,t){const n=this["".concat(t,"Color")],i=this["".concat(t,"Image")],s=this.viewportTransform,o=this["".concat(t,"Vpt")];if(!n&&!i)return;const c=Fn(n);if(n){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=c?n.toLive(e):n,o&&e.transform(...s),c){e.transform(1,0,0,1,n.offsetX||0,n.offsetY||0);const u=n.gradientTransform||n.patternTransform;u&&e.transform(...u)}e.fill(),e.restore()}if(i){e.save();const{skipOffscreen:u}=this;this.skipOffscreen=o,o&&e.transform(...s),i.render(e),this.skipOffscreen=u,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new Ce(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new Ce(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new Ce(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new Ce(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new Ce(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return en(this.getCenterPoint(),Qn(this.viewportTransform))}_centerObject(e,t){e.setXY(t,gt,gt),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){const n=this.clipPath,i=n&&!n.excludeFromExport?this._toObject(n,e,t):null;return he(he(he({version:Kf},oo(this,t)),{},{objects:this._objects.filter((s=>!s.excludeFromExport)).map((s=>this._toObject(s,e,t)))},this.__serializeBgOverlay(e,t)),i?{clipPath:i}:null)}_toObject(e,t,n){let i;this.includeDefaultValues||(i=e.includeDefaultValues,e.includeDefaultValues=!1);const s=e[t](n);return this.includeDefaultValues||(e.includeDefaultValues=!!i),s}__serializeBgOverlay(e,t){const n={},i=this.backgroundImage,s=this.overlayImage,o=this.backgroundColor,c=this.overlayColor;return Fn(o)?o.excludeFromExport||(n.background=o.toObject(t)):o&&(n.background=o),Fn(c)?c.excludeFromExport||(n.overlay=c.toObject(t)):c&&(n.overlay=c),i&&!i.excludeFromExport&&(n.backgroundImage=this._toObject(i,e,t)),s&&!s.excludeFromExport&&(n.overlayImage=this._toObject(s,e,t)),n}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;const n=[];return this._setSVGPreamble(n,e),this._setSVGHeader(n,e),this.clipPath&&n.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(n,"background"),this._setSVGBgOverlayImage(n,"backgroundImage",t),this._setSVGObjects(n,t),this.clipPath&&n.push(`</g>
`),this._setSVGBgOverlayColor(n,"overlay"),this._setSVGBgOverlayImage(n,"overlayImage",t),n.push("</svg>"),n.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,t){const n=t.width||"".concat(this.width),i=t.height||"".concat(this.height),s=kt.NUM_FRACTION_DIGITS,o=t.viewBox;let c;if(o)c='viewBox="'.concat(o.x," ").concat(o.y," ").concat(o.width," ").concat(o.height,'" ');else if(this.svgViewportTransformation){const u=this.viewportTransform;c='viewBox="'.concat(Dt(-u[4]/u[0],s)," ").concat(Dt(-u[5]/u[3],s)," ").concat(Dt(this.width/u[0],s)," ").concat(Dt(this.height/u[3],s),'" ')}else c='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',n,'" ','height="',i,'" ',c,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",Kf,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`)}createSVGClipPathMarkup(e){const t=this.clipPath;return t?(t.clipPathId="CLIPPATH_".concat(Es()),'<clipPath id="'.concat(t.clipPathId,`" >
`).concat(t.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map((e=>{const t=this["".concat(e,"Color")];if(Fn(t)){const n=this["".concat(e,"Vpt")],i=this.viewportTransform,s={isType:()=>!1,width:this.width/(n?i[0]:1),height:this.height/(n?i[3]:1)};return t.toSVG(s,{additionalTransform:n?El(i):""})}})).join("")}createSVGFontFacesMarkup(){const e=[],t={},n=kt.fontPaths;this._objects.forEach((function s(o){e.push(o),Lu(o)&&o._objects.forEach(s)})),e.forEach((s=>{if(!(o=s)||typeof o._renderText!="function")return;var o;const{styles:c,fontFamily:u}=s;!t[u]&&n[u]&&(t[u]=!0,c&&Object.values(c).forEach((d=>{Object.values(d).forEach((h=>{let{fontFamily:g=""}=h;!t[g]&&n[g]&&(t[g]=!0)}))})))}));const i=Object.keys(t).map((s=>`		@font-face {
			font-family: '`.concat(s,`';
			src: url('`).concat(n[s],`');
		}
`))).join("");return i?`	<style type="text/css"><![CDATA[
`.concat(i,`]]></style>
`):""}_setSVGObjects(e,t){this.forEachObject((n=>{n.excludeFromExport||this._setSVGObject(e,n,t)}))}_setSVGObject(e,t,n){e.push(t.toSVG(n))}_setSVGBgOverlayImage(e,t,n){const i=this[t];i&&!i.excludeFromExport&&i.toSVG&&e.push(i.toSVG(n))}_setSVGBgOverlayColor(e,t){const n=this["".concat(t,"Color")];if(n)if(Fn(n)){const i=n.repeat||"",s=this.width,o=this.height,c=this["".concat(t,"Vpt")]?El(Qn(this.viewportTransform)):"";e.push('<rect transform="'.concat(c," translate(").concat(s/2,",").concat(o/2,')" x="').concat(n.offsetX-s/2,'" y="').concat(n.offsetY-o/2,'" width="').concat(i!=="repeat-y"&&i!=="no-repeat"||!ex(n)?s:n.source.width,'" height="').concat(i!=="repeat-x"&&i!=="no-repeat"||!ex(n)?o:n.source.height,'" fill="url(#SVGID_').concat(n.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',n,'"',`></rect>
`)}loadFromJSON(e,t){let{signal:n}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new di("`json` is undefined"));const i=typeof e=="string"?JSON.parse(e):e,{objects:s=[]}=i,o=It(i,iF),{backgroundImage:c,background:u,overlayImage:d,overlay:h,clipPath:g}=o,x=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([Tl(s,{reviver:t,signal:n}),vh({backgroundImage:c,backgroundColor:u,overlayImage:d,overlayColor:h,clipPath:g},{signal:n})]).then((m=>{let[y,v]=m;return this.clear(),this.add(...y),this.set(o),this.set(v),this.renderOnAddRemove=x,this}))}clone(e){const t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){const e=Pn(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:n=1,multiplier:i=1,enableRetinaScaling:s=!1}=e,o=i*(s?this.getRetinaScaling():1);return Ey(this.toCanvasElement(o,e),t,n)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:n=1,multiplier:i=1,enableRetinaScaling:s=!1}=e,o=i*(s?this.getRetinaScaling():1);return Ay(this.toCanvasElement(o,e),t,n)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:n,left:i,top:s,filter:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c=(t||this.width)*e,u=(n||this.height)*e,d=this.getZoom(),h=this.width,g=this.height,x=this.skipControlsDrawing,m=d*e,y=this.viewportTransform,v=[m,0,0,m,(y[4]-(i||0))*e,(y[5]-(s||0))*e],_=this.enableRetinaScaling,S=Pn({width:c,height:u}),T=o?this._objects.filter((C=>o(C))):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=v,this.width=c,this.height=u,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(S.getContext("2d"),T),this.viewportTransform=y,this.width=h,this.height=g,this.calcViewportBoundaries(),this.enableRetinaScaling=_,this.skipControlsDrawing=x,S}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),th.cancelByCanvas(this),this.disposed=!0,new Promise(((e,t)=>{const n=()=>{this.destroy(),e(!0)};n.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=n:n()}))}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject((e=>e.dispose())),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}}ue(Bl,"ownDefaults",nF);const sF=["touchstart","touchmove","touchend"],aF=r=>{const e=Py(r.target),t=(function(n){const i=n.changedTouches;return i&&i[0]?i[0]:n})(r);return new Ce(t.clientX+e.left,t.clientY+e.top)},Jf=r=>sF.includes(r.type)||r.pointerType==="touch",rx=r=>{r.preventDefault(),r.stopPropagation()},Bi=r=>{let e=0,t=0,n=0,i=0;for(let s=0,o=r.length;s<o;s++){const{x:c,y:u}=r[s];(c>n||!s)&&(n=c),(c<e||!s)&&(e=c),(u>i||!s)&&(i=u),(u<t||!s)&&(t=u)}return{left:e,top:t,width:n-e,height:i-t}},oF=["translateX","translateY","scaleX","scaleY"],lF=(r,e)=>nh(r,_r(e,r.calcOwnMatrix())),nh=(r,e)=>{const t=rh(e),{translateX:n,translateY:i,scaleX:s,scaleY:o}=t,c=It(t,oF),u=new Ce(n,i);r.flipX=!1,r.flipY=!1,Object.assign(r,c),r.set({scaleX:s,scaleY:o}),r.setPositionByOrigin(u,gt,gt)},cF=r=>{r.scaleX=1,r.scaleY=1,r.skewX=0,r.skewY=0,r.flipX=!1,r.flipY=!1,r.rotate(0)},Ry=r=>({scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,angle:r.angle,left:r.left,flipX:r.flipX,flipY:r.flipY,top:r.top}),Xd=(r,e,t)=>{const n=r/2,i=e/2,s=[new Ce(-n,-i),new Ce(n,-i),new Ce(-n,i),new Ce(n,i)].map((c=>c.transform(t))),o=Bi(s);return new Ce(o.width,o.height)},yh=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Xr;return _r(Qn(arguments.length>1&&arguments[1]!==void 0?arguments[1]:Xr),r)},$a=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Xr,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Xr;return r.transform(yh(e,t))},uF=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Xr,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Xr;return r.transform(yh(e,t),!0)},hF=(r,e,t)=>{const n=yh(e,t);return nh(r,_r(n,r.calcOwnMatrix())),n},Ly=(r,e)=>{var t;const{transform:{target:n}}=e;(t=n.canvas)===null||t===void 0||t.fire("object:".concat(r),he(he({},e),{},{target:n})),n.fire(r,e)},fF={left:-.5,top:-.5,center:0,bottom:.5,right:.5},tr=r=>typeof r=="string"?fF[r]:r-.5,ih="not-allowed";function By(r){return tr(r.originX)===tr(gt)&&tr(r.originY)===tr(gt)}function nx(r){return .5-tr(r)}const ri=(r,e)=>r[e],jy=(r,e,t,n)=>({e:r,transform:e,pointer:new Ce(t,n)});function zy(r,e){const t=r.getTotalAngle()+Hi(Math.atan2(e.y,e.x))+360;return Math.round(t%360/45)}function Gd(r,e,t,n,i){var s;let{target:o,corner:c}=r;const u=o.controls[c],d=((s=o.canvas)===null||s===void 0?void 0:s.getZoom())||1,h=o.padding/d,g=(function(x,m,y,v){const _=x.getRelativeCenterPoint(),S=y!==void 0&&v!==void 0?x.translateToGivenOrigin(_,gt,gt,y,v):new Ce(x.left,x.top);return(x.angle?m.rotate(-Zt(x.angle),_):m).subtract(S)})(o,new Ce(n,i),e,t);return g.x>=h&&(g.x-=h),g.x<=-h&&(g.x+=h),g.y>=h&&(g.y-=h),g.y<=h&&(g.y+=h),g.x-=u.offsetX,g.y-=u.offsetY,g}const dF=(r,e,t,n)=>{const{target:i,offsetX:s,offsetY:o}=e,c=t-s,u=n-o,d=!ri(i,"lockMovementX")&&i.left!==c,h=!ri(i,"lockMovementY")&&i.top!==u;return d&&i.set(Tt,c),h&&i.set(tn,u),(d||h)&&Ly(wy,jy(r,e,t,n)),d||h},sh=r=>r.replace(/\s+/g," "),ix={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},Ef=(r,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+6*(e-r)*t:t<.5?e:t<2/3?r+(e-r)*(2/3-t)*6:r),sx=(r,e,t,n)=>{r/=255,e/=255,t/=255;const i=Math.max(r,e,t),s=Math.min(r,e,t);let o,c;const u=(i+s)/2;if(i===s)o=c=0;else{const d=i-s;switch(c=u>.5?d/(2-i-s):d/(i+s),i){case r:o=(e-t)/d+(e<t?6:0);break;case e:o=(t-r)/d+2;break;case t:o=(r-e)/d+4}o/=6}return[Math.round(360*o),Math.round(100*c),Math.round(100*u),n]},ax=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(r)/(r.endsWith("%")?100:1)},lu=r=>Math.min(Math.round(r),255).toString(16).toUpperCase().padStart(2,"0"),ox=r=>{let[e,t,n,i=1]=r;const s=Math.round(.3*e+.59*t+.11*n);return[s,s,s,i]};class At{constructor(e){if(ue(this,"isUnrecognised",!1),e)if(e instanceof At)this.setSource([...e._source]);else if(Array.isArray(e)){const[t,n,i,s=1]=e;this.setSource([t,n,i,s])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in ix&&(e=ix[e]),e==="transparent"?[255,255,255,0]:At.sourceFromHex(e)||At.sourceFromRgb(e)||At.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){const[e,t,n]=this.getSource();return"rgb(".concat(e,",").concat(t,",").concat(n,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[e,t,n]=sx(...this.getSource());return"hsl(".concat(e,",").concat(t,"%,").concat(n,"%)")}toHsla(){const[e,t,n,i]=sx(...this.getSource());return"hsla(".concat(e,",").concat(t,"%,").concat(n,"%,").concat(i,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[e,t,n,i]=this.getSource();return"".concat(lu(e)).concat(lu(t)).concat(lu(n)).concat(lu(Math.round(255*i)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(ox(this.getSource())),this}toBlackWhite(e){const[t,,,n]=ox(this.getSource()),i=t<(e||127)?0:255;return this.setSource([i,i,i,n]),this}overlayWith(e){e instanceof At||(e=new At(e));const t=this.getSource(),n=e.getSource(),[i,s,o]=t.map(((c,u)=>Math.round(.5*c+.5*n[u])));return this.setSource([i,s,o,t[3]]),this}static fromRgb(e){return At.fromRgba(e)}static fromRgba(e){return new At(At.sourceFromRgb(e))}static sourceFromRgb(e){const t=sh(e).match(/^rgba?\(\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d{0,3}(?:\.\d+)?%?)\s?)?\)$/i);if(t){const[n,i,s]=t.slice(1,4).map((o=>{const c=parseFloat(o);return o.endsWith("%")?Math.round(2.55*c):c}));return[n,i,s,ax(t[4])]}}static fromHsl(e){return At.fromHsla(e)}static fromHsla(e){return new At(At.sourceFromHsl(e))}static sourceFromHsl(e){const t=sh(e).match(/^hsla?\(\s?([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d*(?:\.\d+)?%?)\s?)?\)$/i);if(!t)return;const n=(At.parseAngletoDegrees(t[1])%360+360)%360/360,i=parseFloat(t[2])/100,s=parseFloat(t[3])/100;let o,c,u;if(i===0)o=c=u=s;else{const d=s<=.5?s*(i+1):s+i-s*i,h=2*s-d;o=Ef(h,d,n+1/3),c=Ef(h,d,n),u=Ef(h,d,n-1/3)}return[Math.round(255*o),Math.round(255*c),Math.round(255*u),ax(t[4])]}static fromHex(e){return new At(At.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const t=e.slice(e.indexOf("#")+1);let n;n=t.length<=4?t.split("").map((u=>u+u)):t.match(/.{2}/g);const[i,s,o,c=255]=n.map((u=>parseInt(u,16)));return[i,s,o,c/255]}}static parseAngletoDegrees(e){const t=e.toLowerCase(),n=parseFloat(t);return t.includes("rad")?Hi(n):t.includes("turn")?360*n:n}}const Ka=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bd;const t=/\D{0,2}$/.exec(r),n=parseFloat(r),i=kt.DPI;switch(t==null?void 0:t[0]){case"mm":return n*i/25.4;case"cm":return n*i/2.54;case"in":return n*i;case"pt":return n*i/72;case"pc":return n*i/72*12;case"em":return n*e;default:return n}},gF=r=>{const[e,t]=r.trim().split(" "),[n,i]=(s=e)&&s!==rn?[s.slice(1,4),s.slice(5,8)]:s===rn?[s,s]:["Mid","Mid"];var s;return{meetOrSlice:t||"meet",alignX:n,alignY:i}},Al=function(r,e){let t,n,i=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)t="url(#SVGID_".concat(e.id,")");else{const s=new At(e),o=s.getAlpha();t=s.toRgb(),o!==1&&(n=o.toString())}else t="none";return i?"".concat(r,": ").concat(t,"; ").concat(n?"".concat(r,"-opacity: ").concat(n,"; "):""):"".concat(r,'="').concat(t,'" ').concat(n?"".concat(r,'-opacity="').concat(n,'" '):"")};class Uy{getSvgStyles(e){const t=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",i=this.strokeDashArray?this.strokeDashArray.join(" "):rn,s=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",c=this.strokeLineJoin?this.strokeLineJoin:"miter",u=this.strokeMiterLimit?this.strokeMiterLimit:"4",d=this.opacity!==void 0?this.opacity:"1",h=this.visible?"":" visibility: hidden;",g=e?"":this.getSvgFilter(),x=Al(or,this.fill);return[Al(nn,this.stroke),"stroke-width: ",n,"; ","stroke-dasharray: ",i,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",s,"; ","stroke-linejoin: ",c,"; ","stroke-miterlimit: ",u,"; ",x,"fill-rule: ",t,"; ","opacity: ",d,";",g,h].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=e?this.calcTransformMatrix():this.calcOwnMatrix(),i='transform="'.concat(El(n));return"".concat(i).concat(t,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),s=e.indexOf("COMMON_PARTS");return e[s]=i,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:n,withShadow:i,additionalTransform:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=t?"":'style="'.concat(this.getSvgStyles(),'" '),c=i?'style="'.concat(this.getSvgFilter(),'" '):"",u=this.clipPath,d=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",h=u&&u.absolutePositioned,g=this.stroke,x=this.fill,m=this.shadow,y=[],v=e.indexOf("COMMON_PARTS");let _;u&&(u.clipPathId="CLIPPATH_".concat(Es()),_='<clipPath id="'.concat(u.clipPathId,`" >
`).concat(u.toClipPathSVG(n),`</clipPath>
`)),h&&y.push("<g ",c,this.getSvgCommons(),` >
`),y.push("<g ",this.getSvgTransform(!1),h?"":c+this.getSvgCommons(),` >
`);const S=[o,d,t?"":this.addPaintOrder()," ",s?'transform="'.concat(s,'" '):""].join("");return e[v]=S,Fn(x)&&y.push(x.toSVG(this)),Fn(g)&&y.push(g.toSVG(this)),m&&y.push(m.toSVG(this)),u&&y.push(_),y.push(e.join("")),y.push(`</g>
`),h&&y.push(`</g>
`),n?n(y.join("")):y.join("")}addPaintOrder(){return this.paintFirst!==or?' paint-order="'.concat(this.paintFirst,'" '):""}}function _h(r){return new RegExp("^("+r.join("|")+")\\b","i")}const ia="textDecorationThickness",Vy=["fontSize","fontWeight","fontFamily","fontStyle"],Wy=["underline","overline","linethrough"],Hy=[...Vy,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],Xy=[...Hy,...Wy,"textBackgroundColor","direction",ia],pF=[...Vy,...Wy,nn,"strokeWidth",or,"deltaY","textBackgroundColor",ia],mF={_reNewline:jd,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:Tt,fontStyle:"normal",lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:Tt,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[ia]:66.667},fi="justify",ah="justify-left",fl="justify-right",dl="justify-center";var lx,cx,ux;const ei=String.raw(lx||(lx=vi(["[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?"],["[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?"]))),Af=String.raw(cx||(cx=vi(["(?:s*,?s+|s*,s*)"],["(?:\\s*,?\\s+|\\s*,\\s*)"]))),xF=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+ei+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+ei+"))?\\s+(.*)"),vF={cx:Tt,x:Tt,r:"radius",cy:tn,y:tn,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":ia},bf="font-size",Ff="clip-path";_h(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]);_h(["symbol","image","marker","pattern","view","svg"]);const hx=_h(["symbol","g","a","svg","clipPath","defs"]);new RegExp(String.raw(ux||(ux=vi(["^s*(",")","(",")","(",")","(",")s*$"],["^\\s*(",")","(",")","(",")","(",")\\s*$"])),ei,Af,ei,Af,ei,Af,ei));const yF=new Ce(1,0),Gy=new Ce,Yy=(r,e)=>r.rotate(e),Qf=(r,e)=>new Ce(e).subtract(r),ed=r=>r.distanceFrom(Gy),td=(r,e)=>Math.atan2(gl(r,e),wF(r,e)),_F=r=>td(yF,r),Yd=r=>r.eq(Gy)?r:r.scalarDivide(ed(r)),$y=function(r){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return Yd(new Ce(-r.y,r.x).scalarMultiply(e?1:-1))},gl=(r,e)=>r.x*e.y-r.y*e.x,wF=(r,e)=>r.x*e.x+r.y*e.y,fx=(r,e,t)=>{if(r.eq(e)||r.eq(t))return!0;const n=gl(e,t),i=gl(e,r),s=gl(t,r);return n>=0?i>=0&&s<=0:!(i<=0&&s>=0)},dx="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",gx=new RegExp("(?:\\s|^)"+dx+dx+"("+ei+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class ji{constructor(e){const t=typeof e=="string"?ji.parseShadow(e):e;Object.assign(this,ji.ownDefaults,t),this.id=Es()}static parseShadow(e){const t=e.trim(),[,n=0,i=0,s=0]=(gx.exec(t)||[]).map((o=>parseFloat(o)||0));return{color:(t.replace(gx,"")||"rgb(0,0,0)").trim(),offsetX:n,offsetY:i,blur:s}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){const t=Yy(new Ce(this.offsetX,this.offsetY),Zt(-e.angle)),n=new At(this.color);let i=40,s=40;return e.width&&e.height&&(i=100*Dt((Math.abs(t.x)+this.blur)/e.width,kt.NUM_FRACTION_DIGITS)+20,s=100*Dt((Math.abs(t.y)+this.blur)/e.height,kt.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(s,'%" height="').concat(100+2*s,'%" x="-').concat(i,'%" width="').concat(100+2*i,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(Dt(this.blur?this.blur/2:0,kt.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(Dt(t.x,kt.NUM_FRACTION_DIGITS),'" dy="').concat(Dt(t.y,kt.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(n.toRgb(),'" flood-opacity="').concat(n.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=ji.ownDefaults;return this.includeDefaultValues?e:Hd(e,((n,i)=>n!==t[i]))}static async fromObject(e){return new this(e)}}ue(ji,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),ue(ji,"type","shadow"),Qe.setClass(ji,"shadow");const Qa=(r,e,t)=>Math.max(r,Math.min(e,t)),SF=[tn,Tt,sn,Dn,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",io,so],Gi=[or,nn,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],kF={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:Tt,originY:tn,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:or,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},CF=(r,e,t,n)=>-t*Math.cos(r/n*Rl)+t+e,TF=()=>!1;class $d{constructor(e){let{startValue:t,byValue:n,duration:i=500,delay:s=0,easing:o=CF,onStart:c=Ru,onChange:u=Ru,onComplete:d=Ru,abort:h=TF,target:g}=e;ue(this,"_state","pending"),ue(this,"durationProgress",0),ue(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=i,this.delay=s,this.easing=o,this._onStart=c,this._onChange=u,this._onComplete=d,this._abort=h,this.target=g,this.startValue=t,this.byValue=n,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const e=t=>{this._state==="pending"&&(this.startTime=t||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout((()=>Bu(e)),this.delay):Bu(e)}tick(e){const t=(e||+new Date)-this.startTime,n=Math.min(t,this.duration);this.durationProgress=n/this.duration;const{value:i,valueProgress:s}=this.calculate(n);this.value=Object.freeze(i),this.valueProgress=s,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),Bu(this.tick)))}register(){th.push(this)}unregister(){th.remove(this)}abort(){this._state="aborted",this.unregister()}}const EF=["startValue","endValue"];class AF extends $d{constructor(e){let{startValue:t=0,endValue:n=100}=e;super(he(he({},It(e,EF)),{},{startValue:t,byValue:n-t}))}calculate(e){const t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}}const bF=["startValue","endValue"];class FF extends $d{constructor(e){let{startValue:t=[0],endValue:n=[100]}=e;super(he(he({},It(e,bF)),{},{startValue:t,byValue:n.map(((i,s)=>i-t[s]))}))}calculate(e){const t=this.startValue.map(((n,i)=>this.easing(e,n,this.byValue[i],this.duration,i)));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}}const OF=["startValue","endValue","easing","onChange","onComplete","abort"],DF=(r,e,t,n)=>e+t*(1-Math.cos(r/n*Rl)),Of=r=>r&&((e,t,n)=>r(new At(e).toRgba(),t,n));class PF extends $d{constructor(e){let{startValue:t,endValue:n,easing:i=DF,onChange:s,onComplete:o,abort:c}=e,u=It(e,OF);const d=new At(t).getSource(),h=new At(n).getSource();super(he(he({},u),{},{startValue:d,byValue:h.map(((g,x)=>g-d[x])),easing:i,onChange:Of(s),onComplete:Of(o),abort:Of(c)}))}calculate(e){const[t,n,i,s]=this.startValue.map(((c,u)=>this.easing(e,c,this.byValue[u],this.duration,u))),o=[...[t,n,i].map(Math.round),Qa(0,s,1)];return{value:o,valueProgress:o.map(((c,u)=>this.byValue[u]!==0?Math.abs((c-this.startValue[u])/this.byValue[u]):0)).find((c=>c!==0))||0}}}function Ky(r){const e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(r)?new FF(r):new AF(r);return e.start(),e}function MF(r){const e=new PF(r);return e.start(),e}class zt{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some((t=>t.eq(e)))}append(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.points=this.points.concat(t.filter((i=>!this.includes(i)))),this}static isPointContained(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(n))return e.eq(t);if(t.x===n.x)return e.x===t.x&&(i||e.y>=Math.min(t.y,n.y)&&e.y<=Math.max(t.y,n.y));if(t.y===n.y)return e.y===t.y&&(i||e.x>=Math.min(t.x,n.x)&&e.x<=Math.max(t.x,n.x));{const s=Qf(t,n),o=Qf(t,e).divide(s);return i?Math.abs(o.x)===Math.abs(o.y):o.x===o.y&&o.x>=0&&o.x<=1}}static isPointInPolygon(e,t){const n=new Ce(e).setX(Math.min(e.x-1,...t.map((s=>s.x))));let i=0;for(let s=0;s<t.length;s++){const o=this.intersectSegmentSegment(t[s],t[(s+1)%t.length],e,n);if(o.includes(e))return!0;i+=+(o.status==="Intersection")}return i%2==1}static intersectLineLine(e,t,n,i){let s=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const c=t.x-e.x,u=t.y-e.y,d=i.x-n.x,h=i.y-n.y,g=e.x-n.x,x=e.y-n.y,m=d*x-h*g,y=c*x-u*g,v=h*c-d*u;if(v!==0){const _=m/v,S=y/v;return(s||0<=_&&_<=1)&&(o||0<=S&&S<=1)?new zt("Intersection").append(new Ce(e.x+_*c,e.y+_*u)):new zt}if(m===0||y===0){const _=s||o||zt.isPointContained(e,n,i)||zt.isPointContained(t,n,i)||zt.isPointContained(n,e,t)||zt.isPointContained(i,e,t);return new zt(_?"Coincident":void 0)}return new zt("Parallel")}static intersectSegmentLine(e,t,n,i){return zt.intersectLineLine(e,t,n,i,!1,!0)}static intersectSegmentSegment(e,t,n,i){return zt.intersectLineLine(e,t,n,i,!1,!1)}static intersectLinePolygon(e,t,n){let i=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const s=new zt,o=n.length;for(let c,u,d,h=0;h<o;h++){if(c=n[h],u=n[(h+1)%o],d=zt.intersectLineLine(e,t,c,u,i,!1),d.status==="Coincident")return d;s.append(...d.points)}return s.points.length>0&&(s.status="Intersection"),s}static intersectSegmentPolygon(e,t,n){return zt.intersectLinePolygon(e,t,n,!1)}static intersectPolygonPolygon(e,t){const n=new zt,i=e.length,s=[];for(let o=0;o<i;o++){const c=e[o],u=e[(o+1)%i],d=zt.intersectSegmentPolygon(c,u,t);d.status==="Coincident"?(s.push(d),n.append(c,u)):n.append(...d.points)}return s.length>0&&s.length===e.length?new zt("Coincident"):(n.points.length>0&&(n.status="Intersection"),n)}static intersectPolygonRectangle(e,t,n){const i=t.min(n),s=t.max(n),o=new Ce(s.x,i.y),c=new Ce(i.x,s.y);return zt.intersectPolygonPolygon(e,[i,o,s,c])}}class NF extends Ty{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){const e=this.getRelativeXY();return this.group?en(e,this.group.calcTransformMatrix()):e}setXY(e,t,n){this.group&&(e=en(e,Qn(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,n)}getRelativeXY(){return new Ce(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,n)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:e,tr:t,br:n,bl:i}=this.aCoords||(this.aCoords=this.calcACoords()),s=[e,t,n,i];if(this.group){const o=this.group.calcTransformMatrix();return s.map((c=>en(c,o)))}return s}intersectsWithRect(e,t){return zt.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection"}intersectsWithObject(e){const t=zt.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every((t=>e.containsPoint(t)))}isContainedWithinRect(e,t){const{left:n,top:i,width:s,height:o}=this.getBoundingRect();return n>=e.x&&n+s<=t.x&&i>=e.y&&i+o<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return zt.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some((n=>n.x<=t.x&&n.x>=e.x&&n.y<=t.y&&n.y>=e.y))||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every((n=>(n.x>=t.x||n.x<=e.x)&&(n.y>=t.y||n.y<=e.y)))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return Bi(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(sn,e),this._set(Dn,e),this.setCoords()}scaleToWidth(e){const t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){const t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?Hi(by(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||Xr.concat()}calcACoords(){const e=ao({angle:this.angle}),{x:t,y:n}=this.getRelativeCenterPoint(),i=Ll(t,n),s=_r(i,e),o=this._getTransformedDimensions(),c=o.x/2,u=o.y/2;return{tl:en({x:-c,y:-u},s),tr:en({x:c,y:-u},s),bl:en({x:-c,y:u},s),br:en({x:c,y:u},s)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,tr(this.originX),tr(this.originY)),t}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;const n=this.transformMatrixKey(e),i=this.matrixCache;return i&&i.key.every(((s,o)=>s===n[o]))?i.value:(this.group&&(t=_r(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:n,value:t},t)}calcOwnMatrix(){const e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key===e)return t.value;const n=this.getRelativeCenterPoint(),i={angle:this.angle,translateX:n.x,translateY:n.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},s=rF(i);return this.ownMatrixCache={key:e,value:s},s}_getNonTransformedDimensions(){return new Ce(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=he({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),n=t.strokeWidth;let i=n,s=0;this.strokeUniform&&(i=0,s=n);const o=t.width+i,c=t.height+i;let u;return u=t.skewX===0&&t.skewY===0?new Ce(o*t.scaleX,c*t.scaleY):Xd(o,c,xh(t)),u.scalarAdd(s)}translateToGivenOrigin(e,t,n,i,s){let o=e.x,c=e.y;const u=tr(i)-tr(t),d=tr(s)-tr(n);if(u||d){const h=this._getTransformedDimensions();o+=u*h.x,c+=d*h.y}return new Ce(o,c)}translateToCenterPoint(e,t,n){if(t===gt&&n===gt)return e;const i=this.translateToGivenOrigin(e,t,n,gt,gt);return this.angle?i.rotate(Zt(this.angle),e):i}translateToOriginPoint(e,t,n){const i=this.translateToGivenOrigin(e,gt,gt,t,n);return this.angle?i.rotate(Zt(this.angle),e):i}getCenterPoint(){const e=this.getRelativeCenterPoint();return this.group?en(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new Ce(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,n){const i=this.translateToCenterPoint(e,t,n),s=this.translateToOriginPoint(i,this.originX,this.originY);this.set({left:s.x,top:s.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),Tt,tn)}}const IF=["type"],RF=["extraParam"];let Fi=class zu extends NF{static getDefaults(){return zu.ownDefaults}get type(){const e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){Ts("warn","Setting type has no effect",e)}constructor(e){super(),ue(this,"_cacheContext",null),Object.assign(this,zu.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=Wi(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){const t=e.width,n=e.height,i=kt.maxCacheSideLimit,s=kt.minCacheSideLimit;if(t<=i&&n<=i&&t*n<=kt.perfLimitSizeTotal)return t<s&&(e.width=s),n<s&&(e.height=s),e;const o=t/n,[c,u]=hl.limitDimsByArea(o),d=Qa(s,c,i),h=Qa(s,u,i);return t>d&&(e.zoomX/=t/d,e.width=d,e.capped=!0),n>h&&(e.zoomY/=n/h,e.height=h,e.capped=!0),e}_getCacheCanvasDimensions(){const e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),n=t.x*e.x/this.scaleX,i=t.y*e.y/this.scaleY;return{width:Math.ceil(n+2),height:Math.ceil(i+2),zoomX:e.x,zoomY:e.y,x:n,y:i}}_updateCacheCanvas(){const e=this._cacheCanvas,t=this._cacheContext,{width:n,height:i,zoomX:s,zoomY:o,x:c,y:u}=this._limitCacheSize(this._getCacheCanvasDimensions()),d=n!==e.width||i!==e.height,h=this.zoomX!==s||this.zoomY!==o;if(!e||!t)return!1;if(d||h){n!==e.width||i!==e.height?(e.width=n,e.height=i):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height));const g=c/2,x=u/2;return this.cacheTranslationX=Math.round(e.width/2-g)+g,this.cacheTranslationY=Math.round(e.height/2-x)+x,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(s,o),this.zoomX=s,this.zoomY=o,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){const t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,n=this.calcTransformMatrix(!t);e.transform(n[0],n[1],n[2],n[3],n[4],n[5])}getObjectScaling(){if(!this.group)return new Ce(Math.abs(this.scaleX),Math.abs(this.scaleY));const e=rh(this.calcTransformMatrix());return new Ce(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){const e=this.getObjectScaling();if(this.canvas){const t=this.canvas.getZoom(),n=this.getCanvasRetinaScaling();return e.scalarMultiply(t*n)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,t){e!==sn&&e!==Dn||(t=this._constrainScale(t)),e===sn&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof ji||(t=new ji(t));const n=this[e]!==t;return this[e]=t,n&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||n&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:t,zoomY:n,cacheTranslationX:i,cacheTranslationY:s}=this,{width:o,height:c}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:t,zoomY:n,cacheTranslationX:i,cacheTranslationY:s,width:o,height:c,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===nn&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,t,n){e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(n,0,0),e.restore()}drawObject(e,t,n){const i=this.fill,s=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,n),this.fill=i,this.stroke=s}createClipPathLayer(e,t){const n=Pn(t),i=n.getContext("2d");if(i.translate(t.cacheTranslationX,t.cacheTranslationY),i.scale(t.zoomX,t.zoomY),e._cacheCanvas=n,t.parentClipPaths.forEach((s=>{s.transform(i)})),t.parentClipPaths.push(e),e.absolutePositioned){const s=Qn(this.calcTransformMatrix());i.transform(s[0],s[1],s[2],s[3],s[4],s[5])}return e.transform(i),e.drawObject(i,!0,t),n}_drawClipPath(e,t,n){if(!t)return;t._transformDone=!0;const i=this.createClipPathLayer(t,n);this.drawClipPathOnCache(e,t,i)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const t=this._cacheCanvas,n=this._cacheContext;return!(!t||!n||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&n&&!e&&(n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,t.width,t.height),n.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;const t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){const n=t.stroke;n&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,Fn(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?this._applyPatternForTransformedGradient(e,n):(e.strokeStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:n}=t;n&&(Fn(n)?(e.fillStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.fillStyle=n)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&t.length!==0&&e.setLineDash(t)}_setShadow(e){if(!this.shadow)return;const t=this.shadow,n=this.canvas,i=this.getCanvasRetinaScaling(),[s,,,o]=(n==null?void 0:n.viewportTransform)||Xr,c=s*i,u=o*i,d=t.nonScaling?new Ce(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*kt.browserShadowBlurConstant*(c+u)*(d.x+d.y)/4,e.shadowOffsetX=t.offsetX*c*d.x,e.shadowOffsetY=t.offsetY*u*d.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!Fn(t))return{offsetX:0,offsetY:0};const n=t.gradientTransform||t.patternTransform,i=-this.width/2+t.offsetX||0,s=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,i,s):e.transform(1,0,0,1,i,s),n&&e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:i,offsetY:s}}_renderPaintInOrder(e){this.paintFirst===nn?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){const t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var n;const i=this._limitCacheSize(this._getCacheCanvasDimensions()),s=this.getCanvasRetinaScaling(),o=i.x/this.scaleX/s,c=i.y/this.scaleY/s,u=Pn({width:Math.ceil(o),height:Math.ceil(c)}),d=u.getContext("2d");d&&(d.beginPath(),d.moveTo(0,0),d.lineTo(o,0),d.lineTo(o,c),d.lineTo(0,c),d.closePath(),d.translate(o/2,c/2),d.scale(i.zoomX/this.scaleX/s,i.zoomY/this.scaleY/s),this._applyPatternGradientTransform(d,t),d.fillStyle=t.toLive(e),d.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(s*this.scaleX/i.zoomX,s*this.scaleY/i.zoomY),e.strokeStyle=(n=d.createPattern(u,"no-repeat"))!==null&&n!==void 0?n:"")}_findCenterFromElement(){return new Ce(this.left+this.width/2,this.top+this.height/2)}clone(e){const t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){const t=this.toCanvasElement(e);return new(Qe.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=Ry(this),n=this.group,i=this.shadow,s=Math.abs,o=e.enableRetinaScaling?_y():1,c=(e.multiplier||1)*o,u=e.canvasProvider||(T=>new Bl(T,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&cF(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&hF(this,this.getViewportTransform()),this.setCoords();const d=Wi(),h=this.getBoundingRect(),g=this.shadow,x=new Ce;if(g){const T=g.blur,C=g.nonScaling?new Ce(1,1):this.getObjectScaling();x.x=2*Math.round(s(g.offsetX)+T)*s(C.x),x.y=2*Math.round(s(g.offsetY)+T)*s(C.y)}const m=h.width+x.x,y=h.height+x.y;d.width=Math.ceil(m),d.height=Math.ceil(y);const v=u(d);e.format==="jpeg"&&(v.backgroundColor="#fff"),this.setPositionByOrigin(new Ce(v.width/2,v.height/2),gt,gt);const _=this.canvas;v._objects=[this],this.set("canvas",v),this.setCoords();const S=v.toCanvasElement(c||1,e);return this.set("canvas",_),this.shadow=i,n&&(this.group=n),this.set(t),this.setCoords(),v._objects=[],v.destroy(),S}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Ey(this.toCanvasElement(e),e.format||"png",e.quality||1)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Ay(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){const{centeredRotation:t,originX:n,originY:i}=this;if(t){const{x:s,y:o}=this.getRelativeCenterPoint();this.originX=gt,this.originY=gt,this.left=s,this.top=o}if(this.set("angle",e),t){const{x:s,y:o}=this.translateToOriginPoint(this.getRelativeCenterPoint(),n,i);this.left=s,this.top=o,this.originX=n,this.originY=i}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){th.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&pi().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,t){return Object.entries(e).reduce(((n,i)=>{let[s,o]=i;return n[s]=this._animate(s,o,t),n}),{})}_animate(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=e.split("."),s=this.constructor.colorProperties.includes(i[i.length-1]),{abort:o,startValue:c,onChange:u,onComplete:d}=n,h=he(he({},n),{},{target:this,startValue:c??i.reduce(((g,x)=>g[x]),this),endValue:t,abort:o==null?void 0:o.bind(this),onChange:(g,x,m)=>{i.reduce(((y,v,_)=>(_===i.length-1&&(y[v]=g),y[v])),this),u&&u(g,x,m)},onComplete:(g,x,m)=>{this.setCoords(),d&&d(g,x,m)}});return s?MF(h):Ky(h)}isDescendantOf(e){const{parent:t,group:n}=this;return t===e||n===e||!!t&&t.isDescendantOf(e)||!!n&&n!==t&&n.isDescendantOf(e)}getAncestors(){const e=[];let t=this;do t=t.parent,t&&e.push(t);while(t);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const t=this.getAncestors(),n=e.getAncestors();if(t.length===0&&n.length>0&&this===n[n.length-1])return{fork:[],otherFork:[e,...n.slice(0,n.length-1)],common:[this]};for(let i,s=0;s<t.length;s++){if(i=t[s],i===e)return{fork:[this,...t.slice(0,s)],otherFork:[],common:t.slice(s)};for(let o=0;o<n.length;o++){if(this===n[o])return{fork:[],otherFork:[e,...n.slice(0,o)],common:[this,...t]};if(i===n[o])return{fork:[this,...t.slice(0,s)],otherFork:[e,...n.slice(0,o)],common:t.slice(s)}}}return{fork:[this,...t],otherFork:[e,...n],common:[]}}hasCommonAncestors(e){const t=this.findCommonAncestors(e);return t&&!!t.common.length}isInFrontOf(e){if(this===e)return;const t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;const n=t.common[0]||this.canvas;if(!n)return;const i=t.fork.pop(),s=t.otherFork.pop(),o=n._objects.indexOf(i),c=n._objects.indexOf(s);return o>-1&&o>c}toObject(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(zu.customProperties,this.constructor.customProperties||[]);let t;const n=kt.NUM_FRACTION_DIGITS,{clipPath:i,fill:s,stroke:o,shadow:c,strokeDashArray:u,left:d,top:h,originX:g,originY:x,width:m,height:y,strokeWidth:v,strokeLineCap:_,strokeDashOffset:S,strokeLineJoin:T,strokeUniform:C,strokeMiterLimit:A,scaleX:P,scaleY:N,angle:O,flipX:V,flipY:B,opacity:te,visible:ie,backgroundColor:D,fillRule:J,paintFirst:F,globalCompositeOperation:se,skewX:Ee,skewY:le}=this;i&&!i.excludeFromExport&&(t=i.toObject(e.concat("inverted","absolutePositioned")));const xe=pe=>Dt(pe,n),X=he(he({},oo(this,e)),{},{type:this.constructor.type,version:Kf,originX:g,originY:x,left:xe(d),top:xe(h),width:xe(m),height:xe(y),fill:Q1(s)?s.toObject():s,stroke:Q1(o)?o.toObject():o,strokeWidth:xe(v),strokeDashArray:u&&u.concat(),strokeLineCap:_,strokeDashOffset:S,strokeLineJoin:T,strokeUniform:C,strokeMiterLimit:xe(A),scaleX:xe(P),scaleY:xe(N),angle:xe(O),flipX:V,flipY:B,opacity:xe(te),shadow:c&&c.toObject(),visible:ie,backgroundColor:D,fillRule:J,paintFirst:F,globalCompositeOperation:se,skewX:xe(Ee),skewY:xe(le)},t?{clipPath:t}:null);return this.includeDefaultValues?X:this._removeDefaultValues(X)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){const t=this.constructor.getDefaults(),n=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return Hd(e,((i,s)=>{if(s===Tt||s===tn||s==="type")return!0;const o=n[s];return i!==o&&!(Array.isArray(i)&&Array.isArray(o)&&i.length===0&&o.length===0)}))}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let t=It(e,IF),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:i}=n,s=It(n,RF);return vh(t,s).then((o=>i?(delete o[i],new this(t[i],o)):new this(o)))}static fromObject(e,t){return this._fromObject(e,t)}};ue(Fi,"stateProperties",SF),ue(Fi,"cacheProperties",Gi),ue(Fi,"ownDefaults",kF),ue(Fi,"type","FabricObject"),ue(Fi,"colorProperties",[or,nn,"backgroundColor"]),ue(Fi,"customProperties",[]),Qe.setClass(Fi),Qe.setClass(Fi,"object");const lo=(r,e,t)=>(n,i,s,o)=>{const c=e(n,i,s,o);return c&&Ly(r,he(he({},jy(n,i,s,o)),t)),c};function co(r){return(e,t,n,i)=>{const{target:s,originX:o,originY:c}=t,u=s.getRelativeCenterPoint(),d=s.translateToOriginPoint(u,o,c),h=r(e,t,n,i);return s.setPositionByOrigin(d,t.originX,t.originY),h}}const px=lo(Cl,co(((r,e,t,n)=>{const i=Gd(e,e.originX,e.originY,t,n);if(tr(e.originX)===tr(gt)||tr(e.originX)===tr(Kt)&&i.x<0||tr(e.originX)===tr(Tt)&&i.x>0){const{target:s}=e,o=s.strokeWidth/(s.strokeUniform?s.scaleX:1),c=By(e)?2:1,u=s.width,d=Math.abs(i.x*c/s.scaleX)-o;return s.set("width",Math.max(d,1)),u!==s.width}return!1})));function LF(r,e,t,n,i){n=n||{};const s=this.sizeX||n.cornerSize||i.cornerSize,o=this.sizeY||n.cornerSize||i.cornerSize,c=n.transparentCorners!==void 0?n.transparentCorners:i.transparentCorners,u=c?nn:or,d=!c&&(n.cornerStrokeColor||i.cornerStrokeColor);let h,g=e,x=t;r.save(),r.fillStyle=n.cornerColor||i.cornerColor||"",r.strokeStyle=n.cornerStrokeColor||i.cornerStrokeColor||"",s>o?(h=s,r.scale(1,o/s),x=t*s/o):o>s?(h=o,r.scale(s/o,1),g=e*o/s):h=s,r.beginPath(),r.arc(g,x,h/2,0,Ju,!1),r[u](),d&&r.stroke(),r.restore()}function BF(r,e,t,n,i){n=n||{};const s=this.sizeX||n.cornerSize||i.cornerSize,o=this.sizeY||n.cornerSize||i.cornerSize,c=n.transparentCorners!==void 0?n.transparentCorners:i.transparentCorners,u=c?nn:or,d=!c&&(n.cornerStrokeColor||i.cornerStrokeColor),h=s/2,g=o/2;r.save(),r.fillStyle=n.cornerColor||i.cornerColor||"",r.strokeStyle=n.cornerStrokeColor||i.cornerStrokeColor||"",r.translate(e,t);const x=i.getTotalAngle();r.rotate(Zt(x)),r["".concat(u,"Rect")](-h,-g,s,o),d&&r.strokeRect(-h,-g,s,o),r.restore()}class Gn{constructor(e){ue(this,"visible",!0),ue(this,"actionName",mh),ue(this,"angle",0),ue(this,"x",0),ue(this,"y",0),ue(this,"offsetX",0),ue(this,"offsetY",0),ue(this,"sizeX",0),ue(this,"sizeY",0),ue(this,"touchSizeX",0),ue(this,"touchSizeY",0),ue(this,"cursorStyle","crosshair"),ue(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,n,i){var s;let{tl:o,tr:c,br:u,bl:d}=i;return((s=t.canvas)===null||s===void 0?void 0:s.getActiveObject())===t&&t.isControlVisible(e)&&zt.isPointInPolygon(n,[o,c,u,d])}getActionHandler(e,t,n){return this.actionHandler}getMouseDownHandler(e,t,n){return this.mouseDownHandler}getMouseUpHandler(e,t,n){return this.mouseUpHandler}cursorStyleHandler(e,t,n){return t.cursorStyle}getActionName(e,t,n){return t.actionName}getVisibility(e,t){var n,i;return(n=(i=e._controlsVisibility)===null||i===void 0?void 0:i[t])!==null&&n!==void 0?n:this.visible}setVisibility(e,t,n){this.visible=e}positionHandler(e,t,n,i){return new Ce(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,n,i,s,o){const c=Vd([Ll(n,i),ao({angle:e}),Wd((s?this.touchSizeX:this.sizeX)||t,(s?this.touchSizeY:this.sizeY)||t)]);return{tl:new Ce(-.5,-.5).transform(c),tr:new Ce(.5,-.5).transform(c),br:new Ce(.5,.5).transform(c),bl:new Ce(-.5,.5).transform(c)}}render(e,t,n,i,s){((i=i||{}).cornerStyle||s.cornerStyle)==="circle"?LF.call(this,e,t,n,i,s):BF.call(this,e,t,n,i,s)}}const jF=(r,e,t)=>t.lockRotation?ih:e.cursorStyle,zF=lo(Sy,co(((r,e,t,n)=>{let{target:i,ex:s,ey:o,theta:c,originX:u,originY:d}=e;const h=i.translateToOriginPoint(i.getRelativeCenterPoint(),u,d);if(ri(i,"lockRotation"))return!1;const g=Math.atan2(o-h.y,s-h.x),x=Math.atan2(n-h.y,t-h.x);let m=Hi(x-g+c);if(i.snapAngle&&i.snapAngle>0){const v=i.snapAngle,_=i.snapThreshold||v,S=Math.ceil(m/v)*v,T=Math.floor(m/v)*v;Math.abs(m-T)<_?m=T:Math.abs(m-S)<_&&(m=S)}m<0&&(m=360+m),m%=360;const y=i.angle!==m;return i.angle=m,y})));function Zy(r,e){const t=e.canvas,n=r[t.uniScaleKey];return t.uniformScaling&&!n||!t.uniformScaling&&n}function qy(r,e,t){const n=ri(r,"lockScalingX"),i=ri(r,"lockScalingY");if(n&&i||!e&&(n||i)&&t||n&&e==="x"||i&&e==="y")return!0;const{width:s,height:o,strokeWidth:c}=r;return s===0&&c===0&&e!=="y"||o===0&&c===0&&e!=="x"}const UF=["e","se","s","sw","w","nw","n","ne","e"],el=(r,e,t)=>{const n=Zy(r,t);if(qy(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",n))return ih;const i=zy(t,e);return"".concat(UF[i],"-resize")};function Kd(r,e,t,n){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const s=e.target,o=i.by,c=Zy(r,s);let u,d,h,g,x,m;if(qy(s,o,c))return!1;if(e.gestureScale)d=e.scaleX*e.gestureScale,h=e.scaleY*e.gestureScale;else{if(u=Gd(e,e.originX,e.originY,t,n),x=o!=="y"?Math.sign(u.x||e.signX||1):1,m=o!=="x"?Math.sign(u.y||e.signY||1):1,e.signX||(e.signX=x),e.signY||(e.signY=m),ri(s,"lockScalingFlip")&&(e.signX!==x||e.signY!==m))return!1;if(g=s._getTransformedDimensions(),c&&!o){const _=Math.abs(u.x)+Math.abs(u.y),{original:S}=e,T=_/(Math.abs(g.x*S.scaleX/s.scaleX)+Math.abs(g.y*S.scaleY/s.scaleY));d=S.scaleX*T,h=S.scaleY*T}else d=Math.abs(u.x*s.scaleX/g.x),h=Math.abs(u.y*s.scaleY/g.y);By(e)&&(d*=2,h*=2),e.signX!==x&&o!=="y"&&(e.originX=nx(e.originX),d*=-1,e.signX=x),e.signY!==m&&o!=="x"&&(e.originY=nx(e.originY),h*=-1,e.signY=m)}const y=s.scaleX,v=s.scaleY;return o?(o==="x"&&s.set(sn,d),o==="y"&&s.set(Dn,h)):(!ri(s,"lockScalingX")&&s.set(sn,d),!ri(s,"lockScalingY")&&s.set(Dn,h)),y!==s.scaleX||v!==s.scaleY}const cu=lo(ph,co(((r,e,t,n)=>Kd(r,e,t,n)))),VF=lo(ph,co(((r,e,t,n)=>Kd(r,e,t,n,{by:"x"})))),WF=lo(ph,co(((r,e,t,n)=>Kd(r,e,t,n,{by:"y"})))),HF=["target","ex","ey","skewingSide"],Df={x:{counterAxis:"y",scale:sn,skew:io,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:Dn,skew:so,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},XF=["ns","nesw","ew","nwse"],GF=(r,e,t)=>{if(e.x!==0&&ri(t,"lockSkewingY")||e.y!==0&&ri(t,"lockSkewingX"))return ih;const n=zy(t,e)%4;return"".concat(XF[n],"-resize")};function Jy(r,e,t,n,i){const{target:s}=t,{counterAxis:o,origin:c,lockSkewing:u,skew:d,flip:h}=Df[r];if(ri(s,u))return!1;const{origin:g,flip:x}=Df[o],m=tr(t[g])*(s[x]?-1:1),y=-Math.sign(m)*(s[h]?-1:1),v=.5*-((s[d]===0&&Gd(t,gt,gt,n,i)[r]>0||s[d]>0?1:-1)*y)+.5;return lo(ky,co(((S,T,C,A)=>(function(P,N,O){let{target:V,ex:B,ey:te,skewingSide:ie}=N,D=It(N,HF);const{skew:J}=Df[P],F=O.subtract(new Ce(B,te)).divide(new Ce(V.scaleX,V.scaleY))[P],se=V[J],Ee=D[J],le=Math.tan(Zt(Ee)),xe=P==="y"?V._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:V._getTransformedDimensions({scaleX:1,scaleY:1}).y,X=2*F*ie/Math.max(xe,1)+le,pe=Hi(Math.atan(X));V.set(J,pe);const R=se!==V[J];if(R&&P==="y"){const{skewX:b,scaleX:ee}=V,G=V._getTransformedDimensions({skewY:se}),H=V._getTransformedDimensions(),me=b!==0?G.x/H.x:1;me!==1&&V.set(sn,me*ee)}return R})(r,T,new Ce(C,A)))))(e,he(he({},t),{},{[c]:v,skewingSide:y}),n,i)}const YF=(r,e,t,n)=>Jy("x",r,e,t,n),$F=(r,e,t,n)=>Jy("y",r,e,t,n);function wh(r,e){return r[e.canvas.altActionKey]}const uu=(r,e,t)=>{const n=wh(r,t);return e.x===0?n?io:Dn:e.y===0?n?so:sn:""},Va=(r,e,t)=>wh(r,t)?GF(0,e,t):el(r,e,t),mx=(r,e,t,n)=>wh(r,e.target)?$F(r,e,t,n):VF(r,e,t,n),xx=(r,e,t,n)=>wh(r,e.target)?YF(r,e,t,n):WF(r,e,t,n),Qy=()=>({ml:new Gn({x:-.5,y:0,cursorStyleHandler:Va,actionHandler:mx,getActionName:uu}),mr:new Gn({x:.5,y:0,cursorStyleHandler:Va,actionHandler:mx,getActionName:uu}),mb:new Gn({x:0,y:.5,cursorStyleHandler:Va,actionHandler:xx,getActionName:uu}),mt:new Gn({x:0,y:-.5,cursorStyleHandler:Va,actionHandler:xx,getActionName:uu}),tl:new Gn({x:-.5,y:-.5,cursorStyleHandler:el,actionHandler:cu}),tr:new Gn({x:.5,y:-.5,cursorStyleHandler:el,actionHandler:cu}),bl:new Gn({x:-.5,y:.5,cursorStyleHandler:el,actionHandler:cu}),br:new Gn({x:.5,y:.5,cursorStyleHandler:el,actionHandler:cu}),mtr:new Gn({x:0,y:-.5,actionHandler:zF,cursorStyleHandler:jF,offsetY:-40,withConnection:!0,actionName:zd})}),KF=()=>({mr:new Gn({x:.5,y:0,actionHandler:px,cursorStyleHandler:Va,actionName:Cl}),ml:new Gn({x:-.5,y:0,actionHandler:px,cursorStyleHandler:Va,actionName:Cl})}),ZF=()=>he(he({},Qy()),KF());class bl extends Fi{static getDefaults(){return he(he({},super.getDefaults()),bl.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),bl.ownDefaults),this.setOptions(e)}static createControls(){return{controls:Qy()}}_updateCacheCanvas(){const e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){const t=e._currentTransform,n=t.target,i=t.action;if(this===n&&i&&i.startsWith(mh))return!1}return super._updateCacheCanvas()}getActiveControl(){const e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const n=Object.entries(this.oCoords);for(let i=n.length-1;i>=0;i--){const[s,o]=n[i],c=this.controls[s];if(c.shouldActivate(s,this,e,t?o.touchCorner:o.corner))return this.__corner=s,{key:s,control:c,coord:this.oCoords[s]}}}calcOCoords(){const e=this.getViewportTransform(),t=this.getCenterPoint(),n=Ll(t.x,t.y),i=ao({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),s=_r(n,i),o=_r(e,s),c=_r(o,[1/e[0],0,0,1/e[3],0,0]),u=this.group?rh(this.calcTransformMatrix()):void 0;u&&(u.scaleX=Math.abs(u.scaleX),u.scaleY=Math.abs(u.scaleY));const d=this._calculateCurrentDimensions(u),h={};return this.forEachControl(((g,x)=>{const m=g.positionHandler(d,c,this,g);h[x]=Object.assign(m,this._calcCornerCoords(g,m))})),h}_calcCornerCoords(e,t){const n=this.getTotalAngle();return{corner:e.calcCornerCoords(n,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(n,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(const t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();const t=this.getRelativeCenterPoint(),n=this._calculateCurrentDimensions(),i=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/i[0],1/i[3]),e.rotate(Zt(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-n.x/2,-n.y/2,n.x,n.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=he({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},n);e.save(),e.strokeStyle=i.borderColor,this._setLineDash(e,i.borderDashArray),this.strokeBorders(e,t),i.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:n,hasControls:i}=this,s=he({hasBorders:n,hasControls:i},t),o=this.getViewportTransform(),c=s.hasBorders,u=s.hasControls,d=_r(o,this.calcTransformMatrix()),h=rh(d);e.save(),e.translate(h.translateX,h.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(h.angle-=180),e.rotate(Zt(this.group?h.angle:this.angle)),c&&this.drawBorders(e,h,t),u&&this.drawControls(e,t),e.restore()}drawBorders(e,t,n){let i;if(n&&n.forActiveSelection||this.group){const s=Xd(this.width,this.height,xh(t)),o=this.isStrokeAccountedForInDimensions()?Ud:(this.strokeUniform?new Ce().scalarAdd(this.canvas?this.canvas.getZoom():1):new Ce(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);i=s.add(o).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else i=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,i,n)}drawControlsConnectingLines(e,t){let n=!1;e.beginPath(),this.forEachControl(((i,s)=>{i.withConnection&&i.getVisibility(this,s)&&(n=!0,e.moveTo(i.x*t.x,i.y*t.y),e.lineTo(i.x*t.x+i.offsetX,i.y*t.y+i.offsetY))})),n&&e.stroke()}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();const n=this.getCanvasRetinaScaling(),{cornerStrokeColor:i,cornerDashArray:s,cornerColor:o}=this,c=he({cornerStrokeColor:i,cornerDashArray:s,cornerColor:o},t);e.setTransform(n,0,0,n,0,0),e.strokeStyle=e.fillStyle=c.cornerColor,this.transparentCorners||(e.strokeStyle=c.cornerStrokeColor),this._setLineDash(e,c.cornerDashArray),this.forEachControl(((u,d)=>{if(u.getVisibility(this,d)){const h=this.oCoords[d];u.render(e,h.x,h.y,c,this)}})),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach((t=>{let[n,i]=t;return this.setControlVisible(n,i)}))}clearContextTop(e){if(!this.canvas)return;const t=this.canvas.contextTop;if(!t)return;const n=this.canvas.viewportTransform;t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(t);const i=this.width+4,s=this.height+4;return t.clearRect(-i/2,-s/2,i,s),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}}function e2(r,e){return e.forEach((t=>{Object.getOwnPropertyNames(t.prototype).forEach((n=>{n!=="constructor"&&Object.defineProperty(r.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n)||Object.create(null))}))})),r}ue(bl,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class Mr extends bl{}e2(Mr,[Uy]),Qe.setClass(Mr),Qe.setClass(Mr,"object");const qF=(r,e,t,n)=>{const i=2*(n=Math.round(n))+1,{data:s}=r.getImageData(e-n,t-n,i,i);for(let o=3;o<s.length;o+=4)if(s[o]>0)return!1;return!0};class t2{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new Ce(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new Ce(1/this.options.scaleX,1/this.options.scaleY):new Ce(1,1)}createSideVector(e,t){const n=Qf(e,t);return this.options.strokeUniform?n.multiply(this.scale):n}projectOrthogonally(e,t,n){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,n)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){const t=new Ce(e);return t.y+=t.x*Math.tan(Zt(this.options.skewY)),t.x+=t.y*Math.tan(Zt(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}}const JF=new Ce;class Za extends t2{static getOrthogonalRotationFactor(e,t){const n=t?td(e,t):_F(e);return Math.abs(n)<Rl?-1:1}constructor(e,t,n,i){super(i),ue(this,"AB",void 0),ue(this,"AC",void 0),ue(this,"alpha",void 0),ue(this,"bisector",void 0),this.A=new Ce(e),this.B=new Ce(t),this.C=new Ce(n),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=td(this.AB,this.AC),this.bisector=Yd(Yy(this.AB.eq(JF)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const i=this.createSideVector(e,t),s=$y(i),o=Za.getOrthogonalRotationFactor(s,this.bisector);return this.scaleUnitVector(s,n*o)}projectBevel(){const e=[];return(this.alpha%Ju==0?[this.B]:[this.B,this.C]).forEach((t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))})),e}projectMiter(){const e=[],t=Math.abs(this.alpha),n=1/Math.sin(t/2),i=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*n),s=this.options.strokeUniform?ed(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return ed(i)/this.strokeProjectionMagnitude<=s&&e.push(this.applySkew(this.A.add(i))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){const n=[],i=new Ce(Za.getOrthogonalRotationFactor(this.bisector),Za.getOrthogonalRotationFactor(new Ce(this.bisector.y,this.bisector.x)));return[new Ce(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(i),new Ce(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(i)].forEach((s=>{fx(s,e,t)&&n.push(this.A.add(s))})),n}projectRoundWithSkew(e,t){const n=[],{skewX:i,skewY:s,scaleX:o,scaleY:c,strokeUniform:u}=this.options,d=new Ce(Math.tan(Zt(i)),Math.tan(Zt(s))),h=this.strokeProjectionMagnitude,g=u?h/c/Math.sqrt(1/c**2+1/o**2*d.y**2):h/Math.sqrt(1+d.y**2),x=new Ce(Math.sqrt(Math.max(h**2-g**2,0)),g),m=u?h/Math.sqrt(1+d.x**2*(1/c)**2/(1/o+1/o*d.x*d.y)**2):h/Math.sqrt(1+d.x**2/(1+d.x*d.y)**2),y=new Ce(m,Math.sqrt(Math.max(h**2-m**2,0)));return[y,y.scalarMultiply(-1),x,x.scalarMultiply(-1)].map((v=>this.applySkew(u?v.multiply(this.strokeUniformScalar):v))).forEach((v=>{fx(v,e,t)&&n.push(this.applySkew(this.A).add(v))})),n}projectRound(){const e=[];e.push(...this.projectBevel());const t=this.alpha%Ju==0,n=this.applySkew(this.A),i=e[t?0:2].subtract(n),s=e[t?1:0].subtract(n),o=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),c=gl(i,o)>0,u=c?i:s,d=c?s:i;return this.isSkewed()?e.push(...this.projectRoundWithSkew(u,d)):e.push(...this.projectRoundNoSkew(u,d)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map((e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector})))}}class vx extends t2{constructor(e,t,n){super(n),this.A=new Ce(e),this.T=new Ce(t)}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const i=this.createSideVector(e,t);return this.scaleUnitVector($y(i),n)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const e=[];if(!this.isSkewed()&&this.A.eq(this.T)){const t=new Ce(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new Za(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){const e=[];if(this.A.eq(this.T)){const t=new Ce(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{const t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),n=this.scaleUnitVector(Yd(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),i=this.A.add(n);e.push(i.add(t),i.subtract(t))}return e.map((t=>this.applySkew(t)))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map((e=>({originPoint:this.A,projectedPoint:e})))}}const QF=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const n=[];if(r.length===0)return n;const i=r.reduce(((s,o)=>(s[s.length-1].eq(o)||s.push(new Ce(o)),s)),[new Ce(r[0])]);if(i.length===1)t=!0;else if(!t){const s=i[0],o=((c,u)=>{for(let d=c.length-1;d>=0;d--)if(u(c[d],d,c))return d;return-1})(i,(c=>!c.eq(s)));i.splice(o+1)}return i.forEach(((s,o,c)=>{let u,d;o===0?(d=c[1],u=t?s:c[c.length-1]):o===c.length-1?(u=c[o-1],d=t?s:c[0]):(u=c[o-1],d=c[o+1]),t&&c.length===1?n.push(...new vx(s,s,e).project()):!t||o!==0&&o!==c.length-1?n.push(...new Za(s,u,d,e).project()):n.push(...new vx(s,o===0?d:u,e).project())})),n},Zd=r=>{const e={};return Object.keys(r).forEach((t=>{e[t]={},Object.keys(r[t]).forEach((n=>{e[t][n]=he({},r[t][n])}))})),e},eO=r=>r.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let $o;const qd=r=>{if($o||$o||($o="Intl"in gh()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),$o){const e=$o.segment(r);return Array.from(e).map((t=>{let{segment:n}=t;return n}))}return tO(r)},tO=r=>{const e=[];for(let t,n=0;n<r.length;n++)(t=rO(r,n))!==!1&&e.push(t);return e},rO=(r,e)=>{const t=r.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return r.charAt(e);if(55296<=t&&t<=56319){if(r.length<=e+1)throw"High surrogate without following low surrogate";const i=r.charCodeAt(e+1);if(56320>i||i>57343)throw"High surrogate without following low surrogate";return r.charAt(e)+r.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";const n=r.charCodeAt(e-1);if(55296>n||n>56319)throw"Low surrogate without preceding high surrogate";return!1},Jd=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return r.fill!==e.fill||r.stroke!==e.stroke||r.strokeWidth!==e.strokeWidth||r.fontSize!==e.fontSize||r.fontFamily!==e.fontFamily||r.fontWeight!==e.fontWeight||r.fontStyle!==e.fontStyle||r.textDecorationThickness!==e.textDecorationThickness||r.textBackgroundColor!==e.textBackgroundColor||r.deltaY!==e.deltaY||t&&(r.overline!==e.overline||r.underline!==e.underline||r.linethrough!==e.linethrough)},nO=(r,e)=>{const t=e.split(`
`),n=[];let i=-1,s={};r=Zd(r);for(let o=0;o<t.length;o++){const c=qd(t[o]);if(r[o])for(let u=0;u<c.length;u++){i++;const d=r[o][u];d&&Object.keys(d).length>0&&(Jd(s,d,!0)?n.push({start:i,end:i+1,style:d}):n[n.length-1].end++),s=d||{}}else i+=c.length,s={}}return n},iO=(r,e)=>{if(!Array.isArray(r))return Zd(r);const t=e.split(jd),n={};let i=-1,s=0;for(let o=0;o<t.length;o++){const c=qd(t[o]);for(let u=0;u<c.length;u++)i++,r[s]&&r[s].start<=i&&i<r[s].end&&(n[o]=n[o]||{},n[o][u]=he({},r[s].style),i===r[s].end-1&&s++)}return n},bs=["display","transform",or,"fill-opacity","fill-rule","opacity",nn,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function yx(r,e){const t=r.nodeName,n=r.getAttribute("class"),i=r.getAttribute("id"),s="(?![a-zA-Z\\-]+)";let o;if(o=new RegExp("^"+t,"i"),e=e.replace(o,""),i&&e.length&&(o=new RegExp("#"+i+s,"i"),e=e.replace(o,"")),n&&e.length){const c=n.split(" ");for(let u=c.length;u--;)o=new RegExp("\\."+c[u]+s,"i"),e=e.replace(o,"")}return e.length===0}function sO(r,e){let t=!0;const n=yx(r,e.pop());return n&&e.length&&(t=(function(i,s){let o,c=!0;for(;i.parentElement&&i.parentElement.nodeType===1&&s.length;)c&&(o=s.pop()),c=yx(i=i.parentElement,o);return s.length===0})(r,e)),n&&t&&e.length===0}const aO=r=>{var e;return(e=vF[r])!==null&&e!==void 0?e:r},oO=new RegExp("(".concat(ei,")"),"gi"),lO=r=>sh(r.replace(oO," $1 ").replace(/,/gi," "));var _x,wx,Sx,kx,Cx,Tx,Ex;const Ur="(".concat(ei,")"),cO=String.raw(_x||(_x=vi(["(skewX)(",")"],["(skewX)\\(","\\)"])),Ur),uO=String.raw(wx||(wx=vi(["(skewY)(",")"],["(skewY)\\(","\\)"])),Ur),hO=String.raw(Sx||(Sx=vi(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),Ur,Ur,Ur),fO=String.raw(kx||(kx=vi(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),Ur,Ur),dO=String.raw(Cx||(Cx=vi(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),Ur,Ur),gO=String.raw(Tx||(Tx=vi(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),Ur,Ur,Ur,Ur,Ur,Ur),Qd="(?:".concat(gO,"|").concat(dO,"|").concat(hO,"|").concat(fO,"|").concat(cO,"|").concat(uO,")"),pO="(?:".concat(Qd,"*)"),mO=String.raw(Ex||(Ex=vi(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),pO),xO=new RegExp(mO),vO=new RegExp(Qd),yO=new RegExp(Qd,"g");function rd(r){const e=[];if(!(r=lO(r).replace(/\s*([()])\s*/gi,"$1"))||r&&!xO.test(r))return[...Xr];for(const t of r.matchAll(yO)){const n=vO.exec(t[0]);if(!n)continue;let i=Xr;const s=n.filter((y=>!!y)),[,o,...c]=s,[u,d,h,g,x,m]=c.map((y=>parseFloat(y)));switch(o){case"translate":i=Ll(u,d);break;case zd:i=ao({angle:u},{x:d,y:h});break;case mh:i=Wd(u,d);break;case io:i=Oy(u);break;case so:i=Dy(u);break;case"matrix":i=[u,d,h,g,x,m]}e.push(i)}return Vd(e)}function _O(r,e,t,n){const i=Array.isArray(e);let s,o=e;if(r!==or&&r!==nn||e!==rn){if(r==="strokeUniform")return e==="non-scaling-stroke";if(r==="strokeDashArray")o=e===rn?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(r==="transformMatrix")o=t&&t.transformMatrix?_r(t.transformMatrix,rd(e)):rd(e);else if(r==="visible")o=e!==rn&&e!=="hidden",t&&t.visible===!1&&(o=!1);else if(r==="opacity")o=parseFloat(e),t&&t.opacity!==void 0&&(o*=t.opacity);else if(r==="textAnchor")o=e==="start"?Tt:e==="end"?Kt:gt;else if(r==="charSpacing"||r===ia)s=Ka(e,n)/n*1e3;else if(r==="paintFirst"){const c=e.indexOf(or),u=e.indexOf(nn);o=or,(c>-1&&u>-1&&u<c||c===-1&&u>-1)&&(o=nn)}else{if(r==="href"||r==="xlink:href"||r==="font"||r==="id")return e;if(r==="imageSmoothing")return e==="optimizeQuality";s=i?e.map(Ka):Ka(e,n)}}else o="";return!i&&isNaN(s)?o:s}function wO(r,e){const t=r.match(xF);if(!t)return;const n=t[1],i=t[3],s=t[4],o=t[5],c=t[6];n&&(e.fontStyle=n),i&&(e.fontWeight=isNaN(parseFloat(i))?i:parseFloat(i)),s&&(e.fontSize=Ka(s)),c&&(e.fontFamily=c),o&&(e.lineHeight=o==="normal"?1:o)}function SO(r,e){r.replace(/;\s*$/,"").split(";").forEach((t=>{if(!t)return;const[n,i]=t.split(":");e[n.trim().toLowerCase()]=i.trim()}))}function kO(r){const e={},t=r.getAttribute("style");return t&&(typeof t=="string"?SO(t,e):(function(n,i){Object.entries(n).forEach((s=>{let[o,c]=s;c!==void 0&&(i[o.toLowerCase()]=c)}))})(t,e)),e}const CO={stroke:"strokeOpacity",fill:"fillOpacity"};function Yi(r,e,t){if(!r)return{};let n,i={},s=Bd;r.parentNode&&hx.test(r.parentNode.nodeName)&&(i=Yi(r.parentElement,e,t),i.fontSize&&(n=s=Ka(i.fontSize)));const o=he(he(he({},e.reduce(((d,h)=>{const g=r.getAttribute(h);return g&&(d[h]=g),d}),{})),(function(d){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g={};for(const x in h)sO(d,x.split(" "))&&(g=he(he({},g),h[x]));return g})(r,t)),kO(r));o[Ff]&&r.setAttribute(Ff,o[Ff]),o[bf]&&(n=Ka(o[bf],s),o[bf]="".concat(n));const c={};for(const d in o){const h=aO(d),g=_O(h,o[d],i,n);c[h]=g}c&&c.font&&wO(c.font,c);const u=he(he({},i),c);return hx.test(r.nodeName)?u:(function(d){const h=Mr.getDefaults();return Object.entries(CO).forEach((g=>{let[x,m]=g;if(d[m]===void 0||d[x]==="")return;if(d[x]===void 0){if(!h[x])return;d[x]=h[x]}if(d[x].indexOf("url(")===0)return;const y=new At(d[x]);d[x]=y.setAlpha(Dt(y.getAlpha()*d[m],2)).toRgba()})),d})(u)}const TO=["left","top","width","height","visible"],r2=["rx","ry"];class hi extends Mr{static getDefaults(){return he(he({},super.getDefaults()),hi.ownDefaults)}constructor(e){super(),Object.assign(this,hi.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){const{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){const{width:t,height:n}=this,i=-t/2,s=-n/2,o=this.rx?Math.min(this.rx,t/2):0,c=this.ry?Math.min(this.ry,n/2):0,u=o!==0||c!==0;e.beginPath(),e.moveTo(i+o,s),e.lineTo(i+t-o,s),u&&e.bezierCurveTo(i+t-ms*o,s,i+t,s+ms*c,i+t,s+c),e.lineTo(i+t,s+n-c),u&&e.bezierCurveTo(i+t,s+n-ms*c,i+t-ms*o,s+n,i+t-o,s+n),e.lineTo(i+o,s+n),u&&e.bezierCurveTo(i+ms*o,s+n,i,s+n-ms*c,i,s+n-c),e.lineTo(i,s+c),u&&e.bezierCurveTo(i,s+ms*c,i+ms*o,s,i+o,s),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...r2,...e])}_toSVG(){const{width:e,height:t,rx:n,ry:i}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-t/2,'" rx="').concat(n,'" ry="').concat(i,'" width="').concat(e,'" height="').concat(t,`" />
`)]}static async fromElement(e,t,n){const i=Yi(e,this.ATTRIBUTE_NAMES,n),{left:s=0,top:o=0,width:c=0,height:u=0,visible:d=!0}=i,h=It(i,TO);return new this(he(he(he({},t),h),{},{left:s,top:o,width:c,height:u,visible:!!(d&&c&&u)}))}}ue(hi,"type","Rect"),ue(hi,"cacheProperties",[...Gi,...r2]),ue(hi,"ownDefaults",{rx:0,ry:0}),ue(hi,"ATTRIBUTE_NAMES",[...bs,"x","y","rx","ry","width","height"]),Qe.setClass(hi),Qe.setSVGClass(hi);const Ni="initialization",oh="added",eg="removed",lh="imperative",n2=(r,e)=>{const{strokeUniform:t,strokeWidth:n,width:i,height:s,group:o}=e,c=o&&o!==r?yh(o.calcTransformMatrix(),r.calcTransformMatrix()):null,u=c?e.getRelativeCenterPoint().transform(c):e.getRelativeCenterPoint(),d=!e.isStrokeAccountedForInDimensions(),h=t&&d?uF(new Ce(n,n),void 0,r.calcTransformMatrix()):Ud,g=!t&&d?n:0,x=Xd(i+g,s+g,Vd([c,e.calcOwnMatrix()],!0)).add(h).scalarDivide(2);return[u.subtract(x),u.add(x)]};class Sh{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){let{type:t,prevStrategy:n,strategy:i}=e;return t===Ni||t===lh||!!n&&i!==n}shouldLayoutClipPath(e){let{type:t,target:{clipPath:n}}=e;return t!==Ni&&n&&!n.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){const{type:n,target:i}=t;if(n===lh&&t.overrides)return t.overrides;if(e.length===0)return;const{left:s,top:o,width:c,height:u}=Bi(e.map((g=>n2(i,g))).reduce(((g,x)=>g.concat(x)),[])),d=new Ce(c,u),h=new Ce(s,o).add(d.scalarDivide(2));if(n===Ni){const g=this.getInitialSize(t,{size:d,center:h});return{center:h,relativeCorrection:new Ce(0,0),size:g}}return{center:h.transform(i.calcOwnMatrix()),size:d}}}ue(Sh,"type","strategy");class nd extends Sh{shouldPerformLayout(e){return!0}}ue(nd,"type","fit-content"),Qe.setClass(nd);const EO=["strategy"],AO=["target","strategy","bubbles","prevStrategy"],i2="layoutManager";class Fl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new nd;ue(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){const t=he(he({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);const n=this.getLayoutResult(t);n&&this.commitLayout(t,n),this.onAfterLayout(t,n),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){const{target:n}=t;return[eh,wy,Cl,Sy,ph,ky,Qu,Kb,Zb].map((i=>e.on(i,(s=>this.performLayout(i===eh?{type:"object_modified",trigger:i,e:s,target:n}:{type:"object_modifying",trigger:i,e:s,target:n})))))}subscribe(e,t){this.unsubscribe(e,t);const n=this.attachHandlers(e,t);this._subscriptions.set(e,n)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach((n=>n())),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach((t=>this.unsubscribe(t,e)))}subscribeTargets(e){e.targets.forEach((t=>this.subscribe(t,e)))}onBeforeLayout(e){const{target:t,type:n}=e,{canvas:i}=t;if(n===Ni||n===oh?this.subscribeTargets(e):n===eg&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),i&&i.fire("object:layout:before",{target:t,context:e}),n===lh&&e.deep){const s=It(e,EO);t.forEachObject((o=>o.layoutManager&&o.layoutManager.performLayout(he(he({},s),{},{bubbles:!1,target:o}))))}}getLayoutResult(e){const{target:t,strategy:n,type:i}=e,s=n.calcLayoutResult(e,t.getObjects());if(!s)return;const o=i===Ni?new Ce:t.getRelativeCenterPoint(),{center:c,correction:u=new Ce,relativeCorrection:d=new Ce}=s,h=o.subtract(c).add(u).transform(i===Ni?Xr:Qn(t.calcOwnMatrix()),!0).add(d);return{result:s,prevCenter:o,nextCenter:c,offset:h}}commitLayout(e,t){const{target:n}=e,{result:{size:i},nextCenter:s}=t;var o,c;n.set({width:i.x,height:i.y}),this.layoutObjects(e,t),e.type===Ni?n.set({left:(o=e.x)!==null&&o!==void 0?o:s.x+i.x*tr(n.originX),top:(c=e.y)!==null&&c!==void 0?c:s.y+i.y*tr(n.originY)}):(n.setPositionByOrigin(s,gt,gt),n.setCoords(),n.set("dirty",!0))}layoutObjects(e,t){const{target:n}=e;n.forEachObject((i=>{i.group===n&&this.layoutObject(e,t,i)})),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,n.clipPath)}layoutObject(e,t,n){let{offset:i}=t;n.set({left:n.left+i.x,top:n.top+i.y})}onAfterLayout(e,t){const{target:n,strategy:i,bubbles:s,prevStrategy:o}=e,c=It(e,AO),{canvas:u}=n;n.fire("layout:after",{context:e,result:t}),u&&u.fire("object:layout:after",{context:e,result:t,target:n});const d=n.parent;s&&d!=null&&d.layoutManager&&((c.path||(c.path=[])).push(n),d.layoutManager.performLayout(he(he({},c),{},{target:d}))),n.set("dirty",!0)}dispose(){const{_subscriptions:e}=this;e.forEach((t=>t.forEach((n=>n())))),e.clear()}toObject(){return{type:i2,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}Qe.setClass(Fl,i2);const bO=["type","objects","layoutManager"];class FO extends Fl{performLayout(){}}class ea extends Cy(Mr){static getDefaults(){return he(he({},super.getDefaults()),ea.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),ue(this,"_activeObjects",[]),ue(this,"__objectSelectionTracker",void 0),ue(this,"__objectSelectionDisposer",void 0),Object.assign(this,ea.ownDefaults),this.setOptions(t),this.groupInit(e,t)}groupInit(e,t){var n;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject((i=>{this.enterGroup(i,!1)})),this.layoutManager=(n=t.layoutManager)!==null&&n!==void 0?n:new Fl,this.layoutManager.performLayout({type:Ni,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(Ts("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(Ts("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter(((t,n,i)=>this.canEnterGroup(t)&&i.indexOf(t)===n))}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=this._filterObjectsBeforeEnteringGroup(t),s=super.add(...i);return this._onAfterObjectsChange(oh,i),s}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const s=this._filterObjectsBeforeEnteringGroup(n),o=super.insertAt(e,...s);return this._onAfterObjectsChange(oh,s),o}remove(){const e=super.remove(...arguments);return this._onAfterObjectsChange(eg,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){const n=this[e];return super._set(e,t),e==="canvas"&&n!==t&&(this._objects||[]).forEach((i=>{i._set(e,t)})),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:n}=t;const i=this._activeObjects;if(e)i.push(n),this._set("dirty",!0);else if(i.length>0){const s=i.indexOf(n);s>-1&&(i.splice(s,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&nh(e,_r(Qn(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);const n=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();n&&(n===e||e.isDescendantOf(n))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(nh(e,_r(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);const n=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;n>-1&&this._activeObjects.splice(n,1)}shouldCache(){const e=Mr.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,t,n){this._renderBackground(e);for(let s=0;s<this._objects.length;s++){var i;const o=this._objects[s];(i=this.canvas)!==null&&i!==void 0&&i.preserveObjectStacking&&o.group!==this?(e.save(),e.transform(...Qn(this.calcTransformMatrix())),o.render(e),e.restore()):o.group===this&&o.render(e)}this._drawClipPath(e,this.clipPath,n)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject((e=>e.setCoords()))}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(he({target:this,type:lh},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){const n=this.includeDefaultValues;return this._objects.filter((function(i){return!i.excludeFromExport})).map((function(i){const s=i.includeDefaultValues;i.includeDefaultValues=n;const o=i[e||"toObject"](t);return i.includeDefaultValues=s,o}))}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.layoutManager.toObject();return he(he(he({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject((e=>{this._watchObject(!1,e),e.dispose()})),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";const t=hi.prototype._toSVG.call(this),n=t.indexOf("COMMON_PARTS");t[n]='for="group" ';const i=t.join("");return e?e(i):i}_toSVG(e){const t=["<g ","COMMON_PARTS",` >
`],n=this._createSVGBgRect(e);n&&t.push("		",n);for(let i=0;i<this._objects.length;i++)t.push("		",this._objects[i].toSVG(e));return t.push(`</g>
`),t}getSvgStyles(){const e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){const t=[],n=this._createSVGBgRect(e);n&&t.push("	",n);for(let i=0;i<this._objects.length;i++)t.push("	",this._objects[i].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e,t){let{type:n,objects:i=[],layoutManager:s}=e,o=It(e,bO);return Promise.all([Tl(i,t),vh(o,t)]).then((c=>{let[u,d]=c;const h=new this(u,he(he(he({},o),d),{},{layoutManager:new FO}));if(s){const g=Qe.getClass(s.type),x=Qe.getClass(s.strategy);h.layoutManager=new g(new x)}else h.layoutManager=new Fl;return h.layoutManager.subscribeTargets({type:Ni,target:h,targets:h.getObjects()}),h.setCoords(),h}))}}ue(ea,"type","Group"),ue(ea,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),Qe.setClass(ea);const OO=(r,e)=>Math.min(e.width/r.width,e.height/r.height),DO=(r,e)=>Math.max(e.width/r.width,e.height/r.height),id="\\s*,?\\s*",Ko="".concat(id,"(").concat(ei,")"),PO="".concat(Ko).concat(Ko).concat(Ko).concat(id,"([01])").concat(id,"([01])").concat(Ko).concat(Ko),MO={m:"l",M:"L"},NO=(r,e,t,n,i,s,o,c,u,d,h)=>{const g=Ui(r),x=Vi(r),m=Ui(e),y=Vi(e),v=t*i*m-n*s*y+o,_=n*i*m+t*s*y+c;return["C",d+u*(-t*i*x-n*s*g),h+u*(-n*i*x+t*s*g),v+u*(t*i*y+n*s*m),_+u*(n*i*y-t*s*m),v,_]},Ax=(r,e,t,n)=>{const i=Math.atan2(e,r),s=Math.atan2(n,t);return s>=i?s-i:2*Math.PI-(i-s)};function bx(r,e,t,n,i,s,o,c){let u;if(kt.cachesBoundsOfCurve&&(u=[...arguments].join(),hl.boundsOfCurveCache[u]))return hl.boundsOfCurveCache[u];const d=Math.sqrt,h=Math.abs,g=[],x=[[0,0],[0,0]];let m=6*r-12*t+6*i,y=-3*r+9*t-9*i+3*o,v=3*t-3*r;for(let A=0;A<2;++A){if(A>0&&(m=6*e-12*n+6*s,y=-3*e+9*n-9*s+3*c,v=3*n-3*e),h(y)<1e-12){if(h(m)<1e-12)continue;const B=-v/m;0<B&&B<1&&g.push(B);continue}const P=m*m-4*v*y;if(P<0)continue;const N=d(P),O=(-m+N)/(2*y);0<O&&O<1&&g.push(O);const V=(-m-N)/(2*y);0<V&&V<1&&g.push(V)}let _=g.length;const S=_,T=s2(r,e,t,n,i,s,o,c);for(;_--;){const{x:A,y:P}=T(g[_]);x[0][_]=A,x[1][_]=P}x[0][S]=r,x[1][S]=e,x[0][S+1]=o,x[1][S+1]=c;const C=[new Ce(Math.min(...x[0]),Math.min(...x[1])),new Ce(Math.max(...x[0]),Math.max(...x[1]))];return kt.cachesBoundsOfCurve&&(hl.boundsOfCurveCache[u]=C),C}const IO=(r,e,t)=>{let[n,i,s,o,c,u,d,h]=t;const g=((x,m,y,v,_,S,T)=>{if(y===0||v===0)return[];let C=0,A=0,P=0;const N=Math.PI,O=T*Ld,V=Vi(O),B=Ui(O),te=.5*(-B*x-V*m),ie=.5*(-B*m+V*x),D=y**2,J=v**2,F=ie**2,se=te**2,Ee=D*J-D*F-J*se;let le=Math.abs(y),xe=Math.abs(v);if(Ee<0){const De=Math.sqrt(1-Ee/(D*J));le*=De,xe*=De}else P=(_===S?-1:1)*Math.sqrt(Ee/(D*F+J*se));const X=P*le*ie/xe,pe=-P*xe*te/le,R=B*X-V*pe+.5*x,b=V*X+B*pe+.5*m;let ee=Ax(1,0,(te-X)/le,(ie-pe)/xe),G=Ax((te-X)/le,(ie-pe)/xe,(-te-X)/le,(-ie-pe)/xe);S===0&&G>0?G-=2*N:S===1&&G<0&&(G+=2*N);const H=Math.ceil(Math.abs(G/N*2)),me=[],Me=G/H,Fe=8/3*Math.sin(Me/4)*Math.sin(Me/4)/Math.sin(Me/2);let be=ee+Me;for(let De=0;De<H;De++)me[De]=NO(ee,be,B,V,le,xe,R,b,Fe,C,A),C=me[De][5],A=me[De][6],ee=be,be+=Me;return me})(d-r,h-e,i,s,c,u,o);for(let x=0,m=g.length;x<m;x++)g[x][1]+=r,g[x][2]+=e,g[x][3]+=r,g[x][4]+=e,g[x][5]+=r,g[x][6]+=e;return g},RO=r=>{let e=0,t=0,n=0,i=0;const s=[];let o,c=0,u=0;for(const d of r){const h=[...d];let g;switch(h[0]){case"l":h[1]+=e,h[2]+=t;case"L":e=h[1],t=h[2],g=["L",e,t];break;case"h":h[1]+=e;case"H":e=h[1],g=["L",e,t];break;case"v":h[1]+=t;case"V":t=h[1],g=["L",e,t];break;case"m":h[1]+=e,h[2]+=t;case"M":e=h[1],t=h[2],n=h[1],i=h[2],g=["M",e,t];break;case"c":h[1]+=e,h[2]+=t,h[3]+=e,h[4]+=t,h[5]+=e,h[6]+=t;case"C":c=h[3],u=h[4],e=h[5],t=h[6],g=["C",h[1],h[2],c,u,e,t];break;case"s":h[1]+=e,h[2]+=t,h[3]+=e,h[4]+=t;case"S":o==="C"?(c=2*e-c,u=2*t-u):(c=e,u=t),e=h[3],t=h[4],g=["C",c,u,h[1],h[2],e,t],c=g[3],u=g[4];break;case"q":h[1]+=e,h[2]+=t,h[3]+=e,h[4]+=t;case"Q":c=h[1],u=h[2],e=h[3],t=h[4],g=["Q",c,u,e,t];break;case"t":h[1]+=e,h[2]+=t;case"T":o==="Q"?(c=2*e-c,u=2*t-u):(c=e,u=t),e=h[1],t=h[2],g=["Q",c,u,e,t];break;case"a":h[6]+=e,h[7]+=t;case"A":IO(e,t,h).forEach((x=>s.push(x))),e=h[6],t=h[7];break;case"z":case"Z":e=n,t=i,g=["Z"]}g?(s.push(g),o=g[0]):o=""}return s},ch=(r,e,t,n)=>Math.sqrt((t-r)**2+(n-e)**2),s2=(r,e,t,n,i,s,o,c)=>u=>{const d=u**3,h=(m=>3*m**2*(1-m))(u),g=(m=>3*m*(1-m)**2)(u),x=(m=>(1-m)**3)(u);return new Ce(o*d+i*h+t*g+r*x,c*d+s*h+n*g+e*x)},a2=r=>r**2,o2=r=>2*r*(1-r),l2=r=>(1-r)**2,LO=(r,e,t,n,i,s,o,c)=>u=>{const d=a2(u),h=o2(u),g=l2(u),x=3*(g*(t-r)+h*(i-t)+d*(o-i)),m=3*(g*(n-e)+h*(s-n)+d*(c-s));return Math.atan2(m,x)},BO=(r,e,t,n,i,s)=>o=>{const c=a2(o),u=o2(o),d=l2(o);return new Ce(i*c+t*u+r*d,s*c+n*u+e*d)},jO=(r,e,t,n,i,s)=>o=>{const c=1-o,u=2*(c*(t-r)+o*(i-t)),d=2*(c*(n-e)+o*(s-n));return Math.atan2(d,u)},Fx=(r,e,t)=>{let n=new Ce(e,t),i=0;for(let s=1;s<=100;s+=1){const o=r(s/100);i+=ch(n.x,n.y,o.x,o.y),n=o}return i},zO=(r,e)=>{let t,n=0,i=0,s={x:r.x,y:r.y},o=he({},s),c=.01,u=0;const d=r.iterator,h=r.angleFinder;for(;i<e&&c>1e-4;)o=d(n),u=n,t=ch(s.x,s.y,o.x,o.y),t+i>e?(n-=c,c/=2):(s=o,n+=c,i+=t);return he(he({},o),{},{angle:h(u)})},c2=r=>{let e,t,n=0,i=0,s=0,o=0,c=0;const u=[];for(const d of r){const h={x:i,y:s,command:d[0],length:0};switch(d[0]){case"M":t=h,t.x=o=i=d[1],t.y=c=s=d[2];break;case"L":t=h,t.length=ch(i,s,d[1],d[2]),i=d[1],s=d[2];break;case"C":e=s2(i,s,d[1],d[2],d[3],d[4],d[5],d[6]),t=h,t.iterator=e,t.angleFinder=LO(i,s,d[1],d[2],d[3],d[4],d[5],d[6]),t.length=Fx(e,i,s),i=d[5],s=d[6];break;case"Q":e=BO(i,s,d[1],d[2],d[3],d[4]),t=h,t.iterator=e,t.angleFinder=jO(i,s,d[1],d[2],d[3],d[4]),t.length=Fx(e,i,s),i=d[3],s=d[4];break;case"Z":t=h,t.destX=o,t.destY=c,t.length=ch(i,s,o,c),i=o,s=c}n+=t.length,u.push(t)}return u.push({length:n,x:i,y:s}),u},UO=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:c2(r),n=0;for(;e-t[n].length>0&&n<t.length-2;)e-=t[n].length,n++;const i=t[n],s=e/i.length,o=r[n];switch(i.command){case"M":return{x:i.x,y:i.y,angle:0};case"Z":return he(he({},new Ce(i.x,i.y).lerp(new Ce(i.destX,i.destY),s)),{},{angle:Math.atan2(i.destY-i.y,i.destX-i.x)});case"L":return he(he({},new Ce(i.x,i.y).lerp(new Ce(o[1],o[2]),s)),{},{angle:Math.atan2(o[2]-i.y,o[1]-i.x)});case"C":case"Q":return zO(i,e)}},VO=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),Ox=new RegExp(PO,"g"),WO=new RegExp(ei,"gi"),HO={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},XO=r=>{var e;const t=[],n=(e=r.match(VO))!==null&&e!==void 0?e:[];for(const i of n){const s=i[0];if(s==="z"||s==="Z"){t.push([s]);continue}const o=HO[s.toLowerCase()];let c=[];if(s==="a"||s==="A"){Ox.lastIndex=0;for(let u=null;u=Ox.exec(i);)c.push(...u.slice(1))}else c=i.match(WO)||[];for(let u=0;u<c.length;u+=o){const d=new Array(o),h=MO[s];d[0]=u>0&&h?h:s;for(let g=0;g<o;g++)d[g+1]=parseFloat(c[u+g]);t.push(d)}}return t},GO=(r,e)=>r.map((t=>t.map(((n,i)=>i===0||e===void 0?n:Dt(n,e))).join(" "))).join(" ");function sd(r,e){const t=r.style;t&&e&&(typeof e=="string"?t.cssText+=";"+e:Object.entries(e).forEach((n=>{let[i,s]=n;return t.setProperty(i,s)})))}class YO extends Iy{constructor(e){let{allowTouchScrolling:t=!1,containerClass:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),ue(this,"upper",void 0),ue(this,"container",void 0);const{el:i}=this.lower,s=this.createUpperCanvas();this.upper={el:s,ctx:s.getContext("2d")},this.applyCanvasStyle(i,{allowTouchScrolling:t}),this.applyCanvasStyle(s,{allowTouchScrolling:t,styles:{position:"absolute",left:"0",top:"0"}});const o=this.createContainerElement();o.classList.add(n),i.parentNode&&i.parentNode.replaceChild(o,i),o.append(i,s),this.container=o}createUpperCanvas(){const{el:e}=this.lower,t=Wi();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){const e=no().createElement("div");return e.setAttribute("data-fabric","wrapper"),sd(e,{position:"relative"}),tx(e),e}applyCanvasStyle(e,t){const{styles:n,allowTouchScrolling:i}=t;sd(e,he(he({},n),{},{"touch-action":i?"manipulation":rn})),tx(e)}setDimensions(e,t){super.setDimensions(e,t);const{el:n,ctx:i}=this.upper;Ny(n,i,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),qf(this.upper.el,e),qf(this.container,e)}cleanupDOM(e){const t=this.container,{el:n}=this.lower,{el:i}=this.upper;super.cleanupDOM(e),t.removeChild(i),t.removeChild(n),t.parentNode&&t.parentNode.replaceChild(n,t)}dispose(){super.dispose(),pi().dispose(this.upper.el),delete this.upper,delete this.container}}class kh extends Bl{constructor(){super(...arguments),ue(this,"targets",[]),ue(this,"_hoveredTargets",[]),ue(this,"_currentTransform",null),ue(this,"_groupSelector",null),ue(this,"contextTopDirty",!1)}static getDefaults(){return he(he({},super.getDefaults()),kh.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new YO(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter((t=>!t.group&&t!==e)).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){const e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;const t=this.getRetinaScaling(),n=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=n,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,n){const i=this.targetFindTolerance,s=this.pixelFindContext;this.clearContext(s),s.save(),s.translate(-t+i,-n+i),s.transform(...this.viewportTransform);const o=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(s),e.selectionBackgroundColor=o,s.restore();const c=Math.round(i*this.getRetinaScaling());return qF(s,c,c,c)}_isSelectionKeyPressed(e){const t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find((n=>!!n&&e[n]===!0)):e[t])}_shouldClearSelection(e,t){const n=this.getActiveObjects(),i=this._activeObject;return!!(!t||t&&i&&n.length>1&&n.indexOf(t)===-1&&i!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&i&&i!==t)}_shouldCenterTransform(e,t,n){if(!e)return;let i;return t===mh||t===sn||t===Dn||t===Cl?i=this.centeredScaling||e.centeredScaling:t===zd&&(i=this.centeredRotation||e.centeredRotation),i?!n:n}_getOriginFromCorner(e,t){const n={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?n.x=Kt:["mr","tr","br"].includes(t)&&(n.x=Tt),["tl","mt","tr"].includes(t)?n.y=Zf:["bl","mb","br"].includes(t)&&(n.y=tn)),n}_setupCurrentTransform(e,t,n){var i;const s=t.group?$a(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:o="",control:c}=t.getActiveControl()||{},u=n&&c?(i=c.getActionHandler(e,t,c))===null||i===void 0?void 0:i.bind(c):dF,d=((m,y,v,_)=>{if(!y||!m)return"drag";const S=_.controls[y];return S.getActionName(v,S,_)})(n,o,e,t),h=e[this.centeredKey],g=this._shouldCenterTransform(t,d,h)?{x:gt,y:gt}:this._getOriginFromCorner(t,o),x={target:t,action:d,actionHandler:u,actionPerformed:!1,corner:o,scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,offsetX:s.x-t.left,offsetY:s.y-t.top,originX:g.x,originY:g.y,ex:s.x,ey:s.y,lastX:s.x,lastY:s.y,theta:Zt(t.angle),width:t.width,height:t.height,shiftKey:e.shiftKey,altKey:h,original:he(he({},Ry(t)),{},{originX:g.x,originY:g.y})};this._currentTransform=x,this.fire("before:transform",{e,transform:x})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){const{x:t,y:n,deltaX:i,deltaY:s}=this._groupSelector,o=new Ce(t,n).transform(this.viewportTransform),c=new Ce(t+i,n+s).transform(this.viewportTransform),u=this.selectionLineWidth/2;let d=Math.min(o.x,c.x),h=Math.min(o.y,c.y),g=Math.max(o.x,c.x),x=Math.max(o.y,c.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(d,h,g-d,x-h)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,d+=u,h+=u,g-=u,x-=u,Mr.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(d,h,g-d,x-h))}findTarget(e){if(this.skipTargetFind)return;const t=this.getViewportPoint(e),n=this._activeObject,i=this.getActiveObjects();if(this.targets=[],n&&i.length>=1){if(n.findControl(t,Jf(e))||i.length>1&&this.searchPossibleTargets([n],t))return n;if(n===this.searchPossibleTargets([n],t)){if(this.preserveObjectStacking){const s=this.targets;this.targets=[];const o=this.searchPossibleTargets(this._objects,t);return e[this.altSelectionKey]&&o&&o!==n?(this.targets=s,n):o}return n}}return this.searchPossibleTargets(this._objects,t)}_pointIsInObjectSelectionArea(e,t){let n=e.getCoords();const i=this.getZoom(),s=e.padding/i;if(s){const[o,c,u,d]=n,h=Math.atan2(c.y-o.y,c.x-o.x),g=Ui(h)*s,x=Vi(h)*s,m=g+x,y=g-x;n=[new Ce(o.x-y,o.y-m),new Ce(c.x+m,c.y-y),new Ce(u.x+y,u.y+m),new Ce(d.x-m,d.y+y)]}return zt.isPointInPolygon(t,n)}_checkTarget(e,t){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,$a(t,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,t.x,t.y)))}_searchPossibleTargets(e,t){let n=e.length;for(;n--;){const i=e[n];if(this._checkTarget(i,t)){if(Lu(i)&&i.subTargetCheck){const s=this._searchPossibleTargets(i._objects,t);s&&this.targets.push(s)}return i}}}searchPossibleTargets(e,t){const n=this._searchPossibleTargets(e,t);if(n&&Lu(n)&&n.interactive&&this.targets[0]){const i=this.targets;for(let s=i.length-1;s>0;s--){const o=i[s];if(!Lu(o)||!o.interactive)return o}return i[0]}return n}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const n=this.upperCanvasEl,i=n.getBoundingClientRect();let s=aF(e),o=i.width||0,c=i.height||0;o&&c||(tn in i&&Zf in i&&(c=Math.abs(i.top-i.bottom)),Kt in i&&Tt in i&&(o=Math.abs(i.right-i.left))),this.calcOffset(),s.x=s.x-this._offset.left,s.y=s.y-this._offset.top,t||(s=$a(s,void 0,this.viewportTransform));const u=this.getRetinaScaling();u!==1&&(s.x/=u,s.y/=u);const d=o===0||c===0?new Ce(1,1):new Ce(n.width/o,n.height/c);return s.multiply(d)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=Wi(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const e=this._activeObject;return Gs(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let n=!1,i=!1;const s=this.getActiveObjects(),o=[],c=[];e.forEach((u=>{s.includes(u)||(n=!0,u.fire("deselected",{e:t,target:u}),c.push(u))})),s.forEach((u=>{e.includes(u)||(n=!0,u.fire("selected",{e:t,target:u}),o.push(u))})),e.length>0&&s.length>0?(i=!0,n&&this.fire("selection:updated",{e:t,selected:o,deselected:c})):s.length>0?(i=!0,this.fire("selection:created",{e:t,selected:o})):e.length>0&&(i=!0,this.fire("selection:cleared",{e:t,deselected:c})),i&&(this._objectsToRender=void 0)}setActiveObject(e,t){const n=this.getActiveObjects(),i=this._setActiveObject(e,t);return this._fireSelectionEvents(n,t),i}_setActiveObject(e,t){const n=this._activeObject;return n!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,Gs(e)&&n!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,t){const n=this._activeObject;return!!n&&!n.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===n&&this.endCurrentTransform(e),Gs(n)&&n===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){const t=this.getActiveObjects(),n=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[n]});const i=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),i}endCurrentTransform(e){const t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){const t=this._currentTransform,n=t.target,i={e,target:n,transform:t,action:t.action};n._scaling&&(n._scaling=!1),n.setCoords(),t.actionPerformed&&(this.fire("object:modified",i),n.fire(eh,i))}setViewportTransform(e){super.setViewportTransform(e);const t=this._activeObject;t&&t.setCoords()}destroy(){const e=this._activeObject;Gs(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){const t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,n){const i=this._realizeGroupTransformOnObject(e),s=super._toObject(e,t,n);return e.set(i),s}_realizeGroupTransformOnObject(e){const{group:t}=e;if(t&&Gs(t)&&this._activeObject===t){const n=oo(e,["angle","flipX","flipY",Tt,sn,Dn,io,so,tn]);return lF(e,t.calcOwnMatrix()),n}return{}}_setSVGObject(e,t,n){const i=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,n),t.set(i)}}ue(kh,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class $O{constructor(e){ue(this,"targets",[]),ue(this,"__disposer",void 0);const t=()=>{const{hiddenTextarea:i}=e.getActiveObject()||{};i&&i.focus()},n=e.upperCanvasEl;n.addEventListener("click",t),this.__disposer=()=>n.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach((e=>{e.isEditing&&e.exitEditing()}))}add(e){this.targets.push(e)}remove(e){this.unregister(e),za(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const KO=["target","oldTarget","fireCanvas","e"],un={passive:!1},Ba=(r,e)=>{const t=r.getViewportPoint(e),n=r.getScenePoint(e);return{viewportPoint:t,scenePoint:n,pointer:t,absolutePointer:n}},xs=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return r.addEventListener(...t)},Tn=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return r.removeEventListener(...t)},ZO={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class ad extends kh{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),ue(this,"_isClick",void 0),ue(this,"textEditingManager",new $O(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach((t=>{this[t]=this[t].bind(this)})),this.addOrRemove(xs,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,t){const n=this.upperCanvasEl,i=this._getEventPrefix();e(My(n),"resize",this._onResize),e(n,i+"down",this._onMouseDown),e(n,"".concat(i,"move"),this._onMouseMove,un),e(n,"".concat(i,"out"),this._onMouseOut),e(n,"".concat(i,"enter"),this._onMouseEnter),e(n,"wheel",this._onMouseWheel,{passive:!1}),e(n,"contextmenu",this._onContextMenu),e(n,"click",this._onClick),e(n,"dblclick",this._onClick),e(n,"dragstart",this._onDragStart),e(n,"dragend",this._onDragEnd),e(n,"dragover",this._onDragOver),e(n,"dragenter",this._onDragEnter),e(n,"dragleave",this._onDragLeave),e(n,"drop",this._onDrop),this.enablePointerEvents||e(n,"touchstart",this._onTouchStart,un)}removeListeners(){this.addOrRemove(Tn,"remove");const e=this._getEventPrefix(),t=Zn(this.upperCanvasEl);Tn(t,"".concat(e,"up"),this._onMouseUp),Tn(t,"touchend",this._onTouchEnd,un),Tn(t,"".concat(e,"move"),this._onMouseMove,un),Tn(t,"touchmove",this._onMouseMove,un),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){const t=this._hoveredTarget,n=he({e},Ba(this,e));this.fire("mouse:out",he(he({},n),{},{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",he({},n)),this._hoveredTargets.forEach((i=>{this.fire("mouse:out",he(he({},n),{},{target:i})),i&&i.fire("mouseout",he({},n))})),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",he({e},Ba(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;const t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;const n={e,target:t};return this.fire("dragstart",n),t.fire("dragstart",n),void xs(this.upperCanvasEl,"drag",this._onDragProgress)}rx(e)}_renderDragEffects(e,t,n){let i=!1;const s=this._dropTarget;s&&s!==t&&s!==n&&(s.clearContextTop(),i=!0),t==null||t.clearContextTop(),n!==t&&(n==null||n.clearContextTop());const o=this.contextTop;o.save(),o.transform(...this.viewportTransform),t&&(o.save(),t.transform(o),t.renderDragSourceEffect(e),o.restore(),i=!0),n&&(o.save(),n.transform(o),n.renderDropTargetEffect(e),o.restore(),i=!0),o.restore(),i&&(this.contextTopDirty=!0)}_onDragEnd(e){const t=!!e.dataTransfer&&e.dataTransfer.dropEffect!==rn,n=t?this._activeObject:void 0,i={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:t,dropTarget:n};Tn(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",i),this._dragSource&&this._dragSource.fire("dragend",i),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){const t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){const t="dragover",{target:n,targets:i}=this.findDragTargets(e),s=this._dragSource,o={e,target:n,subTargets:i,dragSource:s,canDrop:!1,dropTarget:void 0};let c;this.fire(t,o),this._fireEnterLeaveEvents(n,o),n&&(n.canDrop(e)&&(c=n),n.fire(t,o));for(let u=0;u<i.length;u++){const d=i[u];d.canDrop(e)&&(c=d),d.fire(t,o)}this._renderDragEffects(e,s,c),this._dropTarget=c}_onDragEnter(e){const{target:t,targets:n}=this.findDragTargets(e),i={e,target:t,subTargets:n,dragSource:this._dragSource};this.fire("dragenter",i),this._fireEnterLeaveEvents(t,i)}_onDragLeave(e){const t={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",t),this._fireEnterLeaveEvents(void 0,t),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){const{target:t,targets:n}=this.findDragTargets(e),i=this._basicEventHandler("drop:before",he({e,target:t,subTargets:n,dragSource:this._dragSource},Ba(this,e)));i.didDrop=!1,i.dropTarget=void 0,this._basicEventHandler("drop",i),this.fire("drop:after",i)}_onContextMenu(e){const t=this.findTarget(e),n=this.targets||[],i=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:n});return this.stopContextMenu&&rx(e),this._basicEventHandler("contextmenu",i),!1}_onClick(e){const t=e.detail;t>3||t<2||(this._cacheTransformEventData(e),t==2&&e.type==="dblclick"&&this._handleEvent(e,"dblclick"),t==3&&this._handleEvent(e,"tripleclick"),this._resetTransformEventData())}getPointerId(e){const t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){let t=!this.allowTouchScrolling;const n=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),(this.isDrawingMode||n&&this._target===n)&&(t=!0),t&&e.preventDefault(),this._resetTransformEventData();const i=this.upperCanvasEl,s=this._getEventPrefix(),o=Zn(i);xs(o,"touchend",this._onTouchEnd,un),t&&xs(o,"touchmove",this._onMouseMove,un),Tn(i,"".concat(s,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();const t=this.upperCanvasEl,n=this._getEventPrefix();Tn(t,"".concat(n,"move"),this._onMouseMove,un);const i=Zn(t);xs(i,"".concat(n,"up"),this._onMouseUp),xs(i,"".concat(n,"move"),this._onMouseMove,un)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;const t=this._getEventPrefix(),n=Zn(this.upperCanvasEl);Tn(n,"touchend",this._onTouchEnd,un),Tn(n,"touchmove",this._onMouseMove,un),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout((()=>{xs(this.upperCanvasEl,"".concat(t,"down"),this._onMouseDown),this._willAddMouseDown=0}),400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();const t=this.upperCanvasEl,n=this._getEventPrefix();if(this._isMainEvent(e)){const i=Zn(this.upperCanvasEl);Tn(i,"".concat(n,"up"),this._onMouseUp),Tn(i,"".concat(n,"move"),this._onMouseMove,un),xs(t,"".concat(n,"move"),this._onMouseMove,un)}}_onMouseMove(e){const t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){const t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");const n=this._currentTransform,i=this._isClick,s=this._target,{button:o}=e;if(o)return(this.fireMiddleClick&&o===1||this.fireRightClick&&o===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let c,u,d=!1;if(n&&(this._finalizeCurrentTransform(e),d=n.actionPerformed),!i){const h=s===this._activeObject;this.handleSelection(e),d||(d=this._shouldRender(s)||!h&&s===this._activeObject)}if(s){const h=s.findControl(this.getViewportPoint(e),Jf(e)),{key:g,control:x}=h||{};if(u=g,s.selectable&&s!==this._activeObject&&s.activeOn==="up")this.setActiveObject(s,e),d=!0;else if(x){const m=x.getMouseUpHandler(e,s,x);m&&(c=this.getScenePoint(e),m.call(x,e,n,c.x,c.y))}s.isMoving=!1}if(n&&(n.target!==s||n.corner!==u)){const h=n.target&&n.target.controls[n.corner],g=h&&h.getMouseUpHandler(e,n.target,h);c=c||this.getScenePoint(e),g&&g.call(h,e,n,c.x,c.y)}this._setCursorFromEvent(e,s),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,s&&(s.__corner=void 0),d?this.requestRenderAll():i||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){const{target:n,subTargets:i=[]}=t;this.fire(e,t),n&&n.fire(e,t);for(let s=0;s<i.length;s++)i[s]!==n&&i[s].fire(e,t);return t}_handleEvent(e,t,n){const i=this._target,s=this.targets||[],o=he(he(he({e,target:i,subTargets:s},Ba(this,e)),{},{transform:this._currentTransform},t==="up:before"||t==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{}),t==="down:before"||t==="down"?n:{});this.fire("mouse:".concat(t),o),i&&i.fire("mouse".concat(t),o);for(let c=0;c<s.length;c++)s[c]!==i&&s[c].fire("mouse".concat(t),o)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down",{alreadySelected:!1})}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){const t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let t=this._target,n=!!t&&t===this._activeObject;const{button:i}=e;if(i)return(this.fireMiddleClick&&i===1||this.fireRightClick&&i===2)&&this._handleEvent(e,"down",{alreadySelected:n}),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let s=this._shouldRender(t),o=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,o=!0,s=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){const c=this.getScenePoint(e);this._groupSelector={x:c.x,y:c.y,deltaY:0,deltaX:0}}if(n=!!t&&t===this._activeObject,t){t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);const c=t.findControl(this.getViewportPoint(e),Jf(e));if(t===this._activeObject&&(c||!o)){this._setupCurrentTransform(e,t,n);const u=c?c.control:void 0,d=this.getScenePoint(e),h=u&&u.getMouseDownHandler(e,t,u);h&&h.call(u,e,this._currentTransform,d.x,d.y)}}s&&(this._objectsToRender=void 0),this._handleEvent(e,"down",{alreadySelected:n}),s&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=$a(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;const t=this._groupSelector;if(t){const n=this.getScenePoint(e);t.deltaX=n.x-t.x,t.deltaY=n.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{const n=this.findTarget(e);this._setCursorFromEvent(e,n),this._fireOverOutEvents(e,n)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,t){const n=this._hoveredTarget,i=this._hoveredTargets,s=this.targets,o=Math.max(i.length,s.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:n,fireCanvas:!0});for(let c=0;c<o;c++)s[c]===t||i[c]&&i[c]===n||this.fireSyntheticInOutEvents("mouse",{e,target:s[c],oldTarget:i[c]});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,t){const n=this._draggedoverTarget,i=this._hoveredTargets,s=this.targets,o=Math.max(i.length,s.length);this.fireSyntheticInOutEvents("drag",he(he({},t),{},{target:e,oldTarget:n,fireCanvas:!0}));for(let c=0;c<o;c++)this.fireSyntheticInOutEvents("drag",he(he({},t),{},{target:s[c],oldTarget:i[c]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,t){let{target:n,oldTarget:i,fireCanvas:s,e:o}=t,c=It(t,KO);const{targetIn:u,targetOut:d,canvasIn:h,canvasOut:g}=ZO[e],x=i!==n;if(i&&x){const m=he(he({},c),{},{e:o,target:i,nextTarget:n},Ba(this,o));s&&this.fire(g,m),i.fire(d,m)}if(n&&x){const m=he(he({},c),{},{e:o,target:n,previousTarget:i},Ba(this,o));s&&this.fire(h,m),n.fire(u,m)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){const t=this.getScenePoint(e),n=this._currentTransform,i=n.target,s=i.group?$a(t,void 0,i.group.calcTransformMatrix()):t;n.shiftKey=e.shiftKey,n.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,n,s),n.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,n){const{action:i,actionHandler:s,target:o}=t,c=!!s&&s(e,t,n.x,n.y);c&&o.setCoords(),i==="drag"&&c&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||c}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let n=t.hoverCursor||this.hoverCursor;const i=Gs(this._activeObject)?this._activeObject:null,s=(!i||t.group!==i)&&t.findControl(this.getViewportPoint(e));if(s){const o=s.control;this.setCursor(o.cursorStyleHandler(e,o,t))}else t.subTargetCheck&&this.targets.concat().reverse().map((o=>{n=o.hoverCursor||n})),this.setCursor(n)}handleMultiSelection(e,t){const n=this._activeObject,i=Gs(n);if(n&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(n!==t||i)&&(i||!t.isDescendantOf(n)&&!n.isDescendantOf(t))&&!t.onSelect({e})&&!n.getActiveControl()){if(i){const s=n.getObjects();if(t===n){const o=this.getViewportPoint(e);if(!(t=this.searchPossibleTargets(s,o)||this.searchPossibleTargets(this._objects,o))||!t.selectable)return!1}t.group===n?(n.remove(t),this._hoveredTarget=t,this._hoveredTargets=[...this.targets],n.size()===1&&this._setActiveObject(n.item(0),e)):(n.multiSelectAdd(t),this._hoveredTarget=n,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(s,e)}else{n.isEditing&&n.exitEditing();const s=new(Qe.getClass("ActiveSelection"))([],{canvas:this});s.multiSelectAdd(n,t),this._hoveredTarget=s,this._setActiveObject(s,e),this._fireSelectionEvents([n],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;const{x:t,y:n,deltaX:i,deltaY:s}=this._groupSelector,o=new Ce(t,n),c=o.add(new Ce(i,s)),u=o.min(c),d=o.max(c).subtract(u),h=this.collectObjects({left:u.x,top:u.y,width:d.x,height:d.y},{includeIntersecting:!this.selectionFullyContained}),g=o.eq(c)?h[0]?[h[0]]:[]:h.length>1?h.filter((x=>!x.onSelect({e}))).reverse():h;if(g.length===1)this.setActiveObject(g[0],e);else if(g.length>1){const x=Qe.getClass("ActiveSelection");this.setActiveObject(new x(g,{canvas:this}),e)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const u2={x1:0,y1:0,x2:0,y2:0},qO=he(he({},u2),{},{r1:0,r2:0}),Wa=(r,e)=>isNaN(r)&&typeof e=="number"?e:r;function h2(r){return r&&/%$/.test(r)&&Number.isFinite(parseFloat(r))}function f2(r,e){const t=typeof r=="number"?r:typeof r=="string"?parseFloat(r)/(h2(r)?100:1):NaN;return Qa(0,Wa(t,e),1)}const JO=/\s*;\s*/,QO=/\s*:\s*/;function eD(r,e){let t,n;const i=r.getAttribute("style");if(i){const o=i.split(JO);o[o.length-1]===""&&o.pop();for(let c=o.length;c--;){const[u,d]=o[c].split(QO).map((h=>h.trim()));u==="stop-color"?t=d:u==="stop-opacity"&&(n=d)}}const s=new At(t||r.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:f2(r.getAttribute("offset"),0),color:s.toRgb(),opacity:Wa(parseFloat(n||r.getAttribute("stop-opacity")||""),1)*s.getAlpha()*e}}function tD(r,e){const t=[],n=r.getElementsByTagName("stop"),i=f2(e,1);for(let s=n.length;s--;)t.push(eD(n[s],i));return t}function d2(r){return r.nodeName==="linearGradient"||r.nodeName==="LINEARGRADIENT"?"linear":"radial"}function g2(r){return r.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function Xn(r,e){return r.getAttribute(e)}function rD(r,e){return(function(t,n){let i,{width:s,height:o,gradientUnits:c}=n;return Object.entries(t).reduce(((u,d)=>{let[h,g]=d;if(g==="Infinity")i=1;else if(g==="-Infinity")i=0;else{const x=typeof g=="string";i=x?parseFloat(g):g,x&&h2(g)&&(i*=.01,c==="pixels"&&(h!=="x1"&&h!=="x2"&&h!=="r2"||(i*=s),h!=="y1"&&h!=="y2"||(i*=o)))}return u[h]=i,u}),{})})(d2(r)==="linear"?(function(t){return{x1:Xn(t,"x1")||0,y1:Xn(t,"y1")||0,x2:Xn(t,"x2")||"100%",y2:Xn(t,"y2")||0}})(r):(function(t){return{x1:Xn(t,"fx")||Xn(t,"cx")||"50%",y1:Xn(t,"fy")||Xn(t,"cy")||"50%",r1:0,x2:Xn(t,"cx")||"50%",y2:Xn(t,"cy")||"50%",r2:Xn(t,"r")||"50%"}})(r),he(he({},e),{},{gradientUnits:g2(r)}))}class hu{constructor(e){const{type:t="linear",gradientUnits:n="pixels",coords:i={},colorStops:s=[],offsetX:o=0,offsetY:c=0,gradientTransform:u,id:d}=e||{};Object.assign(this,{type:t,gradientUnits:n,coords:he(he({},t==="radial"?qO:u2),i),colorStops:s,offsetX:o,offsetY:c,gradientTransform:u,id:d?"".concat(d,"_").concat(Es()):Es()})}addColorStop(e){for(const t in e){const n=new At(e[t]);this.colorStops.push({offset:parseFloat(t),color:n.toRgb(),opacity:n.getAlpha()})}return this}toObject(e){return he(he({},oo(this,e)),{},{type:this.type,coords:he({},this.coords),colorStops:this.colorStops.map((t=>he({},t))),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=[],i=this.gradientTransform?this.gradientTransform.concat():Xr.concat(),s=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",o=this.colorStops.map((g=>he({},g))).sort(((g,x)=>g.offset-x.offset));let c=-this.offsetX,u=-this.offsetY;var d;s==="objectBoundingBox"?(c/=e.width,u/=e.height):(c+=e.width/2,u+=e.height/2),(d=e)&&typeof d._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(c-=e.pathOffset.x,u-=e.pathOffset.y),i[4]-=c,i[5]-=u;const h=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(s,'"'),'gradientTransform="'.concat(t?t+" ":"").concat(El(i),'"'),""].join(" ");if(this.type==="linear"){const{x1:g,y1:x,x2:m,y2:y}=this.coords;n.push("<linearGradient ",h,' x1="',g,'" y1="',x,'" x2="',m,'" y2="',y,`">
`)}else if(this.type==="radial"){const{x1:g,y1:x,x2:m,y2:y,r1:v,r2:_}=this.coords,S=v>_;n.push("<radialGradient ",h,' cx="',S?g:m,'" cy="',S?x:y,'" r="',S?v:_,'" fx="',S?m:g,'" fy="',S?y:x,`">
`),S&&(o.reverse(),o.forEach((C=>{C.offset=1-C.offset})));const T=Math.min(v,_);if(T>0){const C=T/Math.max(v,_);o.forEach((A=>{A.offset+=C*(1-A.offset)}))}}return o.forEach((g=>{let{color:x,offset:m,opacity:y}=g;n.push("<stop ",'offset="',100*m+"%",'" style="stop-color:',x,y!==void 0?";stop-opacity: "+y:";",`"/>
`)})),n.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),n.join("")}toLive(e){const{x1:t,y1:n,x2:i,y2:s,r1:o,r2:c}=this.coords,u=this.type==="linear"?e.createLinearGradient(t,n,i,s):e.createRadialGradient(t,n,o,i,s,c);return this.colorStops.forEach((d=>{let{color:h,opacity:g,offset:x}=d;u.addColorStop(x,g!==void 0?new At(h).setAlpha(g).toRgba():h)})),u}static async fromObject(e){const{colorStops:t,gradientTransform:n}=e;return new this(he(he({},e),{},{colorStops:t?t.map((i=>he({},i))):void 0,gradientTransform:n?[...n]:void 0}))}static fromElement(e,t,n){const i=g2(e),s=t._findCenterFromElement();return new this(he({id:e.getAttribute("id")||void 0,type:d2(e),coords:rD(e,{width:n.viewBoxWidth||n.width,height:n.viewBoxHeight||n.height}),colorStops:tD(e,n.opacity),gradientUnits:i,gradientTransform:rd(e.getAttribute("gradientTransform")||"")},i==="pixels"?{offsetX:t.width/2-s.x,offsetY:t.height/2-s.y}:{offsetX:0,offsetY:0}))}}ue(hu,"type","Gradient"),Qe.setClass(hu,"gradient"),Qe.setClass(hu,"linear"),Qe.setClass(hu,"radial");const nD=["type","source","patternTransform"];class Pf{get type(){return"pattern"}set type(e){Ts("warn","Setting type has no effect",e)}constructor(e){ue(this,"repeat","repeat"),ue(this,"offsetX",0),ue(this,"offsetY",0),ue(this,"crossOrigin",""),this.id=Es(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:t,crossOrigin:n}=this;return he(he({},oo(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:n,offsetX:Dt(this.offsetX,kt.NUM_FRACTION_DIGITS),offsetY:Dt(this.offsetY,kt.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:n}=e;const{source:i,repeat:s,id:o}=this,c=Wa(this.offsetX/t,0),u=Wa(this.offsetY/n,0),d=s==="repeat-y"||s==="no-repeat"?1+Math.abs(c||0):Wa(i.width/t,0),h=s==="repeat-x"||s==="no-repeat"?1+Math.abs(u||0):Wa(i.height/n,0);return['<pattern id="SVGID_'.concat(o,'" x="').concat(c,'" y="').concat(u,'" width="').concat(d,'" height="').concat(h,'">'),'<image x="0" y="0" width="'.concat(i.width,'" height="').concat(i.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(e,t){let{type:n,source:i,patternTransform:s}=e,o=It(e,nD);const c=await ju(i,he(he({},t),{},{crossOrigin:o.crossOrigin}));return new this(he(he({},o),{},{patternTransform:s&&s.slice(0),source:c}))}}ue(Pf,"type","Pattern"),Qe.setClass(Pf),Qe.setClass(Pf,"pattern");const iD=["path","left","top"],sD=["d"];class Ys extends Mr{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:n,left:i,top:s}=t,o=It(t,iD);super(),Object.assign(this,Ys.ownDefaults),this.setOptions(o),this._setPath(e||[],!0),typeof i=="number"&&this.set(Tt,i),typeof s=="number"&&this.set(tn,s)}_setPath(e,t){this.path=RO(Array.isArray(e)?e:XO(e)),this.setBoundingBox(t)}_findCenterFromElement(){const e=this._calcBoundsFromPath();return new Ce(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){const t=-this.pathOffset.x,n=-this.pathOffset.y;e.beginPath();for(const i of this.path)switch(i[0]){case"L":e.lineTo(i[1]+t,i[2]+n);break;case"M":e.moveTo(i[1]+t,i[2]+n);break;case"C":e.bezierCurveTo(i[1]+t,i[2]+n,i[3]+t,i[4]+n,i[5]+t,i[6]+n);break;case"Q":e.quadraticCurveTo(i[1]+t,i[2]+n,i[3]+t,i[4]+n);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return he(he({},super.toObject(e)),{},{path:this.path.map((t=>t.slice()))})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){const e=GO(this.path,kt.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const e=kt.NUM_FRACTION_DIGITS;return" translate(".concat(Dt(-this.pathOffset.x,e),", ").concat(Dt(-this.pathOffset.y,e),")")}toClipPathSVG(e){const t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){const t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{width:t,height:n,pathOffset:i}=this._calcDimensions();this.set({width:t,height:n,pathOffset:i}),e&&this.setPositionByOrigin(i,gt,gt)}_calcBoundsFromPath(){const e=[];let t=0,n=0,i=0,s=0;for(const o of this.path)switch(o[0]){case"L":i=o[1],s=o[2],e.push({x:t,y:n},{x:i,y:s});break;case"M":i=o[1],s=o[2],t=i,n=s;break;case"C":e.push(...bx(i,s,o[1],o[2],o[3],o[4],o[5],o[6])),i=o[5],s=o[6];break;case"Q":e.push(...bx(i,s,o[1],o[2],o[1],o[2],o[3],o[4])),i=o[3],s=o[4];break;case"Z":i=t,s=n}return Bi(e)}_calcDimensions(){const e=this._calcBoundsFromPath();return he(he({},e),{},{pathOffset:new Ce(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,n){const i=Yi(e,this.ATTRIBUTE_NAMES,n),{d:s}=i;return new this(s,he(he(he({},It(i,sD)),t),{},{left:void 0,top:void 0}))}}ue(Ys,"type","Path"),ue(Ys,"cacheProperties",[...Gi,"path","fillRule"]),ue(Ys,"ATTRIBUTE_NAMES",[...bs,"d"]),Qe.setClass(Ys),Qe.setSVGClass(Ys);const aD=["left","top","radius"],p2=["radius","startAngle","endAngle","counterClockwise"];class Oi extends Mr{static getDefaults(){return he(he({},super.getDefaults()),Oi.ownDefaults)}constructor(e){super(),Object.assign(this,Oi.ownDefaults),this.setOptions(e)}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,Zt(this.startAngle),Zt(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(sn)}getRadiusY(){return this.get("radius")*this.get(Dn)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...p2,...e])}_toSVG(){const e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:t}=this,n=Zt(this.startAngle),i=Zt(this.endAngle),s=Ui(n)*t,o=Vi(n)*t,c=Ui(i)*t,u=Vi(i)*t,d=e>180?1:0,h=this.counterClockwise?0:1;return['<path d="M '.concat(s," ").concat(o," A ").concat(t," ").concat(t," 0 ").concat(d," ").concat(h," ").concat(c," ").concat(u,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(e,t,n){const i=Yi(e,this.ATTRIBUTE_NAMES,n),{left:s=0,top:o=0,radius:c=0}=i;return new this(he(he({},It(i,aD)),{},{radius:c,left:s-c,top:o-c}))}static fromObject(e){return super._fromObject(e)}}ue(Oi,"type","Circle"),ue(Oi,"cacheProperties",[...Gi,...p2]),ue(Oi,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),ue(Oi,"ATTRIBUTE_NAMES",["cx","cy","r",...bs]),Qe.setClass(Oi),Qe.setSVGClass(Oi);const oD=["x1","y1","x2","y2"],lD=["x1","y1","x2","y2"],od=["x1","x2","y1","y2"];class Pi extends Mr{constructor(){let[e,t,n,i]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Pi.ownDefaults),this.setOptions(s),this.x1=e,this.x2=n,this.y1=t,this.y2=i,this._setWidthHeight();const{left:o,top:c}=s;typeof o=="number"&&this.set(Tt,o),typeof c=="number"&&this.set(tn,c)}_setWidthHeight(){const{x1:e,y1:t,x2:n,y2:i}=this;this.width=Math.abs(n-e),this.height=Math.abs(i-t);const{left:s,top:o,width:c,height:u}=Bi([{x:e,y:t},{x:n,y:i}]),d=new Ce(s+c/2,o+u/2);this.setPositionByOrigin(d,gt,gt)}_set(e,t){return super._set(e,t),od.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();const t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;const n=e.strokeStyle;var i;Fn(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(i=this.stroke)!==null&&i!==void 0?i:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=n}_findCenterFromElement(){return new Ce((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return he(he({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){const e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){const{x1:e,x2:t,y1:n,y2:i,width:s,height:o}=this,c=e<=t?-1:1,u=n<=i?-1:1;return{x1:c*s/2,x2:c*-s/2,y1:u*o/2,y2:u*-o/2}}_toSVG(){const{x1:e,x2:t,y1:n,y2:i}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(n,'" x2="').concat(t,'" y2="').concat(i,`" />
`)]}static async fromElement(e,t,n){const i=Yi(e,this.ATTRIBUTE_NAMES,n),{x1:s=0,y1:o=0,x2:c=0,y2:u=0}=i;return new this([s,o,c,u],It(i,oD))}static fromObject(e){let{x1:t,y1:n,x2:i,y2:s}=e,o=It(e,lD);return this._fromObject(he(he({},o),{},{points:[t,n,i,s]}),{extraParam:"points"})}}ue(Pi,"type","Line"),ue(Pi,"cacheProperties",[...Gi,...od]),ue(Pi,"ATTRIBUTE_NAMES",bs.concat(od)),Qe.setClass(Pi),Qe.setSVGClass(Pi);class Ks extends Mr{static getDefaults(){return he(he({},super.getDefaults()),Ks.ownDefaults)}constructor(e){super(),Object.assign(this,Ks.ownDefaults),this.setOptions(e)}_render(e){const t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,n),e.lineTo(0,-n),e.lineTo(t,n),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){const e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(t,",0 ").concat(-t,",").concat(e," ").concat(t),'" />']}}ue(Ks,"type","Triangle"),ue(Ks,"ownDefaults",{width:100,height:100}),Qe.setClass(Ks),Qe.setSVGClass(Ks);const m2=["rx","ry"];class Di extends Mr{static getDefaults(){return he(he({},super.getDefaults()),Di.ownDefaults)}constructor(e){super(),Object.assign(this,Di.ownDefaults),this.setOptions(e)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get(sn)}getRy(){return this.get("ry")*this.get(Dn)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...m2,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,Ju,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,n){const i=Yi(e,this.ATTRIBUTE_NAMES,n);return i.left=(i.left||0)-i.rx,i.top=(i.top||0)-i.ry,new this(i)}}function cD(r){if(!r)return[];const e=r.replace(/,/g," ").trim().split(/\s+/),t=[];for(let n=0;n<e.length;n+=2)t.push({x:parseFloat(e[n]),y:parseFloat(e[n+1])});return t}ue(Di,"type","Ellipse"),ue(Di,"cacheProperties",[...Gi,...m2]),ue(Di,"ownDefaults",{rx:0,ry:0}),ue(Di,"ATTRIBUTE_NAMES",[...bs,"cx","cy","rx","ry"]),Qe.setClass(Di),Qe.setSVGClass(Di);const uD=["left","top"],x2={exactBoundingBox:!1};class Yn extends Mr{static getDefaults(){return he(he({},super.getDefaults()),Yn.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),ue(this,"strokeDiff",void 0),Object.assign(this,Yn.ownDefaults),this.setOptions(t),this.points=e;const{left:n,top:i}=t;this.initialized=!0,this.setBoundingBox(!0),typeof n=="number"&&this.set(Tt,n),typeof i=="number"&&this.set(tn,i)}isOpen(){return!0}_projectStrokeOnPoints(e){return QF(this.points,e,this.isOpen())}_calcDimensions(e){e=he({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});const t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map((d=>d.projectedPoint)):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new Ce,strokeOffset:new Ce,strokeDiff:new Ce};const n=Bi(t),i=xh(he(he({},e),{},{scaleX:1,scaleY:1})),s=Bi(this.points.map((d=>en(d,i,!0)))),o=new Ce(this.scaleX,this.scaleY);let c=n.left+n.width/2,u=n.top+n.height/2;return this.exactBoundingBox&&(c-=u*Math.tan(Zt(this.skewX)),u-=c*Math.tan(Zt(this.skewY))),he(he({},n),{},{pathOffset:new Ce(c,u),strokeOffset:new Ce(s.left,s.top).subtract(new Ce(n.left,n.top)).multiply(o),strokeDiff:new Ce(n.width,n.height).subtract(new Ce(s.width,s.height)).multiply(o)})}_findCenterFromElement(){const e=Bi(this.points);return new Ce(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{left:t,top:n,width:i,height:s,pathOffset:o,strokeOffset:c,strokeDiff:u}=this._calcDimensions();this.set({width:i,height:s,pathOffset:o,strokeOffset:c,strokeDiff:u}),e&&this.setPositionByOrigin(new Ce(t+i/2,n+s/2),gt,gt)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new Ce(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let o;if(Object.keys(e).some((c=>this.strokeUniform||this.constructor.layoutProperties.includes(c)))){var t,n;const{width:c,height:u}=this._calcDimensions(e);o=new Ce((t=e.width)!==null&&t!==void 0?t:c,(n=e.height)!==null&&n!==void 0?n:u)}else{var i,s;o=new Ce((i=e.width)!==null&&i!==void 0?i:this.width,(s=e.height)!==null&&s!==void 0?s:this.height)}return o.multiply(new Ce(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){const n=this.initialized&&this[e]!==t,i=super._set(e,t);return this.exactBoundingBox&&n&&((e===sn||e===Dn)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),i}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return he(he({},super.toObject(e)),{},{points:this.points.map((t=>{let{x:n,y:i}=t;return{x:n,y:i}}))})}_toSVG(){const e=[],t=this.pathOffset.x,n=this.pathOffset.y,i=kt.NUM_FRACTION_DIGITS;for(let s=0,o=this.points.length;s<o;s++)e.push(Dt(this.points[s].x-t,i),",",Dt(this.points[s].y-n,i)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){const t=this.points.length,n=this.pathOffset.x,i=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-n,this.points[0].y-i);for(let s=0;s<t;s++){const o=this.points[s];e.lineTo(o.x-n,o.y-i)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,n){return new this(cD(e.getAttribute("points")),he(he({},It(Yi(e,this.ATTRIBUTE_NAMES,n),uD)),t))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}}ue(Yn,"ownDefaults",x2),ue(Yn,"type","Polyline"),ue(Yn,"layoutProperties",[io,so,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),ue(Yn,"cacheProperties",[...Gi,"points"]),ue(Yn,"ATTRIBUTE_NAMES",[...bs]),Qe.setClass(Yn),Qe.setSVGClass(Yn);class fu extends Yn{isOpen(){return!1}}ue(fu,"ownDefaults",x2),ue(fu,"type","Polygon"),Qe.setClass(fu),Qe.setSVGClass(fu);class v2 extends Mr{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;const t=e===void 0?this.styles:{line:this.styles[e]};for(const n in t)for(const i in t[n])for(const s in t[n][i])return!1;return!0}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;const n=t===void 0?this.styles:{0:this.styles[t]};for(const i in n)for(const s in n[i])if(n[i][s][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;const t=this.styles;let n,i,s=0,o=!0,c=0;for(const u in t){n=0;for(const d in t[u]){const h=t[u][d]||{};s++,h[e]!==void 0?(i?h[e]!==i&&(o=!1):i=h[e],h[e]===this[e]&&delete h[e]):o=!1,Object.keys(h).length!==0?n++:delete t[u][d]}n===0&&delete t[u]}for(let u=0;u<this._textLines.length;u++)c+=this._textLines[u].length;o&&s===c&&(this[e]=i,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;const t=this.styles;let n,i,s;for(i in t){for(s in n=t[i],n)delete n[s][e],Object.keys(n[s]).length===0&&delete n[s];Object.keys(n).length===0&&delete t[i]}}_extendStyles(e,t){const{lineIndex:n,charIndex:i}=this.get2DCursorLocation(e);this._getLineStyle(n)||this._setLineStyle(n);const s=Hd(he(he({},this._getStyleDeclaration(n,i)),t),(o=>o!==void 0));this._setStyleDeclaration(n,i,s)}getSelectionStyles(e,t,n){const i=[];for(let s=e;s<(t||e);s++)i.push(this.getStyleAtPosition(s,n));return i}getStyleAtPosition(e,t){const{lineIndex:n,charIndex:i}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(n,i):this._getStyleDeclaration(n,i)}setSelectionStyles(e,t,n){for(let i=t;i<(n||t);i++)this._extendStyles(i,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var n;const i=this.styles&&this.styles[e];return i&&(n=i[t])!==null&&n!==void 0?n:{}}getCompleteStyleDeclaration(e,t){return he(he({},oo(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,n){this.styles[e][t]=n}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}ue(v2,"_styleProperties",pF);const hD=/  +/g,fD=/"/g;function Mf(r,e,t,n,i){return"		".concat((function(s,o){let{left:c,top:u,width:d,height:h}=o,g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:kt.NUM_FRACTION_DIGITS;const x=Al(or,s,!1),[m,y,v,_]=[c,u,d,h].map((S=>Dt(S,g)));return"<rect ".concat(x,' x="').concat(m,'" y="').concat(y,'" width="').concat(v,'" height="').concat(_,'"></rect>')})(r,{left:e,top:t,width:n,height:i}),`
`)}const dD=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let Nf;class Br extends v2{static getDefaults(){return he(he({},super.getDefaults()),Br.ownDefaults)}constructor(e,t){super(),ue(this,"__charBounds",[]),Object.assign(this,Br.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const e=this.path;e&&(e.segmentsInfo=c2(e.path))}_splitText(){const e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(fi)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,n,i,s,o,c;for(let u=0,d=this._textLines.length;u<d;u++)if((this.textAlign===fi||u!==d-1&&!this.isEndOfWrapping(u))&&(i=0,s=this._textLines[u],t=this.getLineWidth(u),t<this.width&&(c=this.textLines[u].match(this._reSpacesAndTabs)))){n=c.length,e=(this.width-t)/n;for(let h=0;h<=s.length;h++)o=this.__charBounds[u][h],this._reSpaceAndTab.test(s[h])?(o.width+=e,o.kernedWidth+=e,o.left+=i,i+=e):o.left+=i}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){const n=t?this._unwrappedTextLines:this._textLines;let i;for(i=0;i<n.length;i++){if(e<=n[i].length)return{lineIndex:i,charIndex:e};e-=n[i].length+this.missingNewlineOffset(i,t)}return{lineIndex:i-1,charIndex:n[i-1].length<e?n[i-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){const t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===nn?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,n){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case gt:e.textBaseline="middle";break;case"ascender":e.textBaseline=tn;break;case"descender":e.textBaseline=Zf}e.font=this._getFontDeclaration(t,n)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,n=this._textLines.length;t<n;t++){const i=this.getLineWidth(t);i>e&&(e=i)}return e}_renderTextLine(e,t,n,i,s,o){this._renderChars(e,t,n,i,s,o)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const t=e.fillStyle,n=this._getLeftOffset();let i=this._getTopOffset();for(let s=0,o=this._textLines.length;s<o;s++){const c=this.getHeightOfLine(s);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",s)){i+=c;continue}const u=this._textLines[s].length,d=this._getLineLeftOffset(s);let h,g,x=0,m=0,y=this.getValueOfPropertyAt(s,0,"textBackgroundColor");const v=this.getHeightOfLineImpl(s);for(let _=0;_<u;_++){const S=this.__charBounds[s][_];g=this.getValueOfPropertyAt(s,_,"textBackgroundColor"),this.path?(e.save(),e.translate(S.renderLeft,S.renderTop),e.rotate(S.angle),e.fillStyle=g,g&&e.fillRect(-S.width/2,-v*(1-this._fontSizeFraction),S.width,v),e.restore()):g!==y?(h=n+d+m,this.direction==="rtl"&&(h=this.width-h-x),e.fillStyle=y,y&&e.fillRect(h,i,x,v),m=S.left,x=S.width,y=g):x+=S.kernedWidth}g&&!this.path&&(h=n+d+m,this.direction==="rtl"&&(h=this.width-h-x),e.fillStyle=g,e.fillRect(h,i,x,v)),i+=c}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,n,i){const s=hl.getFontCache(t),o=this._getFontDeclaration(t),c=n+e,u=n&&o===this._getFontDeclaration(i),d=t.fontSize/this.CACHE_FONT_SIZE;let h,g,x,m;if(n&&s.has(n)&&(x=s.get(n)),s.has(e)&&(m=h=s.get(e)),u&&s.has(c)&&(g=s.get(c),m=g-x),h===void 0||x===void 0||g===void 0){const y=(function(){return Nf||(Nf=Pn({width:0,height:0}).getContext("2d")),Nf})();this._setTextStyles(y,t,!0),h===void 0&&(m=h=y.measureText(e).width,s.set(e,h)),x===void 0&&u&&n&&(x=y.measureText(n).width,s.set(n,x)),u&&g===void 0&&(g=y.measureText(c).width,s.set(c,g),m=g-x)}return{width:h*d,kernedWidth:m*d}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){const t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,n,i=0;const s=this.pathSide===Kt,o=this.path,c=this._textLines[e],u=c.length,d=new Array(u);this.__charBounds[e]=d;for(let h=0;h<u;h++){const g=c[h];n=this._getGraphemeBox(g,e,h,t),d[h]=n,i+=n.kernedWidth,t=g}if(d[u]={left:n?n.left+n.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},o&&o.segmentsInfo){let h=0;const g=o.segmentsInfo[o.segmentsInfo.length-1].length;switch(this.textAlign){case Tt:h=s?g-i:0;break;case gt:h=(g-i)/2;break;case Kt:h=s?0:g-i}h+=this.pathStartOffset*(s?-1:1);for(let x=s?u-1:0;s?x>=0:x<u;s?x--:x++)n=d[x],h>g?h%=g:h<0&&(h+=g),this._setGraphemeOnPath(h,n),h+=n.kernedWidth}return{width:i,numOfSpaces:0}}_setGraphemeOnPath(e,t){const n=e+t.kernedWidth/2,i=this.path,s=UO(i.path,n,i.segmentsInfo);t.renderLeft=s.x-i.pathOffset.x,t.renderTop=s.y-i.pathOffset.y,t.angle=s.angle+(this.pathSide===Kt?Math.PI:0)}_getGraphemeBox(e,t,n,i,s){const o=this.getCompleteStyleDeclaration(t,n),c=i?this.getCompleteStyleDeclaration(t,n-1):{},u=this._measureChar(e,o,i,c);let d,h=u.kernedWidth,g=u.width;this.charSpacing!==0&&(d=this._getWidthOfCharSpacing(),g+=d,h+=d);const x={width:g,left:0,height:o.fontSize,kernedWidth:h,deltaY:o.deltaY};if(n>0&&!s){const m=this.__charBounds[t][n-1];x.left=m.left+m.width+u.kernedWidth-u.width}return x}getHeightOfLineImpl(e){const t=this.__lineHeights;if(t[e])return t[e];let n=this.getHeightOfChar(e,0);for(let i=1,s=this._textLines[e].length;i<s;i++)n=Math.max(this.getHeightOfChar(e,i),n);return t[e]=n*this._fontSizeMult}getHeightOfLine(e){return this.getHeightOfLineImpl(e)*this.lineHeight}calcTextHeight(){let e=0;for(let t=0,n=this._textLines.length;t<n;t++)e+=t===n-1?this.getHeightOfLineImpl(t):this.getHeightOfLine(t);return e}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let n=0;const i=this._getLeftOffset(),s=this._getTopOffset();for(let o=0,c=this._textLines.length;o<c;o++)this._renderTextLine(t,e,this._textLines[o],i+this._getLineLeftOffset(o),s+n+this.getHeightOfLineImpl(o),o),n+=this.getHeightOfLine(o);e.restore()}_renderTextFill(e){(this.fill||this.styleHas(or))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,n,i,s,o){const c=this.textAlign.includes(fi),u=this.path,d=!c&&this.charSpacing===0&&this.isEmptyStyles(o)&&!u,h=this.direction==="ltr",g=this.direction==="ltr"?1:-1,x=t.direction;let m,y,v,_,S,T="",C=0;if(t.save(),x!==this.direction&&(t.canvas.setAttribute("dir",h?"ltr":"rtl"),t.direction=h?"ltr":"rtl",t.textAlign=h?Tt:Kt),s-=this.getHeightOfLineImpl(o)*this._fontSizeFraction,d)return this._renderChar(e,t,o,0,n.join(""),i,s),void t.restore();for(let A=0,P=n.length-1;A<=P;A++)_=A===P||this.charSpacing||u,T+=n[A],v=this.__charBounds[o][A],C===0?(i+=g*(v.kernedWidth-v.width),C+=v.width):C+=v.kernedWidth,c&&!_&&this._reSpaceAndTab.test(n[A])&&(_=!0),_||(m=m||this.getCompleteStyleDeclaration(o,A),y=this.getCompleteStyleDeclaration(o,A+1),_=Jd(m,y,!1)),_&&(u?(t.save(),t.translate(v.renderLeft,v.renderTop),t.rotate(v.angle),this._renderChar(e,t,o,A,T,-C/2,0),t.restore()):(S=i,this._renderChar(e,t,o,A,T,S,s)),T="",m=y,i+=g*C,C=0);t.restore()}_applyPatternGradientTransformText(e){const t=this.width+this.strokeWidth,n=this.height+this.strokeWidth,i=Pn({width:t,height:n}),s=i.getContext("2d");return i.width=t,i.height=n,s.beginPath(),s.moveTo(0,0),s.lineTo(t,0),s.lineTo(t,n),s.lineTo(0,n),s.closePath(),s.translate(t/2,n/2),s.fillStyle=e.toLive(s),this._applyPatternGradientTransform(s,e),s.fill(),s.createPattern(i,"no-repeat")}handleFiller(e,t,n){let i,s;return Fn(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?(i=-this.width/2,s=-this.height/2,e.translate(i,s),e[t]=this._applyPatternGradientTransformText(n),{offsetX:i,offsetY:s}):(e[t]=n.toLive(e),this._applyPatternGradientTransform(e,n)):(e[t]=n,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:n,strokeWidth:i}=t;return e.lineWidth=i,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",n)}_setFillStyles(e,t){let{fill:n}=t;return this.handleFiller(e,"fillStyle",n)}_renderChar(e,t,n,i,s,o,c){const u=this._getStyleDeclaration(n,i),d=this.getCompleteStyleDeclaration(n,i),h=e==="fillText"&&d.fill,g=e==="strokeText"&&d.stroke&&d.strokeWidth;if(g||h){if(t.save(),t.font=this._getFontDeclaration(d),u.textBackgroundColor&&this._removeShadow(t),u.deltaY&&(c+=u.deltaY),h){const x=this._setFillStyles(t,d);t.fillText(s,o-x.offsetX,c-x.offsetY)}if(g){const x=this._setStrokeStyles(t,d);t.strokeText(s,o-x.offsetX,c-x.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,n){const i=this.get2DCursorLocation(e,!0),s=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"fontSize"),o=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"deltaY"),c={fontSize:s*n.size,deltaY:o+s*n.baseline};this.setSelectionStyles(c,e,t)}_getLineLeftOffset(e){const t=this.getLineWidth(e),n=this.width-t,i=this.textAlign,s=this.direction,o=this.isEndOfWrapping(e);let c=0;return i===fi||i===dl&&!o||i===fl&&!o||i===ah&&!o?0:(i===gt&&(c=n/2),i===Kt&&(c=n),i===dl&&(c=n/2),i===fl&&(c=n),s==="rtl"&&(i===Kt||i===fi||i===fl?c=0:i===Tt||i===ah?c=-n:i!==gt&&i!==dl||(c=-n/2)),c)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];const{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,n){var i;return(i=this._getStyleDeclaration(e,t)[n])!==null&&i!==void 0?i:this[n]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let n=this._getTopOffset();const i=this._getLeftOffset(),s=this.path,o=this._getWidthOfCharSpacing(),c=t==="linethrough"?.5:t==="overline"?1:0,u=this.offsets[t];for(let d=0,h=this._textLines.length;d<h;d++){const g=this.getHeightOfLine(d);if(!this[t]&&!this.styleHas(t,d)){n+=g;continue}const x=this._textLines[d],m=g/this.lineHeight,y=this._getLineLeftOffset(d);let v=0,_=0,S=this.getValueOfPropertyAt(d,0,t),T=this.getValueOfPropertyAt(d,0,or),C=this.getValueOfPropertyAt(d,0,ia),A=S,P=T,N=C;const O=n+m*(1-this._fontSizeFraction);let V=this.getHeightOfChar(d,0),B=this.getValueOfPropertyAt(d,0,"deltaY");for(let D=0,J=x.length;D<J;D++){const F=this.__charBounds[d][D];A=this.getValueOfPropertyAt(d,D,t),P=this.getValueOfPropertyAt(d,D,or),N=this.getValueOfPropertyAt(d,D,ia);const se=this.getHeightOfChar(d,D),Ee=this.getValueOfPropertyAt(d,D,"deltaY");if(s&&A&&P){const le=this.fontSize*N/1e3;e.save(),e.fillStyle=T,e.translate(F.renderLeft,F.renderTop),e.rotate(F.angle),e.fillRect(-F.kernedWidth/2,u*se+Ee-c*le,F.kernedWidth,le),e.restore()}else if((A!==S||P!==T||se!==V||N!==C||Ee!==B)&&_>0){const le=this.fontSize*C/1e3;let xe=i+y+v;this.direction==="rtl"&&(xe=this.width-xe-_),S&&T&&C&&(e.fillStyle=T,e.fillRect(xe,O+u*V+B-c*le,_,le)),v=F.left,_=F.width,S=A,C=N,T=P,V=se,B=Ee}else _+=F.kernedWidth}let te=i+y+v;this.direction==="rtl"&&(te=this.width-te-_),e.fillStyle=P;const ie=this.fontSize*N/1e3;A&&P&&N&&e.fillRect(te,O+u*V+B-c*ie,_-o,ie),n+=g}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:n=this.fontWeight,fontSize:i=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;const o=e.includes("'")||e.includes('"')||e.includes(",")||Br.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[t,n,"".concat(s?this.CACHE_FONT_SIZE:i,"px"),o].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return qd(e)}_splitTextIntoLines(e){const t=e.split(this._reNewline),n=new Array(t.length),i=[`
`];let s=[];for(let o=0;o<t.length;o++)n[o]=this.graphemeSplit(t[o]),s=s.concat(n[o],i);return s.pop(),{_unwrappedLines:n,lines:t,graphemeText:s,graphemeLines:n}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return he(he({},super.toObject([...Xy,...e])),{},{styles:nO(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,t){const{textLayoutProperties:n}=this.constructor;super.set(e,t);let i=!1,s=!1;if(typeof e=="object")for(const o in e)o==="path"&&this.setPathInfo(),i=i||n.includes(o),s=s||o==="path";else i=n.includes(e),s=e==="path";return s&&this.setPathInfo(),i&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,n){const i=Yi(e,Br.ATTRIBUTE_NAMES,n),s=he(he({},t),i),{textAnchor:o=Tt,textDecoration:c="",dx:u=0,dy:d=0,top:h=0,left:g=0,fontSize:x=Bd,strokeWidth:m=1}=s,y=It(s,dD),v=new this(sh(e.textContent||"").trim(),he({left:g+u,top:h+d,underline:c.includes("underline"),overline:c.includes("overline"),linethrough:c.includes("line-through"),strokeWidth:0,fontSize:x},y)),_=v.getScaledHeight()/v.height,S=((v.height+v.strokeWidth)*v.lineHeight-v.height)*_,T=v.getScaledHeight()+S;let C=0;return o===gt&&(C=v.getScaledWidth()/2),o===Kt&&(C=v.getScaledWidth()),v.set({left:v.left-C,top:v.top-(T-v.fontSize*(.07+v._fontSizeFraction))/v.lineHeight,strokeWidth:m}),v}static fromObject(e){return this._fromObject(he(he({},e),{},{styles:iO(e.styles||{},e.text)}),{extraParam:"text"})}}ue(Br,"textLayoutProperties",Hy),ue(Br,"cacheProperties",[...Gi,...Xy]),ue(Br,"ownDefaults",mF),ue(Br,"type","Text"),ue(Br,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),ue(Br,"ATTRIBUTE_NAMES",bs.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),e2(Br,[class extends Uy{_toSVG(){const r=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(r.textTop,r.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(r){const e=this._createBaseSVGMarkup(this._toSVG(),{reviver:r,noStyle:!0,withShadow:!0}),t=this.path;return t?e+t._createBaseSVGMarkup(t._toSVG(),{reviver:r,withShadow:!0,additionalTransform:El(this.calcOwnMatrix())}):e}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(r){let{textBgRects:e,textSpans:t}=r;const n=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ','font-family="'.concat(this.fontFamily.replace(fD,"'"),'" '),'font-size="'.concat(this.fontSize,'" '),this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",n?'text-decoration="'.concat(n,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`]}_getSVGTextAndBg(r,e){const t=[],n=[];let i,s=r;this.backgroundColor&&n.push(...Mf(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let o=0,c=this._textLines.length;o<c;o++)i=this._getLineLeftOffset(o),this.direction==="rtl"&&(i+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(n,o,e+i,s),this._setSVGTextLineText(t,o,e+i,s),s+=this.getHeightOfLine(o);return{textSpans:t,textBgRects:n}}_createTextCharSpan(r,e,t,n,i){const s=kt.NUM_FRACTION_DIGITS,o=this.getSvgSpanStyles(e,r!==r.trim()||!!r.match(hD)),c=o?'style="'.concat(o,'"'):"",u=e.deltaY,d=u?' dy="'.concat(Dt(u,s),'" '):"",{angle:h,renderLeft:g,renderTop:x,width:m}=i;let y="";if(g!==void 0){const v=m/2;h&&(y=' rotate="'.concat(Dt(Hi(h),s),'"'));const _=ao({angle:Hi(h)});_[4]=g,_[5]=x;const S=new Ce(-v,0).transform(_);t=S.x,n=S.y}return'<tspan x="'.concat(Dt(t,s),'" y="').concat(Dt(n,s),'" ').concat(d).concat(y).concat(c,">").concat(eO(r),"</tspan>")}_setSVGTextLineText(r,e,t,n){const i=this.getHeightOfLine(e),s=this.textAlign.includes(fi),o=this._textLines[e];let c,u,d,h,g,x="",m=0;n+=i*(1-this._fontSizeFraction)/this.lineHeight;for(let y=0,v=o.length-1;y<=v;y++)g=y===v||this.charSpacing||this.path,x+=o[y],d=this.__charBounds[e][y],m===0?(t+=d.kernedWidth-d.width,m+=d.width):m+=d.kernedWidth,s&&!g&&this._reSpaceAndTab.test(o[y])&&(g=!0),g||(c=c||this.getCompleteStyleDeclaration(e,y),u=this.getCompleteStyleDeclaration(e,y+1),g=Jd(c,u,!0)),g&&(h=this._getStyleDeclaration(e,y),r.push(this._createTextCharSpan(x,h,t,n,d)),x="",c=u,this.direction==="rtl"?t-=m:t+=m,m=0)}_setSVGTextLineBg(r,e,t,n){const i=this._textLines[e],s=this.getHeightOfLine(e)/this.lineHeight;let o,c=0,u=0,d=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let h=0;h<i.length;h++){const{left:g,width:x,kernedWidth:m}=this.__charBounds[e][h];o=this.getValueOfPropertyAt(e,h,"textBackgroundColor"),o!==d?(d&&r.push(...Mf(d,t+u,n,c,s)),u=g,c=x,d=o):c+=m}o&&r.push(...Mf(d,t+u,n,c,s))}_getSVGLineTopOffset(r){let e,t=0;for(e=0;e<r;e++)t+=this.getHeightOfLine(e);const n=this.getHeightOfLine(e);return{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(r){return"".concat(super.getSvgStyles(r)," text-decoration-thickness: ").concat(Dt(this.textDecorationThickness*this.getObjectScaling().y/10,kt.NUM_FRACTION_DIGITS),"%; white-space: pre;")}getSvgSpanStyles(r,e){const{fontFamily:t,strokeWidth:n,stroke:i,fill:s,fontSize:o,fontStyle:c,fontWeight:u,deltaY:d,textDecorationThickness:h,linethrough:g,overline:x,underline:m}=r,y=this.getSvgTextDecoration({underline:m??this.underline,overline:x??this.overline,linethrough:g??this.linethrough}),v=h||this.textDecorationThickness;return[i?Al(nn,i):"",n?"stroke-width: ".concat(n,"; "):"",t?"font-family: ".concat(t.includes("'")||t.includes('"')?t:"'".concat(t,"'"),"; "):"",o?"font-size: ".concat(o,"px; "):"",c?"font-style: ".concat(c,"; "):"",u?"font-weight: ".concat(u,"; "):"",y?"text-decoration: ".concat(y,"; text-decoration-thickness: ").concat(Dt(v*this.getObjectScaling().y/10,kt.NUM_FRACTION_DIGITS),"%; "):"",s?Al(or,s):"",d?"baseline-shift: ".concat(-d,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(r){return["overline","underline","line-through"].filter((e=>r[e.replace("-","")])).join(" ")}}]),Qe.setClass(Br),Qe.setSVGClass(Br);class gD{constructor(e){ue(this,"target",void 0),ue(this,"__mouseDownInPlace",!1),ue(this,"__dragStartFired",!1),ue(this,"__isDraggingOver",!1),ue(this,"__dragStartSelection",void 0),ue(this,"__dragImageDisposer",void 0),ue(this,"_dispose",void 0),this.target=e;const t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach((n=>n())),this._dispose=void 0}}isPointerOverSelection(e){const t=this.target,n=t.getSelectionStartFromPointer(e);return t.isEditing&&n>=t.selectionStart&&n<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){const t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var n;let{selectionStart:i,selectionEnd:s}=t;const o=this.target,c=o.canvas,u=new Ce(o.flipX?-1:1,o.flipY?-1:1),d=o._getCursorBoundaries(i),h=new Ce(d.left+d.leftOffset,d.top+d.topOffset).multiply(u).transform(o.calcTransformMatrix()),g=c.getScenePoint(e).subtract(h),x=o.getCanvasRetinaScaling(),m=o.getBoundingRect(),y=h.subtract(new Ce(m.left,m.top)),v=c.viewportTransform,_=y.add(g).transform(v,!0),S=o.backgroundColor,T=Zd(o.styles);o.backgroundColor="";const C={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};o.setSelectionStyles(C,0,i),o.setSelectionStyles(C,s,o.text.length),o.dirty=!0;const A=o.toCanvasElement({enableRetinaScaling:c.enableRetinaScaling,viewportTransform:!0});o.backgroundColor=S,o.styles=T,o.dirty=!0,sd(A,{position:"fixed",left:"".concat(-A.width,"px"),border:rn,width:"".concat(A.width/x,"px"),height:"".concat(A.height/x,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{A.remove()},Zn(e.target||this.target.hiddenTextarea).body.appendChild(A),(n=e.dataTransfer)===null||n===void 0||n.setDragImage(A,_.x,_.y)}onDragStart(e){this.__dragStartFired=!0;const t=this.target,n=this.isActive();if(n&&e.dataTransfer){const i=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},s=t._text.slice(i.selectionStart,i.selectionEnd).join(""),o=he({text:t.text,value:s},i);e.dataTransfer.setData("text/plain",s),e.dataTransfer.setData("application/fabric",JSON.stringify({value:s,styles:t.getSelectionStyles(i.selectionStart,i.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,o)}return t.abortCursorAnimation(),n}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const t=this.target.getSelectionStartFromPointer(e),n=this.__dragStartSelection;return t<n.selectionStart||t>n.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e;const n=this.targetCanDrop(t);!this.__isDraggingOver&&n&&(this.__isDraggingOver=!0)}dragOverHandler(e){const{e:t}=e,n=this.targetCanDrop(t);!this.__isDraggingOver&&n?this.__isDraggingOver=!0:this.__isDraggingOver&&!n&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;const{e:n}=e,i=n.defaultPrevented;this.__isDraggingOver=!1,n.preventDefault();let s=(t=n.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(s&&!i){const o=this.target,c=o.canvas;let u=o.getSelectionStartFromPointer(n);const{styles:d}=n.dataTransfer.types.includes("application/fabric")?JSON.parse(n.dataTransfer.getData("application/fabric")):{},h=s[Math.max(0,s.length-1)],g=0;if(this.__dragStartSelection){const x=this.__dragStartSelection.selectionStart,m=this.__dragStartSelection.selectionEnd;u>x&&u<=m?u=x:u>m&&(u-=m-x),o.removeChars(x,m),delete this.__dragStartSelection}o._reNewline.test(h)&&(o._reNewline.test(o._text[u])||u===o._text.length)&&(s=s.trimEnd()),e.didDrop=!0,e.dropTarget=o,o.insertChars(s,d,u),c.setActiveObject(o),o.enterEditing(n),o.selectionStart=Math.min(u+g,o._text.length),o.selectionEnd=Math.min(o.selectionStart+s.length,o._text.length),o.hiddenTextarea.value=o.text,o._updateTextarea(),o.hiddenTextarea.focus(),o.fire(Qu,{index:u+g,action:"drop"}),c.fire("text:changed",{target:o}),c.contextTopDirty=!0,c.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var n;const i=this.target,s=this.target.canvas,{selectionStart:o,selectionEnd:c}=this.__dragStartSelection,u=((n=t.dataTransfer)===null||n===void 0?void 0:n.dropEffect)||rn;u===rn?(i.selectionStart=o,i.selectionEnd=c,i._updateTextarea(),i.hiddenTextarea.focus()):(i.clearContextTop(),u==="move"&&(i.removeChars(o,c),i.selectionStart=i.selectionEnd=o,i.hiddenTextarea&&(i.hiddenTextarea.value=i.text),i._updateTextarea(),i.fire(Qu,{index:o,action:"dragend"}),s.fire("text:changed",{target:i}),s.requestRenderAll()),i.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const Dx=/[ \n\.,;!\?\-]/;class pD extends Br{constructor(){super(...arguments),ue(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:n,delay:i,onComplete:s}=e;return Ky({startValue:this._currentCursorOpacity,endValue:t,duration:n,delay:i,onComplete:s,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:o=>{this._currentCursorOpacity=o,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach((t=>{t&&!t.isDone()&&(e=!0,t.abort())})),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some((e=>!e||e.isDone()))&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}cmdAll(){this.selectAll(),this.renderCursorOrSelection()}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,n=e-1;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n--;for(;/\S/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findWordBoundaryRight(e){let t=0,n=e;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n++;for(;/\S/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}findLineBoundaryLeft(e){let t=0,n=e-1;for(;!/\n/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findLineBoundaryRight(e){let t=0,n=e;for(;!/\n/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}searchWordBoundary(e,t){const n=this._text;let i=e>0&&this._reSpace.test(n[e])&&(t===-1||!jd.test(n[e-1]))?e-1:e,s=n[i];for(;i>0&&i<n.length&&!Dx.test(s);)i+=t,s=n[i];return t===-1&&Dx.test(s)&&i++,i}selectWord(e){var t;e=(t=e)!==null&&t!==void 0?t:this.selectionStart;const n=this.searchWordBoundary(e,-1),i=Math.max(n,this.searchWordBoundary(e,1));this.selectionStart=n,this.selectionEnd=i,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){var t;e=(t=e)!==null&&t!==void 0?t:this.selectionStart;const n=this.findLineBoundaryLeft(e),i=this.findLineBoundaryRight(e);this.selectionStart=n,this.selectionEnd=i,this._fireSelectionChanged(),this._updateTextarea()}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;const t=this.hiddenTextarea;Zn(t).activeElement!==t&&t.focus();const n=this.getSelectionStartFromPointer(e),i=this.selectionStart,s=this.selectionEnd;(n===this.__selectionStartOnMouseDown&&i!==s||i!==n&&s!==n)&&(n>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=n):(this.selectionStart=n,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===i&&this.selectionEnd===s||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,n){const i=n.slice(0,e),s=this.graphemeSplit(i).length;if(e===t)return{selectionStart:s,selectionEnd:s};const o=n.slice(e,t);return{selectionStart:s,selectionEnd:s+this.graphemeSplit(o).length}}fromGraphemeToStringSelection(e,t,n){const i=n.slice(0,e).join("").length;return e===t?{selectionStart:i,selectionEnd:i}:{selectionStart:i,selectionEnd:i+n.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const t=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),n=this.get2DCursorLocation(e),i=n.lineIndex,s=n.charIndex,o=this.getValueOfPropertyAt(i,s,"fontSize")*this.lineHeight,c=t.leftOffset,u=this.getCanvasRetinaScaling(),d=this.canvas.upperCanvasEl,h=d.width/u,g=d.height/u,x=h-o,m=g-o,y=new Ce(t.left+c,t.top+t.topOffset+o).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new Ce(d.clientWidth/h,d.clientHeight/g));return y.x<0&&(y.x=0),y.x>x&&(y.x=x),y.y<0&&(y.y=0),y.y>m&&(y.y=m),y.x+=this.canvas._offset.left,y.y+=this.canvas._offset.top,{left:"".concat(y.x,"px"),top:"".concat(y.y,"px"),fontSize:"".concat(o,"px"),charHeight:o}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(eh),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){const{lineIndex:n,charIndex:i}=this.get2DCursorLocation(e,!0),{lineIndex:s,charIndex:o}=this.get2DCursorLocation(t,!0);if(n!==s){if(this.styles[n])for(let c=i;c<this._unwrappedTextLines[n].length;c++)delete this.styles[n][c];if(this.styles[s])for(let c=o;c<this._unwrappedTextLines[s].length;c++){const u=this.styles[s][c];u&&(this.styles[n]||(this.styles[n]={}),this.styles[n][i+c-o]=u)}for(let c=n+1;c<=s;c++)delete this.styles[c];this.shiftLineStyles(s,n-s)}else if(this.styles[n]){const c=this.styles[n],u=o-i;for(let d=i;d<o;d++)delete c[d];for(const d in this.styles[n]){const h=parseInt(d,10);h>=o&&(c[h-u]=c[d],delete c[d])}}}shiftLineStyles(e,t){const n=Object.assign({},this.styles);for(const i in this.styles){const s=parseInt(i,10);s>e&&(this.styles[s+t]=n[s],n[s-t]||delete this.styles[s])}}insertNewlineStyleObject(e,t,n,i){const s={},o=this._unwrappedTextLines[e].length,c=o===t;let u=!1;n||(n=1),this.shiftLineStyles(e,n);const d=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(const g in this.styles[e]){const x=parseInt(g,10);x>=t&&(u=!0,s[x-t]=this.styles[e][g],c&&t===0||delete this.styles[e][g])}let h=!1;for(u&&!c&&(this.styles[e+n]=s,h=!0),(h||o>t)&&n--;n>0;)i&&i[n-1]?this.styles[e+n]={0:he({},i[n-1])}:d?this.styles[e+n]={0:he({},d)}:delete this.styles[e+n],n--;this._forceClearCache=!0}insertCharStyleObject(e,t,n,i){this.styles||(this.styles={});const s=this.styles[e],o=s?he({},s):{};n||(n=1);for(const u in o){const d=parseInt(u,10);d>=t&&(s[d+n]=o[d],o[d-n]||delete s[d])}if(this._forceClearCache=!0,i){for(;n--;)Object.keys(i[n]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+n]=he({},i[n]));return}if(!s)return;const c=s[t?t-1:1];for(;c&&n--;)this.styles[e][t+n]=he({},c)}insertNewStyleBlock(e,t,n){const i=this.get2DCursorLocation(t,!0),s=[0];let o,c=0;for(let u=0;u<e.length;u++)e[u]===`
`?(c++,s[c]=0):s[c]++;for(s[0]>0&&(this.insertCharStyleObject(i.lineIndex,i.charIndex,s[0],n),n=n&&n.slice(s[0]+1)),c&&this.insertNewlineStyleObject(i.lineIndex,i.charIndex+s[0],c),o=1;o<c;o++)s[o]>0?this.insertCharStyleObject(i.lineIndex+o,0,s[o],n):n&&this.styles[i.lineIndex+o]&&n[0]&&(this.styles[i.lineIndex+o][0]=n[0]),n=n&&n.slice(s[o]+1);s[o]>0&&this.insertCharStyleObject(i.lineIndex+o,0,s[o],n)}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n;i>n&&this.removeStyleFromTo(n,i);const s=this.graphemeSplit(e);this.insertNewStyleBlock(s,n,t),this._text=[...this._text.slice(0,n),...s,...this._text.slice(i)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,n){n<=e?(t===e?this._selectionDirection=Tt:this._selectionDirection===Kt&&(this._selectionDirection=Tt,this.selectionEnd=e),this.selectionStart=n):n>e&&n<t?this._selectionDirection===Kt?this.selectionEnd=n:this.selectionStart=n:(t===e?this._selectionDirection=Kt:this._selectionDirection===Tt&&(this._selectionDirection=Kt,this.selectionStart=t),this.selectionEnd=n)}}class mD extends pD{initHiddenTextarea(){const e=this.canvas&&Zn(this.canvas.getElement())||no(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off",name:"fabricTextarea"}).map((o=>{let[c,u]=o;return t.setAttribute(c,u)}));const{top:n,left:i,fontSize:s}=this._calcTextareaPosition();t.style.cssText="position: absolute; top: ".concat(n,"; left: ").concat(i,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(s,";"),(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map((o=>{let[c,u]=o;return t.addEventListener(c,this[u].bind(this))})),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;const t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){const t=this.fromPaste,{value:n,selectionStart:i,selectionEnd:s}=this.hiddenTextarea;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;const o=()=>{this.updateFromTextArea(),this.fire(Qu),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void o();const c=this._splitTextIntoLines(n).graphemeText,u=this._text.length,d=c.length,h=this.selectionStart,g=this.selectionEnd,x=h!==g;let m,y,v,_,S=d-u;const T=this.fromStringToGraphemeSelection(i,s,n),C=h>T.selectionStart;x?(y=this._text.slice(h,g),S+=g-h):d<u&&(y=C?this._text.slice(g+S,g):this._text.slice(h,h-S));const A=c.slice(T.selectionEnd-S,T.selectionEnd);if(y&&y.length&&(A.length&&(m=this.getSelectionStyles(h,h+1,!1),m=A.map((()=>m[0]))),x?(v=h,_=g):C?(v=g-y.length,_=g):(v=g,_=g+y.length),this.removeStyleFromTo(v,_)),A.length){const{copyPasteData:P}=pi();t&&A.join("")===P.copiedText&&!kt.disableStyleCopyPaste&&(m=P.copiedTextStyle),this.insertNewStyleBlock(A,h,m)}o()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e;const{selectionStart:n,selectionEnd:i}=t;this.compositionStart=n,this.compositionEnd=i,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:e}=pi();e.copiedText=this.getSelectedText(),kt.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let n,i=this._getLineLeftOffset(e);return t>0&&(n=this.__charBounds[e][t-1],i+=n.left+n.width),i}getDownCursorOffset(e,t){const n=this._getSelectionForOffset(e,t),i=this.get2DCursorLocation(n),s=i.lineIndex;if(s===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-n;const o=i.charIndex,c=this._getWidthBeforeCursor(s,o),u=this._getIndexOnLine(s+1,c);return this._textLines[s].slice(o).length+u+1+this.missingNewlineOffset(s)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){const n=this._getSelectionForOffset(e,t),i=this.get2DCursorLocation(n),s=i.lineIndex;if(s===0||e.metaKey||e.keyCode===33)return-n;const o=i.charIndex,c=this._getWidthBeforeCursor(s,o),u=this._getIndexOnLine(s-1,c),d=this._textLines[s].slice(0,o),h=this.missingNewlineOffset(s-1);return-this._textLines[s-1].length+u-d.length+(1-h)}_getIndexOnLine(e,t){const n=this._textLines[e];let i,s,o=this._getLineLeftOffset(e),c=0;for(let u=0,d=n.length;u<d;u++)if(i=this.__charBounds[e][u].width,o+=i,o>t){s=!0;const h=o-i,g=o,x=Math.abs(h-t);c=Math.abs(g-t)<x?u:u-1;break}return s||(c=n.length-1),c}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){const n=this["get".concat(e,"CursorOffset")](t,this._selectionDirection===Kt);if(t.shiftKey?this.moveCursorWithShift(n):this.moveCursorWithoutShift(n),n!==0){const i=this.text.length;this.selectionStart=Qa(0,this.selectionStart,i),this.selectionEnd=Qa(0,this.selectionEnd,i),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){const t=this._selectionDirection===Tt?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,t,n){let i;if(e.altKey)i=this["findWordBoundary".concat(n)](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=n==="Left"?-1:1,!0;i=this["findLineBoundary".concat(n)](this[t])}return i!==void 0&&this[t]!==i&&(this[t]=i,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=Tt,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===Kt&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=Tt,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){const n="moveCursor".concat(e).concat(t.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[n](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===Tt&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=Kt,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=Kt,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}}const Px=r=>!!r.button;class xD extends mD{constructor(){super(...arguments),ue(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new gD(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}doubleClickHandler(e){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}tripleClickHandler(e){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}_mouseDownHandler(e){let{e:t,alreadySelected:n}=e;this.canvas&&this.editable&&!Px(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),n&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=n||this.isEditing)))}mouseUpHandler(e){let{e:t,transform:n}=e;const i=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);const s=this.canvas._activeObject;if(s&&s!==this)return}!this.editable||this.group&&!this.group.interactive||n&&n.actionPerformed||Px(t)||i||this.selected&&!this.getActiveControl()&&(this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection())}setCursorByClick(e){const t=this.getSelectionStartFromPointer(e),n=this.selectionStart,i=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(n,i,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){const t=this.canvas.getScenePoint(e).transform(Qn(this.calcTransformMatrix())).add(new Ce(-this._getLeftOffset(),-this._getTopOffset()));let n=0,i=0,s=0;for(let d=0;d<this._textLines.length&&n<=t.y;d++)n+=this.getHeightOfLine(d),s=d,d>0&&(i+=this._textLines[d-1].length+this.missingNewlineOffset(d-1));let o=Math.abs(this._getLineLeftOffset(s));const c=this._textLines[s].length,u=this.__charBounds[s];for(let d=0;d<c;d++){const h=o+u[d].kernedWidth;if(t.x<=h){Math.abs(t.x-h)<=Math.abs(t.x-o)&&i++;break}o=h,i++}return Math.min(this.flipX?c-i:i,this._text.length)}}const du="moveCursorUp",gu="moveCursorDown",pu="moveCursorLeft",mu="moveCursorRight",xu="exitEditing",Mx=(r,e)=>{const t=e.getRetinaScaling();r.setTransform(t,0,0,t,0,0);const n=e.viewportTransform;r.transform(n[0],n[1],n[2],n[3],n[4],n[5])},vD=he({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:xu,27:xu,33:du,34:gu,35:mu,36:pu,37:pu,38:du,39:mu,40:gu},keysMapRtl:{9:xu,27:xu,33:du,34:gu,35:pu,36:mu,37:mu,38:du,39:pu,40:gu},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class Ii extends xD{static getDefaults(){return he(he({},super.getDefaults()),Ii.ownDefaults)}get type(){const e=super.type;return e==="itext"?"i-text":e}constructor(e,t){super(e,he(he({},Ii.ownDefaults),t)),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof ad&&this.canvas.textEditingManager.remove(this),t instanceof ad&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,n=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,n)}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,n)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){const t=this.isEditing;this.isEditing=!1;const n=super.toCanvasElement(e);return this.isEditing=t,n}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;const e=this.clearContextTop(!0);if(!e)return;const t=this._getCursorBoundaries(),n=this.findAncestorsWithClipPath(),i=n.length>0;let s,o=e;if(i){s=Pn(e.canvas),o=s.getContext("2d"),Mx(o,this.canvas);const c=this.calcTransformMatrix();o.transform(c[0],c[1],c[2],c[3],c[4],c[5])}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(o,t):this.renderCursor(o,t),i)for(const c of n){const u=c.clipPath,d=Pn(e.canvas),h=d.getContext("2d");if(Mx(h,this.canvas),!u.absolutePositioned){const g=c.calcTransformMatrix();h.transform(g[0],g[1],g[2],g[3],g[4],g[5])}u.transform(h),u.drawObject(h,!0,{}),this.drawClipPathOnCache(o,u,d)}i&&(e.setTransform(1,0,0,1,0,0),e.drawImage(s,0,0)),this.canvas.contextTopDirty=!0,e.restore()}findAncestorsWithClipPath(){const e=[];let t=this;for(;t;)t.clipPath&&e.push(t),t=t.parent;return e}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;const n=this._getLeftOffset(),i=this._getTopOffset(),s=this._getCursorBoundariesOffsets(e,t);return{left:n,top:i,leftOffset:s.left,topOffset:s.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,n=0;const{charIndex:i,lineIndex:s}=this.get2DCursorLocation(e);for(let d=0;d<s;d++)t+=this.getHeightOfLine(d);const o=this._getLineLeftOffset(s),c=this.__charBounds[s][i];c&&(n=c.left),this.charSpacing!==0&&i===this._textLines[s].length&&(n-=this._getWidthOfCharSpacing());const u={top:t,left:o+(n>0?n:0)};return this.direction==="rtl"&&(this.textAlign===Kt||this.textAlign===fi||this.textAlign===fl?u.left*=-1:this.textAlign===Tt||this.textAlign===ah?u.left=o-(n>0?n:0):this.textAlign!==gt&&this.textAlign!==dl||(u.left=o-(n>0?n:0))),u}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e);const n=this.get2DCursorLocation(e),i=n.lineIndex,s=n.charIndex>0?n.charIndex-1:0,o=this.getValueOfPropertyAt(i,s,"fontSize"),c=this.getObjectScaling().x*this.canvas.getZoom(),u=this.cursorWidth/c,d=this.getValueOfPropertyAt(i,s,"deltaY"),h=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(i)/this.lineHeight-o*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(i,s,"fill"),opacity:this._currentCursorOpacity,left:t.left+t.leftOffset-u/2,top:h+t.top+d,width:u,height:o}}_renderCursor(e,t,n){const{color:i,opacity:s,left:o,top:c,width:u,height:d}=this.getCursorRenderingData(n,t);e.fillStyle=i,e.globalAlpha=s,e.fillRect(o,c,u,d)}renderSelection(e,t){const n={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,n,t)}renderDragSourceEffect(){const e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){const t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,n){const i=t.selectionStart,s=t.selectionEnd,o=this.textAlign.includes(fi),c=this.get2DCursorLocation(i),u=this.get2DCursorLocation(s),d=c.lineIndex,h=u.lineIndex,g=c.charIndex<0?0:c.charIndex,x=u.charIndex<0?0:u.charIndex;for(let m=d;m<=h;m++){const y=this._getLineLeftOffset(m)||0;let v=this.getHeightOfLine(m),_=0,S=0,T=0;if(m===d&&(S=this.__charBounds[d][g].left),m>=d&&m<h)T=o&&!this.isEndOfWrapping(m)?this.width:this.getLineWidth(m)||5;else if(m===h)if(x===0)T=this.__charBounds[h][x].left;else{const O=this._getWidthOfCharSpacing();T=this.__charBounds[h][x-1].left+this.__charBounds[h][x-1].width-O}_=v,(this.lineHeight<1||m===h&&this.lineHeight>1)&&(v/=this.lineHeight);let C=n.left+y+S,A=v,P=0;const N=T-S;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",A=1,P=v):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===Kt||this.textAlign===fi||this.textAlign===fl?C=this.width-C-N:this.textAlign===Tt||this.textAlign===ah?C=n.left+y-T:this.textAlign!==gt&&this.textAlign!==dl||(C=n.left+y-T)),e.fillRect(C,n.top+n.topOffset+P,N,A),n.topOffset+=_}}getCurrentCharFontSize(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,or)}_getCurrentCharIndex(){const e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}ue(Ii,"ownDefaults",vD),ue(Ii,"type","IText"),Qe.setClass(Ii),Qe.setClass(Ii,"i-text");class Zs extends Ii{static getDefaults(){return he(he({},super.getDefaults()),Zs.ownDefaults)}constructor(e,t){super(e,he(he({},Zs.ownDefaults),t))}static createControls(){return{controls:ZF()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(fi)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,n=0,i=0;const s={};for(let o=0;o<e.graphemeLines.length;o++)e.graphemeText[i]===`
`&&o>0?(n=0,i++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[i])&&o>0&&(n++,i++),s[o]={line:t,offset:n},i+=e.graphemeLines[o].length,n+=e.graphemeLines[o].length;return s}styleHas(e,t){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[t];n&&(t=n.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,n=0,i=e+1,s=!1;const o=this._styleMap[e],c=this._styleMap[e+1];o&&(e=o.line,n=o.offset),c&&(i=c.line,s=i===e,t=c.offset);const u=e===void 0?this.styles:{line:this.styles[e]};for(const d in u)for(const h in u[d]){const g=parseInt(h,10);if(g>=n&&(!s||g<t))for(const x in u[d][h])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[e];if(!n)return{};e=n.line,t=n.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,n){const i=this._styleMap[e];super._setStyleDeclaration(i.line,i.offset+t,n)}_deleteStyleDeclaration(e,t){const n=this._styleMap[e];super._deleteStyleDeclaration(n.line,n.offset+t)}_getLineStyle(e){const t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){const t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;const n=this.getGraphemeDataForRender(e),i=[];for(let s=0;s<n.wordsData.length;s++)i.push(...this._wrapLine(s,t,n));return this.isWrapping=!1,i}getGraphemeDataForRender(e){const t=this.splitByGrapheme,n=t?"":" ";let i=0;return{wordsData:e.map(((s,o)=>{let c=0;const u=t?this.graphemeSplit(s):this.wordSplit(s);return u.length===0?[{word:[],width:0}]:u.map((d=>{const h=t?[d]:this.graphemeSplit(d),g=this._measureWord(h,o,c);return i=Math.max(g,i),c+=h.length+n.length,{word:h,width:g}}))})),largestWordWidth:i}}_measureWord(e,t){let n,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=0;for(let o=0,c=e.length;o<c;o++)s+=this._getGraphemeBox(e[o],t,o+i,n,!0).kernedWidth,n=e[o];return s}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,n){let{largestWordWidth:i,wordsData:s}=n,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const c=this._getWidthOfCharSpacing(),u=this.splitByGrapheme,d=[],h=u?"":" ";let g=0,x=[],m=0,y=0,v=!0;t-=o;const _=Math.max(t,i,this.dynamicMinWidth),S=s[e];let T;for(m=0,T=0;T<S.length;T++){const{word:C,width:A}=S[T];m+=C.length,g+=y+A-c,g>_&&!v?(d.push(x),x=[],g=A,v=!0):g+=c,v||u||x.push(h),x=x.concat(C),y=u?0:this._measureWord([h],e,m),m++,v=!1}return T&&d.push(x),i+o>this.dynamicMinWidth&&(this.dynamicMinWidth=i-c+o),d}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){const t=super._splitTextIntoLines(e),n=this._wrapText(t.lines,this.width),i=new Array(n.length);for(let s=0;s<n.length;s++)i[s]=n[s].join("");return t.lines=i,t.graphemeLines=n,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const e=new Map;for(const t in this._styleMap){const n=parseInt(t,10);if(this._textLines[n]){const i=this._styleMap[t].line;e.set("".concat(i),!0)}}for(const t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}ue(Zs,"type","Textbox"),ue(Zs,"textLayoutProperties",[...Ii.textLayoutProperties,"width"]),ue(Zs,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),Qe.setClass(Zs);class Nx extends Sh{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){const{target:n}=e,{clipPath:i,group:s}=n;if(!i||!this.shouldPerformLayout(e))return;const{width:o,height:c}=Bi(n2(n,i)),u=new Ce(o,c);if(i.absolutePositioned)return{center:$a(i.getRelativeCenterPoint(),void 0,s?s.calcTransformMatrix():void 0),size:u};{const d=i.getRelativeCenterPoint().transform(n.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){const{center:h=new Ce,correction:g=new Ce}=this.calcBoundingBox(t,e)||{};return{center:h.add(d),correction:g.subtract(d),size:u}}return{center:n.getRelativeCenterPoint().add(d),size:u}}}}ue(Nx,"type","clip-path"),Qe.setClass(Nx);class Ix extends Sh{getInitialSize(e,t){let{target:n}=e,{size:i}=t;return new Ce(n.width||i.x,n.height||i.y)}}ue(Ix,"type","fixed"),Qe.setClass(Ix);class yD extends Fl{subscribeTargets(e){const t=e.target;e.targets.reduce(((n,i)=>(i.parent&&n.add(i.parent),n)),new Set).forEach((n=>{n.layoutManager.subscribeTargets({target:n,targets:[t]})}))}unsubscribeTargets(e){const t=e.target,n=t.getObjects();e.targets.reduce(((i,s)=>(s.parent&&i.add(s.parent),i)),new Set).forEach((i=>{!n.some((s=>s.parent===i))&&i.layoutManager.unsubscribeTargets({target:i,targets:[t]})}))}}class qs extends ea{static getDefaults(){return he(he({},super.getDefaults()),qs.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,qs.ownDefaults),this.setOptions(t);const{left:n,top:i,layoutManager:s}=t;this.groupInit(e,{left:n,top:i,layoutManager:s??new yD})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach((i=>{const s=this._objects.findIndex((c=>c.isInFrontOf(i))),o=s===-1?this.size():s;this.insertAt(o,i)}))}canEnterGroup(e){return this.getObjects().some((t=>t.isDescendantOf(e)||e.isDescendantOf(t)))?(Ts("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);const n=new Set;t.forEach((i=>{const{parent:s}=i;s&&n.add(s)})),e===eg?n.forEach((i=>{i._onAfterObjectsChange(oh,t)})):n.forEach((i=>{i._set("dirty",!0)}))}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,n){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const i=he(he({hasControls:!1},n),{},{forActiveSelection:!0});for(let s=0;s<this._objects.length;s++)this._objects[s]._renderControls(e,i);super._renderControls(e,t),e.restore()}}ue(qs,"type","ActiveSelection"),ue(qs,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),Qe.setClass(qs),Qe.setClass(qs,"activeSelection");class _D{constructor(){ue(this,"resources",{})}applyFilters(e,t,n,i,s){const o=s.getContext("2d");if(!o)return;o.drawImage(t,0,0,n,i);const c={sourceWidth:n,sourceHeight:i,imageData:o.getImageData(0,0,n,i),originalEl:t,originalImageData:o.getImageData(0,0,n,i),canvasEl:s,ctx:o,filterBackend:this};e.forEach((d=>{d.applyTo(c)}));const{imageData:u}=c;return u.width===n&&u.height===i||(s.width=u.width,s.height=u.height),o.putImageData(u,0,0),c}}class y2{constructor(){let{tileSize:e=kt.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ue(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),ue(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){const n=Pn({width:e,height:t}),i=n.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});i&&(i.clearColor(0,0,0,0),this.canvas=n,this.gl=i)}applyFilters(e,t,n,i,s,o){const c=this.gl,u=s.getContext("2d");if(!c||!u)return;let d;o&&(d=this.getCachedTexture(o,t));const h={originalWidth:t.width||t.naturalWidth||0,originalHeight:t.height||t.naturalHeight||0,sourceWidth:n,sourceHeight:i,destinationWidth:n,destinationHeight:i,context:c,sourceTexture:this.createTexture(c,n,i,d?void 0:t),targetTexture:this.createTexture(c,n,i),originalTexture:d||this.createTexture(c,n,i,d?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:s},g=c.createFramebuffer();return c.bindFramebuffer(c.FRAMEBUFFER,g),e.forEach((x=>{x&&x.applyTo(h)})),(function(x){const m=x.targetCanvas,y=m.width,v=m.height,_=x.destinationWidth,S=x.destinationHeight;y===_&&v===S||(m.width=_,m.height=S)})(h),this.copyGLTo2D(c,h),c.bindTexture(c.TEXTURE_2D,null),c.deleteTexture(h.sourceTexture),c.deleteTexture(h.targetTexture),c.deleteFramebuffer(g),u.setTransform(1,0,0,1,0,0),h}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,n,i,s){const{NEAREST:o,TEXTURE_2D:c,RGBA:u,UNSIGNED_BYTE:d,CLAMP_TO_EDGE:h,TEXTURE_MAG_FILTER:g,TEXTURE_MIN_FILTER:x,TEXTURE_WRAP_S:m,TEXTURE_WRAP_T:y}=e,v=e.createTexture();return e.bindTexture(c,v),e.texParameteri(c,g,s||o),e.texParameteri(c,x,s||o),e.texParameteri(c,m,h),e.texParameteri(c,y,h),i?e.texImage2D(c,0,u,u,d,i):e.texImage2D(c,0,u,t,n,0,u,d,null),v}getCachedTexture(e,t,n){const{textureCache:i}=this;if(i[e])return i[e];{const s=this.createTexture(this.gl,t.width,t.height,t,n);return s&&(i[e]=s),s}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){const n=e.canvas,i=t.targetCanvas,s=i.getContext("2d");if(!s)return;s.translate(0,i.height),s.scale(1,-1);const o=n.height-i.height;s.drawImage(n,0,o,i.width,i.height,0,0,i.width,i.height)}copyGLTo2DPutImageData(e,t){const n=t.targetCanvas.getContext("2d"),i=t.destinationWidth,s=t.destinationHeight,o=i*s*4;if(!n)return;const c=new Uint8Array(this.imageBuffer,0,o),u=new Uint8ClampedArray(this.imageBuffer,0,o);e.readPixels(0,0,i,s,e.RGBA,e.UNSIGNED_BYTE,c);const d=new ImageData(u,i,s);n.putImageData(d,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const e=this.gl,t={renderer:"",vendor:""};if(!e)return t;const n=e.getExtension("WEBGL_debug_renderer_info");if(n){const i=e.getParameter(n.UNMASKED_RENDERER_WEBGL),s=e.getParameter(n.UNMASKED_VENDOR_WEBGL);i&&(t.renderer=i.toLowerCase()),s&&(t.vendor=s.toLowerCase())}return this.gpuInfo=t,t}}let If;function wD(){const{WebGLProbe:r}=pi();return r.queryWebGL(Wi()),kt.enableGLFiltering&&r.isSupported(kt.textureSize)?new y2({tileSize:kt.textureSize}):new _D}function Rf(){return!If&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(If=wD()),If}const SD=["filters","resizeFilter","src","crossOrigin","type"],_2=["cropX","cropY"];class bn extends Mr{static getDefaults(){return he(he({},super.getDefaults()),bn.ownDefaults)}constructor(e,t){super(),ue(this,"_lastScaleX",1),ue(this,"_lastScaleY",1),ue(this,"_filterScalingX",1),ue(this,"_filterScalingY",1),this.filters=[],Object.assign(this,bn.ownDefaults),this.setOptions(t),this.cacheKey="texture".concat(Es()),this.setElement(typeof e=="string"?(this.canvas&&Zn(this.canvas.getElement())||no()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){var t;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(n),(t=e.classList)===null||t===void 0||t.add(bn.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){const t=Rf(!1);t instanceof y2&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((e=>{const t=this[e];t&&pi().dispose(t),this[e]=void 0}))}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;const t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,-n),e.lineTo(t,-n),e.lineTo(t,n),e.lineTo(-t,n),e.lineTo(-t,-n),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=[];return this.filters.forEach((n=>{n&&t.push(n.toObject())})),he(he({},super.toObject([..._2,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const e=[],t=this._element,n=-this.width/2,i=-this.height/2;let s=[],o=[],c="",u="";if(!t)return[];if(this.hasCrop()){const d=Es();s.push('<clipPath id="imageCrop_'+d+`">
`,'	<rect x="'+n+'" y="'+i+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),c=' clip-path="url(#imageCrop_'+d+')" '}if(this.imageSmoothing||(u=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(n-this.cropX,'" y="').concat(i-this.cropY,'" width="').concat(t.width||t.naturalWidth,'" height="').concat(t.height||t.naturalHeight,'"').concat(u).concat(c,`></image>
`)),this.stroke||this.strokeDashArray){const d=this.fill;this.fill=null,o=['	<rect x="'.concat(n,'" y="').concat(i,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=d}return s=this.paintFirst!==or?s.concat(o,e):s.concat(e,o),s}getSrc(e){const t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ju(e,{crossOrigin:t,signal:n}).then((i=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(i)}))}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const e=this.resizeFilter,t=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),i=n.x,s=n.y,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||i>t&&s>t)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=i,void(this._lastScaleY=s);const c=Pn(o),{width:u,height:d}=o;this._element=c,this._lastScaleX=e.scaleX=i,this._lastScaleY=e.scaleY=s,Rf().applyFilters([e],o,u,d,this._element),this._filterScalingX=c.width/this._originalElement.width,this._filterScalingY=c.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter((s=>s&&!s.isNeutralState())),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const t=this._originalElement,n=t.naturalWidth||t.width,i=t.naturalHeight||t.height;if(this._element===this._originalElement){const s=Pn({width:n,height:i});this._element=s,this._filteredEl=s}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,i),this._lastScaleX=1,this._lastScaleY=1);Rf().applyFilters(e,this._originalElement,n,i,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){const t=this._element;if(!t)return;const n=this._filterScalingX,i=this._filterScalingY,s=this.width,o=this.height,c=Math.max(this.cropX,0),u=Math.max(this.cropY,0),d=t.naturalWidth||t.width,h=t.naturalHeight||t.height,g=c*n,x=u*i,m=Math.min(s*n,d-g),y=Math.min(o*i,h-x),v=-s/2,_=-o/2,S=Math.min(s,d/n-c),T=Math.min(o,h/i-u);t&&e.drawImage(t,g,x,m,y,v,_,S,T)}_needsResize(){const e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.getOriginalSize();this.width=e||n.width,this.height=t||n.height}parsePreserveAspectRatioAttribute(){const e=gF(this.preserveAspectRatio||""),t=this.width,n=this.height,i={width:t,height:n};let s,o=this._element.width,c=this._element.height,u=1,d=1,h=0,g=0,x=0,m=0;return!e||e.alignX===rn&&e.alignY===rn?(u=t/o,d=n/c):(e.meetOrSlice==="meet"&&(u=d=OO(this._element,i),s=(t-o*u)/2,e.alignX==="Min"&&(h=-s),e.alignX==="Max"&&(h=s),s=(n-c*d)/2,e.alignY==="Min"&&(g=-s),e.alignY==="Max"&&(g=s)),e.meetOrSlice==="slice"&&(u=d=DO(this._element,i),s=o-t/u,e.alignX==="Mid"&&(x=s/2),e.alignX==="Max"&&(x=s),s=c-n/d,e.alignY==="Mid"&&(m=s/2),e.alignY==="Max"&&(m=s),o=t/u,c=n/d)),{width:o,height:c,scaleX:u,scaleY:d,offsetLeft:h,offsetTop:g,cropX:x,cropY:m}}static fromObject(e,t){let{filters:n,resizeFilter:i,src:s,crossOrigin:o,type:c}=e,u=It(e,SD);return Promise.all([ju(s,he(he({},t),{},{crossOrigin:o})),n&&Tl(n,t),i&&Tl([i],t),vh(u,t)]).then((d=>{let[h,g=[],[x]=[],m={}]=d;return new this(h,he(he({},u),{},{src:s,filters:g,resizeFilter:x},m))}))}static fromURL(e){let{crossOrigin:t=null,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;return ju(e,{crossOrigin:t,signal:n}).then((s=>new this(s,i)))}static async fromElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const i=Yi(e,this.ATTRIBUTE_NAMES,n);return this.fromURL(i["xlink:href"]||i.href,t,i).catch((s=>(Ts("log","Unable to parse Image",s),null)))}}ue(bn,"type","Image"),ue(bn,"cacheProperties",[...Gi,..._2]),ue(bn,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),ue(bn,"CSS_CANVAS","canvas-img"),ue(bn,"ATTRIBUTE_NAMES",[...bs,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),Qe.setClass(bn),Qe.setSVGClass(bn);_h(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const Ch=r=>r.webgl!==void 0,tg="precision highp float",kD=`
    `.concat(tg,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),CD=["type"],TD=["type"],ED=new RegExp(tg,"g");class lr{get type(){return this.constructor.type}constructor(){let e=It(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},CD);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return kD}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:i="highp"}}=pi();i!=="highp"&&(t=t.replace(ED,tg.replace("highp",i)));const s=e.createShader(e.VERTEX_SHADER),o=e.createShader(e.FRAGMENT_SHADER),c=e.createProgram();if(!s||!o||!c)throw new di("Vertex, fragment shader or program creation error");if(e.shaderSource(s,n),e.compileShader(s),!e.getShaderParameter(s,e.COMPILE_STATUS))throw new di("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(s)));if(e.shaderSource(o,t),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new di("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(o)));if(e.attachShader(c,s),e.attachShader(c,o),e.linkProgram(c),!e.getProgramParameter(c,e.LINK_STATUS))throw new di('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(c)));const u=this.getUniformLocations(e,c)||{};return u.uStepW=e.getUniformLocation(c,"uStepW"),u.uStepH=e.getUniformLocation(c,"uStepH"),{program:c,attributeLocations:this.getAttributeLocations(e,c),uniformLocations:u}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){const n=this.constructor.uniformLocations,i={};for(let s=0;s<n.length;s++)i[n[s]]=e.getUniformLocation(t,n[s]);return i}sendAttributeData(e,t,n){const i=t.aPosition,s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}_setupFrameBuffer(e){const t=e.context;if(e.passes>1){const n=e.destinationWidth,i=e.destinationHeight;e.sourceWidth===n&&e.sourceHeight===i||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,n,i)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;const t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){return!1}applyTo(e){Ch(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){const t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){const t=e.context,n=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(n.program),this.sendAttributeData(t,n.attributeLocations,e.aPosition),t.uniform1f(n.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(n.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,n.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,n){e.activeTexture(n),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){const{sourceWidth:t,sourceHeight:n}=e,i=Pn({width:t,height:n});e.helpLayer=i}}toObject(){const e=Object.keys(this.constructor.defaults||{});return he({type:this.type},e.reduce(((t,n)=>(t[n]=this[n],t)),{}))}toJSON(){return this.toObject()}static async fromObject(e,t){return new this(It(e,TD))}}ue(lr,"type","BaseFilter"),ue(lr,"uniformLocations",[]);const AD={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class vu extends lr{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(AD[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:t}}=e;const n=new At(this.color).getSource(),i=this.alpha,s=n[0]*i,o=n[1]*i,c=n[2]*i,u=1-i;for(let d=0;d<t.length;d+=4){const h=t[d],g=t[d+1],x=t[d+2];let m,y,v;switch(this.mode){case"multiply":m=h*s/255,y=g*o/255,v=x*c/255;break;case"screen":m=255-(255-h)*(255-s)/255,y=255-(255-g)*(255-o)/255,v=255-(255-x)*(255-c)/255;break;case"add":m=h+s,y=g+o,v=x+c;break;case"difference":m=Math.abs(h-s),y=Math.abs(g-o),v=Math.abs(x-c);break;case"subtract":m=h-s,y=g-o,v=x-c;break;case"darken":m=Math.min(h,s),y=Math.min(g,o),v=Math.min(x,c);break;case"lighten":m=Math.max(h,s),y=Math.max(g,o),v=Math.max(x,c);break;case"overlay":m=s<128?2*h*s/255:255-2*(255-h)*(255-s)/255,y=o<128?2*g*o/255:255-2*(255-g)*(255-o)/255,v=c<128?2*x*c/255:255-2*(255-x)*(255-c)/255;break;case"exclusion":m=s+h-2*s*h/255,y=o+g-2*o*g/255,v=c+x-2*c*x/255;break;case"tint":m=s+h*u,y=o+g*u,v=c+x*u}t[d]=m,t[d+1]=y,t[d+2]=v}}sendUniformData(e,t){const n=new At(this.color).getSource();n[0]=this.alpha*n[0]/255,n[1]=this.alpha*n[1]/255,n[2]=this.alpha*n[2]/255,n[3]=this.alpha,e.uniform4fv(t.uColor,n)}}ue(vu,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),ue(vu,"type","BlendColor"),ue(vu,"uniformLocations",["uColor"]),Qe.setClass(vu);const bD={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},FD=["type","image"];class yu extends lr{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return bD[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){const t=e.context,n=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,n,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){const e=this.image,{width:t,height:n}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/n,1]}applyTo2d(e){let{imageData:{data:t,width:n,height:i},filterBackend:{resources:s}}=e;const o=this.image;s.blendImage||(s.blendImage=Wi());const c=s.blendImage,u=c.getContext("2d");c.width!==n||c.height!==i?(c.width=n,c.height=i):u.clearRect(0,0,n,i),u.setTransform(o.scaleX,0,0,o.scaleY,o.left,o.top),u.drawImage(o.getElement(),0,0,n,i);const d=u.getImageData(0,0,n,i).data;for(let h=0;h<t.length;h+=4){const g=t[h],x=t[h+1],m=t[h+2],y=t[h+3],v=d[h],_=d[h+1],S=d[h+2],T=d[h+3];switch(this.mode){case"multiply":t[h]=g*v/255,t[h+1]=x*_/255,t[h+2]=m*S/255,t[h+3]=y*T/255;break;case"mask":t[h+3]=T}}}sendUniformData(e,t){const n=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,n)}toObject(){return he(he({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(e,t){let{type:n,image:i}=e,s=It(e,FD);return bn.fromObject(i,t).then((o=>new this(he(he({},s),{},{image:o}))))}}ue(yu,"type","BlendImage"),ue(yu,"defaults",{mode:"multiply",alpha:1}),ue(yu,"uniformLocations",["uTransformMatrix","uImage"]),Qe.setClass(yu);class _u extends lr{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float totalC = 0.0;
      float totalA = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);
        float weight = 1.0 - abs(percent);
        float alpha = weight * sample.a;
        color.rgb += sample.rgb * alpha;
        color.a += alpha;
        totalA += weight;
        totalC += alpha;
      }
      gl_FragColor.rgb = color.rgb / totalC;
      gl_FragColor.a = color.a / totalA;
    }
  `}applyTo(e){Ch(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){let{imageData:{data:t,width:n,height:i}}=e;this.aspectRatio=n/i,this.horizontal=!0;let s=this.getBlurValue()*n;const o=new Uint8ClampedArray(t),c=15,u=4*n;for(let d=0;d<t.length;d+=4){let h=0,g=0,x=0,m=0,y=0;const v=d-d%u,_=v+u;for(let S=-14;S<c;S++){const T=S/c,C=4*Math.floor(s*T),A=1-Math.abs(T);let P=d+C;P<v?P=v:P>_&&(P=_);const N=t[P+3]*A;h+=t[P]*N,g+=t[P+1]*N,x+=t[P+2]*N,m+=N,y+=A}o[d]=h/m,o[d+1]=g/m,o[d+2]=x/m,o[d+3]=m/y}this.horizontal=!1,s=this.getBlurValue()*i;for(let d=0;d<o.length;d+=4){let h=0,g=0,x=0,m=0,y=0;const v=d%u,_=o.length-u+v;for(let S=-14;S<c;S++){const T=S/c,C=Math.floor(s*T)*u,A=1-Math.abs(T);let P=d+C;P<v?P=v:P>_&&(P=_);const N=o[P+3]*A;h+=o[P]*N,g+=o[P+1]*N,x+=o[P+2]*N,m+=N,y+=A}t[d]=h/m,t[d+1]=g/m,t[d+2]=x/m,t[d+3]=m/y}}sendUniformData(e,t){const n=this.chooseRightDelta();e.uniform2fv(t.uDelta,n)}isNeutralState(){return this.blur===0}getBlurValue(){let e=1;const{horizontal:t,aspectRatio:n}=this;return t?n>1&&(e=1/n):n<1&&(e=n),e*this.blur*.12}chooseRightDelta(){const e=this.getBlurValue();return this.horizontal?[e,0]:[0,e]}}ue(_u,"type","Blur"),ue(_u,"defaults",{blur:0}),ue(_u,"uniformLocations",["uDelta"]),Qe.setClass(_u);class wu extends lr{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=Math.round(255*this.brightness);for(let i=0;i<t.length;i+=4)t[i]+=n,t[i+1]+=n,t[i+2]+=n}isNeutralState(){return this.brightness===0}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}}ue(wu,"type","Brightness"),ue(wu,"defaults",{brightness:0}),ue(wu,"uniformLocations",["uBrightness"]),Qe.setClass(wu);const w2={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class Ha extends lr{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){const t=e.imageData.data,n=this.matrix,i=this.colorsOnly;for(let s=0;s<t.length;s+=4){const o=t[s],c=t[s+1],u=t[s+2];if(t[s]=o*n[0]+c*n[1]+u*n[2]+255*n[4],t[s+1]=o*n[5]+c*n[6]+u*n[7]+255*n[9],t[s+2]=o*n[10]+c*n[11]+u*n[12]+255*n[14],!i){const d=t[s+3];t[s]+=d*n[3],t[s+1]+=d*n[8],t[s+2]+=d*n[13],t[s+3]=o*n[15]+c*n[16]+u*n[17]+d*n[18]+255*n[19]}}}sendUniformData(e,t){const n=this.matrix,i=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],s=[n[4],n[9],n[14],n[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,i),e.uniform4fv(t.uConstants,s)}toObject(){return he(he({},super.toObject()),{},{matrix:[...this.matrix]})}}function ha(r,e){var t;const n=(ue(t=class extends Ha{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",r),ue(t,"defaults",{colorsOnly:!1,matrix:e}),t);return Qe.setClass(n,r),n}ue(Ha,"type","ColorMatrix"),ue(Ha,"defaults",w2),ue(Ha,"uniformLocations",["uColorMatrix","uConstants"]),Qe.setClass(Ha);ha("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);ha("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);ha("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);ha("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);ha("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);ha("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);ha("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class Rx extends lr{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){Ch(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach((t=>{t.applyTo(e)}))}toObject(){return{type:this.type,subFilters:this.subFilters.map((e=>e.toObject()))}}isNeutralState(){return!this.subFilters.some((e=>!e.isNeutralState()))}static fromObject(e,t){return Promise.all((e.subFilters||[]).map((n=>Qe.getClass(n.type).fromObject(n,t)))).then((n=>new this({subFilters:n})))}}ue(Rx,"type","Composed"),Qe.setClass(Rx);class Su extends lr{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:t}}=e;const n=Math.floor(255*this.contrast),i=259*(n+255)/(255*(259-n));for(let s=0;s<t.length;s+=4)t[s]=i*(t[s]-128)+128,t[s+1]=i*(t[s+1]-128)+128,t[s+2]=i*(t[s+2]-128)+128}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}}ue(Su,"type","Contrast"),ue(Su,"defaults",{contrast:0}),ue(Su,"uniformLocations",["uContrast"]),Qe.setClass(Su);const OD={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class ku extends lr{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return OD[this.getCacheKey()]}applyTo2d(e){const t=e.imageData,n=t.data,i=this.matrix,s=Math.round(Math.sqrt(i.length)),o=Math.floor(s/2),c=t.width,u=t.height,d=e.ctx.createImageData(c,u),h=d.data,g=this.opaque?1:0;let x,m,y,v,_,S,T,C,A,P,N,O,V;for(N=0;N<u;N++)for(P=0;P<c;P++){for(_=4*(N*c+P),x=0,m=0,y=0,v=0,V=0;V<s;V++)for(O=0;O<s;O++)T=N+V-o,S=P+O-o,T<0||T>=u||S<0||S>=c||(C=4*(T*c+S),A=i[V*s+O],x+=n[C]*A,m+=n[C+1]*A,y+=n[C+2]*A,g||(v+=n[C+3]*A));h[_]=x,h[_+1]=m,h[_+2]=y,h[_+3]=g?n[_+3]:v}e.imageData=d}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return he(he({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}ue(ku,"type","Convolute"),ue(ku,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),ue(ku,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),Qe.setClass(ku);const S2="Gamma";class Cu extends lr{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:t}}=e;const n=this.gamma,i=1/n[0],s=1/n[1],o=1/n[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const c=this.rgbValues;for(let u=0;u<256;u++)c.r[u]=255*Math.pow(u/255,i),c.g[u]=255*Math.pow(u/255,s),c.b[u]=255*Math.pow(u/255,o);for(let u=0;u<t.length;u+=4)t[u]=c.r[t[u]],t[u+1]=c.g[t[u+1]],t[u+2]=c.b[t[u+2]]}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}isNeutralState(){const{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:S2,gamma:this.gamma.concat()}}}ue(Cu,"type",S2),ue(Cu,"defaults",{gamma:[1,1,1]}),ue(Cu,"uniformLocations",["uGamma"]),Qe.setClass(Cu);const DD={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class Tu extends lr{applyTo2d(e){let{imageData:{data:t}}=e;for(let n,i=0;i<t.length;i+=4){const s=t[i],o=t[i+1],c=t[i+2];switch(this.mode){case"average":n=(s+o+c)/3;break;case"lightness":n=(Math.min(s,o,c)+Math.max(s,o,c))/2;break;case"luminosity":n=.21*s+.72*o+.07*c}t[i+2]=t[i+1]=t[i]=n}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return DD[this.mode]}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}}ue(Tu,"type","Grayscale"),ue(Tu,"defaults",{mode:"average"}),ue(Tu,"uniformLocations",["uMode"]),Qe.setClass(Tu);const PD=he(he({},w2),{},{rotation:0});class Lf extends Ha{calculateMatrix(){const e=this.rotation*Math.PI,t=Ui(e),n=Vi(e),i=1/3,s=Math.sqrt(i)*n,o=1-t;this.matrix=[t+o/3,i*o-s,i*o+s,0,0,i*o+s,t+i*o,i*o-s,0,0,i*o-s,i*o+s,t+i*o,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}}ue(Lf,"type","HueRotation"),ue(Lf,"defaults",PD),Qe.setClass(Lf);class Eu extends lr{applyTo2d(e){let{imageData:{data:t}}=e;for(let n=0;n<t.length;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2],this.alpha&&(t[n+3]=255-t[n+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}}ue(Eu,"type","Invert"),ue(Eu,"defaults",{alpha:!1,invert:!0}),ue(Eu,"uniformLocations",["uInvert","uAlpha"]),Qe.setClass(Eu);class Au extends lr{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=this.noise;for(let i=0;i<t.length;i+=4){const s=(.5-Math.random())*n;t[i]+=s,t[i+1]+=s,t[i+2]+=s}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}isNeutralState(){return this.noise===0}}ue(Au,"type","Noise"),ue(Au,"defaults",{noise:0}),ue(Au,"uniformLocations",["uNoise","uSeed"]),Qe.setClass(Au);class bu extends lr{applyTo2d(e){let{imageData:{data:t,width:n,height:i}}=e;for(let s=0;s<i;s+=this.blocksize)for(let o=0;o<n;o+=this.blocksize){const c=4*s*n+4*o,u=t[c],d=t[c+1],h=t[c+2],g=t[c+3];for(let x=s;x<Math.min(s+this.blocksize,i);x++)for(let m=o;m<Math.min(o+this.blocksize,n);m++){const y=4*x*n+4*m;t[y]=u,t[y+1]=d,t[y+2]=h,t[y+3]=g}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}}ue(bu,"type","Pixelate"),ue(bu,"defaults",{blocksize:4}),ue(bu,"uniformLocations",["uBlocksize"]),Qe.setClass(bu);class Fu extends lr{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=255*this.distance,i=new At(this.color).getSource(),s=[i[0]-n,i[1]-n,i[2]-n],o=[i[0]+n,i[1]+n,i[2]+n];for(let c=0;c<t.length;c+=4){const u=t[c],d=t[c+1],h=t[c+2];u>s[0]&&d>s[1]&&h>s[2]&&u<o[0]&&d<o[1]&&h<o[2]&&(t[c+3]=0)}}sendUniformData(e,t){const n=new At(this.color).getSource(),i=this.distance,s=[0+n[0]/255-i,0+n[1]/255-i,0+n[2]/255-i,1],o=[n[0]/255+i,n[1]/255+i,n[2]/255+i,1];e.uniform4fv(t.uLow,s),e.uniform4fv(t.uHigh,o)}}ue(Fu,"type","RemoveColor"),ue(Fu,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),ue(Fu,"uniformLocations",["uLow","uHigh"]),Qe.setClass(Fu);class Ou extends lr{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){const e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){const e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){const e=this.getFilterWindow();return this.generateShader(e)}getTaps(){const e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,n=this.getFilterWindow(),i=new Array(n);for(let s=1;s<=n;s++)i[s-1]=e(s*t);return i}generateShader(e){const t=new Array(e);for(let n=1;n<=e;n++)t[n-1]="".concat(n,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(t.map(((n,i)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(n,") * uTaps[").concat(i,"] + texture2D(uTexture, vTexCoord - ").concat(n,") * uTaps[").concat(i,`];
              sum += 2.0 * uTaps[`).concat(i,`];
            `))).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){Ch(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;const n=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(n)/n}}applyTo2d(e){const t=e.imageData,n=this.scaleX,i=this.scaleY;this.rcpScaleX=1/n,this.rcpScaleY=1/i;const s=t.width,o=t.height,c=Math.round(s*n),u=Math.round(o*i);let d;d=this.resizeType==="sliceHack"?this.sliceByTwo(e,s,o,c,u):this.resizeType==="hermite"?this.hermiteFastResize(e,s,o,c,u):this.resizeType==="bilinear"?this.bilinearFiltering(e,s,o,c,u):this.resizeType==="lanczos"?this.lanczosResize(e,s,o,c,u):new ImageData(c,u),e.imageData=d}sliceByTwo(e,t,n,i,s){const o=e.imageData,c=.5;let u=!1,d=!1,h=t*c,g=n*c;const x=e.filterBackend.resources;let m=0,y=0;const v=t;let _=0;x.sliceByTwo||(x.sliceByTwo=Wi());const S=x.sliceByTwo;(S.width<1.5*t||S.height<n)&&(S.width=1.5*t,S.height=n);const T=S.getContext("2d");for(T.clearRect(0,0,1.5*t,n),T.putImageData(o,0,0),i=Math.floor(i),s=Math.floor(s);!u||!d;)t=h,n=g,i<Math.floor(h*c)?h=Math.floor(h*c):(h=i,u=!0),s<Math.floor(g*c)?g=Math.floor(g*c):(g=s,d=!0),T.drawImage(S,m,y,t,n,v,_,h,g),m=v,y=_,_+=g;return T.getImageData(m,y,i,s)}lanczosResize(e,t,n,i,s){const o=e.imageData.data,c=e.ctx.createImageData(i,s),u=c.data,d=this.lanczosCreate(this.lanczosLobes),h=this.rcpScaleX,g=this.rcpScaleY,x=2/this.rcpScaleX,m=2/this.rcpScaleY,y=Math.ceil(h*this.lanczosLobes/2),v=Math.ceil(g*this.lanczosLobes/2),_={},S={x:0,y:0},T={x:0,y:0};return(function C(A){let P,N,O,V,B,te,ie,D,J,F,se;for(S.x=(A+.5)*h,T.x=Math.floor(S.x),P=0;P<s;P++){for(S.y=(P+.5)*g,T.y=Math.floor(S.y),B=0,te=0,ie=0,D=0,J=0,N=T.x-y;N<=T.x+y;N++)if(!(N<0||N>=t)){F=Math.floor(1e3*Math.abs(N-S.x)),_[F]||(_[F]={});for(let Ee=T.y-v;Ee<=T.y+v;Ee++)Ee<0||Ee>=n||(se=Math.floor(1e3*Math.abs(Ee-S.y)),_[F][se]||(_[F][se]=d(Math.sqrt(Math.pow(F*x,2)+Math.pow(se*m,2))/1e3)),O=_[F][se],O>0&&(V=4*(Ee*t+N),B+=O,te+=O*o[V],ie+=O*o[V+1],D+=O*o[V+2],J+=O*o[V+3]))}V=4*(P*i+A),u[V]=te/B,u[V+1]=ie/B,u[V+2]=D/B,u[V+3]=J/B}return++A<i?C(A):c})(0)}bilinearFiltering(e,t,n,i,s){let o,c,u,d,h,g,x,m,y,v,_,S,T,C=0;const A=this.rcpScaleX,P=this.rcpScaleY,N=4*(t-1),O=e.imageData.data,V=e.ctx.createImageData(i,s),B=V.data;for(x=0;x<s;x++)for(m=0;m<i;m++)for(h=Math.floor(A*m),g=Math.floor(P*x),y=A*m-h,v=P*x-g,T=4*(g*t+h),_=0;_<4;_++)o=O[T+_],c=O[T+4+_],u=O[T+N+_],d=O[T+N+4+_],S=o*(1-y)*(1-v)+c*y*(1-v)+u*v*(1-y)+d*y*v,B[C++]=S;return V}hermiteFastResize(e,t,n,i,s){const o=this.rcpScaleX,c=this.rcpScaleY,u=Math.ceil(o/2),d=Math.ceil(c/2),h=e.imageData.data,g=e.ctx.createImageData(i,s),x=g.data;for(let m=0;m<s;m++)for(let y=0;y<i;y++){const v=4*(y+m*i);let _=0,S=0,T=0,C=0,A=0,P=0,N=0;const O=(m+.5)*c;for(let V=Math.floor(m*c);V<(m+1)*c;V++){const B=Math.abs(O-(V+.5))/d,te=(y+.5)*o,ie=B*B;for(let D=Math.floor(y*o);D<(y+1)*o;D++){let J=Math.abs(te-(D+.5))/u;const F=Math.sqrt(ie+J*J);F>1&&F<-1||(_=2*F*F*F-3*F*F+1,_>0&&(J=4*(D+V*t),N+=_*h[J+3],T+=_,h[J+3]<255&&(_=_*h[J+3]/250),C+=_*h[J],A+=_*h[J+1],P+=_*h[J+2],S+=_))}}x[v]=C/S,x[v+1]=A/S,x[v+2]=P/S,x[v+3]=N/T}return g}}ue(Ou,"type","Resize"),ue(Ou,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),ue(Ou,"uniformLocations",["uDelta","uTaps"]),Qe.setClass(Ou);class Du extends lr{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=-this.saturation;for(let i=0;i<t.length;i+=4){const s=t[i],o=t[i+1],c=t[i+2],u=Math.max(s,o,c);t[i]+=u!==s?(u-s)*n:0,t[i+1]+=u!==o?(u-o)*n:0,t[i+2]+=u!==c?(u-c)*n:0}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}ue(Du,"type","Saturation"),ue(Du,"defaults",{saturation:0}),ue(Du,"uniformLocations",["uSaturation"]),Qe.setClass(Du);class Pu extends lr{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=-this.vibrance;for(let i=0;i<t.length;i+=4){const s=t[i],o=t[i+1],c=t[i+2],u=Math.max(s,o,c),d=(s+o+c)/3,h=2*Math.abs(u-d)/255*n;t[i]+=u!==s?(u-s)*h:0,t[i+1]+=u!==o?(u-o)*h:0,t[i+2]+=u!==c?(u-c)*h:0}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}ue(Pu,"type","Vibrance"),ue(Pu,"defaults",{vibrance:0}),ue(Pu,"uniformLocations",["uVibrance"]),Qe.setClass(Pu);const MD=({project:r,onProjectUpdate:e})=>{const[t,n]=vt.useState(null),[i,s]=vt.useState(null),[o,c]=vt.useState(!1),[u,d]=vt.useState(!1),[h,g]=vt.useState(!1),[x,m]=vt.useState(null),[y,v]=vt.useState(!1),[_,S]=vt.useState(!1),[T,C]=vt.useState(!1),A=vt.useRef(null),P=vt.useRef(null),N=vt.useRef(null),O=vt.useRef(null),V=()=>{const ne="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(r,null,2)),z=document.createElement("a");z.setAttribute("href",ne),z.setAttribute("download",(r.watchName||"watchface")+".json"),document.body.appendChild(z),z.click(),z.remove()},B=()=>{O.current&&(O.current.value="",O.current.click())},te=ne=>{const z=ne.target.files&&ne.target.files[0];if(!z)return;const Le=new FileReader;Le.onload=E=>{var de;try{const ce=JSON.parse((de=E.target)==null?void 0:de.result);ce&&ce.components&&Array.isArray(ce.components)?e(ce):alert("Invalid project file.")}catch(ce){alert("Failed to load project: "+ce)}},Le.readAsText(z)},ie=ne=>{switch(ne){case mt.Steps:return"Steps";case mt.HeartRate:return"Heart Rate";case mt.Calories:return"Calories";case mt.Battery:return"Battery";case mt.BloodOxygen:return"Blood Oxygen";case mt.Distance:return"Step Distance";case mt.Sleep:return"Sleep Duration";case mt.Weather:return"Weather";default:return"Steps"}},D=ne=>{const z=ie(ne),Le=$n.getWatchSettingByItemName(z);return{maxValue:(Le==null?void 0:Le.MaxNum)||999999,minValue:(Le==null?void 0:Le.MinNum)||0,defaultValue:(Le==null?void 0:Le.Default)||0,targetValue:(Le==null?void 0:Le.TargetValue)||0,itemName:z}},J=(ne,z,Le,E,de,ce,j)=>{m({componentType:ne,elementType:z,dateTimeFormat:Le,timeComponentType:E,digitType:de,digitPosition:ce,componentName:j}),g(!0)},F=()=>{if(g(!1),!x)return;let ne=x.componentType;const z=x.elementType,Le=x.dateTimeFormat,E=x.timeComponentType,de=x.digitType,ce=x.digitPosition,j=x.componentName;A.current&&(A.current.onchange=U=>{const ae=Array.from(U.target.files||[]);if(ae.length>0){const Ae=ae.map(Oe=>URL.createObjectURL(Oe));if(ne==="dateTime"&&Le){if(Le==="AMPM"||Le==="AM/PM"){if(ae.length!==2){if(!confirm(`AM/PM component requires exactly 2 images (one for AM, one for PM). You uploaded ${ae.length} images.

Options:
 Click OK to create a simple background image instead
 Click Cancel to go back and upload 2 images`)){if(A.current)try{A.current.value=""}catch{}return}ne="image"}}else if(Le==="Week"){if(ae.length!==7){if(!confirm(`Week component requires 7 images (one for each day of the week). You uploaded ${ae.length} images.

Options:
 Click OK to create a simple background image instead
 Click Cancel to go back and upload 7 images`)){if(A.current)try{A.current.value=""}catch{}return}ne="image"}}else if((de==="multi"||de==="single")&&ae.length<10){if(!confirm(`For ${Le||"DateTime"} components, you typically need 10 images (one for each digit 0-9). You uploaded ${ae.length} images.

Options:
 Click OK to create a simple background image instead
 Click Cancel to go back and upload 10 digit images (0.png to 9.png)`)){if(A.current)try{A.current.value=""}catch{}return}ne="image"}}else if(ne!=="progress"){if(ne==="number"){if(ae.length<10){const Oe=`For number components, you typically need at least 10 images (one for each digit 0-9). You uploaded ${ae.length} images.

Options:
 Click OK to create a simple background image instead
 Click Cancel to go back and upload at least 10 digit images (0.png to 9.png)`;if(!confirm(Oe)){if(A.current)try{A.current.value=""}catch{}return}ne="image"}else if(de==="multi"){const Oe=D(z||0),Re={id:Hn(),type:"number",elementType:z,name:j||Oe.itemName||"Number",images:Ae,position:{x:150,y:200},size:{width:250,height:80},config:{leadingZero:!1,minValue:Oe.minValue,maxValue:Oe.maxValue,defaultValue:Oe.defaultValue,targetValue:Oe.targetValue,itemName:Oe.itemName,digitPosition:"multi"}},Be={...r,components:[...r.components,Re]};if(e(Be),A.current)try{A.current.value=""}catch{}return}else if(de==="single"){const Oe=D(z||0),Re={id:Hn(),type:"number",elementType:z,name:`${j||Oe.itemName} ${ce||"Single"}`,images:Ae,position:{x:150,y:200},size:{width:50,height:80},config:{leadingZero:!1,minValue:0,maxValue:9,defaultValue:0,itemName:Oe.itemName,digitPosition:ce}},Be={...r,components:[...r.components,Re]};if(e(Be),A.current)try{A.current.value=""}catch{}return}}}const Pe=$n.getWatchSettingByItemName(Le||""),ge=Pe?$n.getComponentConfig(Pe):{dateTimeFormat:Le,leadingZero:!0,minValue:0,maxValue:100,defaultValue:0};if(ne==="dateTime"&&Le)if(Le==="AMPM"||Le==="AM/PM"){const Oe={id:Hn(),type:"dateTime",elementType:z,timeComponent:E,name:"AM/PM",images:Ae,position:{x:150,y:200},size:{width:60,height:40},config:{...ge,dateTimeFormat:"AMPM"}},Re={...r,components:[...r.components,Oe]};if(e(Re),A.current)try{A.current.value=""}catch{}return}else if(Le==="Week"){const Oe={id:Hn(),type:"dateTime",elementType:z,timeComponent:E,name:"Week",images:Ae,position:{x:150,y:200},size:{width:80,height:40},config:{...ge,dateTimeFormat:"Week"}},Re={...r,components:[...r.components,Oe]};if(e(Re),A.current)try{A.current.value=""}catch{}return}else if(de==="multi"){const Oe={id:Hn(),type:"dateTime",elementType:z,timeComponent:E,name:`${Le}`,images:Ae,position:{x:150,y:200},size:{width:Le==="Year"?200:100,height:80},config:{...ge,digitPosition:"multi"}},Re={...r,components:[...r.components,Oe]};if(e(Re),A.current)try{A.current.value=""}catch{}}else if(de==="single"){const Oe={id:Hn(),type:"dateTime",elementType:z,timeComponent:E,name:`${Le} ${ce||"Single"}`,images:Ae,position:{x:100,y:200},size:{width:50,height:80},config:{...ge,digitPosition:ce||"single"}},Re={...r,components:[...r.components,Oe]};if(e(Re),A.current)try{A.current.value=""}catch{}}else{const Oe={id:Hn(),type:"dateTime",elementType:z,timeComponent:E,name:`${Le} Tens`,images:Ae,position:{x:100,y:200},size:{width:50,height:80},config:{dateTimeFormat:Le,leadingZero:!0,minValue:0,maxValue:Le==="Hour"?2:5,defaultValue:1,digitPosition:"tens"}},Re={id:Hn(),type:"dateTime",elementType:z,timeComponent:E,name:`${Le} Ones`,images:Ae,position:{x:160,y:200},size:{width:50,height:80},config:{dateTimeFormat:Le,leadingZero:!0,minValue:0,maxValue:9,defaultValue:2,digitPosition:"ones"}},Be={...r,components:[...r.components,Oe,Re]};if(e(Be),A.current)try{A.current.value=""}catch{}}else{const Oe=ne==="image"&&z===null,Re=Oe?null:D(z||0),Be={id:Hn(),type:ne,elementType:z,timeComponent:E,name:Oe?`Background Image ${r.components.length+1}`:(Re==null?void 0:Re.itemName)||`${ne} ${r.components.length+1}`,images:Ae,position:{x:100,y:100},size:{width:100,height:100},config:{leadingZero:!0,minValue:(Re==null?void 0:Re.minValue)||0,maxValue:(Re==null?void 0:Re.maxValue)||100,defaultValue:(Re==null?void 0:Re.defaultValue)||0,targetValue:(Re==null?void 0:Re.targetValue)||0,itemName:Oe?"Background Image":(Re==null?void 0:Re.itemName)||ne}};console.log("Adding new component:",Be);const re={...r,components:[...r.components,Be]};if(e(re),m(null),A.current)try{A.current.value=""}catch{}}}},A.current.click())},se=ne=>{A.current&&(A.current.onchange=z=>{const Le=Array.from(z.target.files||[]);if(Le.length>0){const E=URL.createObjectURL(Le[0]),de=ne==="hour"?0:ne==="minute"?1:2,ce={id:Hn(),type:"analog",elementType:null,name:`${ne.charAt(0).toUpperCase()+ne.slice(1)} Hand`,images:[E],position:{x:220,y:0},size:{width:26,height:466},config:{itemName:"Pointer",startAngle:0,endAngle:ne==="hour"?720:360,originPointX:13,originPointY:233,valueIndex:de,value:0,angle:0}},j={...r,components:[...r.components,ce]};if(e(j),A.current)try{A.current.value=""}catch{}}},A.current.click())},Ee=ne=>{if(ne===0)return;const z=[...r.components];[z[ne-1],z[ne]]=[z[ne],z[ne-1]],e({...r,components:z})},le=ne=>{if(ne===r.components.length-1)return;const z=[...r.components];[z[ne],z[ne+1]]=[z[ne+1],z[ne]],e({...r,components:z})},xe=ne=>{const z=r.components.filter((Le,E)=>E!==ne);e({...r,components:z}),(t==null?void 0:t.id)===r.components[ne].id&&n(null)},X=ne=>{const z={id:Hn(),type:pe(ne),elementType:ne.elementType,name:ne.dragName||ne.itemName||"Unnamed Component",images:Array.isArray(ne.imageSource)?ne.imageSource:[ne.imageSource].filter(Boolean),position:{x:ne.x||100,y:ne.y||100},size:{width:ne.width||100,height:ne.height||50},config:R(ne)},Le=$n.validateComponent(ne);Le.length>0&&console.warn("Component validation issues:",Le);const E={...r,components:[...r.components,z]};e(E)},pe=ne=>{switch(ne.constructor.name){case"DragBindNormalDateTime":case"DragBindSingleDigit":case"DragBindWeek":case"DragBindMonthDay":case"DragBindAMPM":return"dateTime";case"DragBindProgress":return"progress";case"DragBindNums":return"number";case"DragBindSwitch":case"DragBindImage":return"image";default:return"dateTime"}},R=ne=>{const z={};return z.elementType=ne.elementType,z.itemName=ne.itemName,"dateTimeFormat"in ne&&(z.dateTimeFormat=ne.dateTimeFormat),"maxNum"in ne&&(z.maxValue=ne.maxNum,z.minValue=ne.minNum,z.defaultValue=ne.defaultNum),"targetValue"in ne&&(z.targetValue=ne.targetValue),"fillType"in ne&&(z.fillType=ne.fillType),"openSource"in ne&&(z.openImage=ne.openSource,z.closeImage=ne.closeSource),"amSource"in ne&&(z.amImage=ne.amSource,z.pmImage=ne.pmSource),z},b=ne=>{n(ne)},ee=(ne,z)=>{const Le=r.components.map(E=>E.id===ne?{...E,position:z}:E);e({...r,components:Le})},G=ne=>{const z=r.components.map(Le=>Le.id===ne.id?ne:Le);e({...r,components:z}),n(ne)},H=ne=>{const z=r.components.filter(Le=>Le.id!==ne);e({...r,components:z}),(t==null?void 0:t.id)===ne&&n(null)},me=async()=>{var Oe,Re,Be;const ne=r.watchName||"MyWatchFace",z=new Date().toISOString().replace(/[:]/g,"-").split(".")[0],Le=`${ne}_${z}`,E=new Set,de=new Map;r.components.forEach(re=>{re.images.forEach(nt=>{nt&&E.add(nt)})});const ce=new Map;let j=0;for(const re of E)if(re.startsWith("blob:"))try{const He=await(await fetch(re)).blob(),Ne=He.type.split("/")[1]||"png",Ye=`image_${(j+1).toString().padStart(3,"0")}.${Ne}`,Ze=`assets/${Ye}`,dt=new File([He],Ye,{type:He.type});ce.set(Ze,dt),de.set(re,Ze),j++}catch(nt){console.warn("Failed to process image:",re,nt),de.set(re,re)}else{const He=`assets/${`external_${(j+1).toString().padStart(3,"0")}.png`}`;de.set(re,He),j++}const U={WatchName:r.watchName,WatchCode:r.watchCode,CornerX:null,CornerY:null,Width:r.width,Height:r.height,ThumbnailWidth:46,ThumbnailHeight:46,Corner:0,DeviceType:r.deviceType,CreateTime:r.createTime,IsAlbum:!1,ColorBit:r.colorBit,AlbumBackground:null,FolderName:Le,ImageData:Object.fromEntries(ce),WatchStyles:[{StyleName:"style1",DragBindBases:r.components.map(re=>{const nt=re.images.map(He=>de.get(He)||He);if(console.log(`Processing component: "${re.name}", type: "${re.type}", type check: ${re.type==="analog"}`),re.type==="image")return{$type:"WatchControlLibrary.DragBindImage, WatchControlLibrary",dragName:re.name,height:re.size.height,left:re.position.x,top:re.position.y,align:0,elementType:re.elementType,Source:nt[0]||"",DragName:re.name,Width:re.size.width,DragId:re.id,Height:re.size.height,Left:re.position.x,Top:re.position.y,Align:0,ElementType:re.elementType,MaxNum:re.config.maxValue||0,MinNum:re.config.minValue||0,SubItems:[],Visable:!0,ItemName:re.config.itemName||re.name.split(" ")[0],DefaultNum:re.config.defaultValue||null,VerifyNullNum:re.images.length===11};if(re.type==="dateTime"){let He=re.config.itemName||re.name.split(" ")[0];if(re.config.digitPosition&&re.config.digitPosition!=="multi"){const Ye={tens:"Tens",ones:"Ones",hundreds:"Hundreds",thousands:"Thousands",single:"Single"}[re.config.digitPosition]||"";Ye&&(He=`${He} (${Ye})`)}return{$type:"WatchControlLibrary.DragBindNormalDateTime, WatchControlLibrary",dragName:re.name,height:re.size.height,left:re.position.x,top:re.position.y,align:0,elementType:re.elementType,DateTimeFormat:re.config.dateTimeFormat||"Hour",UnitIcon:null,ImageSource:nt,SetDateTime:new Date().toISOString(),LeadingZero:re.config.leadingZero||!0,DragName:re.name,Width:re.size.width,DragId:re.id,Height:re.size.height,Left:re.position.x,Top:re.position.y,Align:0,ElementType:re.elementType,MaxNum:re.config.maxValue||0,MinNum:re.config.minValue||0,SubItems:[],Visable:!0,ItemName:He,DefaultNum:re.config.defaultValue||null,VerifyNullNum:re.images.length===11}}else if(re.type==="progress"){const He=re.config.fillType!==void 0?re.config.fillType:re.config.itemName==="Battery"||re.config.itemName==="Battery Progress";let Ne=re.config.itemName||re.name.split(" ")[0];if(re.config.digitPosition&&re.config.digitPosition!=="multi"){const Ze={tens:"Tens",ones:"Ones",hundreds:"Hundreds",thousands:"Thousands",single:"Single"}[re.config.digitPosition]||"";Ze&&(Ne=`${Ne} (${Ze})`)}return{$type:"WatchControlLibrary.DragBindProgress, WatchControlLibrary",dragName:re.name,height:re.size.height,left:re.position.x,top:re.position.y,align:0,elementType:re.elementType,CurrentNum:0,RatioNum:0,TargetValue:re.config.targetValue||re.config.maxValue||100,UnitSource:null,FillType:He,ImageSource:nt,DragName:re.name,Width:re.size.width,DragId:re.id,Height:re.size.height,Left:re.position.x,Top:re.position.y,Align:0,ElementType:re.elementType,MaxNum:re.config.maxValue||0,MinNum:re.config.minValue||0,SubItems:[],Visable:!0,ItemName:Ne,DefaultNum:re.config.defaultValue||null,VerifyNullNum:re.images.length===11}}else if(re.type==="number"){const He=nt.length===11,Ne=He?nt.slice(0,10):nt,Ye=He?nt[10]:null;let Ze=re.config.itemName||re.name.split(" ")[0];if(re.config.digitPosition&&re.config.digitPosition!=="multi"){const st={tens:"Tens",ones:"Ones",hundreds:"Hundreds",thousands:"Thousands",single:"Single"}[re.config.digitPosition]||"";st&&(Ze=`${Ze} (${st})`)}return{$type:"WatchControlLibrary.DragBindNums, WatchControlLibrary",dragName:re.name,height:re.size.height,left:re.position.x,top:re.position.y,align:0,elementType:re.elementType,CurrentNum:re.config.defaultValue||0,UnitSource:null,ImageSource:Ne,MinusSource:null,EmptySource:Ye,DefaultNum:re.config.defaultValue,DragName:re.name,Width:re.size.width,DragId:re.id,Height:re.size.height,Left:re.position.x,Top:re.position.y,Align:0,ElementType:re.elementType,MaxNum:re.config.maxValue||0,MinNum:re.config.minValue||0,SubItems:[],Visable:!0,ItemName:Ze,VerifyNullNum:re.images.length===11}}else return re.type==="analog"?{$type:"WatchControlLibrary.DragBindPoint, WatchControlLibrary",dragName:re.name,height:re.size.height,left:re.position.x,top:re.position.y,align:0,elementType:null,StartAngle:re.config.startAngle||0,EndAngle:re.config.endAngle||360,OriginPointX:re.config.originPointX||13,OriginPointY:re.config.originPointY||233,Source:nt[0]||"",Value:re.config.value||0,Angle:re.config.angle||0,ValueIndex:re.config.valueIndex||0,DragName:re.name,Width:re.size.width,DragId:re.id,Height:re.size.height,Left:re.position.x,Top:re.position.y,Align:0,ElementType:null,MaxNum:0,MinNum:0,SubItems:[],Visable:!0,ItemName:re.config.itemName||"Pointer",DefaultNum:null,VerifyNullNum:!1}:(console.error("Unknown component type:",re.type,re),{$type:"WatchControlLibrary.DragBindImage, WatchControlLibrary",dragName:re.name,height:re.size.height,left:re.position.x,top:re.position.y,align:0,elementType:re.elementType,Source:nt[0]||"",DragName:re.name,Width:re.size.width,DragId:re.id,Height:re.size.height,Left:re.position.x,Top:re.position.y,Align:0,ElementType:re.elementType,MaxNum:re.config.maxValue||0,MinNum:re.config.minValue||0,SubItems:[],Visable:!0,ItemName:re.config.itemName||re.name.split(" ")[0],DefaultNum:re.config.defaultValue||null,VerifyNullNum:!1})}).filter(re=>re!==null),TemplateBinds:[],ScreenType:0,Zh:{Width:0,Height:0,Item:{KwhNum:0,StepNum:((Oe=r.components.find(re=>re.config.itemName==="Steps"))==null?void 0:Oe.config.defaultValue)||7645,HeartRateNum:((Re=r.components.find(re=>re.config.itemName==="Heart Rate"))==null?void 0:Re.config.defaultValue)||72,CalorieNum:((Be=r.components.find(re=>re.config.itemName==="Calories"))==null?void 0:Be.config.defaultValue)||324,CurrentDateTime:new Date().toISOString(),StrengthNum:0,IsOpen:!1},DragBindBases:null}}]};U.WatchStyles[0].TemplateBinds=[...U.WatchStyles[0].DragBindBases];const ae=new $1,Ae=ae.folder(Le),Pe=JSON.stringify(U,null,2);Ae.file(`${ne}.json`,Pe);const ge=`# Watch Face Project: ${ne}

## Project Structure:
\`\`\`
${Le}/
 ${ne}.json          # Watch face configuration with embedded base64 images
 README.md                    # This file
\`\`\`

## Usage for Backend Processing:
1. Extract this ZIP file to get the project folder
2. Send the entire project folder to your backend program
3. The backend will read ${ne}.json with embedded base64 images
4. Backend will decode base64 images and generate the .bin file for the watch

## Component Details:
- Components: ${r.components.length}
- Image Assets: ${ce.size} (embedded as base64)
- Watch Dimensions: ${r.width}x${r.height}
- Device Type: ${r.deviceType}

## Generated on: ${new Date().toLocaleString()}
## Export Format: Compatible with Windows WatchFace Designer backend (Base64 embedded images)
`;Ae.file("README.md",ge);try{const re=await ae.generateAsync({type:"blob"}),nt=URL.createObjectURL(re),He=document.createElement("a");He.href=nt,He.download=`${Le}.zip`,document.body.appendChild(He),He.click(),document.body.removeChild(He),URL.revokeObjectURL(nt),console.log(`Exported project: ${Le}.zip`)}catch(re){console.error("Export failed:",re);const nt=new Blob([Pe],{type:"application/json"}),He=URL.createObjectURL(nt),Ne=document.createElement("a");Ne.href=He,Ne.download="watchFace.json",document.body.appendChild(Ne),Ne.click(),document.body.removeChild(Ne),URL.revokeObjectURL(He)}},Me=async()=>{var ne,z,Le;try{c(!0);const E=r.watchName||"MyWatchFace",de=new Date().toISOString().replace(/[:]/g,"-").split(".")[0],ce=`${E}_${de}`,j=new Set,U=new Map;r.components.forEach(Ne=>{Ne.images.forEach(Ye=>{Ye&&j.add(Ye)})});const ae=new Map;let Ae=0;for(const Ne of j)if(Ne.startsWith("blob:"))try{const Ze=await(await fetch(Ne)).blob(),dt=await new Promise(pr=>{const mn=new FileReader;mn.onloadend=()=>{const ni=mn.result.split(",")[1];pr(ni)},mn.readAsDataURL(Ze)}),st=Ze.type.split("/")[1]||"png",Nn=`assets/${`image_${(Ae+1).toString().padStart(3,"0")}.${st}`}`;ae.set(Nn,dt),U.set(Ne,Nn),Ae++}catch(Ye){console.warn("Failed to process image:",Ne,Ye),U.set(Ne,Ne)}else{const Ze=`assets/${`external_${(Ae+1).toString().padStart(3,"0")}.png`}`;U.set(Ne,Ze),Ae++}console.log("imageFiles Map keys:",Array.from(ae.keys())),console.log("imageFiles Map size:",ae.size),console.log("imageMappings:",Array.from(U.entries()));const Pe={WatchName:r.watchName,WatchCode:r.watchCode,CornerX:null,CornerY:null,Width:r.width,Height:r.height,ThumbnailWidth:46,ThumbnailHeight:46,Corner:0,DeviceType:r.deviceType,CreateTime:r.createTime,IsAlbum:!1,ColorBit:r.colorBit,AlbumBackground:null,FolderName:ce,ImageData:Object.fromEntries(ae),WatchStyles:[{StyleName:"style1",DragBindBases:r.components.map(Ne=>{const Ye={DragName:Ne.name,Width:Ne.size.width,Height:Ne.size.height,Left:Ne.position.x,Top:Ne.position.y,Align:0,ElementType:Ne.elementType,DragId:Ne.id,MaxNum:Ne.config.maxValue||0,MinNum:Ne.config.minValue||0,SubItems:[],Visable:!0,ItemName:Ne.config.itemName||Ne.name.split(" ")[0],DefaultNum:Ne.config.defaultValue||null,VerifyNullNum:Ne.images.length===11},Ze=Ne.images.map(dt=>U.get(dt)||dt);if(Ne.type==="image")return{$type:"WatchControlLibrary.DragBindImage, WatchControlLibrary",...Ye,Source:Ze[0]||""};if(Ne.type==="dateTime")return{$type:"WatchControlLibrary.DragBindNormalDateTime, WatchControlLibrary",...Ye,DateTimeFormat:Ne.config.dateTimeFormat||"Hour",UnitIcon:null,ImageSource:Ze,SetDateTime:new Date().toISOString(),LeadingZero:Ne.config.leadingZero||!0};if(Ne.type==="progress"){const dt=Ne.config.fillType!==void 0?Ne.config.fillType:Ne.config.itemName==="Battery"||Ne.config.itemName==="Battery Progress";return{$type:"WatchControlLibrary.DragBindProgress, WatchControlLibrary",...Ye,CurrentNum:0,RatioNum:0,TargetValue:Ne.config.targetValue||Ne.config.maxValue||100,UnitSource:null,FillType:dt,ImageSource:Ze}}else if(Ne.type==="number"){const dt=Ze.length===11,st=dt?Ze.slice(0,10):Ze,Ht=dt?Ze[10]:null;return{$type:"WatchControlLibrary.DragBindNums, WatchControlLibrary",...Ye,CurrentNum:Ne.config.defaultValue||0,UnitSource:null,ImageSource:st,MinusSource:null,EmptySource:Ht,DefaultNum:Ne.config.defaultValue}}else if(Ne.type==="analog")return{$type:"WatchControlLibrary.DragBindPoint, WatchControlLibrary",dragName:Ne.name,height:Ne.size.height,left:Ne.position.x,top:Ne.position.y,align:0,elementType:null,StartAngle:Ne.config.startAngle||0,EndAngle:Ne.config.endAngle||360,OriginPointX:Ne.config.originPointX||13,OriginPointY:Ne.config.originPointY||233,Source:Ze[0]||"",Value:Ne.config.value||0,Angle:Ne.config.angle||0,ValueIndex:Ne.config.valueIndex||0,DragName:Ne.name,Width:Ne.size.width,DragId:Ne.id,Height:Ne.size.height,Left:Ne.position.x,Top:Ne.position.y,Align:0,ElementType:null,MaxNum:0,MinNum:0,SubItems:[],Visable:!0,ItemName:Ne.config.itemName||"Pointer",DefaultNum:null,VerifyNullNum:!1};return console.error("Unknown component type:",Ne.type,Ne),{$type:"WatchControlLibrary.DragBindImage, WatchControlLibrary",...Ye,Source:Ze[0]||""}}),TemplateBinds:[],ScreenType:0,Zh:{Width:0,Height:0,Item:{KwhNum:0,StepNum:((ne=r.components.find(Ne=>Ne.config.itemName==="Steps"))==null?void 0:ne.config.defaultValue)||7645,HeartRateNum:((z=r.components.find(Ne=>Ne.config.itemName==="Heart Rate"))==null?void 0:z.config.defaultValue)||72,CalorieNum:((Le=r.components.find(Ne=>Ne.config.itemName==="Calories"))==null?void 0:Le.config.defaultValue)||324,CurrentDateTime:new Date().toISOString(),StrengthNum:0,IsOpen:!1},DragBindBases:null}}]};Pe.WatchStyles[0].TemplateBinds=[...Pe.WatchStyles[0].DragBindBases],console.log("watchFaceData.ImageData keys:",Object.keys(Pe.ImageData)),console.log("watchFaceData.ImageData:",Pe.ImageData);const ge=new $1,Oe=ge.folder(ce),Re=JSON.stringify(Pe,null,2);Oe.file(`${E}.json`,Re);const Be=await ge.generateAsync({type:"blob"});console.log("Sending project to backend:",{projectName:ce,components:r.components.length,imageFiles:ae.size,componentDetails:r.components.map(Ne=>({name:Ne.name,type:Ne.type,imageCount:Ne.images.length,config:Ne.config}))}),console.log("DragBindBases JSON:",JSON.stringify(Pe.WatchStyles[0].DragBindBases,null,2)),new FormData().append("zipFile",Be,`${ce}.zip`),console.log("=== GENERATING JSON ==="),console.log("Total components:",r.components.length),r.components.forEach((Ne,Ye)=>{var Ze,dt;console.log(`Component ${Ye+1}:`,{name:Ne.name,type:Ne.type,elementType:Ne.elementType,digitPosition:(Ze=Ne.config)==null?void 0:Ze.digitPosition,itemName:(dt=Ne.config)==null?void 0:dt.itemName})}),console.log("=====================");const nt="http://localhost:3001/api/jieli/convert";let He=null;try{He=await fetch(nt,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({watchFaceData:Pe})})}catch(Ne){throw new Error(`Failed to connect to JieLi middleware at ${nt}. Make sure the middleware server is running. Error: ${Ne.message}`)}if(!He)throw new Error("Failed to connect to JieLi middleware. Make sure the server is running on port 3001.");if(He.ok){const Ne=await He.blob(),Ye=He.headers.get("Content-Disposition");let Ze=`${r.watchCode}_${r.watchName}_${r.deviceType}.bin`;if(Ye){const Ht=Ye.match(/filename="(.+)"/);Ht&&(Ze=Ht[1])}const dt=URL.createObjectURL(Ne),st=document.createElement("a");st.href=dt,st.download=Ze,document.body.appendChild(st),st.click(),document.body.removeChild(st),URL.revokeObjectURL(dt),console.log(`Generated and downloaded bin file: ${Ze}`)}else{const Ne=await He.text();console.error("Backend error response:",Ne);let Ye=`Backend error: ${He.status}`;if(Ne.includes("image_")){const Ze=Ne.match(/image_(\d+)\.png/);if(Ze){const dt=parseInt(Ze[1]);Ye=`Missing image file: image_${Ze[1]}.png

This usually means you need to upload ${dt} images for a digit component.
For digit components (numbers, time, progress), you need exactly 10 images:
 0.png, 1.png, 2.png, ... 9.png (one for each digit)

If you want to create a simple background image instead, please delete this component and add it again as an 'Image' component.`}}else Ne.includes("FileNotFoundException")?Ye=`Missing required files. Please ensure:
 All images are included in your project
 For digit components: upload 10 images (0.png to 9.png)
 For simple images: use the 'Image' component type`:Ye+=` - ${Ne}`;throw new Error(Ye)}}catch(E){console.error("Error generating bin file:",E);const de=E.message||"Unknown error occurred",ce=de.includes("image_")||de.includes("Missing image file");alert(ce?` Watch Face Generation Failed

${de}

 Quick Fix:
1. Delete components with insufficient images
2. Add them again with the correct number of images
3. Or change component type to 'Image' for simple backgrounds`:`Error generating bin file: ${de}`)}finally{c(!1)}};vt.useEffect(()=>{if(P.current&&!N.current){const ne=new ad(P.current,{width:r.width,height:r.height,backgroundColor:"transparent",selection:!1,evented:!1,interactive:!1,skipTargetFind:!0});N.current=ne,u&&Fe()}return()=>{N.current&&(N.current.dispose(),N.current=null)}},[r.width,r.height]),vt.useEffect(()=>{N.current&&(u?Fe():be())},[u]);const Fe=()=>{if(!N.current)return;const ne=N.current,z=r.width,Le=r.height,E=20,de="#00ff00",ce=.6;be();for(let j=0;j<=z;j+=E){const U=new Pi([j,0,j,Le],{stroke:de,strokeWidth:1,opacity:ce,selectable:!1,evented:!1,data:{isGrid:!0}});ne.add(U)}for(let j=0;j<=Le;j+=E){const U=new Pi([0,j,z,j],{stroke:de,strokeWidth:1,opacity:ce,selectable:!1,evented:!1,data:{isGrid:!0}});ne.add(U)}ne.renderAll()},be=()=>{if(!N.current)return;const ne=N.current;ne.getObjects().filter(E=>{var de;return(de=E.data)==null?void 0:de.isGrid}).forEach(E=>ne.remove(E)),ne.renderAll()},De=()=>{d(!u)};return L.jsxs("div",{className:"assembly-view view-container",children:[L.jsx("input",{type:"file",ref:A,style:{display:"none"},multiple:!0,accept:"image/*"}),L.jsxs("div",{className:`sidebar${y?" collapsed":""}`,children:[L.jsxs("div",{className:"sidebar-header",children:[L.jsx("h3",{children:"Component Library"}),L.jsxs("div",{style:{display:"flex",gap:8},children:[L.jsxs("button",{className:"btn btn-primary",onClick:()=>J("image",null),children:[L.jsx(Nu,{size:16})," Add Images"]}),L.jsx("button",{className:"btn btn-secondary",style:{minWidth:32},onClick:()=>v(ne=>!ne),title:y?"Expand":"Collapse",children:y?"":""})]})]}),!y&&L.jsx(Lb,{onAddTimeComponent:(ne,z,Le,E)=>J("dateTime",0,z,ne,Le,E),onAddProgressComponent:ne=>J("progress",ne),onAddNumberComponent:(ne,z,Le)=>{J("number",ne,void 0,void 0,z,Le,ne===1?"Blood Oxygen":ne===3?"Steps":ne===4?"Heart Rate":ne===5?"Calories":"Number")},onAddImageComponent:()=>J("image",null),onAddComponent:X,onAddAnalogComponent:se})]}),L.jsxs("div",{className:"main-area",children:[L.jsxs("div",{className:"toolbar",children:[L.jsxs("div",{className:"toolbar-left",children:[L.jsx("span",{className:"project-name",children:r.watchName}),L.jsxs("div",{style:{marginLeft:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[L.jsx("label",{style:{fontWeight:"bold"},children:"Watch Shape:"}),L.jsxs("select",{value:r.watchShape||"circle",onChange:ne=>{const z=ne.target.value;let Le=466,E=466;z==="square"?(Le=390,E=450):z==="small"&&(Le=240,E=284);const de={...r,watchShape:z,width:Le,height:E};e(de)},style:{padding:"6px 12px",borderRadius:"4px",border:"1px solid #444",backgroundColor:"#2a2a2a",color:"#fff",fontSize:"14px"},children:[L.jsx("option",{value:"circle",children:"Circle (466  466)"}),L.jsx("option",{value:"square",children:"Square (390  450)"}),L.jsx("option",{value:"small",children:"Small (240  284)"})]})]})]}),L.jsxs("div",{className:"toolbar-right",children:[L.jsxs("button",{className:`btn ${u?"btn-primary":"btn-secondary"}`,onClick:De,title:"Toggle Guide Grid",children:[L.jsx(kw,{size:16}),u?"Hide Grid":"Show Grid"]}),L.jsxs("button",{className:"btn btn-secondary",children:[L.jsx(Ow,{size:16}),"Settings"]}),L.jsxs("button",{className:"btn btn-secondary",onClick:V,children:[L.jsx(Fw,{size:16}),"Save Project"]}),L.jsxs("button",{className:"btn btn-secondary",onClick:B,children:[L.jsx(Nu,{size:16}),"Open Project"]}),L.jsx("input",{type:"file",accept:"application/json",style:{display:"none"},ref:O,onChange:te}),L.jsxs("button",{className:"btn btn-primary",onClick:me,children:[L.jsx(Nm,{size:16}),"Export JSON"]}),L.jsxs("button",{className:"btn btn-success",onClick:Me,disabled:o,children:[L.jsx(Nm,{size:16}),o?"Generating...":"Generate Bin File"]})]})]}),L.jsx("div",{className:"canvas-area",children:L.jsxs("div",{className:"watch-canvas",style:{position:"relative",width:r.width,height:r.height,borderRadius:r.watchShape==="circle"?"50%":"20px"},children:[L.jsx("canvas",{ref:P,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:u?1e3:-1,userSelect:"none",display:u?"block":"none"}}),L.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:100},children:r.components.map((ne,z)=>L.jsxs("div",{className:`watch-component ${(t==null?void 0:t.id)===ne.id?"selected":""}`,style:{position:"absolute",left:ne.position.x,top:ne.position.y,width:ne.size.width,height:ne.size.height,border:(t==null?void 0:t.id)===ne.id?"2px solid #0066cc":"1px solid transparent",cursor:"move",zIndex:z},onClick:()=>b(ne),onMouseDown:Le=>{Le.preventDefault();const de=Le.currentTarget.parentElement.getBoundingClientRect(),ce=Le.clientX-de.left,j=Le.clientY-de.top,U=ce-ne.position.x,ae=j-ne.position.y,Ae=ge=>{const Oe=ge.clientX-de.left,Re=ge.clientY-de.top,Be=Math.max(0,Math.min(r.width-ne.size.width,Oe-U)),re=Math.max(0,Math.min(r.height-ne.size.height,Re-ae));ee(ne.id,{x:Be,y:re})},Pe=()=>{document.removeEventListener("mousemove",Ae),document.removeEventListener("mouseup",Pe)};document.addEventListener("mousemove",Ae),document.addEventListener("mouseup",Pe)},children:[ne.images.length>0&&L.jsx(L.Fragment,{children:ne.config.digitPosition==="multi"?L.jsx("div",{style:{display:"flex",width:"100%",height:"100%",justifyContent:"space-between"},children:ne.config.dateTimeFormat==="Year"?L.jsxs(L.Fragment,{children:[L.jsx("img",{src:ne.images[2],alt:"2",style:{width:"22%",height:"100%",objectFit:"contain"}}),L.jsx("img",{src:ne.images[0],alt:"0",style:{width:"22%",height:"100%",objectFit:"contain"}}),L.jsx("img",{src:ne.images[2],alt:"2",style:{width:"22%",height:"100%",objectFit:"contain"}}),L.jsx("img",{src:ne.images[5],alt:"5",style:{width:"22%",height:"100%",objectFit:"contain"}})]}):L.jsxs(L.Fragment,{children:[L.jsx("img",{src:ne.images[1],alt:"1",style:{width:"45%",height:"100%",objectFit:"contain"}}),L.jsx("img",{src:ne.images[2],alt:"2",style:{width:"45%",height:"100%",objectFit:"contain"}})]})}):L.jsx("img",{src:ne.images[0],alt:ne.name,style:{width:"100%",height:"100%",objectFit:"contain",pointerEvents:"none"}})}),L.jsx("div",{className:"component-label",children:ne.name})]},ne.id))})]})})]}),L.jsxs("div",{className:`properties-panel${_?" collapsed":""}`,children:[L.jsxs("div",{className:"properties-header",children:[L.jsx("h3",{children:"Properties"}),L.jsx("button",{className:"btn btn-secondary",style:{minWidth:32},onClick:()=>S(ne=>!ne),title:_?"Expand":"Collapse",children:_?"":""})]}),!_&&(t?L.jsx(Bb,{component:t,onUpdate:G,onDelete:()=>H(t.id)}):L.jsx("div",{className:"no-selection",children:L.jsx("p",{children:"Select a component to edit its properties"})}))]}),L.jsxs("div",{className:`layer-manager-sidebar${T?" collapsed":""}`,children:[L.jsxs("div",{className:"layer-manager-header",children:[L.jsx("h3",{children:"Layers"}),L.jsx("span",{className:"layer-count",children:r.components.length}),L.jsx("button",{className:"btn btn-secondary",style:{minWidth:32,marginLeft:8},onClick:()=>C(ne=>!ne),title:T?"Expand":"Collapse",children:T?"":""})]}),!T&&L.jsxs(L.Fragment,{children:[L.jsx("div",{className:"layer-info-banner",children:L.jsx("p",{children:"Top layers appear in front"})}),L.jsx("div",{className:"layer-list",children:r.components.length===0?L.jsx("div",{className:"no-layers",children:L.jsx("p",{children:"No components yet"})}):r.components.map((ne,z)=>L.jsxs("div",{className:`layer-item ${(t==null?void 0:t.id)===ne.id?"layer-selected":""}`,onClick:()=>n(ne),children:[L.jsxs("div",{className:"layer-controls",children:[L.jsx("button",{className:"layer-btn",onClick:Le=>{Le.stopPropagation(),Ee(z)},disabled:z===0,title:"Move up (bring forward)",children:""}),L.jsx("button",{className:"layer-btn",onClick:Le=>{Le.stopPropagation(),le(z)},disabled:z===r.components.length-1,title:"Move down (send backward)",children:""})]}),L.jsxs("div",{className:"layer-info-text",children:[L.jsx("span",{className:"layer-index",children:z+1}),L.jsx("span",{className:"layer-name",children:ne.name}),L.jsx("span",{className:"layer-type",children:ne.type})]}),L.jsx("button",{className:"layer-btn layer-delete",onClick:Le=>{Le.stopPropagation(),xe(z)},title:"Delete layer",children:""})]},ne.id))})]})]}),h&&L.jsx("div",{className:"modal-overlay",onClick:()=>{g(!1),m(null)},children:L.jsxs("div",{className:"modal-content file-picker-dialog",onClick:ne=>ne.stopPropagation(),children:[L.jsxs("div",{className:"modal-header",children:[L.jsx("h2",{children:"Select Files"}),L.jsx("button",{className:"modal-close",onClick:()=>{g(!1),m(null)},children:""})]}),L.jsxs("div",{className:"modal-body",children:[L.jsx("p",{className:"dialog-message",children:"Click the button below to select image files for your component."}),L.jsxs("div",{className:"modal-actions",children:[L.jsx("button",{className:"btn btn-secondary",onClick:()=>{g(!1),m(null)},children:"Cancel"}),L.jsxs("button",{className:"btn btn-primary btn-large",onClick:F,children:[L.jsx(Nu,{size:16}),"Select Files"]})]})]})]})})]})},ND=({project:r})=>{const[e,t]=vt.useState(!1),[n,i]=vt.useState({time:{hour:12,minute:34,second:56,day:6,month:11,year:2025,weekDay:4},battery:85,bloodOxygen:98,steps:8547,heartRate:72,calories:324,showNoData:!1});vt.useEffect(()=>{if(!e)return;const h=setInterval(()=>{i(g=>{let x=g.time.second+1,m=g.time.minute,y=g.time.hour;return x>=60&&(x=0,m+=1),m>=60&&(m=0,y+=1),y>=24&&(y=0),{...g,time:{...g.time,hour:y,minute:m,second:x}}})},1e3);return()=>clearInterval(h)},[e]);const s=(h,g,x)=>{i(h==="time"?m=>({...m,time:{...m.time,[g]:x}}):m=>({...m,[g]:x}))},o=(h,g)=>{if(!h.images||h.images.length===0)return null;if(h.type==="dateTime"){if(h.config.dateTimeFormat==="Hour"){const m=h.config.leadingZero?g.toString().padStart(2,"0"):g.toString();if(h.config.digitPosition==="tens"){if(!h.config.leadingZero&&g<10)return null;const y=parseInt(m.charAt(0))||0;return h.images[y]||h.images[0]}else if(h.config.digitPosition==="ones"){const y=h.config.leadingZero?parseInt(m.charAt(1))||0:parseInt(m.charAt(m.length-1))||0;return h.images[y]||h.images[0]}}else if(h.config.dateTimeFormat==="Minute"){const m=h.config.leadingZero?g.toString().padStart(2,"0"):g.toString();if(h.config.digitPosition==="tens"){if(!h.config.leadingZero&&g<10)return null;const y=parseInt(m.charAt(0))||0;return h.images[y]||h.images[0]}else if(h.config.digitPosition==="ones"){const y=h.config.leadingZero?parseInt(m.charAt(1))||0:parseInt(m.charAt(m.length-1))||0;return h.images[y]||h.images[0]}}else if(h.config.dateTimeFormat==="Second"){const m=h.config.leadingZero?g.toString().padStart(2,"0"):g.toString();if(h.config.digitPosition==="tens"){if(!h.config.leadingZero&&g<10)return null;const y=parseInt(m.charAt(0))||0;return h.images[y]||h.images[0]}else if(h.config.digitPosition==="ones"){const y=h.config.leadingZero?parseInt(m.charAt(1))||0:parseInt(m.charAt(m.length-1))||0;return h.images[y]||h.images[0]}}else if(h.config.dateTimeFormat==="Day"){const m=g.toString().padStart(2,"0");if(h.config.digitPosition==="tens"){const y=parseInt(m.charAt(0))||0;return h.images[y]||h.images[0]}else if(h.config.digitPosition==="ones"){const y=parseInt(m.charAt(1))||0;return h.images[y]||h.images[0]}}else if(h.config.dateTimeFormat==="Month"){const m=g.toString().padStart(2,"0");if(h.config.digitPosition==="tens"){const y=parseInt(m.charAt(0))||0;return h.images[y]||h.images[0]}else if(h.config.digitPosition==="ones"){const y=parseInt(m.charAt(1))||0;return h.images[y]||h.images[0]}}else if(h.config.dateTimeFormat==="Year"){const m=g.toString().padStart(4,"0");if(h.config.digitPosition==="thousands"){const y=parseInt(m.charAt(0))||0;return h.images[y]||h.images[0]}else if(h.config.digitPosition==="hundreds"){const y=parseInt(m.charAt(1))||0;return h.images[y]||h.images[0]}else if(h.config.digitPosition==="tens"){const y=parseInt(m.charAt(2))||0;return h.images[y]||h.images[0]}else if(h.config.digitPosition==="ones"){const y=parseInt(m.charAt(3))||0;return h.images[y]||h.images[0]}}const x=g%10;return h.images[x]||h.images[0]}else if(h.type==="progress"){const x=Math.max(0,Math.min(100,g/(h.config.maxValue||100)*100)),m=Math.floor(x/100*(h.images.length-1));return h.images[m]||h.images[0]}return h.images[0]||null},c=(h,g)=>{if(h.config.digitPosition!=="multi")return null;if(["Steps","Heart Rate","Blood Oxygen","Calories"].includes(h.config.itemName||h.name)&&n.showNoData&&h.images.length===11)return L.jsx("img",{src:h.images[10],alt:`${h.name} no data`,style:{width:"100%",height:"100%",objectFit:"contain"}});let y="",v=2;h.config.dateTimeFormat==="Year"?(y=g.toString().padStart(4,"0"),v=4):(y=h.config.leadingZero?g.toString().padStart(2,"0"):g.toString(),v=y.length);const _=h.size.width/Math.max(v,2);return L.jsx("div",{style:{position:"relative",width:"100%",height:"100%"},children:y.split("").map((S,T)=>{const C=parseInt(S),A=h.images[C]||h.images[0];return A?L.jsx("img",{src:A,alt:`${h.name} digit ${S}`,style:{position:"absolute",left:T*_,top:0,width:_,height:"100%",objectFit:"contain"}},T):null})})},u=h=>{switch(h.elementType){case 0:return h.config.dateTimeFormat==="Hour"?n.time.hour:h.config.dateTimeFormat==="Minute"?n.time.minute:h.config.dateTimeFormat==="Second"?n.time.second:h.config.dateTimeFormat==="Day"?n.time.day:h.config.dateTimeFormat==="Month"?n.time.month:h.config.dateTimeFormat==="Year"?n.time.year:h.config.dateTimeFormat==="WeekDay"?n.time.weekDay:0;case 1:return n.bloodOxygen;case 2:return n.battery;case 3:return n.steps;case 4:return n.heartRate;case 5:return n.calories;default:return h.config.defaultValue||0}},d=()=>{const h=new Date;i(g=>({...g,time:{hour:h.getHours(),minute:h.getMinutes(),second:h.getSeconds(),day:h.getDate(),month:h.getMonth()+1,year:h.getFullYear(),weekDay:h.getDay()}}))};return L.jsxs("div",{className:"preview-view view-container",children:[L.jsxs("div",{className:"sidebar",children:[L.jsxs("div",{className:"sidebar-header",children:[L.jsx("h3",{children:"Simulation Controls"}),L.jsxs("div",{className:"playback-controls",children:[L.jsx("button",{className:`control-btn ${e?"active":""}`,onClick:()=>t(!e),children:e?L.jsx(Ew,{size:16}):L.jsx(Aw,{size:16})}),L.jsx("button",{className:"control-btn",onClick:d,children:L.jsx(bw,{size:16})})]})]}),L.jsxs("div",{className:"simulation-controls",children:[L.jsxs("div",{className:"control-group",children:[L.jsx("h4",{children:"Time"}),L.jsxs("div",{className:"control-row",children:[L.jsx("label",{children:"Hour:"}),L.jsx("input",{type:"range",min:"0",max:"23",value:n.time.hour,onChange:h=>s("time","hour",parseInt(h.target.value)),className:"slider"}),L.jsx("span",{children:n.time.hour})]}),L.jsxs("div",{className:"control-row",children:[L.jsx("label",{children:"Minute:"}),L.jsx("input",{type:"range",min:"0",max:"59",value:n.time.minute,onChange:h=>s("time","minute",parseInt(h.target.value)),className:"slider"}),L.jsx("span",{children:n.time.minute})]}),L.jsxs("div",{className:"control-row",children:[L.jsx("label",{children:"Second:"}),L.jsx("input",{type:"range",min:"0",max:"59",value:n.time.second,onChange:h=>s("time","second",parseInt(h.target.value)),className:"slider"}),L.jsx("span",{children:n.time.second})]}),L.jsxs("div",{className:"control-row",children:[L.jsx("label",{children:"Day:"}),L.jsx("input",{type:"range",min:"1",max:"31",value:n.time.day,onChange:h=>s("time","day",parseInt(h.target.value)),className:"slider"}),L.jsx("span",{children:n.time.day})]}),L.jsxs("div",{className:"control-row",children:[L.jsx("label",{children:"Month:"}),L.jsx("input",{type:"range",min:"1",max:"12",value:n.time.month,onChange:h=>s("time","month",parseInt(h.target.value)),className:"slider"}),L.jsx("span",{children:n.time.month})]})]}),L.jsxs("div",{className:"control-group",children:[L.jsx("h4",{children:"Health & Battery"}),L.jsxs("div",{className:"control-row",children:[L.jsx("label",{children:"Battery:"}),L.jsx("input",{type:"range",min:"0",max:"100",value:n.battery,onChange:h=>s("","battery",parseInt(h.target.value)),className:"slider"}),L.jsxs("span",{children:[n.battery,"%"]})]}),L.jsxs("div",{className:"control-row",children:[L.jsx("label",{children:"Blood O2:"}),L.jsx("input",{type:"range",min:"90",max:"100",value:n.bloodOxygen,onChange:h=>s("","bloodOxygen",parseInt(h.target.value)),className:"slider"}),L.jsxs("span",{children:[n.bloodOxygen,"%"]})]}),L.jsxs("div",{className:"control-row",children:[L.jsx("label",{children:"Steps:"}),L.jsx("input",{type:"range",min:"0",max:"20000",value:n.steps,onChange:h=>s("","steps",parseInt(h.target.value)),className:"slider"}),L.jsx("span",{children:n.steps.toLocaleString()})]}),L.jsxs("div",{className:"control-row",children:[L.jsx("label",{children:"Heart Rate:"}),L.jsx("input",{type:"range",min:"60",max:"120",value:n.heartRate,onChange:h=>s("","heartRate",parseInt(h.target.value)),className:"slider"}),L.jsxs("span",{children:[n.heartRate," bpm"]})]}),L.jsxs("div",{className:"control-row",children:[L.jsx("label",{children:"Calories:"}),L.jsx("input",{type:"range",min:"0",max:"5000",value:n.calories,onChange:h=>s("","calories",parseInt(h.target.value)),className:"slider"}),L.jsx("span",{children:n.calories.toLocaleString()})]}),L.jsxs("div",{className:"control-section",children:[L.jsx("h4",{children:"Data State"}),L.jsxs("div",{className:"control-row",children:[L.jsx("label",{children:'Show "No Data":'}),L.jsx("input",{type:"checkbox",checked:n.showNoData,onChange:h=>s("","showNoData",h.target.checked?1:0),className:"control-checkbox"})]}),L.jsx("p",{className:"help-text",children:'Toggle to preview the "no data" image for Steps, Heart Rate, Blood Oxygen, and Calories components'})]})]})]})]}),L.jsxs("div",{className:"main-area",children:[L.jsxs("div",{className:"preview-header",children:[L.jsx("h3",{children:"Live Preview"}),L.jsxs("div",{className:"preview-info",children:[L.jsxs("span",{children:["Components: ",r.components.length]}),L.jsxs("span",{children:["Time: ",n.time.hour.toString().padStart(2,"0"),":",n.time.minute.toString().padStart(2,"0"),":",n.time.second.toString().padStart(2,"0")]})]})]}),L.jsx("div",{className:"canvas-area",children:L.jsx("div",{className:"watch-canvas",children:r.components.map(h=>{const g=u(h);if(h.type==="analog"){let x=0;const m=h.config.valueIndex||0;if(m===0){const _=n.time.hour%12,S=n.time.minute;x=_*30+S*.5}else m===1?x=n.time.minute*6:m===2&&(x=n.time.second*6);const y=h.config.originPointX||13,v=h.config.originPointY||233;return L.jsx("div",{className:"preview-component analog-hand",style:{position:"absolute",left:h.position.x,top:h.position.y,width:h.size.width,height:h.size.height},children:h.images[0]?L.jsx("img",{src:h.images[0],alt:h.name,style:{width:"100%",height:"100%",objectFit:"contain",transformOrigin:`${y}px ${v}px`,transform:`rotate(${x}deg)`}}):L.jsx("div",{className:"placeholder-component",children:L.jsx("span",{children:h.name})})},h.id)}return L.jsx("div",{className:"preview-component",style:{position:"absolute",left:h.position.x,top:h.position.y,width:h.size.width,height:h.size.height},children:h.config.digitPosition==="multi"?c(h,g):(()=>{const x=o(h,g);return x?L.jsx("img",{src:x,alt:h.name,style:{width:"100%",height:"100%",objectFit:"contain"}}):L.jsx("div",{className:"placeholder-component",children:L.jsx("span",{children:h.name})})})()},h.id)})})})]})]})};function ID(){const[r,e]=vt.useState("assembly"),[t,n]=vt.useState({id:"project-"+Date.now(),watchName:"My Watch Face",watchCode:"MWF",deviceType:"Hsad",width:466,height:466,watchShape:"circle",createTime:new Date().toISOString(),colorBit:16,folderName:"MWF_MyWatchFace_Hsad",components:[]}),i=s=>{n(s)};return L.jsxs("div",{className:"app",children:[L.jsxs("div",{className:"app-header",children:[L.jsx("h1",{children:"Watch Face Assembly Tool"}),L.jsxs("div",{className:"app-nav",children:[L.jsx("button",{className:`nav-btn ${r==="assembly"?"active":""}`,onClick:()=>e("assembly"),children:"Assembly"}),L.jsx("button",{className:`nav-btn ${r==="preview"?"active":""}`,onClick:()=>e("preview"),children:"Preview"})]})]}),L.jsx("div",{className:"app-content",children:r==="assembly"?L.jsx(MD,{project:t,onProjectUpdate:i}):L.jsx(ND,{project:t})})]})}vw.createRoot(document.getElementById("root")).render(L.jsx(Lx.StrictMode,{children:L.jsx(ID,{})}));
//# sourceMappingURL=index-CXuBX9vH.js.map
